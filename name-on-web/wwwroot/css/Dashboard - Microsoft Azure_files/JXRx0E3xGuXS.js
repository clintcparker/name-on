define("MsPortalImpl/UI/Compositions/UI.Composition.BladeOpener.Selectable2",["require","exports","f","i","o","MsPortalImpl/UI/Compositions/UI.Composition.BladeOpenerBase","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/ViewModels/ViewModels.BladeCaller"],(function(n,t,i,r,u,f,e,o){"use strict";function c(n){var t=h(n);return t&&t.type===20560}function y(n,t,i){var r=t.collectorContainer;r&&(f.bindOutputsToSelectable2(n,t,i,[o.bindingName_bladeCallerResult],(function(n){r.onInputsSetCallbacks.triggerCallbacks(n,undefined)})),i.registerForDispose((function(){r.dispose();t.collectorContainer===r&&(t.collectorContainer=null)})))}function p(n,t){var i=h(n);return Q(i.getBladeConfig()).then((function(n){var r=new l,f={selectable:t,supplyProviderConfig:function(){return n.config},supplyInitialData:function(){return n.initialState},receiveResult:function(n){i.receiveResult(n)},fxInternalFI:!0},u=new s.ParameterCollector(r,f);return r.collector=u,t.collectorContainer=r,r.onInputsSetCallbacks.triggerCallbacks({},undefined),u}))}function w(n,t){n.detailBladeInputs=i.clone(n.detailBladeInputs,!0,!0);n.flags=n.flags|64;var r=n.detailBladeInputs,u=t.bladeCaller;r[o.bindingName_bladeCallId]=u[o.bindingName_bladeCallId]();r[o.bindingName_bladeCallerParams]=u[o.bindingName_bladeCallerParams]()}function b(n,t){var r,i=[];return i[2]=function(n,i){var u=i.bladeRequest.bladeReference;if(c(u))return p(u,t.selectable).then((function(n){r=n}))},i[4]=function(n,t){if(c(t.bladeRequest.bladeReference)){w(t.selection,r);return}},i}function k(n,t){var i=[];return i[5]=function(i,r){var u=r.openedBlades&&r.openedBlades.length===1&&r.openedBlades[0];u&&y("Selectable2ParameterCollector",t.selectable2,u);var f=r.value,e=f&&f.operationId,o=t.selectable2.notifyBladeOpenCompleted,s=o.bind(null,e,!1),h=o.bind(null,e,!0);f&&f.flags&4&&(u?u.awaitComposed().then(h,s):r.reboundBlade?h():s());d(t.container,n.services.desktop,f,u||r.reboundBlade);return},i}function d(n,t,i,r){var f=i&&i.onClosed,u,o;r&&f&&(u=n.createChildLifetime(),o=[e.DesktopManagerEvents.bladeClosed,e.DesktopManagerEvents.bladeRebound].join(" "),u.registerForDispose($(t).setEvents([o,function(n,t){t.id===r.id&&(u.dispose(),f(t.reason||1,r.returnValue))}])))}var l;u.defineProperty(t,"__esModule",{value:!0});var a=r.TriggerableLifetimeManager,s=i.ViewModels,v=s.Internal,h=r.shellInterface;l=(function(n){function t(){var t=n.call(this)||this;return t.onInputsSetCallbacks=v.createOnInputsSetCallbacks(),t}return __extends(t,n),t})(a);t.parameterCollectorHandler=b;t.selectable2InvocationHandler=k}))