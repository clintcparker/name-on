define("MsPortalImpl.Controls/Controls/Forms/Selector",["require","exports","f","o","ko","MsPortalImpl.Controls/Controls/Base/ValidatableControl","Viva.Controls/Controls/Base/ValidationPlacements/Viva.Css","MsPortalImpl.Controls/Controls/Forms/SelectorBase","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u,f,e,o,s){"use strict";var h;return (function(n){var l=i.Base.Images,y=l.Shell,a="fxs-portal-hover",p="fxc-selector-disabled",w="fxc-selector-locked",t="fxc-selector",h=(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t})(o.BaseViewModel),c,v;n.BaseViewModel=h;c=(function(n){function i(i,r,u){var f=this;return u=u||{},u.viewModelType=u.viewModelType||h,f=n.call(this,i,r,u)||this,i.addClass(t).addClass(a),f.$tabIndex.subscribeAndRun(f.ltm,(function(n){i.attr("tabindex",n)})),f}return __extends(i,n),i.prototype.dispose=function(){n.prototype.dispose.call(this)},r.defineProperty(i.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),i.prototype._addHtml=function(){n.prototype._addHtml.call(this)},i.prototype._afterCreate=function(){n.prototype._afterCreate.call(this)},i.prototype._attachEvents=function(){var t=this;n.prototype._attachEvents.call(this);this.ltm.registerForDispose(this.element.setEvents([s.default.click,function(n){t._activateSelector();n.stopPropagation()},],[s.default.keypress,function(n){(n.keyCode===13||n.keyCode===32)&&(n.stopImmediatePropagation(),t._activateSelector(),n.preventDefault());n.stopPropagation()},]))},i.prototype._initializeComputeds=function(){var t=this;n.prototype._initializeComputeds.call(this);u.computed(this.ltm,(function(){var r=t.options,n=r.locked(),i=t.$disabled();t._chevronIcon(n?l.Lock():y.Chevron());t.element.toggleClass(w,!!n).toggleClass(p,!!i).toggleClass(a,!i);t.element.attr("aria-disabled",n||i?!0:null)}))},i})(o.BaseWidget);n.BaseWidget=c;v=(function(n){function i(i,r,u){var f=n.call(this,i,r,u)||this;return f.element.addClass(t),f._initializeWidgets(),f}return __extends(i,n),r.defineProperty(i.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),i.prototype.dispose=function(){this._checkExistsOrRegisterDestroyId(n.prototype.dispose)||(this.element.removeClass(t).removeAttr("aria-disabled"),n.prototype.dispose.call(this))},i.prototype._initializeWidgets=function(){this._nestedViewModel=this._getNestedViewModel();var n=new c(this.element,this._nestedViewModel);this._validatableWidgets.push(n);this._widgets.push(n)},i.prototype._getNestedViewModel=function(){var t=this.ltm,n=new h(this.vmBasicOption);return n.populateFromObject(this.options),n.validationPlacements.push(new e.Css(t)),n.isDefault||(n.isDefault=u.computed(t,(function(){return n.value()===n.defaultValue()}))),u.utils.twoWayBinding(t,this.options.selectable.isSelected,n.selected),n.selectable=null,n},i})(f.Widget);n.Widget=v})(h||(h={})),h}));
define("MsPortalImpl.Controls/Fields/SelectorField",["require","exports","f","i","o","ko","$","MsPortalImpl.Controls/Controls/Forms/Selector","MsPortalImpl.Controls/Fields/Base/Field","MsPortalImpl/Resources/ImplScriptResources","Viva.Controls/Controls/Base/ValidationPlacements/Viva.Css","Viva.Controls/Controls/Base/Viva.Validators","MsPortalImpl/Base/Base.Selectable2","MsPortalImpl/UI/Compositions/UI.Composition.Selectable2Registrar","_generated/Less/MsPortalImpl.Controls/Fields/Selector.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){"use strict";var y;return (function(n){var b=i.ViewModels,t=jQuery,p="<label id='{0}' style='display:none;'>{1}<\/label>",e="azc-selectorField",y="fxc-selectorField",w=(function(n){function s(t,i,r){return n.call(this,t,i,r)||this}return __extends(s,n),s.prototype._initializeField=function(){n.prototype._initializeField.call(this);this.element.addClass(e).addClass(y);this.selectorInit()},s.prototype.dispose=function(){this._checkExistsOrRegisterDestroyId(n.prototype.dispose)||(this.element.removeClass(e).removeClass(y),n.prototype.dispose.call(this))},u.defineProperty(s.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),u.defineProperty(s.prototype,"validatableViewModel",{get:function(){return this._selectorViewModel},enumerable:!0,configurable:!0}),u.defineProperty(s.prototype,"validatableWidget",{get:function(){return this._selectorWidget},enumerable:!0,configurable:!0}),s.prototype.selectorInit=function(){var e=this,n,r=this.ltm,s,v;this._requiredValidator=new l.Required(r,null);this._isRequired=f.computed(r,(function(){return e.options.validations().some((function(n){return n.type===1}))}));this._hasValue=f.observable(!1);this._selectorViewModel=new o.BaseViewModel(this.vmBasicOption);s=this._selectorViewModel;s.validationPlacements.push(new c.Css(r));n=t("<div />");this.appendControl(n);this.linkSelectorViewModels();this._selectorWidget=new o.BaseWidget(n,s);var u=this._selectorWidget,a="azc-selector-guid-"+i.getUniqueId(),y=a+"-balloon",w=function(n,t){return e.element.find(n).attr("id",t)};w(".azc-dockedballoon-anchor",y);v=w("label",a)[0];v&&v.textContent||t(p.format(a+="-default",h.Controls.creatorAndSelectorLabel)).insertBefore(n);f.computed(this.ltm,[this.options.showValue,u._validationErrElemId],(function(t,i){var r=[i||"",y,u._descElemId];t&&r.splice(1,0,u._displayTextElemId);n.attr("aria-describedby",r.join(" "))}));f.computed(r,[this.options.ariaLabel,this.options.label],(function(t,i){var r=t||i;e._isRequired()&&(r+=". "+h.requiredField);n.attr("aria-label",r?r:null)}));f.computed(r,[this._isRequired,this.options.valid],(function(n,t){u._isRequired(n);u._showRequiredBalloon(n&&t)}));this._hasValue.subscribeAndRun(r,u._hasValue);this.setupValidationBindings()},s.prototype.linkSelectorViewModels=function(){var c=this,i=this.options,n=this._selectorViewModel,u=this.ltm,e=i.selectable,o,s;!e&&i._msPortalFxOnClick&&(e=v.getSelectableWithClickHandler(i,this.element,i._msPortalFxOnClick));o=e.isSelected;s=n.selected;r.isSelectable2(e)&&(e=a.getOrCreate(e));n.value=i._msPortalFxWidgetValue;i.label.subscribeAndRun(u,n.label);i.showValue.subscribeAndRun(u,n.showValue);i.icon.subscribeAndRun(u,n.icon);i.isDefault?(n.isDefault=f.observable(),f.computed(u,(function(){n.isDefault(i.isDefault())}))):n.isDefault=f.computed(u,(function(){return n.value()===n.defaultValue()}));f.computed(u,(function(){n.displayText(c._isRequired()&&!c._checkIfValueExists()&&!t.trim(c.options.displayText())?h.Selector.valueRequired:i.displayText())}));i.locked.subscribeAndRun(u,n.locked);i.infoBalloonText.subscribeAndRun(u,n.infoBalloonText);i.infoBalloonLink.subscribeAndRun(u,n.infoBalloonLink);i.lockedBalloonText.subscribeAndRun(u,n.lockedBalloonText);o.subscribe(u,(function(t){s()!==t&&s(t);c.getPerformValidationFromViewModel()&&!t&&n.enableValidation(!0)}));s(o());s.subscribe(u,(function(n){n!==o()&&(n?e.onClick():o(n))}));this.linkValidatableControlViewModels()},s.prototype._createLabelAndSubLabel=function(){this._attachLabelAndSubLabel({inhibitLabel:!0})},s.prototype._checkIfValueExists=function(){var n=this._selectorViewModel.value(),t=!(n===null||n===undefined);return typeof n=="string"&&(t=this._requiredValidator._validate(n)===2),this._hasValue(t),t},s})(s.FieldWidget);n.Widget=w})(y||(y={})),y}))