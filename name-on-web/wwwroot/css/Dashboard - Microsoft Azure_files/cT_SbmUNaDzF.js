define("MsPortalImpl.Controls/Fields/DropDownField",["require","exports","o","ko","MsPortalImpl.Controls/Fields/Base/Field","Viva.Controls/Controls/Forms/Viva.GroupDropDown","Viva.Controls/Controls/Base/ValidationPlacements/Viva.Css","Viva.Controls/Controls/Base/ValidationPlacements/Viva.DockedBalloon"],(function(n,t,i,r,u,f,e,o){"use strict";var s;return (function(n){var t=(function(n){function t(t,i,r){return n.call(this,t,i,r)||this}return __extends(t,n),t.prototype._initializeField=function(){n.prototype._initializeField.call(this);this.element.addClass("azc-dropdownField").addClass("fxc-DropDownField");this.dropDownFieldInit()},t.prototype.dispose=function(){n.prototype.dispose.call(this);this._dropDownWidget&&(this._dropDownWidget.dispose(),this._dropDownWidget=null,this._dropDownViewModel=null);this._cleanElement("azc-dropdownField","fxc-DropDownField")},i.defineProperty(t.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),i.defineProperty(t.prototype,"validatableViewModel",{get:function(){return this._dropDownViewModel},enumerable:!0,configurable:!0}),i.defineProperty(t.prototype,"validatableWidget",{get:function(){return this._dropDownWidget},enumerable:!0,configurable:!0}),t.prototype.dropDownFieldInit=function(){var t=this.ltm,i=this._dropDownViewModel=new f.ViewModel(this.vmBasicOption),n;i.validationPlacements.push(new e.Css(t),new o.DockedBalloon(t,o.DockedBalloon.defaultOptions));n=$("<div />");this.appendControl(n);this.linkDropDownViewModels();this._addWidget(this._dropDownWidget=new f.Widget(n,i));this.setupValidationBindings()},t.prototype.linkDropDownViewModels=function(){var t=this._dropDownViewModel,n=t.items,i=this.options,r=function(t,i){i===void 0&&(i=-1);var r=f.ViewModel.createDropdownItemsFromArray(t,{textKey:"text",valueKey:"value",disabledKey:"disabled"});i<0?r.forEach((function(t){n.push(t)})):r.forEach((function(t){n.splice(i++,0,t)}))},u=function(i){var r=t.valueItems().first((function(n){return n.value()===i.value}));r&&n&&n().length>0&&n.remove(r)};r(i.options());i.options.subscribeArrayEdits(this.ltm,(function(n){n.forEach((function(n){var t=n.value;n.status==="added"?r([t],n.index):n.status==="deleted"&&u(t)}))}));t.value=i._msPortalFxWidgetValue;this.linkValidatableControlViewModels()},t})(u.FieldWidget);n.Widget=t})(s||(s={})),s}))