define("WebsitesExtension/TypeScript/AppServiceEnvironment/Utilities/Utilities",["require","exports","f","$","Websites/ClientResources/GeneralResources","WebsitesExtension/TypeScript/Ajax/Ajax","WebsitesExtension/TypeScript/AppServiceEnvironment/Models/ASEModels","WebsitesExtension/TypeScript/Utility/Utility.Website","WebsitesExtension/TypeScript/ExtensionAssets/Constants"],(function(n,t,i,r,u,f,e,o,s){"use strict";var h;return (function(n){function t(n){var t=n.toString();switch(n){case e.HostingEnvironmentStatus.Preparing:t=u.Enums.HostingEnvironmentStatus.preparing;break;case e.HostingEnvironmentStatus.Deleting:t=u.Enums.HostingEnvironmentStatus.deleting;break;case e.HostingEnvironmentStatus.Ready:t=u.Enums.HostingEnvironmentStatus.ready;break;case e.HostingEnvironmentStatus.Scaling:t=u.Enums.HostingEnvironmentStatus.scaling;break;default:o.logError("HostingEnvironmentStatus: Unknown enum value {0}".format(n))}return t}function h(){return i.Services.Rpc.invokeCallback(s.VirtualNetworks.
VnetClassicExtensionName,"ListVirtualNetworks",!1)}function c(){return i.Services.Rpc.invokeCallback(s.VirtualNetworks.VnetClassicExtensionName,"GetVirtualNetworkDefaultAddressSpace",25)}function l(n){if(!n)return"";var t=i.ViewModels.Services.ResourceTypes.parseResourceDescriptor(n);return t&&t.provider===s.ResourceTypes.ClassicNetworkProvider?s.VirtualNetworks.VnetClassicExtensionName:s.VirtualNetworks.VnetV2ExtensionName}function a(n){if(!n)return"";var t=i.ViewModels.Services.ResourceTypes.parseResourceDescriptor(n);return t&&t.provider===s.ResourceTypes.ClassicNetworkProvider?s.VirtualNetworks.VnetClassicSubnetBladeName:s.VirtualNetworks.VnetV2SubnetBladeName}function v(n,t){var i=r.Deferred(),e=!0,o;return t?f.validateEnvironmentName(n,t).done((function(n){e=n;e||(o=u.appServiceNameNotAvailable.format(t));i.resolve({valid:e,message:o})})).fail((function(){i.reject(u.appServiceNameFailValidation)})):i.reject(u.appServiceNameFailValidation),i.promise()}function y(n,t){var i=null;return!n||
!n.ClusterSettings()||n.ClusterSettings().forEach((function(n){n.Name()===s.Asset.ClusterSettingName&&n.Value()===t&&(i=n)})),i}n.getHostingEnvironmentStatus=t;n.getVNETList=h;n.getVNETDefaultAddress=c;n.getVnetExtensionNameFromVnetId=l;n.getVnetSubnetBladeNameExtensionFromVnetId=a;n.validateEnvironmentName=v;n.getClusterSettingCorrelatedToCert=y})(h||(h={})),h}));define("WebsitesExtension/TypeScript/Helpers/NotificationHelper",["require","exports","f","o","WebsitesExtension/TypeScript/Utility/Utility.Notifications"],(function(n,t,i,r,u){"use strict";var f;return (function(n){function f(n,t){var r=new i.Hubs.Notifications.ClientNotification({title:n.inProgressTitle,description:n.inProgressMessage,status:i.Hubs.Notifications.NotificationStatus.InProgress,asset:n.assetInfo});r.publish();t.then((function(){r.title=n.successTitle;r.description=n.successMessage;r.status=i.Hubs.Notifications.NotificationStatus.Success;r.publish()}),(function(t){r.title=n.failureTitle;r.status=i.Hubs.Notifications.NotificationStatus.
Error;u.setErrorDescription(r,t,n.failureMessage);r.publish()})).progress((function(){r.title=n.inProgressTitle;r.description=n.inProgressMessage;r.status=i.Hubs.Notifications.NotificationStatus.InProgress;r.publish()}))}function e(n){if(!n)return"";if(n.responseJSON)return n.responseJSON.Message||n.responseJSON.message||"";try{if(n.responseText){var t=JSON.parse(n.responseText);if(t)return t.Message||t.message||""}}catch(i){}return""}var t=(function(){function n(n,t,i,r,u,f,e){this._inProgressTitle=u;this._inProgressMessage=f;this._successTitle=n;this._successMessage=t;this._failureTitle=i;this._failureMessage=r;this.assetInfo=e}return r.defineProperty(n.prototype,"inProgressTitle",{get:function(){return this._inProgressTitle},enumerable:!0,configurable:!0}),r.defineProperty(n.prototype,"inProgressMessage",{get:function(){return this._inProgressMessage},enumerable:!0,configurable:!0}),r.defineProperty(n.prototype,"successTitle",{get:function(){return this._successTitle},enumerable:!0,configurable:
!0}),r.defineProperty(n.prototype,"successMessage",{get:function(){return this._successMessage},enumerable:!0,configurable:!0}),r.defineProperty(n.prototype,"failureTitle",{get:function(){return this._failureTitle},enumerable:!0,configurable:!0}),r.defineProperty(n.prototype,"failureMessage",{get:function(){return this._failureMessage},enumerable:!0,configurable:!0}),n})();n.NotificationSettings=t;n.trackOperationState=f;n.getXhrError=e})(f||(f={})),f}));define("WebsitesExtension/TypeScript/Utility/Utility.DynamicBladeSelection",["require","exports","WebsitesExtension/TypeScript/ExtensionAssets/Constants","WebsitesExtension/TypeScript/AppServiceEnvironment/Utilities/Utilities"],(function(n,t,i,r){"use strict";var u;return (function(n){function t(n){return{extension:r.getVnetExtensionNameFromVnetId(n),detailBlade:i.VirtualNetworks.VnetBladeName,detailBladeInputs:{id:n}}}function u(n){return{extension:r.getVnetExtensionNameFromVnetId(n),detailBlade:r.getVnetSubnetBladeNameExtensionFromVnetId(
n),detailBladeInputs:{id:n}}}n.getVnetBlade=t;n.getVnetSubnetBlade=u})(u||(u={})),u}));define("WebsitesExtension/TypeScript/VPNNetwork/Models/VPNNetwork",["require","exports"],(function(){"use strict";var n;return (function(n){var t;(function(n){n[n.NotInSync=0]="NotInSync";n[n.InSync=1]="InSync";n[n.NotFound=2]="NotFound"})(t=n.CertSyncStatus||(n.CertSyncStatus={}))})(n||(n={})),n}));define("WebsitesExtension/TypeScript/VPNNetwork/Data/VPNNetworkData",["require","exports","f","WebsitesExtension/TypeScript/Utility/Utility.Slots","WebsitesExtension/TypeScript/Ajax/Ajax","WebsitesExtension/TypeScript/Helpers/NotificationHelper","Websites/ClientResources/GeneralResources","WebsitesExtension/TypeScript/Utility/Utility.Cache","WebsitesExtension/TypeScript/Deprecated/ExtensionCore/Data/DataCacheLoader","WebsitesExtension/TypeScript/Deprecated/ExtensionCore/Data/AtomizationContext","WebsitesExtension/TypeScript/Deprecated/ExtensionCore/Data/AtomizedDataCacheLoader","WebsitesExtension/TypeScript/Deprecated/ExtensionCore/Data/AtomizationScope"],
(function(n,t,i,r,u,f,e,o,s,h,c,l){"use strict";var a,v,y,p,w,b,k,d;return (function(n){var t=e.Network,a=(function(){function n(){var n=this;this.atomizationContext=new h;this.HostingPlanVPNNetworkQueryCache=new i.Data.QueryCache({loader:new s({entityTypeName:"Microsoft.Portal.Extensions.Websites.Base.Models.VPNNetwork",sourceUri:function(){return"/api/Websites/GetHostingPlanVPNNetworks"},httpMethod:"POST"})});this.AppServicePlanVirtualNetworkSummaryQueryCache=new i.Data.QueryCache(new o.DataConfig({entityTypeName:"Microsoft.Portal.Extensions.Websites.Base.Models.VirtualNetworkSummary",sourceUri:function(){return"/api/Websites/GetAppServicePlanVirtualNetworkSummary"},httpMethod:"POST"}));this.VirtualNetworkRegionsQueryCache=new i.Data.QueryCache(new o.DataConfig({sourceUri:function(){return"/api/Websites/GetV2VirtualNetworkRegions"},httpMethod:"POST",requestBody:function(n){return{SubscriptionId:n}}}));this.V2VirtualNetworksQueryCache=new i.Data.QueryCache(new o.DataConfig({entityTypeName:
"Microsoft.Portal.Extensions.Websites.Base.Models.VirtualNetwork",sourceUri:function(){return"/api/Websites/ListV2VirtualNetworks"},httpMethod:"POST",requestBody:function(n){return{SubscriptionId:n}}}));this.V2VirtualNetworksWithStatusQueryCache=new i.Data.QueryCache(new o.DataConfig({entityTypeName:"Microsoft.Portal.Extensions.Websites.Base.Models.VirtualNetwork",sourceUri:function(){return"/api/Websites/ListV2VirtualNetworksWithStatus"},httpMethod:"POST",requestBody:function(n){return{SubscriptionId:n}}}));this.VirtualNetworkV2LocalNetworksQueryCache=new i.Data.QueryCache(new o.DataConfig({entityTypeName:"Microsoft.Portal.Extensions.Websites.Base.Models.VirtualNetworkV2LocalNetworkGateway",sourceUri:function(){return"/api/Websites/GetGatewayV2LocalNetworks"},httpMethod:"POST",requestBody:function(n){return{ResourceUri:n}}}));this.VPNNetworkQueryCache=new i.Data.QueryCache({loader:new c({entityTypeName:"Microsoft.Portal.Extensions.Websites.Base.Models.VPNNetwork",sourceUri:function(){
return"/api/Websites/GetVPNNetworks"},httpMethod:"POST",atomization:{context:this.atomizationContext,scope:l.List,partitionKey:function(t){var i=r.parseWebsiteName(t.Name);return n._getPartitionKey(t.SubscriptionId,t.ResourceGroup,i.ProductionSiteName,i.SlotName)}}})});this.AppServicePlanWebAppsInVirtualNetworkQueryCache=new i.Data.QueryCache(new o.DataConfig({sourceUri:function(){return"/api/Websites/GetVirtualNetworkWebApps"},httpMethod:"POST",requestBody:function(n){return{ResourceUri:n}}}));this.VirtualNetworkEntityCache=new i.Data.EntityCache(new o.DataConfig({entityTypeName:"Microsoft.Portal.Extensions.Websites.Base.Models.VirtualNetwork",sourceUri:function(){return"/api/Websites/GetVirtualNetwork"},httpMethod:"POST",requestBody:function(n){return{ResourceUri:n}}}));this.VirtualNetworkGatewayEntityCache=new i.Data.EntityCache(new o.DataConfig({entityTypeName:"Microsoft.Portal.Extensions.Websites.Base.Models.VirtualNetworkGateway",sourceUri:function(){return"/api/Websites/GetVirtualNetworkGateway"}
,httpMethod:"POST",requestBody:function(n){return{ResourceUri:n}}}));this.VirtualNetworkGatewayV2EntityCache=new i.Data.EntityCache(new o.DataConfig({entityTypeName:"Microsoft.Portal.Extensions.Websites.Base.Models.VirtualNetworkGatewayV2",sourceUri:function(){return"/api/Websites/GetVirtualNetworkGatewayV2"},httpMethod:"POST",requestBody:function(n){return{ResourceUri:n}}}));this.VirtualNetworkRouteQueryCache=new i.Data.QueryCache(new o.DataConfig({entityTypeName:"Microsoft.Portal.Extensions.Websites.Base.Models.VirtualNetworkRoute",sourceUri:function(){return"/api/Websites/ListVirtualNetworkRoutes"},httpMethod:"POST",requestBody:function(n){return{ResourceUri:n}}}));this.VPNNetworkEntityCache=new i.Data.EntityCache({loader:new c({entityTypeName:"Microsoft.Portal.Extensions.Websites.Base.Models.VPNNetwork",sourceUri:function(){return"/api/Websites/GetVPNNetwork"},httpMethod:"POST",requestBody:function(n){return{ResourceUri:n}},atomization:{context:this.atomizationContext,scope:l.SingleItem,
itemMatchesAtomization:function(n,t){return AntUx.StringEx.equals(n.Id(),t,AntUx.StringComparison.IgnoreCase)},partitionKey:function(t){var r=i.ViewModels.Services.ResourceTypes.parseResourceDescriptor(t),u=r.resources.length===3?r.resources[1]:"";return n._getPartitionKey(r.subscription,r.resourceGroup,r.resources[0],u)}}})});this.VPNNetworkGatewayStatusCache=new i.Data.EntityCache({loader:new s({entityTypeName:"Microsoft.Portal.Extensions.Websites.Base.Models.VPNNetwork",sourceUri:function(){return"/api/Websites/VPNNetworkGetGatewayStatus"},httpMethod:"POST",requestBody:function(n){return{SubscriptionId:n.SubscriptionId,SiteId:{Name:n.Name,ResourceGroup:n.ResourceGroup},GetGatewayStatus:n.GetGatewayStatus}}})});this.VirtualNetworkRouteEditScopeCache=i.Data.EditScopeCache.create({entityTypeName:"Microsoft.Portal.Extensions.Websites.Base.Models.VirtualNetworkRoute",supplyExistingData:function(t,i){var r=n.VirtualNetworkRouteQueryCache.createView(i),u=Q.defer();return r.fetch(t).then((function(
){u.resolve(r.items)})),u.promise},refreshEditScope:function(t,i){return n.VirtualNetworkRouteQueryCache.createView(i).fetch(t)},saveEditScopeChanges:function(n,r,e){var h=[],s,o,c;return r.root().forEach((function(t){r.getEditState(t)()===i.Data.EditState.Deleted&&(s=n+"/routes/"+t.Name(),h.push(u.post("DeleteVirtualNetworkRoute",{ResourceUri:s})))})),e.forEach((function(t){if(t.editState===i.Data.EditState.Created||t.editState===i.Data.EditState.Updated){var r=t.entity;r.Name()||r.Name(r.StartAddress());r.RouteType("STATIC");r.DenyRoute(!1);s=n+"/routes/"+r.Name();h.push(u.post("PutVirtualNetworkRoute",{ResourceUri:s,Route:r}))}})),o=Q.defer(),Q.all(h).then((function(){return o.resolve(),{action:i.Data.AcceptEditScopeChangesAction.AcceptClientChanges}}),(function(){return o.reject(),{action:i.Data.AcceptEditScopeChangesAction.AcceptClientChanges}})),c=new f.NotificationSettings(t.routesUpdateSuccessTitle,t.routesUpdateSuccessText,t.routesUpdateFailureTitle,t.routesUpdateFailureText,t.routesUpdateInProgressTitle,
t.routesUpdateInProgressText),f.trackOperationState(c,o.promise),o.promise}})}return n.prototype._getPartitionKey=function(n,t,i,r){return"{0}~{1}~{2}~{3}".format(n,t,i,r||"production")},n})();n.VPNNetworkData=a})(a||(a={})),v={name:"Microsoft.Portal.Extensions.Websites.Base.Models.VPNNetwork",properties:{Id:null,VnetResourceId:null,VnetName:null,VnetGuid:null,CertsInSync:null,CertBlob:null,CertThumbprint:null,OperationId:null,GatewayStatus:null},idProperties:["Id"],entityType:!0},i.Data.Metadata.setTypeMetadata(v.name,v),y={name:"Microsoft.Portal.Extensions.Websites.Base.Models.VirtualNetworkRoute",properties:{StartAddress:null,EndAddress:null,Name:null,DenyRoute:null,RouteType:null},idProperties:["Name"],entityType:!0},i.Data.Metadata.setTypeMetadata(y.name,y),p={name:"Microsoft.Portal.Extensions.Websites.Base.Models.VirtualNetworkSummary",properties:{VnetName:null,VnetNameProper:null,VnetResourceUri:null,VnetGatewayStatus:null},idProperties:["VnetNameProper"],entityType:!0},i.Data.Metadata.
setTypeMetadata(p.name,p),w={name:"Microsoft.Portal.Extensions.Websites.Base.Models.VirtualNetwork",properties:{Name:null,Location:null,ProvisioningState:null,Status:null,SiteId:null,InUse:null,AddressSpace:null,VpnClientAddressSpace:null,GatewayProfile:null,DhcpOptions:null},idProperties:["Name"],entityType:!0},i.Data.Metadata.setTypeMetadata(w.name,w),b={name:"Microsoft.Portal.Extensions.Websites.Base.Models.VirtualNetworkGateway",properties:{ProvisioningState:null,Status:null,RoutingType:null,GatewayIpAddress:null},idProperties:["GatewayIpAddress"],entityType:!0},i.Data.Metadata.setTypeMetadata(b.name,b),k={name:"Microsoft.Portal.Extensions.Websites.Base.Models.VirtualNetworkGatewayV2",properties:{Location:null,ProvisioningState:null,ResourceGuid:null,IpConfigurations:null,Sku:null,GatewayType:null,VpnType:null,EnableBgp:null,VpnClientConfiguration:null},idProperties:["ResourceGuid"],entityType:!0},i.Data.Metadata.setTypeMetadata(k.name,k),d={name:"Microsoft.Portal.Extensions.Websites.Base.Models.VirtualNetworkV2LocalNetworkGateway",
properties:{ProvisioningState:null,ResourceGuid:null,LocalNetworkAddressSpace:null,GatewayIpAddress:null},idProperties:["ResourceGuid"],entityType:!0},i.Data.Metadata.setTypeMetadata(d.name,d),a}));define("WebsitesExtension/TypeScript/VPNNetwork/VPNNetworkArea",["require","exports","o","WebsitesExtension/TypeScript/VPNNetwork/Data/VPNNetworkData","WebsitesExtension/TypeScript/Deprecated/ExtensionCore/Utilities/Lazy"],(function(n,t,i,r,u){"use strict";var f;return (function(n){var t=(function(){function n(){this.VPNNetworkData=new r.VPNNetworkData}return i.defineProperty(n,"instance",{get:function(){return n._lazyDataContextSingleton.value},enumerable:!0,configurable:!0}),n})();t._lazyDataContextSingleton=new u(function(){return new t});n.DataContext=t})(f||(f={})),f}));var __extends=this&&this.__extends||(function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(
){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}})();define("WebsitesExtension/TypeScript/Networking/ViewModels/VirtualNetworkSettings",["require","exports","f","o","ko","Websites/ClientResources/GeneralResources","WebsitesExtension/TypeScript/Shared/SharedArea","WebsitesExtension/TypeScript/Models/WebsiteResourceId","WebsitesExtension/TypeScript/ExtensionAssets/Constants","WebsitesExtension/TypeScript/VPNNetwork/VPNNetworkArea","WebsitesExtension/TypeScript/Utility/Utility.Website","WebsitesExtension/TypeScript/VPNNetwork/Models/VPNNetwork","WebsitesExtension/TypeScript/Utility/Utility.DynamicBladeSelection","WebsitesExtension/TypeScript/ExtensionAssets/Constants"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){"use strict";var y=i.ViewModels.Controls.Lists.Grid,p;return (function(n){var t=f.Network,p=(function(){function n(){}return n})(),b,w,k;p.Site="Site";p.ServerFarm="ServerFarm";n.BladeParentType=p;b=(function(n){function r(){var r=n.call(this)||
this;return r.title(t.vnetIntegrationTitle),r.icon(i.Base.Images.Polychromatic.VirtualNetwork()),r}return __extends(r,n),r.prototype.onInputsSet=function(n){return this.subtitle(n.parentResourceName),null},r})(i.ViewModels.Blade);n.VirtualNetworkSettingsBlade=b;w=(function(){function n(){this.vnetVisible=u.observable(!0);this.pointToSiteVisible=u.observable(!0);this.siteToSiteVisible=u.observable(!0);this.dnsVisible=u.observable(!0)}return n})();n.PartVisibilityModel=w;k=(function(){function n(n){var r=this,l,a,o;this.resourceUri=u.observable("");this.vnetResourceUri=u.observable("");this.appServicePlanUri=u.observable("");this.siteResourceUri=u.observable("");this.vnetSplicedResourceUri=u.observable("");this.webAppsInAspText=u.observable(t.webAppsUsingVirtualNetwork);this.vnetNameText=u.observable(t.vnetNameText);this.vnetNameValue=u.observable(t.loadingText);this.vnetLocationText=u.observable(t.locationText);this.vnetLocationValue=u.observable(t.loadingText);this.vnetCertificateStatusText=
u.observable(t.certificateStatusText);this.vnetCertificateStatusValue=u.observable(t.loadingText);this.vnetGatewayStatusText=u.observable(t.gatewayStatusText);this.vnetGatewayStatusValue=u.observable(t.loadingText);this.vnetAddressSpace=u.observable(t.vnetAddressSpaceText);this.pointToSiteAddressSpace=u.observable(t.pointToSiteAddressSpaceText);this.pointToSiteNotConfiguredText=u.observable(t.pointToSiteNotConfiguredText);this.siteToSiteAddressSpace=u.observable(t.siteToSiteAddressSpaceText);this.siteToSiteNotConfiguredText=u.observable(t.siteToSiteNotConfiguredText);this.dnsServersText=u.observable(t.dnsServersText);this.dnsServersNotConfiguredText=u.observable(t.dnsServersNotConfiguredText);this.siteToVnetAddressSpaceText=u.observable(t.siteToVnetAddressSpaceText);this.vnetNotFoundText=u.observable(t.vnetNotFoundText);this.vnetBladeSelectable=new i.ViewModels.Selectable;this.bladeParentType=u.observable("");this.visibilityModel=new w;this.infoIcon=u.observable(i.Base.Images.Polychromatic.
GlobeError());this.vnetCertIconDisplay=u.observable("none");this.vnetCertStatusColor=u.observable(s.Colors.black);this.vnetCertInSync=u.observable(!0);this.ipAddressValidation=new i.ViewModels.RegExMatchValidation(s.Regex.ipAddressValidation,t.ipAddressInvalid);this._virtualNetworkEntityCache=h.DataContext.instance.VPNNetworkData.VirtualNetworkEntityCache.createView(n,{interceptNotFound:!1});this._virtualNetworkGatewayEntityCache=h.DataContext.instance.VPNNetworkData.VirtualNetworkGatewayEntityCache.createView(n,{interceptNotFound:!1});this._virtualNetworkGatewayV2EntityCache=h.DataContext.instance.VPNNetworkData.VirtualNetworkGatewayV2EntityCache.createView(n,{interceptNotFound:!1});this._vpnNetworkEntityCache=h.DataContext.instance.VPNNetworkData.VPNNetworkEntityCache.createView(n,{interceptNotFound:!1});this._siteView=e.DataContext.instance.websitesData.websiteCache.createView(n);this._virtualNetworkRoutesQueryCache=h.DataContext.instance.VPNNetworkData.VirtualNetworkRouteQueryCache.
createView(n);this._webAppsInVirtualNetworkQueryCache=h.DataContext.instance.VPNNetworkData.AppServicePlanWebAppsInVirtualNetworkQueryCache.createView(n);this._virtualNetworkV2LocalNetworkGatewaysQueryCache=h.DataContext.instance.VPNNetworkData.VirtualNetworkV2LocalNetworksQueryCache.createView(n);this._editScopeView=h.DataContext.instance.VPNNetworkData.VirtualNetworkRouteEditScopeCache.createView(n);var c=u.observableArray([{name:u.observable(t.startAddressColumnText),itemKey:"startAddress"},{name:u.observable(t.endAddressColumnText),itemKey:"endAddress"}]),p=u.observableArray([{name:u.observable(t.addressColumnText),itemKey:"server"}]),b=u.observableArray([{name:u.observable(t.nameColumn),itemKey:"name",format:y.Format.HtmlBindings,formatOptions:{htmlBindingsTemplate:"<span data-bind='text: value, style: { color : \"#00BCF2\" }'><\/span>"}}]),k=y.Extensions.SelectableRow,d={selectableRow:{selectionMode:1,activateOnSelected:u.observable(!0)}},g=this._webAppsInVirtualNetworkQueryCache.
items.map(n,(function(n,t){return{name:t.split("/").last(),resourceUri:t}}));this.infoBox=new i.ViewModels.Controls.InfoBox.LinkViewModel(n,{image:u.observable(i.Base.Images.Polychromatic.Info()),text:u.observable(f.Networking.Certificates.notInSyncLearnMore),clickableLink:u.observable(i.ViewModels.Part.createClickableLinkViewModel(u.observable("https://go.microsoft.com/fwlink/?linkid=854601")))});this.webAppsInAspGrid=new y.ViewModel(n,g,k,d);this.webAppsInAspGrid.columns=b;this.webAppsInAspGrid.showHeader=!1;this.webAppsInAspGrid.noRowsMessage(t.loadingText);this.vnetRoutesGrid=new y.ViewModel(n,u.observableArray());this.vnetRoutesGrid.columns=c;this.vnetRoutesGrid.showHeader=!0;this.vnetRoutesGrid.noRowsMessage(t.loadingText);this.pointToSiteRoutesGrid=new y.ViewModel(n,u.observableArray());this.pointToSiteRoutesGrid.columns=c;this.pointToSiteRoutesGrid.showHeader=!0;this.pointToSiteRoutesGrid.noRowsMessage(t.loadingText);this.siteToSiteRoutesGrid=new y.ViewModel(n,u.observableArray());
this.siteToSiteRoutesGrid.columns=c;this.siteToSiteRoutesGrid.showHeader=!0;this.siteToSiteRoutesGrid.noRowsMessage(t.loadingText);this.dnsServersGrid=new y.ViewModel(n,u.observableArray());this.dnsServersGrid.columns=p;this.dnsServersGrid.showHeader=!1;this.dnsServersGrid.noRowsMessage(t.loadingText);this.siteToVnetRoutesGrid=new y.ViewModel(n,u.observableArray());this.siteToVnetRoutesGrid.columns=c;this.siteToVnetRoutesGrid.showHeader=!0;this.siteToVnetRoutesGrid.noRowsMessage(t.loadingText);l=y.Extensions.EditableRow|y.Extensions.ContextMenuShortcut;a=this._createExtensionsOptions();o=new y.ViewModel(n,null,l,a);o.showHeader=!0;o.columns(this._columns);o.rowAdd=function(){};this.siteToVnetRoutesEditableGrid=o;this.routesAppLevelHelpBalloon=new i.ViewModels.Controls.DockedBalloon.ViewModel(n);this.routesAppLevelHelpBalloon.type=i.ViewModels.Controls.DockedBalloon.Type.Info;this.routesAppLevelHelpBalloon.content(t.routesHelpBalloon);this._container=n;this.vnetCertInSync.subscribe(n,(function(
n){n?(r.vnetCertStatusColor(v.Colors.black),r.vnetCertificateStatusValue(t.certificatesInSync),r.vnetCertIconDisplay("none")):(r.vnetCertStatusColor(v.Colors.red),r.vnetCertificateStatusValue(t.certificatesNotInSync),r.vnetCertIconDisplay("inline-block"))}))}return n.prototype.onInputsSet=function(n){var r=this,f,u,e,h;return this._resetPart(),f=n.resourceUri.split("/"),f[7]==="sites"?(this.bladeParentType(p.Site),u=n.resourceUri.split("/"),e=u.splice(u.length-2),this.siteResourceUri(u.join("/")),this.vnetSplicedResourceUri(e.join("/"))):(this.bladeParentType(p.ServerFarm),this.appServicePlanUri(n.resourceUri),this._webAppsInVirtualNetworkQueryCache.fetch(this.appServicePlanUri())),h="",h=c.isClassicVnet(n.vnetResourceUri)?s.VirtualNetworks.VnetClassicExtensionName:s.VirtualNetworks.VnetV2ExtensionName,this.vnetBladeSelectable.selectedValue(a.getVnetBlade(n.vnetResourceUri)),Q.all([i.Base.Security.hasPermission(n.resourceUri,["Microsoft.Web/sites/virtualNetworkConnections/read"]),i.Base.
Security.hasPermission(n.vnetResourceUri,["Microsoft.ClassicNetwork/virtualNetworks/read"])]).spread((function(u,f){u&&f&&(r._virtualNetworkEntityCache.fetch(n.vnetResourceUri).then((function(){var u=r._virtualNetworkEntityCache.item(),f,e,o,s;u.Status()==="NotFound"?(r.visibilityModel.vnetVisible(!1),r.vnetLocationValue(t.networkNotFound),r.vnetNameValue(t.networkNotFound),r.vnetCertificateStatusValue(t.networkNotFound),r.vnetGatewayStatusValue(t.networkNotFoundDetails)):(i.Azure.getLocations().then((function(n){r.vnetLocationValue(n[u.Location()])})),c.isClassicVnet(n.vnetResourceUri)?r.vnetNameValue(t.classicVnetNameTemplate.format(u.Name())):r.vnetNameValue(u.Name()),f=[],u.AddressSpace().AddressPrefixes().forEach((function(n){var t=r._addressWithCidrToAddressSpace(n);t!=null&&f.push(t)})),r.vnetRoutesGrid.items(f),u.DhcpOptions()!=null&&(e=[],u.DhcpOptions().DnsServers().forEach((function(n){e.push({server:n})})),r.dnsServersGrid.items(e)),r.dnsServersGrid.items().length===0&&r.visibilityModel.
dnsVisible(!1),r.vnetRoutesGrid.noRowsMessage(t.noRoutesDefinedText),r.dnsServersGrid.noRowsMessage(t.noDnsServersDefinedText),r.siteToVnetRoutesGrid.noRowsMessage(t.noRoutesDefinedText),c.isClassicVnet(n.vnetResourceUri)?(u.VpnClientAddressSpace()!=null&&(o=[],u.VpnClientAddressSpace().AddressPrefixes().forEach((function(n){var t=r._addressWithCidrToAddressSpace(n);t!=null&&o.push(t)})),r.pointToSiteRoutesGrid.items(o)),r.pointToSiteRoutesGrid.items().length===0&&r.visibilityModel.pointToSiteVisible(!1),s=[],u.GatewayProfile()!=null&&u.GatewayProfile().LocalNetworkSites().forEach((function(n){n.AddressSpace().forEach((function(n){var t=r._addressWithCidrToAddressSpace(n);t!=null&&s.push(t)}))})),r.siteToSiteRoutesGrid.items(s),r.siteToSiteRoutesGrid.items().length===0&&r.visibilityModel.siteToSiteVisible(!1),r._virtualNetworkGatewayEntityCache.fetch(n.vnetResourceUri).then((function(){var n=r._virtualNetworkGatewayEntityCache.item();n.Status()==="Provisioned"?r.vnetGatewayStatusValue(t.gatewayOnline):
r.vnetGatewayStatusValue(t.gatewayOffline)})),r._vpnNetworkEntityCache.fetch(n.resourceUri).then((function(){var n=r._vpnNetworkEntityCache.item();r.vnetCertInSync(n.CertsInSync()!==l.CertSyncStatus.InSync);r.vnetCertInSync(n.CertsInSync()===l.CertSyncStatus.InSync)}))):(r._virtualNetworkGatewayV2EntityCache.fetch(u.VnetGatewayUri()).then((function(){var i=r._virtualNetworkGatewayV2EntityCache.item(),u;i&&i.ProvisioningState()!=="NotFound"?r.vnetGatewayStatusValue(t.gatewayOnline):r.vnetGatewayStatusValue(t.gatewayOffline);i&&i.VpnClientConfiguration()&&i.VpnClientConfiguration().VpnClientAddressPool()&&(u=[],i.VpnClientConfiguration().VpnClientAddressPool().AddressPrefixes().forEach((function(n){var t=r._addressWithCidrToAddressSpace(n);t!=null&&u.push(t)})),r.pointToSiteRoutesGrid.items(u),r._vpnNetworkEntityCache.fetch(n.resourceUri).then((function(){var t=r._vpnNetworkEntityCache.item(),n=!1;i.VpnClientConfiguration().VpnClientRootCertificates()&&i.VpnClientConfiguration().VpnClientRootCertificates(
).forEach((function(i){i.Properties().PublicCertData()===t.CertBlob()&&(n=!0)}));r.vnetCertInSync(!n);r.vnetCertInSync(n)})))})),r._virtualNetworkV2LocalNetworkGatewaysQueryCache.fetch(u.VnetGatewayUri()).then((function(){var n=r._virtualNetworkV2LocalNetworkGatewaysQueryCache.items(),t=[];n!=null&&n.forEach((function(n){n.LocalNetworkAddressSpace().AddressPrefixes().forEach((function(n){var i=r._addressWithCidrToAddressSpace(n);i!=null&&t.push(i)}))}));r.siteToSiteRoutesGrid.items(t);r.siteToSiteRoutesGrid.items().length===0&&r.visibilityModel.siteToSiteVisible(!1)}))))})),r.bladeParentType()===p.Site?r._siteView.fetch(o.WebsiteResourceId.fromCsmResourceId(r.siteResourceUri())).then((function(){var n=r._siteView.item().ServerFarmId()+"/"+r.vnetSplicedResourceUri();r._virtualNetworkRoutesQueryCache.fetch(n).then((function(){var n=[];r._virtualNetworkRoutesQueryCache.items().forEach((function(t){n.push({startAddress:t.StartAddress(),endAddress:t.EndAddress()})}));r.siteToVnetRoutesGrid.items(n)}))})):r.
_editScopeView.fetchForExistingData(n.editScopeId,n.resourceUri))}))},n.prototype._resetPart=function(){this.visibilityModel.vnetVisible(!0);this.visibilityModel.dnsVisible(!0);this.visibilityModel.pointToSiteVisible(!0);this.visibilityModel.siteToSiteVisible(!0);this.vnetNameValue(t.loadingText);this.vnetLocationValue(t.loadingText);this.vnetCertificateStatusValue(t.loadingText);this.vnetGatewayStatusValue(t.loadingText);this.vnetRoutesGrid.items([]);this.pointToSiteRoutesGrid.items([]);this.siteToSiteRoutesGrid.items([]);this.dnsServersGrid.items([]);this.siteToVnetRoutesGrid.items([])},n.prototype._addressWithCidrToAddressSpace=function(n){var f=n.split("/"),i,t,r;if(f.length!==2)return null;var c=f[0],h=f[1],e=f[0].split(".");if(e.length!==4||(i=parseInt(h),i===NaN||i<0||i>32))return null;for(t={startAddress:"",endAddress:""},r=0;r<4;r++){if(i>=8)t.startAddress+=e[r],t.endAddress+=e[r];else if(i<=0)t.startAddress+="0",t.endAddress+="255";else{var o=8-i,s=256-(1<<o),u=parseInt(e[r]);
if(u===NaN||u<0||u>255)return null;t.startAddress+=(u&s).toString();t.endAddress+=((u&s)+((1<<o)-1)).toString()}r!==3&&(t.startAddress+=".",t.endAddress+=".");i-=8}return t},n.prototype._createExtensionsOptions=function(){return{editableRow:{editScope:this._editScopeView.editScope,placement:0,maxBufferedRows:25,allowEditExistingItems:!0,allowEditCreatedItems:!0}}},r.defineProperty(n.prototype,"_columns",{get:function(){return[{name:u.observable(t.startAddressColumnText),itemKey:"StartAddress",editableFormat:y.Format.HtmlBindings,editableFormatOptions:{htmlBindingsType:y.HtmlBindingsType.TextBox,htmlBindingsData:{validations:[this.ipAddressValidation]}}},{name:u.observable(t.endAddressColumnText),itemKey:"EndAddress",editableFormat:y.Format.HtmlBindings,editableFormatOptions:{htmlBindingsType:y.HtmlBindingsType.TextBox,htmlBindingsData:{validations:[this.ipAddressValidation]}}}]},enumerable:!0,configurable:!0}),n})();n.VirtualNetworkSettingsPart=k})(p||(p={})),p}))