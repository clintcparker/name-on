define("HubsExtension/Browse/SkinnyBrowse/SkinnyListTiles",["require","exports","f","i","o","ko","HubsExtension/Browse/BrowseClientStrings","HubsExtension/_generated/BladeReferences","HubsExtension/ArmHelpers/ArmApisStartup","HubsExtension/ResourceMap/ResourceMapCommon","HubsExtension/Browse/SkinnyBrowse/SkinnyBrowseTile"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";var d,g,nt;u.defineProperty(t,"__esModule",{value:!0});var b=i.Base,l=i.ViewModels.Services.ResourceTypes,w=b.Diagnostics.createLog(n),k=b.Constants.ResourceTypes.AllResources.toLowerCase(),a=l.isResourceGroupId,y=l.compareResourceGroupId,v=l.isResourceId,tt=l.compareResourceId,it={accepted:!0,deleting:!0,deleted:!0,failed:!0,movingresources:!0},p=(function(n){function t(t,i,r){var u=n.call(this,t,i,r)||this;return u.extenderViewModel=f.observable(),t.registerForDispose((function(){u._disposeExtender();u._disposeDeleteWatcher()})),u}return __extends(t,n),t.prototype._connectExtender=function(n){var t=this,u=null,f=a(n),e=v(n),o=!f&&!e;o&&(n.extensionName=(n.extensionName||"").toLowerCase(),n.assetType=(n.assetType||"").toLowerCase());this.extenderViewModel.subscribe(this.container,(function(s){t._disposeExtender();t._extenderLifetime=new r.TriggerableLifetimeManager;s.refreshPacket.subscribe(t._extenderLifetime,(function(r){var h,c,s;r!==u&&r&&(u=r,h=r,f&&a(h.resourceGroupId)&&y(h.resourceGroupId,n)&&t.refresh(),c=r,e&&v(c.resourceId)&&tt(c.resourceId,n)&&t.refresh(),s=r,o&&(s.assetOwner||"").toLowerCase()===n.extensionName&&(s.assetType||"").toLowerCase()===n.assetType&&i.deepEquals(s.assetId,n.assetId)&&t.refresh())}))}))},t.prototype._disposeExtender=function(){this._extenderLifetime&&this._extenderLifetime.dispose();this._extenderLifetime=null},t.prototype._disposeDeleteWatcher=function(){this._deleteWatcher&&h.unregisterResourceGroupDeleteWatcher(this._deleteWatcher);this._deleteWatcher=null},t.prototype._watchResourceGroupScope=function(){var n=this,t=function(t){n.addAllowed(t)},i=function(){var i=s.makeResourceManagerTelemetry("GridV1Browse.resourceGroup.checkState");h.ResourceGroupClient.getResourceGroup(n.listScope,i).then((function(i){y(i.id,n.listScope)&&(n.listScopeLocation=i.location,t(!it[(i.provisioningState||"").toLowerCase()]))})).catch((function(){t(!1)}))};this._disposeDeleteWatcher();this._deleteWatcher=h.registerResourceGroupDeleteWatcher({resourceGroupDeleteStarted:function(i){y(i,n.listScope)&&t(!1)},resourceGroupDeleteFailed:function(t){y(t,n.listScope)&&i()}});i()},t.prototype._onResourceGroupInput=function(t){return this.partTitleOverride=e.mapResourceGroupBladeSubtitle,this.assetTitleOverride=l.parseResourceGroupDescriptor(t).resourceGroup,this.bladeReferenceOverride=function(){return Q(new o.ResourceMenuBladeReference({id:t}))},this.addAllowed(!1),this.listScope=t,this._watchResourceGroupScope(),this._connectExtender(t),n.prototype.onInputsSet.call(this,{resourceType:k,scope:t})},t.prototype._onResourceInput=function(t){return this.partTitleOverride=e.mapResourceGroupBladeSubtitle,this.assetTitleOverride=l.parseResourceDescriptor(t).resource,this.bladeReferenceOverride=function(){return Q(i.Assets.mapResourceIdToBladeReference(t))},this._connectExtender(t),n.prototype.onInputsSet.call(this,{resourceType:k,scope:l.buildResourceGroupIdFromResourceId(t)})},t.prototype._onAssetInput=function(n){var t=this;return i.Assets.mapAssetIdToResourceId(n).then((function(n){if(a(n))return t._onResourceGroupInput(n);if(v(n))return t._onResourceInput(n);t.container.notFound(e.pinnedPartNotValid);w.warning("Cannot use ResourceListTile for non-resource or resource group entity type.")}))},t})(c.SkinnyBrowseTile);t.ListTileBase=p;d=(function(n){function t(t,i,r){var u=n.call(this,t,i,r)||this;return u.resourceGroup=f.observable(),u}return __extends(t,n),t.prototype.onInputsSet=function(t){var i=t.resourceGroup||t.id,r;if(this.resourceGroup(i),a(i))return n.prototype._onResourceGroupInput.call(this,i);this.container.notFound(e.pinnedPartNotValid);r=v(i)&&l.buildResourceTypeFromResourceId(i)||"non-resource";w.warning("Cannot use ResourceGroupListTile for non-resource group entity type ("+r+").")},t})(p);t.ResourceGroupListTile=d;g=(function(n){function t(t,i,r){return n.call(this,t,i,r)||this}return __extends(t,n),t.prototype.onInputsSet=function(t){return n.prototype._onAssetInput.call(this,{extensionName:t.assetOwner,assetType:t.assetType,assetId:t.assetId})},t})(p);t.ResourceListTile=g;nt=(function(n){function t(t,i,r){var u=n.call(this,t,i,r)||this;return u.resourceGroup=f.observable(),u}return __extends(t,n),t.prototype.onInputsSet=function(t){var i=t.id;if(a(i))return this.resourceGroup(i),n.prototype._onResourceGroupInput.call(this,i);if(v(i))return this.resourceGroup(l.buildResourceGroupIdFromResourceId(i)),n.prototype._onResourceInput.call(this,i);this.container.notFound(e.pinnedPartNotValid);w.warning("Cannot use ListResourceGroupTile for non-resource or resource group entity type.")},t})(p);t.ListResourceGroupTile=nt}))