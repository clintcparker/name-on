define("_generated/Less/MsPortalImpl.Controls/Controls/Lists/Menu.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,'.ext-menublade-part{height:100%}.fxc-menu-search{min-height:23px;margin-bottom:20px}.fxc-menu-loading{margin:20px auto;width:32px;height:32px;opacity:.7}.fxc-menu-scrollarea{overflow:auto;height:calc(100% - 23px - 20px)}.fxs-menu-scrollarea-full-height{height:100%}.ext-fxc-menu-icon{height:15px;width:15px;padding:9px 0 8px;-webkit-flex:0 0 auto;flex:0 0 auto}.fxc-menu-grid{padding:0}.fxc-menu-grid .azc-listView-item{display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center}.fxc-menu-grid .azc-listView-item[aria-disabled=true] .ext-fxc-menu-icon,.fxc-menu-grid .azc-listView-item[aria-disabled=true] .ext-fxc-menu-listView-item{opacity:.5}.fxc-menu-grid .ext-fxc-menu-icon,.fxc-menu-grid .ext-fxc-menu-listView-item{display:block;padding:10px 0 9px 10px;position:relative}.fxc-menu-grid .azc-listView-groupheader{margin:0}.fxc-menu-grid .azc-listView-groupheader-text,.fxc-menu-grid .azc-listView-item,.fxc-menu-grid .ext-fxc-menu-groupheader{border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:inherit;margin:0}.fxc-menu-grid .azc-listView-groupheader-text,.fxc-menu-grid .ext-fxc-menu-groupheader{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe WP",Tahoma,Arial,sans-serif;font-weight:600;font-size:10px;line-height:10px;text-transform:uppercase;padding:5px 0 10px 5px}.fxs-menublade .fxs-blade-content-container-default .fxs-part{overflow:hidden!important}')}));
define("MsPortalImpl.Controls/Controls/Lists/Menu",["require","exports","f","o","ko","$","MsPortalImpl.Controls/Controls/Base/Loadable","MsPortalImpl/Base/Base.Selectable2","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.EventTypes","_generated/Less/MsPortalImpl.Controls/Controls/Lists/Menu.css"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";function p(n,t,i,r){var u=Q.defer(),e=n.createChildLifetime(),f;return t.enabled?t.enabled.subscribeAndRun(e,(function(n){n&&u.resolve(!0)})):u.resolve(!0),i!==-1&&(f=y.setTimeout((function(){u.resolve(!1)}),i)),u.promise.finally((function(){f&&y.clearTimeout(f);e.dispose()})).then((function(n){return n&&r(t),n}))}r.defineProperty(t,"__esModule",{value:!0});var l=i.ViewModels.Controls,c=l.Lists.ListView,w=c.ViewModel,b=i.Base.Promises,a=o.getOrCreate,v="fxc-menu",k="<div data-bind='image: $data.icon' class='ext-fxc-menu-icon msportalfx-svg-c07'><\/div><div data-bind='text: $data.displayText' class='ext-fxc-menu-listView-item msportalfx-text-small msportalfx-text-ellipsis'><\/div>",d="<!-- ko if: searchBox --><div class='fxc-menu-search' data-bind='pcControl: searchBox'><\/div><!-- /ko --><div class='fxc-menu-scrollarea' data-bind='css: { \"fxs-menu-scrollarea-full-height\": !searchBox }'><div class='fxc-menu-grid' data-bind='pcControl: grid'><\/div><\/div>",g='<!-- ko ifnot: $data.value === "'+i.Assets.QuickAccessGroupId+"\" --><div class='ext-fxc-menu-groupheader' data-bind='text: $data.value'><\/div><!-- /ko -->",y=window,nt=500,tt=(function(n){function t(t,r,e){var o=n.call(this,t,r,e)||this,tt,y,rt,ut,ft,et;o._queryString=u.observable("");o._overview=u.observable();o._callbacks=f.Callbacks();o._searchMissCallbacks=f.Callbacks();o.selectedItemText=u.observable();t.addClass(v).html(d);var p=o.ltm,nt=o._data=r._msPortalFxData,ot=nt.items,st=nt.selectableMap,it=nt.options;return o.getResourceType=function(){var n=it.peek()||{};return n.resourceType},tt=u.observableArray([]),u.explicitComputed(p,[ot,o._overview],(function(n){var t=o._overview(),i=[];t&&i.push(t);tt(i.concat(n))})),o._visibleItems=tt.map(p,(function(n,t){var r=i.extend({metadata:{}},t);return r.metadata.disabled||(r.metadata.disabled=u.observable(!1)),r.enabled&&r.enabled.subscribeAndRun(n,(function(n){return r.metadata.disabled(!n)})),r})).filter(p,(function(n){return!n.visible||n.visible()})),y=o._listVM=new w(p,c.Extensions.Selectable|c.Extensions.Groupable|c.Extensions.ContextMenu|c.Extensions.Filterable,{groupable:{groupKey:u.observable("group"),order:u.observable(c.GroupOrder.Collection),headerTemplate:g},filterable:{filterText:o._queryString,filterKey:u.observable("aggregatedKeywords")}}),y.outlineStyle(!1),y.extensionOptions.selectable.activateOnSelected=!0,o._visibleItems.subscribeAndRun(p,y.items),y.itemTemplate=k,rt=y.extensionOptions.selectable.selectedItem,ut=new b.CancelationToken,rt.subscribe(p,(function(n){var r,f,t,e,i;o.resetStartupLifetimeManager();ut.cancel();n&&(f=st()[n.id],t=a(f),t.isSelected()||(o._clickSelectable(n.id,t),o._selectedId=n.id,e=t.isSelected.subscribe(t.createChildLifetime(),(function(){n===y.extensionOptions.selectable.selectedItem()&&y.extensionOptions.selectable.selectedItem(null);e.dispose()}))),i=o._overview(),r=(i&&i.id)===n.id?null:u.unwrap(n.displayText));o.selectedItemText(r)})),ft=r.showSearch?new l.SearchBox.ViewModel(p,{resultLimit:0,placeholder:u.observable(s.Menu.queryString),hideSuggestions:u.observable(!0),update:function(n){o._queryString(n);var i=n.toLowerCase(),t=o._listVM.items().filter((function(n){return~n.aggregatedKeywords.toLowerCase().indexOf(i)})).map((function(n){return n.displayText}));return t.length===0&&o._searchMissCallbacks.fire({query:o._queryString()}),Q(t)},submit:function(n){return o._queryString(n),Q(!0)}}):null,t.trigger(h.default.fxregistermenu,o),et=u.observable(y),o._bindDescendants({grid:et,searchBox:ft}),o.getTelemetryInfo=function(){var t=it.peek()||{},n={itemCount:o._visibleItems.peek().length};return i.extendStringMapIntoMap(n,t,(function(n){return i.isPrimitive(n)?n:undefined}),!0),n},o}return __extends(t,n),t.prototype.onItemClick=function(n){this._callbacks.add(n)},t.prototype.onSearchMiss=function(n){this._searchMissCallbacks.add(n)},t.prototype.resetStartupLifetimeManager=function(){var n=this._startupLifetimeManager;n&&n.dispose();this._startupLifetimeManager=null},t.prototype.setDefaultId=function(n){var r=this,e=this._listVM,o=e.extensionOptions.selectable.selectedItem,l;o()&&o(null);var s=this._data,v=s.selectableMap,h=s.options;this.resetStartupLifetimeManager();var t=this._startupLifetimeManager=this.ltm.createChildLifetime(),c=u.observable(),f=function(n){e.extensionOptions.selectable.selectedItem(n)};u.computed(t,[v,this._visibleItems,c,],(function(n,e,o){var s,h;n&&o&&(i.isFeatureEnabled("preservemenuitem")?(h=e.first((function(n){return n.id===r._selectedId})),s=h?p(t,h,nt,f):Q(!1)):s=Q(!1),s.then((function(s){var h,c;s||t.isDisposed()||(h=e.first((function(n){return n.id===o})),h?p(t,h,-1,f):(c=!1,i.forEachKey(n,(function(i){if(!c){var s=a(n[i]),o=e.first((function(n){return n.id===i}));o&&(s.isSelected()&&(!o.enabled||o.enabled())?(c=!0,f(o),Q.nextTick((function(){return r.resetStartupLifetimeManager()}))):u.computed(t,[s.isSelected,o.enabled||u.observable(!0)],(function(n,t){n&&t&&(f(o),r.resetStartupLifetimeManager())})))}}))))})))}));l=h.subscribe(t,(function(t){if(t){var f=t.overview,u=t.defaultId;f?(r._overview(i.extend2(f,{group:i.Assets.QuickAccessGroupId,aggregatedKeywords:[f.displayText].concat(f.keywords).join(" ")})),u||(u=f.id)):r._overview(null);u=n.recommendedId||u;u&&c(u)}}));n.rebinding||l.callback(h())},t.prototype.switchItem=function(n){var t=this._visibleItems().first((function(t){return t.id===n}));t&&this._listVM.extensionOptions.selectable.selectedItem(t)},t.prototype.getSelectedId=function(){return this._selectedId},t.prototype.dispose=function(){this._cleanElement(v);n.prototype.dispose.call(this)},t.prototype.selectDefaultItem=function(){this._listVM.extensionOptions.selectable.selectedItem(this._visibleItems.peek()[0])},t.prototype._clickSelectable=function(n,t){t.onClick();this._callbacks.fire(n,{query:this._queryString()})},t})(e.Widget);t.Widget=tt}))