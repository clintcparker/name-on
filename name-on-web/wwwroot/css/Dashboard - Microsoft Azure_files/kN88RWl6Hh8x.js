define("HubsExtension/BrowseGrid2/BrowseBlades/BrowseConfigurations/BrowseBulkCommandImpl",["require","exports","f","ko"],(function(n,t,i,r){"use strict";var u;return (function(n){var t=i.ViewModels,f=t.Dialogs,u=(function(){function n(n,t,i){var u=this;this._canExecute=r.observable(!0);this._cmdDef=t;this._cmdContext=i;this.canExecute=r.computed(n,(function(){return u._cmdContext.hasSelectedItems()&&u._canExecute()}))}return n.prototype.execute=function(n){var t=this;if(this._canExecute(!1),n===6||n===4){var r=this._cmdContext.selectedBrowseItems(),u=r.map((function(n){return{name:n.name,resourceId:n.resourceId,resourceType:n.resourceType.toLowerCase()}})),f=i.require("HubsExtension/ArmHelpers/ArmBulkCommand").then((function(n){return n.execute(t._cmdDef,t._cmdContext.resourceType,u)}));return this._canExecute(!0),f.then((function(){if(t._cmdContext.onCompleteCallback)return t._cmdContext.onCompleteCallback(r)}))}return this._canExecute(!0),Q()},n})();n.BulkCommandImpl=u})(u||(u={})),u}));
define("HubsExtension/_generated/HtmlTs/BrowseGrid2/BrowseBlades/Templates/TagsColumn",["require","exports"],(function(){"use strict";return function(){return'<!-- ko if: value --><div data-bind="pcControl:value"><\/div><!-- /ko -->'}}));
define("HubsExtension/BrowseGrid2/BrowseBlades/BrowseConfigurations/Base",["require","exports","f","i","o","ko","$","Extensions/Hubs/PillList","Fx/Composition/Selectable","Fx/Controls/MoveResourceToolbarButton","HubsExtension/Browse/BrowseClientStrings","HubsExtension/ResourceMap/ResourceMapClientStrings","HubsExtension/_generated/BladeReferences","HubsExtension/_generated/ExtensionDefinition","HubsExtension/ArmHelpers/ArmApisStartup","HubsExtension/ArmHelpers/Models/ArmResourceInstance","HubsExtension/Browse/BrowseArea","HubsExtension/Common/AssetTypeCache","HubsExtension/Common/CommonErrorHandling","HubsExtension/Common/HubsObservables","HubsExtension/Common/ResourceIconMap","HubsExtension/HubsCommon","HubsExtension/Notifications/EventSubscriptionService","HubsExtension/ResourceMap/ResourceMapCommon","HubsExtension/ResourceMap/ViewModels/ResourceProviderHelpers","HubsExtension/BrowseGrid2/BulkDeleteBlade/BulkDeleteBladeModel","HubsExtension/BrowseGrid2/BrowseBlades/BrowseConfigurations/BrowseBulkCommandImpl","HubsExtension/_generated/HtmlTs/BrowseGrid2/BrowseBlades/Templates/NameColumn","HubsExtension/_generated/HtmlTs/BrowseGrid2/BrowseBlades/Templates/TagsColumn"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot){"use strict";function kr(n){return typeof n=="number"&&dt[n]||(typeof n=="number"||n)&&n.toString()}function dr(){return{id:dt[1],name:f.observable(st.Name.title),format:br,activatable:!0,width:f.observable("200px"),sortable:!0}}function gr(n,t,r){var u=0;return n&&n.length&&n.some((function(n){var e=n.property.name,h="",c="",l,o,s;return e==="tagsArray"?(l={items:f.observableArray([])},h=(t.tagsArray()||l).items().map((function(n){return n.value})).sort().join(","),c=(r.tagsArray()||l).items().map((function(n){return n.value})).sort().join(",")):e.startsWith("tags.")?(o=ht(f.utils.unwrapObservablePath(t,e))||"",h=typeof o=="string"?o:o.item&&o.item().value||"",s=ht(f.utils.unwrapObservablePath(r,e))||"",c=typeof s=="string"?s:s.item&&s.item().value||""):(h=ht(f.utils.unwrapObservablePath(t,e))||"",c=ht(f.utils.unwrapObservablePath(r,e))||""),u=i.compare(h,c),u&&n.direction===0&&(u=-u),u!==0})),u}function bi(n,t,i){var r=at.parseResourceDescriptor(t);return n?n.format({resourceId:yt(t),name:yt(r.resource),type:yt(r.type),provider:yt(r.provider),resourceGroup:yt(r.resourceGroup),subscriptionId:yt(r.subscription),locationId:yt(i)}):null}function ct(n,t,i){return{id:dt[n],name:t.title,description:t.description,visible:!i}}function oi(n,t,i,r){return{id:dt[n],name:t.title,visible:!r,dynamicSelectionProvider:i,activatable:!0}}function si(n){return{id:dt[12],name:st.Tags.title,visible:!n,format:new ui.Grid2.Formatters.HtmlTemplate({template:ot()})}}function ki(n,t,i,r){return function(){n.closeContextBlade().then((function(){n.openContextPane(new a.EditTagsBladeReference({resource:t.id,tagName:r},function(r,u){r===2&&u&&u.update&&(t.tagsProperty(u.newTags),gt(n,t,i))}))}))}}function hi(n,t,i,r,u){var e={label:r?u?c.addTag.format(r):c.editTag.format(r):c.editResourceTags.format(t.name),icon:vt.Edit(),enabled:f.observable(!0),onClick:ki(n,t,i,r)};return f.observable(new o.ViewModel(n,{label:c.tagsLabel.format(t.name),items:f.observableArray([]),actionButtons:[e]}))}function gt(n,t,i){nu(n,t,i);tu(n,t)}function nu(t,r,e){var l=r.tags(),s=u.create(null),h=r.tagsProperty()||{},a=i.forEachKey(h,(function(n,t,i){i[n.toLowerCase()]=n}),u.create(null));e().forEach((function(u){var p,y,w,v;if(u.id.startsWith("tags."))if(p=u.id.substring(5).toLowerCase(),y=a[p],y){if(w={value:ht(h[y])},v=l[p],v&&v.item)v.item(w);else{var b=ki(t,r,e,p),k={label:c.editTag.format(y),icon:vt.Edit(),enabled:f.observable(!0),onClick:b},d={label:c.deleteTag.format(y),icon:vt.Delete(),enabled:f.observable(!0),onClick:function(){var u={telemetryName:"ConfirmDeleteTag",title:c.deleteTagTitle,content:c.deleteTagMessage.format(y),buttons:4,onClosed:function(u){u.button===6&&i.require(n.normalize("../../../Tags/TagsArea")).then((function(n){return n.deleteTag(y,ht(h[y]),r.id).then((function(){di(t,r,e)}))}))}};t.openDialog(u)}};v=new o.ViewModel(t,{label:c.resourceTagLabel.format(y,r.name),item:f.observable(w),actionButtons:[k,d]})}s[p]=v}else v=l[p],v&&v.items||(v=hi(t,r,e,p,!0)()),s[p]=v}));r.tags(s)}function tu(n,t){var r=t.tagsProperty(),u=i.forEachKey(r,(function(n,t,i){y.isHiddenTag(n)||i.push({value:c.tagLabel.format(n,ht(t))})}),[]);t.tagsArray().items(u.sort((function(n,t){return i.compare(n.value,t.value)})))}function di(n,t,i){var f=y.makeResourceManagerTelemetry("GridV2Browse.updateTags"),r,e=!1,u=t.id;fi(u)?(e=!0,r=pi(u,f,!0)):lr(u)&&(r=ar(u,f,!0));r&&r.then((function(r){t.tagsProperty(r.tags);gt(n,t,i);e&&t.status(r.provisioningState)})).catch((function(n){if(!k.isExpectedArmError(n))throw n;}))}function iu(n,t){if(n.dynamicBladeService()){var r=ai.getViewModelsDefinition.acquireObject(ir.client,ai.getWindowId({name:n.extensionName()}),{type:ni.ViewModelTypes.ViewModel,name:n.dynamicBladeService(),initialState:null,createSelectable:!1});return Q(r).then((function(r){var e=r.getValue(),u=e.content,f;return typeof u.onInputsSet!="function"?(or.warning("Dynamic blade service had no onInputsSet."),r.dispose(),t()):(f=u.onInputsSet({assetId:n.id}),Q(f||!0).then((function(){var i=u.bladeName();return i?Q(yi(u.extensionName()||n.extensionName(),i,{id:n.id})):t()})).finally((function(){i.disposeViewModelProperties(r.getValue());r.dispose()})))}))}return t()}var yt,gi,lt;u.defineProperty(t,"__esModule",{value:!0});var nr=i.Assets,kt=i.Base,ni=kt.Constants,tr=ni.ResourceTypes,ir=r.Rpc,ci=kt.Diagnostics,ii=ci.Telemetry,vt=kt.Images,li=vt.Polychromatic,ai=r.Extension,ti=i.ViewModels,ri=r.ViewModels,ru=ti.ActionBars.Base,pt=ti.Toolbars,rr=ti.Dialogs,ui=ri.Controls.Lists,at=ti.Services.ResourceTypes,ur=ni.AssetNames,fr=ui.Grid2.Formatters,wt=kt.Images.StatusBadge,er=i.require,or=ci.createLog(n),sr=c.BulkCommand,st=c.Columns,bt=c.ProvisioningStates,hr=v.BladeNames.resourceMenuBlade,cr=v.BladeNames.resources,vi=nr.assetTypeInformationSupportsContract,ht=f.utils.peekObservable,yi=ri.getBladeSelection,lr=at.isResourceId,fi=at.isResourceGroupId,ei=at.compareResourceGroupId,ar=it.ResourceClient.getResource,pi=it.ResourceGroupClient.getResourceGroup,wi=li.ResourceDefault(),vr=v.AssetTypes.ResourceGroups.Permissions,yr="BrowseItemActivated",pr="../../../Common/HubsPermissions",wr={accepted:!0,deleting:!0,deleted:!0,failed:!0,movingresources:!0},br=new ui.Grid2.Formatters.HtmlTemplate({template:et()}),dt=(lt={},lt[1]="name",lt[2]="kind",lt[3]="resourceGroup",lt[4]="location",lt[5]="locationId",lt[6]="resourceId",lt[7]="resourceGroupId",lt[8]="resourceType",lt[9]="subscription",lt[10]="subscriptionId",lt[11]="assetType",lt[12]="tagsArray",lt);t.mapColumnIdToString=kr;t.getNameColumn=dr;t.browseCompare=gr;yt=encodeURIComponent;gi=(function(){function t(n,t){var r=this,h,e,o,s;this.assetTypeInfo=f.observable();this.loaded=f.observable(!1);this.groupBy=f.observable("");this._assetTypes=new i.Map;this._mpItemId="";this._mpMenuItemId="";this._ltm=n;this._columnsType=this._resourceType=t.resourceType;this._resourceTypeLower=this._resourceType.toLowerCase();this._resourceFilter=t.resourceFilter;this._selectedTags=t.selectedTags;this._searchString=this._resourceFilter.filterText;this._toolbar=t.toolbar;this._contentState=t.contentState;this._contentStateText=t.contentStateDisplayText;this._container=t.container;this._loadDataMarker=t.loadDataTelemetryEventMarker;this._scope=t.scope;this._listScope=t.listScope;this._columnsScopeType=at.isResourceGroupId(this._listScope)&&it.resourceGroupsTypeKey;this._onRefresh=t.onRefresh;this._excludedResourceTypes=t.excludedTypesFromBrowse;this._includeTypes=t.includeTypes;this._hasErrors=f.observable(!1);this._createPresent=!1;this._resourceTypeName="";this._resourceInstanceMap=new i.Map;this._addAllowed=f.observable(!0);this.groupByItems=f.observableArray([]);this._groupAriaLabelLookup=u.create(null);this._chooseColumnsAllowed=f.observable(!1);this._deleteAllowed=f.observable(!1);this._moveAllowed=f.observable(!1);n.registerForDispose((function(){r._disposeDeleteWatcher()}));this._setContentState();this._items=f.observableArray();this.moreDataOnServer=f.observable(!1);this.itemCount=f.pureComputed((function(){return r._items().length}));this.selectedItemsCount=f.observable(0);this.addSupported=!1;this._selectedIds=f.observableArray();this._selectedAll=f.observable(!1);this._unselectedIds=f.observableArray();this._selectedBrowseItems=f.pureComputed((function(){var t=r._items(),n=r._unselectedIds(),i=function(t){return r._selectedAll()?!n.length||!n.some((function(n){return t.id===n.id})):r._selectedIds().some((function(n){return t.id===n.id}))};return t.reduce((function(n,t){return i(t)?(n.push(t),n):n}),[])}));h=this._eventWatcher=new w.ArmEventWatcher;n.registerForDispose((function(){h.disposeEventWatcher()}));e=this._resourceTypeLower===it.resourceGroupsTypeKey;e||this._getAssetTypes();e||this._getAssetTypes();b.getResourceTypeAssetTypeInformation(this._resourceType,!0).then((function(n){r.assetTypeInfo(n)}));d.getLocationDisplayNames().then((function(n){r._updateLocations(n)}));o=function(n){var u=r._resourceTypeLower===tr.RecentResources.toLowerCase(),t;u||(t=i.extendArrayIntoMap({},n,(function(n){return n.assetId.toLowerCase()}),i.wrap(!0)),r._items().forEach((function(n){t[(n.id||"").toLowerCase()]&&di(r._container,n,r.gridViewModel.columns)})))};s=function(n,t){var f=i.extendArrayIntoMap({},n,(function(n){return n.assetId.toLowerCase()}),i.wrap(!0)),u=r._items().slice();i.remove(u,(function(n){return f[t(n).toLowerCase()]}));r._items(u)};this._eventWatcher.attachEventWatch(this._resourceType,{writeToResourceGroup:o,writeToResource:o,resourceGroupDeleted:function(n){return s(n,(function(n){return(e?n.id:n.resourceGroupId)||""}))},resourceDeleted:function(n){return s(n,(function(n){return n.id||""}))}})}return t.prototype._getAssetTypes=function(){var n=this;b.getAssetTypesInformation().then((function(t){t.subscribeAndRun(n._ltm,(function(t){n._updateAssetTypes(t)}))}))},t.prototype._updateAssetTypes=function(n){var t=this;n&&(this._assetTypes.clear(),n.filter((function(n){return!!n.resourceType})).forEach((function(n){return t._assetTypes.set(n.resourceType.toLowerCase(),n)})));this._items().forEach((function(n){var u=n.resourceType,f=(u||"").toLowerCase(),i=f&&t._assetTypes.get(f),r;i&&n.needType()&&(r=i.compositeDisplayName&&i.compositeDisplayName.singular||u,n.needType(!1),n.icon(i.icon||wi),n.isPreview(n.useAssetTypePreview&&i.isPreview),n.assetType(r),n.assetTypeName(r),n.extensionName(i.extensionName||null),n.dynamicBladeService(i.dynamicBladeServiceViewModel),n.externalLink(bi(i.browseLinkUri,n.id,n.locationId)),t._checkIconAndBladeFromKind(n.id,n,i))}))},t.prototype._createFilteringComputed=function(){var n=this;f.pureComputed((function(){return[n._getSearchString(),n._resourceFilter.selectedSubscriptions(),n._resourceFilter.selectedTypes(),n._resourceFilter.selectedLocations(),n._resourceFilter.selectedResourceGroups(),n._selectedTags(),n._resourceFilter.invertResourceGroupFilter(),]})).extend({deferred:!0}).subscribe(this._ltm,(function(){n.refresh()}))},t.prototype._getSearchString=function(){var n=(this._resourceFilter.filterText()||"").trim();return n.startsWith('"')&&n.endsWith('"')&&(n=n.substring(1,n.length-1)),n},t.prototype._createGridOptions=function(n){var t={columns:f.observableArray([]),contextMenu:{enabled:!0,hiddenInCollapsed:!0},scrolling:{enabled:!0,horizontal:!1},resizing:{enabled:!0}};return e.extend(t,n)},t.prototype._checkIconAndBladeFromKind=function(n,t,i,r){var u={assetTypeInformation:i,extensionName:ht(t.extensionName)};g.checkItemKind({setIcon:t.icon,setUseResourceMenu:t.kindUseResourceMenu,setIsPreview:t.isPreview,setKindBladeAndPart:function(n,i,r){t.kindBlade(n);t.kindBladeExtension(i);t.kindPart(r)},setAssetTypeDisplayName:function(n){r?t.assetTypeName(n):t.assetType(n)}},n,ht(t.kind),u)},t.prototype._getSelectionPromise=function(n,t){var f=this,r,u;return n.id?(r=function(){return w.makeResourceBlade(n.id,{sessionId:i.sessionId,instance:p.toResourceInstance(f._resourceInstanceMap.get(n.id.toLowerCase()))})},w.checkNoBladeName(t))?Q(r()):n.kindUseResourceMenu()!==!1&&(vi(t,8)||n.kindUseResourceMenu()===!0&&vi(t,16))?r():n.kindBlade()?Q(yi(n.kindBladeExtension(),n.kindBlade(),{id:n.id})):(u=function(){var i,r;if(fi(n.id))return i={extension:v.definitionName,assetType:ur.ResourceGroups,detailBladeInputs:{id:n.id}},Q(i);if(at.isResourceId(n.id))return r={resourceId:n.id,extension:t.extensionName,detailBladeInputs:{id:n.id}},Q(r);throw new Error("Did not handle selection for model ID: "+at.buildResourceTypeFromResourceManagerId(n.id));},n.extensionName(t.extensionName),n.dynamicBladeService(t.dynamicBladeServiceViewModel),iu(n,u)):null},t.prototype._setSelectionPromiseAndGetSelection=function(n,t){return n.dynamicBladeSelectionPromise()||n.dynamicBladeSelectionPromise(this._getSelectionPromise(n,t)),n.dynamicBladeSelectionPromise()},t.prototype._getSubOrGroupSelectionPromise=function(n){return Q({selectionKey:n,extension:v.definitionName,detailBlade:hr,detailBladeInputs:{id:n,referrerInfo:{sessionId:i.sessionId,instance:p.toResourceInstance(this._resourceInstanceMap.get(n.toLowerCase()))}}})},t.prototype._createChooseColumnButton=function(){var n=this,t=new pt.OpenBladeButton2({id:"choosecolumns"+i.getUniqueId(),label:c.chooseColumnsCommand,icon:vt.Columns(),supplyBladeReference:function(){var t=new a.ChooseColumnsBladeReference({resourceType:n._columnsType,scopeResourceType:n._columnsScopeType,subscriptions:n._getSelectedSubIds()},function(){});return t.metadata?t.metadata.isContextBlade=!0:t.metadata={isContextBlade:!0},t}}),r=this._chooseColumnsAllowed;return r.subscribeAndRun(this._container,(function(n){t.disabled(!n)})),t},t.prototype.getAddBlade=function(){var n=this;return w.getCreateBlade({resourceType:this._resourceType,marketplaceItemId:this._mpItemId,marketplaceMenuItemId:this._mpMenuItemId,listScope:this._listScope,listScopeLocation:this._listScopeLocation,createFlowPromise:this._createFlowPromise,onCreateFlowPromise:function(t){n._createFlowPromise=t}})},t.prototype._createAddResourceButton=function(n,t,r,u){var e=this,f;return this._mpItemId=r,this._mpMenuItemId=u,this.addSupported=!0,f=new pt.OpenBladeButton2({supplyBladeReferenceAsync:function(){return e.getAddBlade()}}),this._addAllowed.subscribeAndRun(this._container,(function(n){f.disabled(!n)})),f.id="addresource"+i.getUniqueId(),f.label(c.addTitle),f.icon(vt.Add()),f},t.prototype._createRefreshButton=function(){var t=this,n=new pt.CommandButton;return n.label(c.refreshCommand),n.icon(vt.Refresh()),n.command={canExecute:f.observable(!0),execute:function(){return t._onRefresh&&t._onRefresh(),t.refresh(!0)}},n},t.prototype._createAssignTagsButton=function(){var n=this,t=new pt.OpenBladeButton2({supplyBladeReference:function(){var i=n._selectedBrowseItems().map((function(n){return n.id})),t=new a.AssignTagsBladeReference({resources:i},function(t,i){if(t===2&&i&&i.update){var r=i.update;n._items().forEach((function(t){var u=t.id||"";r[u]&&(t.tagsProperty(i.newTags[u]),gt(n._container,t,n.gridViewModel.columns))}))}});return t.metadata?t.metadata.isContextBlade=!0:t.metadata={isContextBlade:!0},t}});return t.id="assigntags"+i.getUniqueId(),t.label(c.assignTagsCommand),t.icon(vt.Tags()),f.reactor(this._container,(function(){t.disabled(n._selectedBrowseItems().length<1)})),t},t.prototype._createDeleteButton=function(t){var u=this,f=new pt.OpenBladeButton2({id:"deleteresourcegroup"+i.getUniqueId(),label:l.deleteResourceGroupCommandTitle,icon:vt.Delete(),supplyBladeReference:function(){if(i.isFeatureEnabled("newgroupdelete")){var n=new a.ResourceGroupDeleteBladeReference({id:t},function(n,t){n===2&&t&&t.executedDelete&&u.refresh(!0)});return n.metadata?n.metadata.isContextBlade=!0:n.metadata={isContextBlade:!0},n}return new s.ParameterProviderBladeReference("OldResourceGroupDeleteBlade","HubsExtension",{parameters:{resourceGroup:t},receiveResult:function(n){if(n.actionBarAction()===4){var t=new rt.ResourceGroupDeleteOperation(n.resourceGroup(),n.resourceGroupName());t.execute();u.refresh(!0)}}},{isContextBlade:!0})}}),r=this._deleteAllowed;return er(n.normalize(pr)).then((function(n){r.subscribeAndRun(u._container,(function(i){var u=f.disabled;i?n.Internal.hasPermission(t,[vr.deleteObject,],null).then((function(n){u(!(r()&&n))})).catch((function(){u(!r())})):u(!0)}))})),r(!1),f},t.prototype._createMoveButton=function(n){return new h.ViewModel(this._container,{resourceId:n})},t.prototype._watchResourceGroupScope=function(){var n=this,t=function(t){n._deleteAllowed(t);n._addAllowed(t);n._moveAllowed(t)},i=function(){var i=y.makeResourceManagerTelemetry("GridV2Browse.resourceGroup.checkState");pi(n._listScope,i).then((function(i){ei(i.id,n._listScope)&&(n._listScopeLocation=i.location,t(!wr[(i.provisioningState||"").toLowerCase()]))})).catch((function(){t(!1)}))};this._disposeDeleteWatcher();this._deleteWatcherId=it.registerResourceGroupDeleteWatcher({resourceGroupDeleteStarted:function(i){ei(i,n._listScope)&&t(!1)},resourceGroupDeleteFailed:function(t){ei(t,n._listScope)&&i()}});i()},t.prototype._getSelectedSubIds=function(){return y.filterSubscriptionsByScope(this._resourceFilter.selectedSubscriptions().map((function(n){return n.subscriptionId})),this._scope)},t.prototype._setContentState=function(n){var t=this._contentState,i=this._contentStateText;this._hasErrors()||n?(t(2),i(c.browseResourcesError)):this._createPresent?(t(5),i(c.createCompletionMessage.format(this._resourceTypeName))):(t(0),i(null))},t.prototype._initializeCreateListener=function(){var n=this,t=tt.subscribeToArmEvent({source:"microsoft.resources",operationNameRegex:"microsoft.resources/subscriptions/resourcegroups/deployments/write",status:"succeeded"},(function(t){var i=n._getSelectedSubIds();t.forEach((function(t){var r=t.properties&&t.properties.subscriptionId;r&&i.indexOf(r.toLowerCase())===-1||(n._createPresent=!0,n._setContentState())}))}));this._container.registerForDispose((function(){tt.removeArmEventSubscription(t)}))},t.prototype._getResourceColumns=function(n){var t=this;return n===void 0&&(n=!0),[ct(11,st.AssetType),oi(3,st.ResourceGroup,(function(n,i){var r=t._getSubOrGroupSelectionPromise(ht(i.resourceGroupId));return r.then((function(n){t._logActivation(i.id,n,"resourceGroup")})),r}),!n),ct(4,st.Location),oi(9,st.Subscription,(function(n,i){var r=t._getSubOrGroupSelectionPromise("/subscriptions/"+ht(i.subscriptionId));return r.then((function(n){t._logActivation(i.id,n,"subscription")})),r}),!n),ct(2,st.Kind,!0),ct(7,st.ResourceGroupId,!0),ct(5,st.LocationId,!0),ct(6,st.ResourceId,!0),ct(8,st.ResourceType,!0),ct(10,st.SubscriptionId,!0),si(!0),]},t.prototype._getTenantResourceColumns=function(){return[ct(11,st.AssetType),ct(4,st.Location),ct(2,st.Kind,!0),ct(5,st.LocationId,!0),ct(6,st.ResourceId,!0),ct(8,st.ResourceType,!0),si(!0),]},t.prototype._getResourceGroupColumns=function(){var t=this,n={svg:wt.Unknown(),text:bt.notSpecified},i={svg:wt.Pending(),text:bt.accepted},r={svg:wt.Warning(),text:bt.deleting},u={svg:wt.Disabled(),text:bt.deleted},f={svg:wt.Failed(),text:bt.failed},e={svg:wt.Pending(),text:bt.movingResources},o={svg:wt.Success(),text:bt.succeeded};return[oi(9,st.Subscription,(function(n,i){var r=t._getSubOrGroupSelectionPromise("/subscriptions/"+ht(i.subscriptionId));return r.then((function(n){t._logActivation(i.id,n,"subscription")})),r})),ct(4,st.Location),ct(5,st.LocationId,!0),ct(7,st.ResourceGroupId,!0),ct(10,st.SubscriptionId,!0),{id:"status",name:st.Status.title,visible:!1,format:new fr.SvgIconLookup({svgIconLookup:{"##DEFAULT##":n,notspecified:n,NotSpecified:n,accepted:i,Accepted:i,deleting:r,Deleting:r,deleted:u,Deleted:u,failed:f,Failed:f,movingresources:e,MovingResources:e,succeeded:o,Succeeded:o},width:"16px",height:"16px"}),description:c.Columns.Status.description},si(!0),]},t.prototype._logPrimaryDataLoadedTelemetry=function(n){this._loadDataMarker&&ii.endTrace(this._loadDataMarker,ii.ActionModifier.Complete,{resourceType:this._resourceType,rows:n});this._loadDataMarker=null},t.prototype._logActivation=function(n,t,i){ii.trace({action:yr,extension:t.extension,source:cr,data:{assetId:n,detailBlade:t.detailBlade,detailBladeExtension:t.extension,column:i}})},t.prototype._createBrowseResourceItemFromResource=function(n,t,r,e,o){var y=this,h=ht(n.id);this._resourceInstanceMap.set(h.toLowerCase(),f.toJS(n));var l=ht(n.location),a=at.parseResourceDescriptor(h),v=ht(n.type),p=v.toLowerCase(),s=this._assetTypes.get(p)||r.get(p)||{},b=f.observable(s.compositeDisplayName&&s.compositeDisplayName.singular||v),k=w.getResourceName(n,o),g=ht(n.tags),c={icon:f.observable(s.icon||wi),name:k,isPreview:f.observable(t&&s.isPreview),subscription:f.observable(a.subscription),location:f.observable(this._locationDisplayMap&&l&&this._locationDisplayMap[l.toLowerCase()]||l),locationId:l,resourceGroup:a.resourceGroup,kind:f.observable(ht(n.kind)),kindUseResourceMenu:f.observable(),assetType:b,assetTypeName:b,resourceId:h,resourceType:v,resourceGroupId:at.buildResourceGroupIdFromResourceId(h),subscriptionId:a.subscription,tagsProperty:f.observable(g),tags:f.observable(u.create(null)),tagsArray:null,id:h,supplemental:e&&f.observable(e),extensionName:f.observable(s.extensionName||null),dynamicBladeService:f.observable(s.dynamicBladeServiceViewModel),dynamicBladeSelectionPromise:f.observable(),externalLink:f.observable(bi(s.browseLinkUri,h,l)),kindBlade:f.observable(),kindBladeExtension:f.observable(),kindPart:f.observable(),needType:f.observable(!s.assetType),useAssetTypePreview:t};return a.subscription&&i.tryImmediateResolve(d.getSubscription(a.subscription),(function(n){c.subscription(n.uniqueDisplayName)})),c.tagsArray=hi(this._container,c,this.gridViewModel.columns),this.gridViewModel.columns.subscribeAndRun(this._container,(function(){gt(y._container,c,y.gridViewModel.columns)})),this._checkIconAndBladeFromKind(h,c,s),c},t.prototype._createBrowseResourceGroupItemFromResourceGroup=function(n){var s=this,e=ht(n.id);this._resourceInstanceMap.set(e.toLowerCase(),f.toJS(n));var o=ht(n.location),t=at.parseResourceGroupDescriptor(e),h=w.getResourceName(n),c=ht(n.tags),r={icon:f.observable(li.ResourceGroup()),name:h,subscription:f.observable(t.subscription),location:f.observable(this._locationDisplayMap&&o&&this._locationDisplayMap[o.toLowerCase()]||o),locationId:ht(n.location),resourceGroupId:at.buildResourceGroupIdFromDescriptor(t),subscriptionId:t.subscription,status:f.observable(ht(n.provisioningState)),tagsProperty:f.observable(c),tags:f.observable(u.create(null)),tagsArray:null,id:e};return t.subscription&&i.tryImmediateResolve(d.getSubscription(t.subscription),(function(n){r.subscription(n.uniqueDisplayName)})),r.tagsArray=hi(this._container,r,this.gridViewModel.columns),this.gridViewModel.columns.subscribeAndRun(this._container,(function(){gt(s._container,r,s.gridViewModel.columns)})),r},t.prototype._performGetResources=function(n,t){var r=this,u;return this._prevLtm&&this._prevLtm.dispose(),u=this._prevLtm=this._ltm.createChildLifetime(),i.tryImmediateResolve(n,(function(n){return kt.Promises.cancelOnDispose(u,n.getResources(u,t)).then((function(n){t.partialErrors()&&r._setContentState(!0);var i=n.subscribe(u,(function(n){var t=n.length,i=t>2e3,u=i?n.slice(0,2e3):n;r._logPrimaryDataLoadedTelemetry(t);r._items(u.map((function(n){return r._makeBrowseItem(n)})));r.moreDataOnServer(i);r.loaded(!0)}));n().length&&i.callback(n())}))}))},t.prototype._performRefresh=function(n){var t=this;return this.gridViewModel.loading(!0),this._hasErrors(!1),this._createPresent=!1,n.then((function(){t._setContentState()})).catchError(i.Errors.CanceledError,(function(){})).catch((function(){t._hasErrors(!0);t._setContentState()}))},t.prototype._updateLocations=function(n){n&&(this._locationDisplayMap=n);n=this._locationDisplayMap;n&&this._items&&this._items().forEach((function(t){var i=t.locationId;i&&t.location(n[i.toLowerCase()]||i)}))},t.prototype._getSelectionFactory=function(){var n=this;return function(t,i){return b.getResourceTypeAssetTypeInformation(i.resourceType,!0).then((function(r){var u=n._excludedResourceTypes&&n._excludedResourceTypes[i.resourceType.toLowerCase()],e=i.kind()&&i.kind().toLowerCase(),f,o=n._includeTypes();return f=o&&(u===!0||u&&u[e]===!0)||!r?Q(ri.getBladeSelection(v.definitionName,v.BladeNames.resourceMenuBlade,{id:i.resourceId})):n._setSelectionPromiseAndGetSelection(i,r),f.then((function(i){n._logActivation(t,i)})),f}))}},t.prototype._getPinProvider=function(){return function(n){var t,r=n.id;if(fi(r))t=Q({partName:nt.resourceGroupPartName,extensionName:ni.ExtensionNames.Hubs});else{if(n.kindBlade&&n.kindBlade()&&!n.kindPart())return Q(undefined);t=b.getResourceTypeAssetTypeInformation(n.resourceType).then((function(t){return{partName:n.kindPart()||t.partName,extensionName:t.extensionName}}))}return t.then((function(n){var t=n.partName,u=n.extensionName;return new i.Composition.PartReference(t,{id:r},{extensionName:u})}))}},t.prototype._createBulkCommands=function(n,t){var i=this,r=[],u;return n.forEach((function(n){var e=sr.tooltip.format(n.label),o,s;n.confirmWithTextInput?r.push(i._createBulkDeleteButton(n,e)):(u||(u=f.computed(i._ltm,(function(){return i.selectedItemsCount()>0}))),o=new rr.MessageBox(n.confirmationTitle,n.confirmationMessage,4),s=new pt.DialogButton({name:"{0}.BulkCmd.{1}".format(i._resourceType,n.id),label:n.label,icon:n.icon,tooltip:e,dialogOptions:o,command:new ft.BulkCommandImpl(i._ltm,n,{resourceType:i._resourceType,hasSelectedItems:u,selectedBrowseItems:i._selectedBrowseItems,onCompleteCallback:t})}),r.push(s))})),r},t.prototype._createBulkDeleteButton=function(n,t){var i=this,r=new pt.OpenBladeButton2({label:n.label,icon:n.icon,tooltip:t,supplyBladeReference:function(){var r=[],u=i._selectedBrowseItems().length,t;return u<=ut.MaxBatchDeleteResources&&(r=i._selectedBrowseItems().map((function(n){return{name:n.name,resourceId:n.resourceId,resourceType:n.resourceType.toLowerCase(),assetType:n.assetType(),icon:n.icon()}}))),t=new a.BulkDeleteBladeReference({resources:r,commandDefinition:n,resourceType:i._resourceType,resourceInfoCount:u}),t.metadata?t.metadata.isContextBlade=!0:t.metadata={isContextBlade:!0},t}});return r.name=r.id="{0}.BulkCmd.{1}".format(this._resourceType,n.id),f.reactor(this._container,(function(){r.disabled(!(i.selectedItemsCount()>0))})),r},t.prototype._disposeDeleteWatcher=function(){var n=this._deleteWatcherId;n&&it.unregisterResourceGroupDeleteWatcher(n);this._deleteWatcherId=null},t})();t.BaseConfiguration=gi}))