define("MsPortalImpl.Controls/Fields/CustomHtmlField",["require","exports","f","o","ko","MsPortalImpl.Controls/Fields/Base/FormValidation","MsPortalImpl.Controls/Fields/Base/LabelAndBalloonWidget","MsPortalImpl.Controls/Controls/Base/Loadable"],(function(n,t,i,r,u,f,e,o){"use strict";var s;return (function(n){var t="msportalfx-form-formelement",s="msportalfx-customHtml",h=jQuery,c="<div data-bind='untrustedHtml: { html: htmlTemplate, data: innerViewModel, isolated: isolated }' class='azc-formElementContainer'><\/div>",l=(function(n){function o(r,f,o){var l=n.call(this,r,f,o)||this,a;return l._vms=u.observableArray(),l.element.addClass(s).addClass(t),l._htmlContentDiv=h(c),a=new e.LabelAndBalloonWidgetHelper(l.ltm,i.extend({infoBalloonTabbable:!0},f)),a.appendWidgetToDom(l.element,l._htmlContentDiv),a.insertLabelBefore(l._htmlContentDiv),a.insertSubLabelAfter(l._htmlContentDiv),l._bindElement(f,l._htmlContentDiv),l._updateTemplate(),l.options.htmlTemplate.subscribe(l.ltm,(function(){l._updateTemplate()})),l}return __extends(o,n),o.prototype.dispose=function(){this._cleanElement("msportalfx-form-formelement","msportalfx-customHtml");this._htmlContentDiv&&(this._cleanDescendants(),this._htmlContentDiv.remove(),this._htmlContentDiv=null);n.prototype.dispose.call(this)},r.defineProperty(o.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),o.prototype._updateTemplate=function(){var n=this,t=f.gatherFormFields(this._htmlContentDiv).map((function(n){return n.viewmodel}));this._vms(t);this._vmsLifetimeManager&&(this._vmsLifetimeManager.dispose(),this._vmsLifetimeManager=null);this._vmsLifetimeManager=this.ltm.createChildLifetime();u.reactor(this._vmsLifetimeManager,(function(){var t=n._vms();n.options.dirty(t.some((function(n){return n&&n.dirty&&n.dirty()})))}));u.reactor(this._vmsLifetimeManager,(function(){var t=f.gatherFormFields(n._htmlContentDiv).map((function(n){return n.viewmodel}));n.options.valid(t.every((function(n){return n&&n.valid?n.valid():!0})))}));this.options._msPortalFxClearValidation((function(){var t=[];return n._vms().forEach((function(n){if(typeof n.clearValidation=="function"){var i=n.clearValidation();i&&t.push(i)}})),Q.all(t)}));this.options._msPortalFxTriggerValidation((function(){var t=n._vms().map((function(n){if(typeof n.triggerValidation=="function")return n.triggerValidation()})).filter(i.identity);return Q.all(t).then((function(n){return n.every(i.identity)}))}))},o})(o.Widget);n.Widget=l})(s||(s={})),s}))