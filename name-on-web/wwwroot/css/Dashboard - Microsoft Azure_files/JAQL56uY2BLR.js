define("_generated/Less/MsPortalImpl.Controls/Controls/SearchBox.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxc-search{display:block;position:relative}.fxc-search .azc-form-labelcontainer{display:none}.fxc-search-icon{width:14px;height:14px;position:absolute;top:4px;left:7px;opacity:.8}.fxc-search-discard-icon{width:11px;height:11px;position:absolute;top:4px;right:11px;cursor:pointer;display:none;opacity:.7}.fxc-search .azc-textBox,.fxc-search-populated .fxc-search-discard-icon{display:block}.fxc-search .azc-textBox .azc-textBox-wrapper input{padding-left:31px;padding-right:24px}.fxc-search .azc-textBox .azc-textBox-wrapper input::-ms-clear{display:none}.fxc-search ul{padding:0;margin:0;position:absolute;width:100%;z-index:150}.fxc-search li{border-left:1px solid;border-left-color:inherit;border-right:1px solid;border-right-color:inherit;list-style-type:none;border-top-width:0;border-bottom-width:0;padding:9px 32px;cursor:pointer}.fxc-search li:last-child{border-bottom:1px solid;border-bottom-color:inherit}.fxc-search-no-result{pointer-events:none}")}));
define("MsPortalImpl.Controls/Controls/SearchBox",["require","exports","f","o","ko","MsPortalImpl.Controls/Controls/Base/OptionsBase","MsPortalImpl/Svg/Library/Discard.svg","MsPortalImpl/Base/Base.KeyboardHelper","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.SvgHelper","MsPortalImpl/Base/Base.EventTypes","_generated/Less/MsPortalImpl.Controls/Controls/SearchBox.css"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";var l;return (function(n){function p(n,t){return n.update?n.update(t||""):Q([])}var g=i.Base,nt=g.Images,w=i.ViewModels,ft=w.Controls,tt=w.Forms.TextBox.ViewModel,t=window,a=i.isNullOrUndefined,it=5,v="fxs-portal-focus",b="fxc-search-discard-icon",y="fxc-search-list",l="fxc-search-populated",k="fxc-search",d="fxc-searchbox-container",rt="<div class='msportalfx-svg-flip-horizontal fxc-search-icon fxs-portal-svg-secondary' data-bind='image: $ctl._icon'><\/div>"+("<div class='"+b+" fxs-portal-svg-secondary' aria-hidden='true'>")+h.getSvgReferenceOrFallBackToData(e).outerHTML+"<\/div><div aria-live='polite' aria-hidden='true' aria-atomic='true' class='fxs-hide-accessible-label' data-bind='text: $ctl._ariaLive'><\/div>"+('<div role="combobox" tabindex="-1" class=\''+d+"' aria-haspopup='listbox' data-bind='pcControl: $ctl._textBoxViewModel, attr:{\"aria-disabled\": $disabled}'><\/div>")+('<ul role="listbox" tabindex="-1" aria-label="'+i.encodeAttribute(s.DropDown.optionContainer)+"\" class='azc-bg-default fxs-portal-border "+y+"' data-bind='visible: $ctl._popupOpen() && !$ctl.options.hideSuggestions(), attr: {\"aria-disabled\": $disabled}'>")+"<!-- ko foreach: $ctl._currentItems --><li role=\"option\" class='fxs-portal-hover' data-bind='text: $data'><\/li><!-- /ko --><!-- ko if: !$ctl._currentItems().length -->"+('<li role="option" class=\'fxc-search-no-result\' disabled="disabled" aria-disabled="true">'+i.encodeAttribute(s.Search.noResults)+"<\/li>")+"<!-- /ko --><\/ul>",ut=(function(n){function f(i,r,f){var e=n.call(this,i,r,f)||this,o,c,h;return e._clickedInsideWidget=!1,e._currentItems=u.observableArray(),e._events=[],e._icon=nt.Search({isLogo:!0}),e._ignoreTextBoxValueUpdate=!1,e._popupOpen=u.observable(!1),e._busy=u.observable(!1),e._dirty=!1,e._forceDismiss=!1,e._ariaLive=u.observable(""),o=e.ltm,i.addClass(k),i.html(rt),e._attachEventHandlers(),e._textBoxViewModel=new tt(o,{label:u.observable(s.Controls.searchBox),emptyValueText:e.options.placeholder,valueUpdateTrigger:4}),c=e.options.defaultText,a(c)||(e._textBoxViewModel.value(c),e._originalText=c,e.element.addClass(l)),e._textBoxViewModel.value.subscribe(o,(function(n){e._ignoreTextBoxValueUpdate||(e._originalText=n,t.clearTimeout(e._typingTimer),n?e._typingTimer=t.setTimeout((function(){e.isDisposed()||e._updateDropdown(n)}),e.options.updateFrequency):(e.element.removeClass(l),e._currentItems([]),p(e.options)))})),e.options._msPortalFxresetTrigger((function(){return e._reset()})),h=e.options.resultLimit,a(h)?e._unchangingResultLimit=it:u.isObservable(h)?h.subscribe(o,(function(n){var t=e._currentItems();n<t.length&&e._currentItems(t.slice(0,n))})):e._unchangingResultLimit=h,e._bindDescendants(),e._accessibility(),e._currentItems.subscribeAndRun(o,(function(n){e._forceDismiss?(e._dirty=!1,e._forceDismiss=!1):!e._dirty&&e._textBoxViewModel.value()&&e.element.findByClassName("azc-input")[0]===document.activeElement?e._dirty=!0:e._textBoxViewModel.value()||(e._dirty=!1);var t=!!(n.length||e._dirty);e._popupOpen(t);e._comboBoxElement.attr("aria-expanded",t);e._searchBoxElement.removeAttr("aria-activedescendant")})),e}return __extends(f,n),f.prototype.dispose=function(){this.element.removeClass(k);i.disposeDisposable(this._events);this._events=[];n.prototype.dispose.call(this)},r.defineProperty(f.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),f.prototype._accessibility=function(){var n=this,t=this.element.find("label").attr("id"),r=t+"-for",i=t+"-listbox";this._activeItemId=t+"-active";this._comboBoxElement=this.element.findByClassName(d);this._searchBoxElement=this._comboBoxElement.find("#"+r);this._listBoxElement=this.element.find("> ul");this._listBoxElement.attr("id",i);this._comboBoxElement.attr("aria-owns",i);this._searchBoxElement.attr({role:"searchbox","aria-controls":i,"aria-autocomplete":"list","aria-placeholder":this.options.placeholder()});this._busy.subscribeAndRun(this.ltm,(function(t){n._searchBoxElement.attr("aria-busy",t);n._listBoxElement.attr("aria-busy",t)}));this.options.ariaLabel.subscribeAndRun(this.ltm,(function(i){var r=(i||"").trim();r?(n._comboBoxElement.attr({"aria-labelledby":null,"aria-label":r}),n._searchBoxElement.attr({"aria-labelledby":null,"aria-label":r})):(n._comboBoxElement.attr("aria-labelledby",t),n._searchBoxElement.attr("aria-labelledby",t))}))},f.prototype._reset=function(){return this._updateTextBoxWithOutOpeningDropDown(""),this._dirty=!1,this._currentItems([]),this.element.removeClass(l),t.clearTimeout(this._typingTimer),Q()},f.prototype._attachEventHandlers=function(){var n=this,i=function(){var t=n._textBoxViewModel.value();n._busy(!0);n.options.submit(t,n._originalText).finally((function(){n._busy(!1)}));n._originalText=t;n._popupOpen(!1)};this._events.push(this.element.setEvents([c.default.mousedown,function(t){var i=$(t.target);i.is("li")&&(n._clickedInsideWidget=!0,$(i).click())},],[c.default.keydown,function(t){(t.which===38&&n._popupOpen()||t.which===40)&&t.preventDefault()},],[c.default.keyup,function(r){var f=n.element.findByClassName(v),e,u,h=function(t){t.addClass(v).attr({id:n._activeItemId,"aria-selected":!0});n._searchBoxElement.attr("aria-activedescendant",n._activeItemId)},c=function(t,i,r){t.length?(t.removeClass(v).removeAttr("id aria-selected"),i&&i.length?(n._updateTextBoxWithOutOpeningDropDown(i.text()),h(i)):n._updateTextBoxWithOutOpeningDropDown(n._originalText)):(n._updateTextBoxWithOutOpeningDropDown(r.text()),h(r))},s;if(o.getModifierKeys(r)===0)switch(r.which){case 13:r.stopPropagation();t.clearTimeout(n._typingTimer);n._currentItems([]);i();break;case 27:n._currentItems([]);n._textBoxViewModel.value("");case 9:n._popupOpen(!1);break;case 8:case 46:n._textBoxViewModel.value()===""&&(n._dirty=!1,n._popupOpen(!1));break;case 40:if(s=n._textBoxViewModel.value(),!n._popupOpen()&&s){n._updateDropdown(s);break}if(e=f.next("li"),u=n.element.find("."+y+" li").first(),u.attr("disabled")==="disabled")break;c(f,e,u);break;case 38:if(n._popupOpen()){if(e=f.prev("li"),u=n.element.find("."+y+" li").last(),u.attr("disabled")==="disabled")break;c(f,e,u)}}},],[c.default.focusout,function(){n._forceDismiss=!0;n._popupOpen(!1);n._clickedInsideWidget||(n._currentItems([]),n._updateTextBoxWithOutOpeningDropDown(n._originalText))},],[c.default.click,function(t){var r=$(t.target);r.is("li")&&(n._updateTextBoxWithOutOpeningDropDown(r.text()),n._currentItems([]),i());n._clickedInsideWidget=!1},]));this._events.push(this.element.findByClassName(b).setEvents([c.default.click,function(){n._busy(!0);p(n.options).finally((function(){n._busy(!1)}));n._originalText="";n._reset();n.element.findByClassName("azc-input").focus()},]))},f.prototype._updateTextBoxWithOutOpeningDropDown=function(n){this._ignoreTextBoxValueUpdate=!0;this._textBoxViewModel.value(n);this._ignoreTextBoxValueUpdate=!1},f.prototype._updateDropdown=function(n){var t=this;this.element.addClass(l);this._busy(!0);i.Base.Promises.cancelOnDispose(this.ltm,(function(){return p(t.options,n)})).then((function(i){i=i||[];var r=t._unchangingResultLimit;a(r)&&(r=t.options.resultLimit());r&&i.length>r&&(i=i.slice(0,r));t._currentItems(i);t._ariaLive(s.DropDown.filterResult.format(i.length,n))})).finally((function(){t._busy(!1)}))},f})(f.Widget);n.Widget=ut})(l||(l={})),l}))