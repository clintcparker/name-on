define("Directories/ViewModels/DirectoryOverview/ActiveDirectoryOverview",["require","exports","f","o","ko","Fx/Controls/DropDown","Fx/Composition/TemplateBlade","Fx/Controls/TextBox","_generated/Microsoft_AAD_ERM/BladeReferences","_generated/Microsoft_AAD_ProtectionCenter/BladeReferences","_generated/Microsoft_Azure_PIM/BladeReferences","_generated/BladeReferences","_generated/ExtensionDefinition","_generated/Svg","ApplicationManagement/Constants","CommonConstants","CommonResources","Directories/Constants","Directories/Utilities/DirectoriesUtils","Directories/DirectoryResources","Shared/Utilities/DirectoryRoles","Directories/ViewModels/DirectoryOverview/DirectoryWhatsNewData","Directories/ViewModels/DirectoryOverview/DirectoryWhatsNewDataGenerated","InProductFeedback/Utilities","ApplicationManagement/Utils/ManagedAppsUtils","Permissions/Permission","RegisteredApps/RegisteredAppsConstants","Reports/Constants","Users/ViewModels/DirectoryRoles/RoleTemplateIds","Shared/Utilities","Users/ViewModels/UserAddNew/UserCreationService","Users/Constants"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct){"use strict";var lt,yt;r.defineProperty(t,"__esModule",{value:!0});var at=i.ViewModels.Controls.Visualization.Chart,pt=i.ViewModels.Controls.Lists.Grid,wt=i.getEnvironmentValue,vt;(function(n){n[n.noError=0]="noError";n[n.defaultError=1]="defaultError";n[n.roleError=2]="roleError";n[n.subscriptionError=3]="subscriptionError"})(vt=t.ChartStatus||(t.ChartStatus={})),(function(n){n[n.users=1]="users";n[n.groups=2]="groups";n[n.enterpriseApplications=3]="enterpriseApplications";n[n.appRegistrations=4]="appRegistrations"})(lt=t.FindGridTypes||(t.FindGridTypes={}));yt=(function(){function n(){this.title="";this.subtitle="";this.imageLaunchCurrent=i.Base.Images.LaunchCurrent({palette:3});this.domainname=u.observable();this.directoryname=u.observable();this.servicelevel=u.observable(p.dotdotdot);this.usersSigninChartTitle=d.Chart.title;this.chartRoleMoreInfo=d.directoryOverviewChartRoleMoreInfoText;this.chartStatus=u.observable(vt.noError);this.chartErrorRoleLine=d.Chart.Error.roleLine;this.chartErrorSubscriptionLine=d.Chart.Error.subscriptionLine;this.chartErrorSubscriptionLineFreeTrial=d.Chart.Error.subscriptionLineFreeTrial;this.chartErrorDefaultLine=d.Chart.Error.defaultLine;this.resourceWhatsNewTitle=d.directoryOverviewWhatsNewTitleText;this.resourceWhatsNewSubTitle=d.directoryOverviewWhatsNewSubTitleText;this.resourceWhatsNewNumber=u.observable("");this.resourceViewArchive=d.directoryOverviewWhatsNewArchiveText;this.displayWhatsNewItems=u.observableArray([]);this.displayWhatsNewProductCapabilities=u.observableArray([]);this.resourceYourRole=d.directoryOverviewRoleText;this.userRole=u.observable("");this.resourceMoreInfo=d.directoryOverviewRoleMoreInfoText;this.resourceFind=d.directoryOverviewFindText;this.showFindGrid=u.observable(!1);this.resourceAdConnect=d.directoryOverviewAdConnectText;this.resourceAdConnectSyncStatus=d.directoryOverviewAdConnectSyncStatusText;this.adConnectSyncStatus=u.observable("");this.resourceAdConnectLastSync=d.directoryOverviewAdConnectLastSyncText;this.adConnectLastSync=u.observable("");this.resourceCreate=d.directoryOverviewCreateText;this.createItems=u.observableArray([]);this.resourceOtherCapabilities=d.directoryOverviewOtherCapabilitiesText;this.otherCapabilitiesItems=u.observableArray([]);this.miscellaneousItems=u.observableArray([]);this._whatsNewItemClicked=u.observable();this._productCapabilityClicked=u.observable();this._resourceFindAll=u.observable(d.directoryOverviewFindAllText);this._resourceBlank=u.observable("")}return n.prototype.onInitialize=function(){return this._initialize(),Q.all(this._executePromises())},n.prototype.onChartClick=function(){var n=this.context.container;this.usersSigninChart.loading()===!1&&n.openBlade(new l.SignInEventsBladeReference({}))},n.prototype.onChartTryBuyProduct=function(){var n=this.context.container;this.usersSigninChart.loading()===!1&&n.openBlade(new l.TryBuyProductBladeReference)},n.prototype._executePromises=function(){var n=this,t=[];return this._getAccountSkusQueryViewPromise(),this._getSignInEventsSummaryQueryViewPromise(),this._getUserSystemRoleTemplateIdsQueryViewPromise(),this._getAdConnectStatusEntityViewPromise(),t.push(this._getWhatsNewQueryView.fetch(tt.whatsNewArchiveDay).then((function(){n._populateProductCapabilities();n._populateWhatsNew(b.allServices);n.resourceWhatsNewNumber(d.directoryOverviewWhatsNewNumberText.format(n.displayWhatsNewItems().length,tt.whatsNewArchiveDay.toString("MMMM dd, yyyy")))}))),t.push(i.Base.Security.getUserInfo().then((function(t){n.domainname(t.domainName);n.directoryname(t.directoryName)}))),t},n.prototype._initialize=function(){this._initializeNotifiers();this._initializeQuery();this._initializeChart();this._initializeFindItems();this._initializeGrid();this._initializeCreateItems();this._initializeOtherCapabilitiesItems();this._initializeMiscellaneousItems();this._initializeToolbar();this._initializeInProductFeedback()},n.prototype._initializeInProductFeedback=function(){it.setBannerFeedbackItem(this.context.container,a.BladeNames.activeDirectoryOverviewBlade)},n.prototype._initializeNotifiers=function(){var t=this,n=this.context.container;this._whatsNewItemClicked=u.observable();this._whatsNewItemClicked.subscribe(n,(function(t){i.notNullOrUndefined(t)&&n.openContextPane(new l.DirectoryWhatsNewBladeReference({whatsNewId:t.id}))}));this._productCapabilityClicked=u.observable();this._productCapabilityClicked.subscribe(n,(function(n){if(i.notNullOrUndefined(n)){var r=t.displayWhatsNewProductCapabilities();u.utils.arrayForEach(r,(function(t){t.image(n.id===t.id?i.Base.Images.Check():i.Base.Images.Blank())}));t._populateWhatsNew(n.id)}}))},n.prototype._initializeQuery=function(){var i=this.context,n=i.container,t=i.model;this._getAccountSkusQueryView=t.licensesDataContext.getAccountSkus.createView(n);this._signInEventsSummaryEntityView=t.reportsDataContext.signInEventsSummaryQuery.createView(n);this._getWhatsNewQueryView=t.getWhatsNewQuery.createView(n);this._getUserSystemRoleTemplateIdsQueryView=ut.Permission.getUserSystemRoleTemplateIdsQuery.createView(n);this._getAdConnectStatusEntityView=t.adConnectStatusEntity.createView(n);this._getUsersQueryView=t.usersDataContext.usersListQuery.createView(n);this._getGroupsQueryView=t.groupsDataContext.getGroupsQuery.createView(n);this._getAppRegistrationsQueryView=t.registeredAppsDataContext.applicationsQuery.createView(n);this._getEnterpriseApplicationsQueryView=t.enterpriseApplicationsDataContext.applicationsQuery.createView(n)},n.prototype._getAccountSkusQueryViewPromise=function(){var t=this,r=this.context,u=r.container,f=r.model,n="";this.servicelevel(p.dotdotdot);this._getAccountSkusQueryView.fetch({}).then((function(){var r=t._getAccountSkusQueryView.items();i.findIndex(r,(function(n){return i.localeCompareIgnoreCase(n.skuId(),b.LicenseSkuIds.premium2)===0}))>=0&&(n+=w.servicePlanAzureADPremiumP2Name);i.findIndex(r,(function(n){return i.localeCompareIgnoreCase(n.skuId(),b.LicenseSkuIds.premium)===0}))>=0&&(n+=(n.length>0?", ":"")+w.servicePlanAzureADPremiumP1Name);i.findIndex(r,(function(n){return i.localeCompareIgnoreCase(n.skuId(),b.LicenseSkuIds.basic)===0}))>=0&&(n+=(n.length>0?", ":"")+w.servicePlanAzureADBasicName);n.length===0?f.featureConfigurations.fetchFeatureConfigurations(u).then((function(n){t.servicelevel(k.populateOfficePlanInfo(n))})):t.servicelevel(n)})).catch((function(){t.servicelevel(n)}))},n.prototype._initializeChart=function(){var e=this.context.container,o=Date.now(),n=new Date(o),t=new Date(n.getFullYear(),n.getMonth(),n.getDate(),0,0,0),s=new i.ViewModels.Controls.Visualization.Chart.MetricRuleMetric({aggregationScope:1,aggregationType:1,unit:"",showBarColor:!0}),h=new at.MetricRule({scope:0,metrics:u.observableArray([s])}),r=new i.ViewModels.Controls.Visualization.Chart.LineChartSeriesView,f=new i.ViewModels.Controls.Visualization.Chart.LineChartView;t.setDate(t.getDate()-b.daysOfChart);this._chartStartDateTime=u.observable(t);this._chartEndDateTime=u.observable(n);this._chartSeries=u.observableArray([]);this.usersSigninChart=new at.ViewModel(e);this.usersSigninChart.series=this._chartSeries;r.seriesName(d.Chart.metricSigninsText);f.seriesView([r]);this.usersSigninChart.views([f]);this.usersSigninChart.xAxis.scale(2);this.usersSigninChart.xAxis.showGridLines(!1);this.usersSigninChart.xAxis.min=this._chartStartDateTime;this.usersSigninChart.xAxis.max=this._chartEndDateTime;this.usersSigninChart.xAxis.position(3);this.usersSigninChart.yAxis.scale(1);this.usersSigninChart.yAxis.showGridLines(!1);this.usersSigninChart.yAxis.autoScaleUnit(!0);this.usersSigninChart.yAxis.position(4);this.usersSigninChart.legendPosition(0);this.usersSigninChart.interactionBehavior(at.InteractionBehavior.XSlider_Off);this.usersSigninChart.metricsRules([h]);this.usersSigninChart.metrics.visible(!1)},n.prototype._getSignInEventsSummaryQueryViewPromise=function(){var n=this;return this.usersSigninChart.loading(!0),this._signInEventsSummaryEntityView.fetch({startDateTime:this._chartStartDateTime,endDateTime:this._chartEndDateTime,userId:null,appId:null}).then((function(){var r=n._signInEventsSummaryEntityView.item(),t;i.notNullOrUndefined(r)&&(t=new at.Series,t.name(d.Chart.metricSigninsText),t.values(r.activityData().map((function(n){return new at.ChartItem(n.dateTime(),n.activityCount())}))),n._chartSeries([t]))})).catch((function(t){var i=vt.defaultError;if(!!t&&!!t.errorData&&!!t.errorData.responseJSON&&!!t.errorData.responseJSON.ClientData&&!!t.errorData.responseJSON.ClientData.errorCode)switch(t.errorData.responseJSON.ClientData.errorCode){case et.ReportAPIErrorCodes.Authentication_RequestFromUnsupportedUserRole:i=vt.roleError;break;case et.ReportAPIErrorCodes.Authentication_RequestFromNonPremiumTenantOrB2CTenant:i=vt.subscriptionError}n.chartStatus(i)})).finally((function(){n.usersSigninChart.loading(!1)}))},n.prototype._getUserSystemRoleTemplateIdsQueryViewPromise=function(){var t=this,n="";this.userRole(p.dotdotdot);this._getUserSystemRoleTemplateIdsQueryView.fetch({}).then((function(){var r=t._getUserSystemRoleTemplateIdsQueryView.items(),u=r.length,f=i.findIndex(r,(function(n){return n===ot.RoleTemplateIds.CompanyAdministrator}))>=0;n=u===0?d.directoryOverviewRoleDefault:u===1?g.GetLocalizedDirectoryRole(r[0],d.directoryOverviewRoleDefault):f?d.directoryOverviewRoleTextTemplate.format(g.GetLocalizedDirectoryRole(ot.RoleTemplateIds.CompanyAdministrator,d.directoryOverviewRoleDefault),(u-1).toString()):d.directoryOverviewRoleTextTemplate.format(g.GetLocalizedDirectoryRole(r[0],d.directoryOverviewRoleDefault),(u-1).toString());k.isDeleteDirectoryEnabled()&&f&&t._deleteDirectoryButton.disabled(!1)})).catch((function(){})).finally((function(){t.userRole(n)}))},n.prototype._initializeFindItems=function(){var n=this,t=this.context.container,r=[{text:d.directoryOverviewFindUsersText,value:lt.users},{text:d.directoryOverviewFindGroupsText,value:lt.groups},{text:d.directoryOverviewFindEnterpriseApplicationsText,value:lt.enterpriseApplications},{text:d.directoryOverviewFindAppRegistrationsText,value:lt.appRegistrations}];this.findType=f.create(t,{items:r,suppressDirtyBehavior:!0,value:lt.users});this.findType.value.subscribe(t,(function(){n.findBox.value("")}));this.findBox=o.create(t,{placeHolderText:d.directoryOverviewFindPlaceholderText,suppressDirtyBehavior:!0,validations:u.observableArray([new i.ViewModels.CustomValidation("",function(t){var r;if(t==="")return n.showFindGrid(!1),Q().then((function(){return i.ViewModels.getValidationResult()}));switch(n.findType.value()){case lt.users:r=n._getUsersQueryViewPromise(t);break;case lt.groups:r=n._getGroupsQueryViewPromise(t);break;case lt.enterpriseApplications:r=n._getEnterpriseApplicationsQueryViewPromise(t);break;case lt.appRegistrations:r=n._getAppRegistrationsQueryViewPromise(t)}return Q(r.then((function(){return n.showFindGrid(!0),i.ViewModels.getValidationResult()})))})])})},n.prototype._getUsersQueryViewPromise=function(n){var t=this;return this._getUsersQueryView.fetch({searchText:n,filterValue:"",top:b.maxSearchItems,nextLink:"",adminUnit:""}).then((function(){var n=[],i=1;u.utils.arrayForEach(t._getUsersQueryView.items(),(function(r){i===b.maxSearchItems?n.push({objectId:t._resourceBlank,displayName:t._resourceFindAll,imageUrl:t._resourceBlank,extraInfo:t._resourceBlank,isUser:u.observable(!0),isGroup:u.observable(!1),appId:t._resourceBlank}):n.push({objectId:r.objectId,displayName:r.displayName,imageUrl:r.imageUrl,extraInfo:r.displayUserPrincipalName,isUser:u.observable(!0),isGroup:u.observable(!1),appId:t._resourceBlank});i++}));t.findGrid.items(n)}))},n.prototype._getGroupsQueryViewPromise=function(n){var t=this;return this._getGroupsQueryView.fetch({searchText:n,top:b.maxSearchItems,nextLink:"",orderByFieldName:"displayName",orderAscending:!0,groupState:"",adminUnit:""}).then((function(){var n=[],i=1;u.utils.arrayForEach(t._getGroupsQueryView.items(),(function(r){i===b.maxSearchItems?n.push({objectId:t._resourceBlank,displayName:t._resourceFindAll,imageUrl:t._resourceBlank,extraInfo:t._resourceBlank,isUser:u.observable(!1),isGroup:u.observable(!0),appId:t._resourceBlank}):n.push({objectId:r.objectId,displayName:r.displayName,imageUrl:r.imageUrl,extraInfo:t._resourceBlank,isUser:r.isUser,isGroup:r.isGroup,appId:t._resourceBlank});i++}));t.findGrid.items(n)}))},n.prototype._getEnterpriseApplicationsQueryViewPromise=function(n){var t=this,r=this.context.model;return this._getEnterpriseApplicationsQueryView.fetch({searchText:u.observable(n),top:u.observable(b.maxSearchItems),appListQuery:u.observable(y.AppListQueryEnum.EnterpriseApps),accountEnabled:null,isAppVisible:null,loadLogo:u.observable(!1),putCachedLogoUrlOnly:u.observable(!0),nextLink:null,usedFirstPartyAppIds:null}).then((function(){var f=[],e=1,n=t._getEnterpriseApplicationsQueryView.items();n.length>0&&(r.enterpriseApplicationsDataContext.applicationsLogo(n).then((function(t){for(var r,i=0;i<n.length;i++)r=n[i].appId(),t[r]!==null&&n[i].logo45Url(t[r])})),u.utils.arrayForEach(t._getEnterpriseApplicationsQueryView.items(),(function(n){e===b.maxSearchItems?f.push({objectId:t._resourceBlank,displayName:t._resourceFindAll,imageUrl:t._resourceBlank,extraInfo:t._resourceBlank,isUser:u.observable(!1),isGroup:u.observable(!1),appId:t._resourceBlank}):(rt.imageExists(n.logo45Url(),0,(function(t){t||n.logo45Url(i.Base.Resources.getVersionlessContentUri(y.defaultAppLogoUrl))})),f.push({objectId:n.objectId,displayName:n.displayName,imageUrl:n.logo45Url,extraInfo:t._resourceBlank,isUser:u.observable(!1),isGroup:u.observable(!1),appId:n.appId}));e++})));t.findGrid.items(f)}))},n.prototype._getAppRegistrationsQueryViewPromise=function(n){var t=this,r=this.context.model;return this._getAppRegistrationsQueryView.fetch({searchText:n,searchAll:!0,top:b.maxSearchItems,nextLink:"",putCachedLogoUrlOnly:!0}).then((function(){var f=[],e=1,n=t._getAppRegistrationsQueryView.items();n.length>0&&(r.registeredAppsDataContext.applicationsLogo(n).then((function(t){for(var r,i=0;i<n.length;i++)r=n[i].appId(),t[r]!==null&&n[i].logoUrl(t[r])})),u.utils.arrayForEach(n,(function(n){e===b.maxSearchItems?f.push({objectId:t._resourceBlank,displayName:t._resourceFindAll,imageUrl:t._resourceBlank,extraInfo:t._resourceBlank,isUser:u.observable(!1),isGroup:u.observable(!1),appId:t._resourceBlank}):(rt.imageExists(n.logoUrl(),0,(function(t){t||n.logoUrl(i.Base.Resources.getVersionlessContentUri(ft.defaultAppLogoUrl))})),f.push({objectId:n.objectId,displayName:n.displayName,imageUrl:n.logoUrl,extraInfo:t._resourceBlank,isUser:u.observable(!1),isGroup:u.observable(!1),appId:n.appId}));e++})));t.findGrid.items(f)}))},n.prototype._initializeGrid=function(){var n=this.context.container,t=function(n,t){return n.displayName()===t.selectionKey},r=function(n){return{selectionKey:n.displayName()}},f=pt.Extensions.SelectableRow,e={selectableRow:{selectionMode:1,itemMatchesSelection:t,activateOnSelected:u.observable(!0),createSelection:r},onRowClicked:this._onFindGridRowClick.bind(this)};this.findGrid=new pt.ViewModel(n,null,f,e);this.findGrid.noRowsMessage=u.observable(w.noResultsText);this.findGrid.showHeader=!1;this.findGrid.columns=u.observableArray([{itemKey:"objectId",width:u.observable("100%"),format:i.ViewModels.Controls.Lists.Grid.Format.HtmlBindings,formatOptions:{htmlBindingsTemplate:"\n                            <div class='ext-member-list-item-image' data-bind='visible: settings.item.imageUrl().length > 0'>\n                                <img alt='object icon' data-bind='attr: { src: settings.item.imageUrl }, css: { ext-thumbnailborder-user: settings.item.isUser(), ext-thumbnailborder-group: settings.item.isGroup()}' class='ext-find-object-image'>\n                            <\/div>\n                            <div class='ext-member-list-item-details'>\n                                <div data-bind='text: settings.item.displayName, attr: { title: settings.item.displayName }' class='msportalfx-text-ellipsis'><\/div>\n                                <div data-bind='visible: settings.item.displayName() !== settings.item.extraInfo(), text: settings.item.extraInfo, attr: { title: settings.item.extraInfo }' class='msportalfx-text-ellipsis msportalfx-text-muted-50'><\/div>\n                            <\/div>\n                        "}}])},n.prototype._onFindGridRowClick=function(n){var t=this.context.container;if(i.notNullOrUndefined(n)){switch(this.findType.value()){case lt.users:n.objectId().length===0?t.openBlade(new l.UsersListBladeV2Reference({adminUnitObjectId:""})):t.openBlade(new l.UserDetailsMenuBladeReference({userId:n.objectId()}));break;case lt.groups:n.objectId().length===0?t.openBlade(new l.GroupsListBladeReference({adminUnitObjectId:""})):t.openBlade(new l.GroupDetailsMenuBladeReference({groupId:n.objectId()}));break;case lt.enterpriseApplications:n.objectId().length===0?t.openBlade(new l.EnterpriseApplicationListBladeV2Reference):st.openManagedAppMenuBlade(t,n.objectId(),n.appId());break;case lt.appRegistrations:n.objectId().length===0?t.openBlade(new l.ApplicationsListBladeReference):t.openBlade(new l.ApplicationBladeReference({appId:n.appId(),objectId:n.objectId()}))}this.showFindGrid(!1)}},n.prototype._getAdConnectStatusEntityViewPromise=function(){var n=this;return this.adConnectSyncStatus(p.dotdotdot),this.adConnectLastSync(p.dotdotdot),this._getAdConnectStatusEntityView.fetch({}).then((function(){var t=n._getAdConnectStatusEntityView.item();t.dirSyncEnabled()?(n.adConnectSyncStatus(d.directoryOverviewAdConnectSyncStatusEnabled),n.adConnectLastSync(k.stringNumberOfHoursFromLastSync(t.numberOfHoursFromLastSync()))):(n.adConnectSyncStatus(d.directoryOverviewAdConnectSyncStatusNotEnabled),n.adConnectLastSync(d.directoryOverviewAdConnectSyncStatusNeverRun))}))},n.prototype._initializeCreateItems=function(){var n=this;this.createItems.push({image:i.Base.Images.Person(),text:d.directoryOverviewCreateUserText,fxclick:function(){n._onCreateUser()}});this.createItems.push({image:i.Base.Images.Polychromatic.Website(),text:d.directoryOverviewCreateGuestUserText,fxclick:function(){n._onCreateGuestUser()}});this.createItems.push({image:i.Base.Images.PersonWithFriend({palette:3}),text:d.directoryOverviewCreateGroupText,fxclick:function(){n._onCreateGroup()}});this.createItems.push({image:i.Base.Images.Polychromatic.Grid({palette:3}),text:d.directoryOverviewCreateEnterpriseApplicationText,fxclick:function(){n._onCreateApplication()}});this.createItems.push({image:v.PortalExtension.ADExtension.Client.RegisteredApps.Images.registeredApps,text:d.directoryOverviewCreateAppRegistrationText,fxclick:function(){n._onCreateApplicationRegistration()}})},n.prototype._onCreateUser=function(){var n=this.context,t=n.container,r=n.model,i=new ht.UserCreationService(t,r);t.openBlade(new l.UserAddNewBladeReference({supplyInitialData:function(){return i.SupplyInitialData()},receiveResult:function(n){return i.ReceiveResult(n)},supplyProviderConfig:function(){return{}}}))},n.prototype._onCreateGuestUser=function(){var n=this.context.container;n.openBlade(new l.UserAddNewBladeV2Reference({initialMode:ct.bladeMode.invite,lock:!0}))},n.prototype._onCreateGroup=function(){var n=this.context.container;n.openBlade(new l.AddGroupBladeReference)},n.prototype._onCreateApplication=function(){var n=this.context.container;n.openBlade(new l.AppGalleryCategoriesBladeReference)},n.prototype._onCreateApplicationRegistration=function(){var n=this.context.container;n.openBlade(new l.ApplicationAddBladeReference({onOutputsChanged:function(){}}))},n.prototype._initializeOtherCapabilitiesItems=function(){var n=this,t=wt("otherCapabilitiesTileEnabledLinks");t.split(";").forEach((function(t){switch(t){case b.OtherCapabilitiesEnabledLinks.identityProtectionCenter:n.otherCapabilitiesItems.push({text:d.directoryOverviewOtherCapabilitiesIdentityProtectionText,fxclick:function(){n._onIdentityProtection()}});break;case b.OtherCapabilitiesEnabledLinks.priviligedIdentityManagement:n.otherCapabilitiesItems.push({text:d.directoryOverviewOtherCapabilitiesPrivilegedIdentityManagementText,fxclick:function(){n._onPrivilegedIdentityManagement()}});break;case b.OtherCapabilitiesEnabledLinks.manageDomainNames:n.otherCapabilitiesItems.push({text:d.directoryOverviewOtherCapabilitiesManageDomainNames,fxclick:function(){n._onAzureADDomainServices()}});break;case b.OtherCapabilitiesEnabledLinks.configureUserSettings:n.otherCapabilitiesItems.push({text:d.directoryOverviewOtherCapabilitiesUserSettings,fxclick:function(){n._onConfigureUserSettings()}});break;case b.OtherCapabilitiesEnabledLinks.tenantRestrictionsReport:n.otherCapabilitiesItems.push({text:d.directoryOverviewOtherCapabilitiesTenantRestrictionsText,fxclick:function(){n._onTenantRestrictions()}});break;case b.OtherCapabilitiesEnabledLinks.azureADDomainServices:n.otherCapabilitiesItems.push({text:d.directoryOverviewOtherCapabilitiesAzureADDomainServicesText,fxclick:function(){n._onAzureADDomainServices()}});break;case b.OtherCapabilitiesEnabledLinks.accessReviews:wt("isAccessReviewsErmExtensionEnabled")&&n.otherCapabilitiesItems.push({text:d.directoryOverviewOtherCapabilitiesAccessReviewsText,fxclick:function(){n._onAccessReviews()}})}}))},n.prototype._onIdentityProtection=function(){var n=this.context.container;n.openBlade(new h.OnboardingBladeReference({supplyInitialData:function(){return{}},receiveResult:function(){},supplyProviderConfig:function(){return{provisioningConfig:{provisioningEnabled:!0}}}}))},n.prototype._onPrivilegedIdentityManagement=function(){var n=this.context.container;n.openBlade(new c.CommonMenuBladeReference({}))},n.prototype._onAzureADDomainServices=function(){var n=this.context.container;n.openBlade(new l.DomainsListBladeReference)},n.prototype._onAccessReviews=function(){var n=this.context.container;n.openBlade(new s.DashboardBladeReference)},n.prototype._onTenantRestrictions=function(){var n=this.context.container;n.openBlade(new l.SignInEventsRestrictedBladeReference({}))},n.prototype._onConfigureUserSettings=function(){var n=this.context.container;n.openBlade(new l.DirectoryUserSettingsBladeReference({}))},n.prototype._initializeMiscellaneousItems=function(){var n=this;this.miscellaneousItems.push({text:d.directoryOverviewMiscellaneousGettingStartedText,fxclick:function(){n._onGetttingStarted()}});this.miscellaneousItems.push({text:d.directoryOverviewMiscellaneousCreateDirectoryText,fxclick:function(){n._onCreateDirectory()}})},n.prototype._onGetttingStarted=function(){var n=this.context.menu;n.switchItem(p.menuIds.directoryQuickStartMenuId)},n.prototype._onCreateDirectory=function(){var n=this.context.container;n.openBlade(new l.DirectoryAddBladeReference)},n.prototype._initializeToolbar=function(){var t=this.context.container,n=[],r=new i.ViewModels.Toolbars.Toolbar(t);t.commandBar=r;n.push(this._createSwitchDirectoryButton());n.push(this._createDeleteDirectoryButton());r.setItems(n)},n.prototype._createSwitchDirectoryButton=function(){return new i.ViewModels.Toolbars.OpenLinkButton({label:d.commandSwitchDirectoryLabel,icon:i.Base.Images.Link(),uri:"#menu/directory",target:"_self"})},n.prototype._createDeleteDirectoryButton=function(){var n="#blade/"+a.definitionName+"/"+a.BladeNames.directoryDeleteBlade;return this._deleteDirectoryButton=new i.ViewModels.Toolbars.OpenLinkButton({label:d.commandDeleteDirectoryLabel,icon:i.Base.Images.Delete(),uri:n,target:"_self"}),this._deleteDirectoryButton.disabled(!0),this._deleteDirectoryButton},n.prototype._populateProductCapabilities=function(){var f=this,e,n=[],r,t,u;e=this._getWhatsNewQueryView.items();e.forEach((function(e){t=e.productCapabilityId();r=i.find(nt.whatsNewItemProductCapabilities,(function(n){return n.id===t}));i.notNullOrUndefined(r)&&i.notNullOrUndefined(i.find(nt.whatsNewItemServiceCategories,(function(n){return n.id===e.serviceCategoryId()})))&&(u=i.findIndex(n,(function(n){return n.id===t})),u>=0?(n[u].count++,n[0].count++):(n.length===0&&n.push(f._createDisplayProductCapability(b.allServices,d.WhatsNewItemServiceCategory.allServices,0)),n.push(f._createDisplayProductCapability(t,r.desciption,1)),n[0].count++))}));this.displayWhatsNewProductCapabilities(n)},n.prototype._createDisplayProductCapability=function(n,t,r){return{id:n,productCapabilityDescription:t,count:r,image:u.observable(n===b.allServices?i.Base.Images.Check():i.Base.Images.Blank()),fxclick:this._onWhatsNewProductCapabilityClick,itemClicked:this._productCapabilityClicked}},n.prototype._populateWhatsNew=function(n){var f=this,h=this.context.container,e=[],o,t,r,u,s;o=this._getWhatsNewQueryView.items.filter(h,(function(t){return n===b.allServices||t.productCapabilityId()===n}))();o.forEach((function(n){t=i.find(nt.whatsNewItemTypes,(function(t){return t.id===n.typeId()}));r=i.find(nt.whatsNewItemServiceCategories,(function(t){return t.id===n.serviceCategoryId()}));i.notNullOrUndefined(r)&&(s=n.productCapabilityId(),u=i.find(nt.whatsNewItemProductCapabilities,(function(n){return n.id===s})),i.notNullOrUndefined(u)&&e.push({id:n.id(),typeDescription:t.desciption,css:t.css,serviceCategoryDescription:r.desciption,productCapabilityDescription:u.desciption,formattedDate:n.date().toString("MMMM dd, yyyy"),shortTitle:n.title(),fxclick:f._onWhatsNewItemClick,itemClicked:f._whatsNewItemClicked}))}));this.displayWhatsNewItems(e)},n.prototype._onWhatsNewItemClick=function(){var n=this;n.itemClicked(n)},n.prototype._onWhatsNewProductCapabilityClick=function(){var n=this;n.itemClicked(n)},n})();yt=__decorate([e.Decorator({htmlTemplate:"../../Templates/DirectoryOverview.html",styleSheets:["../../Styles/OverviewStyles.css"],isPinnable:!1})],yt);t.ActiveDirectoryOverviewBlade=yt}));
define("_generated/adapters/blade/ActiveDirectoryOverviewBladeAdapter",["require","exports","o","Fx/Composition/ViewModelAdapters","Directories/ViewModels/DirectoryOverview/ActiveDirectoryOverview"],(function(n,t,i,r,u){"use strict";i.defineProperty(t,"__esModule",{value:!0});var f=(function(n){function t(t,i,r){return n.call(this,t,i,r,u.ActiveDirectoryOverviewBlade)||this}return __extends(t,n),t})(r.ViewModelAdapter);t.ActiveDirectoryOverviewBladeAdapter=f}));
define("_generated/Blades/ActiveDirectoryOverviewBlade",["require","exports","_generated/Blades/UsersAreaStyles.css","_generated/Blades/UserProvisioning.css","_generated/Blades/Upsell.css","_generated/Blades/SupportRequestProblemDetailsAreaStyles.css","_generated/Blades/SpotlightStyles.css","_generated/Blades/SingleSignOn.css","_generated/Blades/SharedAreaStyles.css","_generated/Blades/Settings.css","_generated/Blades/SelectorAndGridStyles.css","_generated/Blades/PoliciesAreaStyles.css","_generated/Blades/PasswordResetAreaStyles.css","_generated/Blades/OverviewStyles.css","_generated/Blades/NotificationsAreaStyles.css","_generated/Blades/MultifactorAuthentication.css","_generated/Blades/MdmApps.css","_generated/Blades/ManagedApps.css","_generated/Blades/LoginTenantBranding.css","_generated/Blades/Licenses.css","_generated/Blades/GroupsAreaStyles.css","_generated/Blades/EnterpriseApps.css","_generated/Blades/Domains.css","_generated/Blades/DirectoriesAreaStyles.css","_generated/Blades/DevicesAreaStyles.css","_generated/Blades/CustomAppAddButtonParts.css","_generated/Blades/ClassicPolicies.css","_generated/Blades/AppList.css","_generated/Blades/ApplicationsStyles.css","_generated/Blades/ApplicationProxy.css","_generated/adapters/blade/ActiveDirectoryOverviewBladeAdapter"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st){"use strict";var ht;return (function(n){n.blade={name:"ActiveDirectoryOverviewBlade",viewModelName:"Directories$ActiveDirectoryOverviewBladeAdapter",lenses:[],pinnable:!1,initialDisplayState:2,style:8,toolbar:{source:{valuesFrom:[{referenceType:0,property:"content.commandBar"}]}},templateBlade:{htmlTemplate:null,partSize:9,htmlTemplateInline:{file:"DirectoryOverview.html",content:'<div class="msportalfx-padding"> <div class="ext-directoryoverview-top"> <div> <div><span data-bind="text:domainname"><\/span><\/div> <div class="ext-directoryoverview-directoryproperties-directoryname"><span data-bind="text:directoryname"><\/span><\/div> <div><span data-bind="text:servicelevel"><\/span><\/div> <\/div> <\/div> <div class="ext-directoryoverview-main ext-directoryoverview-flexrow"> <div class="ext-directoryoverview-main-left"> <div class="ext-directoryoverview-chart"> <div class="ext-directoryoverview-chart-title"><span data-bind="text:usersSigninChartTitle"><\/span><\/div> <div class="ext-directoryoverview-chart-chart"> <!-- ko if: chartStatus() === 0 --> <div data-bind="pcControl: usersSigninChart, fxclick:onChartClick"><\/div> <!-- /ko --> <!-- ko if: chartStatus() !== 0 --> <div class="ext-directoryoverview-chart-error-line"><\/div> <div class="ext-directoryoverview-chart-error-data"> <div class="ext-directoryoverview-chart-error-data-item"> <!-- ko if: chartStatus() === 1 --> <div data-bind="text:chartErrorDefaultLine"><\/div> <!-- /ko --> <!-- ko if: chartStatus() === 2 --> <div> <span data-bind="text:chartErrorRoleLine"><\/span>&nbsp; <a href="https://docs.microsoft.com/azure/active-directory/active-directory-assign-admin-roles-azure-portal" target="_blank"><span data-bind="text:chartRoleMoreInfo"><\/span><\/a> <\/div> <div class="ext-directoryoverview-chart-error-blankline"><\/div> <div class="ext-directoryoverview-flexrow"> <div class="ext-directoryoverview-chart-error-roletext" data-bind="text:resourceYourRole"><\/div> <div>&nbsp;<\/div> <div data-bind="text:userRole"><\/div> <\/div> <!-- /ko --> <!-- ko if: chartStatus() === 3 --> <div data-bind="text:chartErrorSubscriptionLine"><\/div> <div><a data-bind="text:chartErrorSubscriptionLineFreeTrial, fxclick:onChartTryBuyProduct"><\/a><\/div> <!-- /ko --> <\/div> <\/div> <div class="ext-directoryoverview-chart-error-line"><\/div> <!-- /ko --> <\/div> <\/div> <div class="ext-directoryoverview-whatsnew-summary"> <div class="ext-directoryoverview-whatsnew-text" data-bind="text: resourceWhatsNewTitle"><\/div> <div class="ext-directoryoverview-whatsnew-subtitletext" data-bind="text: resourceWhatsNewSubTitle"><\/div> <div class="ext-directoryoverview-flexrow"> <div><span data-bind="text:resourceWhatsNewNumber"><\/span>&nbsp;&nbsp;<a href="https://docs.microsoft.com/azure/active-directory/whats-new" target="_blank"><span data-bind="text:resourceViewArchive"><\/span><\/a><\/div> &nbsp; <div data-bind="image: imageLaunchCurrent" class="ext-directoryoverview-imageLaunchCurrent"><\/div> <\/div> <\/div> <div class="ext-directoryoverview-flexrow"> <div> <div> <div data-bind="foreach:displayWhatsNewProductCapabilities"> <div class="ext-directoryoverview-whatsnew-productcapabilities-item ext-directoryoverview-flexrow"> <div class="ext-directoryoverview-whatsnew-productcapabilities-item-checkbox"><a data-bind="fxclick:fxclick" class="ext-directoryoverview-whatsnew-productcapabilities-item-hyperlink"><span data-bind="image: image" class="ext-directoryoverview-whatsnew-productcapabilities-item-image"><\/span><\/a><\/div> <div class="msportalfx-text-ellipsis ext-directoryoverview-whatsnew-productcapabilities-item-text">&nbsp;&nbsp;<span data-bind="text:productCapabilityDescription"><\/span><\/div> <div>(<span data-bind="text:count"><\/span>)<\/div> <\/div> <\/div> <\/div> <\/div> <div class="ext-directoryoverview-whatsnew-details"> <div> <div data-bind="foreach:displayWhatsNewItems"> <div> <div class="ext-directoryoverview-whatsnew-item-type-base"><span data-bind="text:typeDescription, css: css" class="ext-directoryoverview-whatsnew-item-type"><\/span><\/div> <div class="ext-directoryoverview-whatsnew-item-serviceproduct"> <span data-bind="text:serviceCategoryDescription"><\/span>&nbsp;-&nbsp;<span data-bind="text:productCapabilityDescription"><\/span> <\/div> <div class="ext-directoryoverview-whatsnew-item-formattedDate msportalfx-text-muted-50"><span data-bind="text:formattedDate"><\/span><\/div> <div class="ext-directoryoverview-main-whatsnew-item-shorttitle"> <a data-bind="text:shortTitle, fxclick:fxclick"><\/a> <\/div> <div class="ext-directoryoverview-main-whatsnew-item-line"><\/div> <\/div> <\/div> <\/div> <\/div> <\/div> <\/div> <div class="ext-directoryoverview-main-right"> <div class="ext-directoryoverview-userrole"> <div class="ext-directoryoverview-userrole-text" data-bind="text:resourceYourRole"><\/div> <div data-bind="text:userRole"><\/div> <div class="ext-directoryoverview-flexrow"> <div><a href="https://docs.microsoft.com/azure/active-directory/active-directory-assign-admin-roles-azure-portal" target="_blank"><span data-bind="text:resourceMoreInfo"><\/span><\/a><\/div> &nbsp; <div data-bind="image: imageLaunchCurrent" class="ext-directoryoverview-imageLaunchCurrent"><\/div> <\/div> <\/div> <div class="ext-directoryoverview-find"> <div class="ext-directoryoverview-find-text" data-bind="text: resourceFind"><\/div> <div class="ext-directoryoverview-find-findtype" data-bind="pcControl:findType"><\/div> <div class="ext-directoryoverview-find-findbox" data-bind="pcControl:findBox"><\/div> <div class="ext-directoryoverview-find-findgrid" data-bind="pcControl:findGrid, visible: showFindGrid"><\/div> <\/div> <div class="ext-directoryoverview-adconnect"> <div class="ext-directoryoverview-adconnect-text" data-bind="text: resourceAdConnect"><\/div> <div class="ext-directoryoverview-flexrow"> <div data-bind="text: resourceAdConnectSyncStatus" class="ext-directoryoverview-adconnect-columnlabel"><\/div> <div data-bind="text: adConnectSyncStatus" class="ext-directoryoverview-adconnect-columndata"><\/div> <\/div> <div class="ext-directoryoverview-flexrow"> <div data-bind="text: resourceAdConnectLastSync" class="ext-directoryoverview-adconnect-columnlabel"><\/div> <div data-bind="text: adConnectLastSync" class="ext-directoryoverview-adconnect-columndata"><\/div> <\/div> <\/div> <div class="ext-directoryoverview-create"> <div class="ext-directoryoverview-create-text" data-bind="text: resourceCreate"><\/div> <div data-bind="foreach:createItems"> <div class="ext-directoryoverview-create-item"> <div data-bind="image: image" class="ext-directoryoverview-create-item-image"><\/div> <div><a data-bind="fxclick:fxclick"><span data-bind="text:text"><\/span><\/a><\/div> <\/div> <\/div> <\/div> <div class="ext-directoryoverview-othercapabilities"> <div class="ext-directoryoverview-othercapabilities-text" data-bind="text: resourceOtherCapabilities"><\/div> <div data-bind="foreach:otherCapabilitiesItems"> <div class="ext-directoryoverview-othercapabilities-item"> <div><a data-bind="fxclick:fxclick"><span data-bind="text:text"><\/span><\/a><\/div> <\/div> <\/div> <\/div> <div class="ext-directoryoverview-main-right-line"><\/div> <div> <div data-bind="foreach:miscellaneousItems"> <div class="ext-directoryoverview-miscellaneous-item"> <div><a data-bind="fxclick:fxclick"><span data-bind="text:text"><\/span><\/a><\/div> <\/div> <\/div> <\/div> <\/div> <\/div> <\/div> '},styleSheets:[{file:"Blades/ApplicationProxy.css",content:st},{file:"Blades/EnterpriseApps.css",content:nt},{file:"Blades/EnterpriseApps.css",content:nt},{file:"Blades/AppList.css",content:et},{file:"Blades/CustomAppAddButtonParts.css",content:ut},{file:"Blades/ManagedApps.css",content:b},{file:"Blades/MdmApps.css",content:w},{file:"Blades/Settings.css",content:h},{file:"Blades/SingleSignOn.css",content:o},{file:"Blades/SharedAreaStyles.css",content:s},{file:"Blades/DevicesAreaStyles.css",content:rt},{file:"Blades/DirectoriesAreaStyles.css",content:it},{file:"Blades/Domains.css",content:tt},{file:"Blades/SharedAreaStyles.css",content:s},{file:"Blades/GroupsAreaStyles.css",content:g},{file:"Blades/Licenses.css",content:d},{file:"Blades/LoginTenantBranding.css",content:k},{file:"Blades/MultifactorAuthentication.css",content:p},{file:"Blades/NotificationsAreaStyles.css",content:y},{file:"Blades/PasswordResetAreaStyles.css",content:a},{file:"Blades/SelectorAndGridStyles.css",content:c},{file:"Blades/SelectorAndGridStyles.css",content:c},{file:"Blades/ClassicPolicies.css",content:ft},{file:"Blades/PoliciesAreaStyles.css",content:l},{file:"Blades/Upsell.css",content:u},{file:"Blades/ApplicationsStyles.css",content:ot},{file:"Blades/SharedAreaStyles.css",content:s},{file:"Blades/SpotlightStyles.css",content:e},{file:"Blades/SupportRequestProblemDetailsAreaStyles.css",content:f},{file:"Blades/SharedAreaStyles.css",content:s},{file:"Blades/UserProvisioning.css",content:r},{file:"Blades/SharedAreaStyles.css",content:s},{file:"Blades/UsersAreaStyles.css",content:i},{file:"Blades/OverviewStyles.css",content:v}],isV2:!0},attributes:1}})(ht||(ht={})),ht}))