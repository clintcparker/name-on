define("Users/ViewModels/UserProfile/UserProfileV2",["require","exports","f","o","ko","Fx/Controls/Button","Fx/Controls/CopyableLabel","Fx/Controls/DropDown","Fx/Controls/FileUpload","Fx/Composition/Selectable","Fx/Controls/OptionsGroup","Fx/Composition/TemplateBlade","Fx/Controls/TextBox","Fx/Controls/Validations","_generated/BladeReferences","_generated/ExtensionDefinition","CommonConstants","CommonResources","Groups/Constants","Groups/GroupsResources","InProductFeedback/Utilities","Permissions/Permission","Reports/Constants","Users/ViewModels/UserAddNew/UserCreationService","Users/UsersResources","Users/Constants","Users/Utilities/UsersFormValidations","Users/Utilities/UsersProvidersModels","Fx/Controls/FileUpload"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot){"use strict";var st,vt;r.defineProperty(t,"__esModule",{value:!0});var ht=i.ViewModels.Controls.Visualization.Chart,yt={isAuthenticationContactInfoUpdated:"isAuthenticationContactInfoUpdated",isThumbnailUpdated:"isThumbnailUpdated",imageDataToUpload:"imageDataToUpload",imageUrl:"imageUrl"},ct=[{text:rt.ageGroupUndefinedDropdownItem,value:ut.ageGroupsDropdown.undefined},{text:rt.ageGroupMinorDropdownItem,value:ut.ageGroupsDropdown.minor},{text:rt.ageGroupAdultDropdownItem,value:ut.ageGroupsDropdown.adult},{text:rt.ageGroupNotAdultDropdownItem,value:ut.ageGroupsDropdown.notAdult}],lt=[{text:rt.consentProvidedNoneDropdownItem,value:ut.consentProvidedDropdown.none},{text:rt.consentProvidedGrantedDropdownItem,value:ut.consentProvidedDropdown.granted},{text:rt.consentProvidedDeniedDropdownItem,value:ut.consentProvidedDropdown.denied},{text:rt.consentProvidedNotRequiredDropdownItem,value:ut.consentProvidedDropdown.notRequired}],pt=[{arrayPosition:0,errorMessage:rt.saveUserProfileNotificationPartialErrorProfileProperties},{arrayPosition:1,errorMessage:rt.saveUserProfileNotificationPartialErrorPhoto},{arrayPosition:2,errorMessage:rt.saveUserProfileNotificationPartialErrorAuth},{arrayPosition:3,errorMessage:rt.saveUserProfileNotificationPartialErrorManager}],at;(function(n){n[n.noError=0]="noError";n[n.defaultError=1]="defaultError";n[n.roleError=2]="roleError";n[n.subscriptionError=3]="subscriptionError"})(at=t.ChartStatus||(t.ChartStatus={})),(function(n){n[n.view=0]="view";n[n.edit=1]="edit"})(st=t.ViewEditMode||(t.ViewEditMode={}));vt=(function(){function n(){this.title=u.observable("");this.subtitle="";this.viewEditMode=u.observable();this.loadingImage=i.Base.Images.Loading.EllipsisSquare();this.thumbnailUrl=u.observable();this.thumbnailUploadInfoText=rt.userProfileThumbnailUploadInfo;this.signinChartText=rt.userProfileFormElementSignIns;this.groupMembershipsText=rt.userProfileFormElementGroupMemberships;this.groupMembershipsData=u.observable("");this.identityText=rt.userIdentityFormSectionTitle;this.displayNameText=rt.userProfileFormElementName;this.displayNameData=u.observable("");this.objectIdText=rt.userProfileFormElementObjectId;this.userTypeText=rt.userProfileFormElementUserType;this.userTypeData=u.observable("");this.userNameText=rt.userProfileFormElementUserName;this.userNameData=u.observable("");this.sourceText=rt.userProfileFormElementSource;this.sourceData=u.observable("");this.givenNameText=rt.userProfileFormElementGivenName;this.givenNameData=u.observable("");this.surameText=rt.userProfileFormElementSurname;this.surameData=u.observable("");this.invitationAcceptedText=rt.userProfileFormElementInvitationAccepted;this.invitationAcceptedData=u.observable("");this.invitationUrlIdText=rt.userProfileCopyableInvitationUrlLabel;this.jobInfoText=rt.userWorkInfoFormSectionJobInfo;this.jobTitleText=rt.userDetailsEssentialsJobTitle;this.jobTitleData=u.observable("");this.departmentText=rt.userWorkInfoFormElementDepartment;this.departmentData=u.observable("");this.managerText=rt.userWorkInfoFormElementManager;this.managerData=u.observable("");this.settingsText=rt.userProfileSettingsSectionTitle;this.blockSignInSwitchText=rt.userProfileBlockSignIn;this.blockSignInSwitchData=u.observable("");this.usageLocationText=rt.userProfileFormElementUsageLocation;this.usageLocationData=u.observable("");this.contactInfoText=rt.userWorkInfoFormSectionContactInfo;this.streetAddressText=rt.userWorkInfoFormElementStreetAddress;this.streetAddressData=u.observable("");this.stateText=rt.userWorkInfoFormElementState;this.stateData=u.observable("");this.countryText=rt.userWorkInfoFormElementCountry;this.countryData=u.observable("");this.officeText=rt.userWorkInfoFormElementOffice;this.officeData=u.observable("");this.cityText=rt.userWorkInfoFormElementCity;this.cityData=u.observable("");this.zipText=rt.userWorkInfoFormElementZipCode;this.zipData=u.observable("");this.officePhoneText=rt.userWorkInfoFormElementOfficePhone;this.officePhoneData=u.observable("");this.mobilePhoneText=rt.userWorkInfoFormElementMobilePhone;this.mobilePhoneData=u.observable("");this.authenticationContactInfoText=rt.userProfileAuthenticationContactInfoSectionTitle;this.authenticationPhoneText=rt.userProfileFormElementAuthenticationPhone;this.authenticationPhoneData=u.observable("");this.authenticationEmailAddressText=rt.userProfileFormElementAuthenticationEmail;this.authenticationEmailAddressData=u.observable("");this.authenticationAlternatePhoneText=rt.userProfileFormElementAuthenticationAlternativePhone;this.authenticationAlternatePhoneData=u.observable("");this.authenticationAlternateEmailAddressText=rt.userProfileFormElementAlternateEmailAddress;this.authenticationAlternateEmailAddressData=u.observable("");this.authenticationManageContactInformationText=u.observable("");this.authenticationManageContactInformationUrl=i.getEnvironmentValue("userProfileAuthManageContactInformationUrl");this.authenticationManageContactInformationUrlText=rt.authenticationManageContactInformationUrlText;this.authenticationManageNoAccessText=rt.authenticationManageNoAccessText;this.minorsAndConsentSectionLabelText=rt.minorsAndConsentSectionLabel;this.ageGroupText=rt.ageGroupLabel;this.ageGroupData=u.observable("");this.consentProvidedForMinorText=rt.consentProvidedLabel;this.consentProvidedForMinorData=u.observable("");this.legalAgeGroupClassificationText=rt.ageGroupClassificationLabel;this.legalAgeGroupClassificationData=u.observable("");this.showRemoveThumbnailUrl=u.observable(!1);this.chartStatus=u.observable(at.noError);this.chartRoleMoreInfo=rt.userProfileChartRoleMoreInfoText;this.chartErrorRoleLine=rt.UserProfile.Error.roleLine;this.chartErrorSubscriptionLine=rt.UserProfile.Error.subscriptionLine;this.chartErrorSubscriptionLineFreeTrial=rt.UserProfile.Error.subscriptionLineFreeTrial;this.chartErrorDefaultLine=rt.UserProfile.Error.defaultLine;this.isLoadComplete=u.observable(!1);this.editText=b.edit.toLocaleLowerCase();this.showEdit=u.observable(!1);this.showEditCloudAndSynced=u.observable(!1);this.showEditMfaCloudAndSynced=u.observable(!1);this.showEditGdpr=u.observable(!1);this.isGlobalAdmin=u.observable(!1);this.isUserAdmin=u.observable(!1);this.isSelfMode=u.observable(!0);this.isGuestUser=u.observable(!1);this.isInvitedGuestUser=u.observable(!1);this.invitationUrlVisible=u.observable(!1);this.showChangeManager=u.observable(!1);this.changeManagerText=b.change;this.removeText=b.remove;this._isDeleteExecuting=u.observable(!1);this._saveInProgress=u.observable(!1);this._canEdit=u.observable(!1);this._canDelete=u.observable(!1);this._allowRemoveRemoveThumbnailUrl=!1;this._managerData=u.observable({managerId:null,managerDisplayName:null});this._dirtyableContracts=[];this._adminEditableContracts=[];this._adminEditableCloudOnlyContracts=[];this._adminEditableCloudAndSyncedContracts=[];this._adminEditableGdprContracts=[];this._mfaAdminEditableCloudAndSyncedContracts=[];this._userEditableContracts=[];this._userEmptyPropertyViewValues=[this.givenNameData,this.surameData,this.jobTitleData,this.departmentData,this.streetAddressData,this.stateData,this.countryData,this.officeData,this.cityData,this.zipData,this.officePhoneData,this.mobilePhoneData,this.authenticationPhoneData,this.authenticationEmailAddressData,this.authenticationAlternatePhoneData,this.authenticationAlternateEmailAddressData]}return n.prototype.onInitialize=function(){var n=this;return this._initialize(),Q.all(this._executePromises()).then((function(){n.isLoadComplete(!0)}))},n.prototype.editTextClick=function(){this.viewEditMode(st.edit)},n.prototype.removeThumbnailUrlClick=function(){this.thumbnailUrl(this._defaultThumbnailUrl);this._imageDataToUpload="";this.showRemoveThumbnailUrl(!1);this.thumbnailUpload.dirty(!0)},n.prototype.onChartClick=function(){var n=this.context,t=n.parameters,i=n.container;this.signinChart.loading()===!1&&i.openBlade(new y.SignInEventsBladeReference({userObjectId:t.userId}))},n.prototype.onChartTryBuyProduct=function(){var n=this.context.container;this.signinChart.loading()===!1&&n.openBlade(new y.TryBuyProductBladeReference)},n.prototype.groupMembershipsClick=function(){var n=this.context.menu;n.switchItem(w.menuIds.groupsMenuId)},n.prototype.removeManagerClick=function(){var n=this._managerData().managerId;i.notNullOrUndefined(n)&&n.length>0&&(this._managerData({managerId:null,managerDisplayName:null}),this.managerTextbox.dirty(!0))},n.prototype.changeManagerClick=function(){var n=this,t=this.context,i=t.parameters,r=t.container,u=function(t,i){if(t===2){var r={managerId:i.selectedMembers.length>0?i.selectedMembers[0].objectId:null,managerDisplayName:i.selectedMembers.length>0?i.selectedMembers[0].displayName:null};r.managerId!==n._managerData().managerId&&(n._managerData(r),n.managerTextbox.dirty(!0))}},f={selectedObjectIds:[this._managerData().managerId],disabledObjectIds:[i.userId],searchCriteria:1,isSingleSelect:!0,isInviteEnabled:!1,title:rt.changeManagerBladeTitle};r.openContextPane(new y.DirectoryObjectPickerBladeReference(f,u))},n.prototype.managerDataClick=function(){var t=this.context.container,n=this._managerData().managerId;i.notNullOrUndefined(n)&&n.length>0&&t.openBlade(new y.UserDetailsMenuBladeReference({userId:n}))},n.prototype._initialize=function(){this.isLoadComplete(!1);this._initializeQuery();this._initializeToolbar();this._initializeControls();this._initializeChart();this._initializeManagerId();this._initializeMode(st.view);this._initializeInProductFeedback()},n.prototype._executePromises=function(){var n=this,i=this.context,t=i.container,e=i.parameters,o=i.model,r=[],u=this._getUserDetailsEntity.fetch({userId:e.userId}).then((function(){n._getManagerData();n._initializeImageData();n._displayUser();n._initializeResendInvitationData()})),s=nt.Permission.CheckPermission(nt.TargetObjectType.User,nt.ActionType.Update,t),h=nt.Permission.CheckPermission(nt.TargetObjectType.UserProfileBasicProperties,nt.ActionType.Update,t),f;return r.push(u),f=o.sharedDataContext.getCurrentContext.fetch({},t),this._initializePromises(u,s,h,f),t.revealContent(),r},n.prototype._initializePromises=function(n,t,i,r){this._initializeUsersEnvironmentSettingsPromises();this._initializeAdminEditableAllContractsPromises(n,t,i);this._initializeMfaAdminEditableCloudAndSyncedContractsPromises();this._initializeUserEditableContractsPromises(n,t,i,r);this._initializeGlobalAdminEditableContractsPromises();this._initializeUserAdminEditableContractsPromises();this._initializeSelfPromises(r);this._getSignInEventsSummaryQueryViewPromise();this._groupMembershipsCountData();this._initializeDeleteUserPromise()},n.prototype._initializeUsersEnvironmentSettingsPromises=function(){var n=this,t=this.context,i=t.container,r=t.model;r.usersEnvironmentSettingsEntity.fetch({},i).then((function(t){n.usageLocationDropDown.items(t.data().countries().map((function(n){return{text:n.displayName(),value:n.countryCode()}})));n._displayUsageLocationData()}))},n.prototype._initializeAdminEditableAllContractsPromises=function(n,t,i){var r=this,u=[n,t,i];Q.all(u).then((function(n){var i=n[1],u=n[2],t=r._getUserDetailsEntity.item(),f=t.dirSyncEnabled&&t.dirSyncEnabled()?!0:!1;f?i&&u&&(r._adminEditableCloudAndSyncedContracts.forEach((function(n){return n.disabled(!1)})),r.showEditCloudAndSynced(!0),r._canEdit(!0)):i&&u&&(r._adminEditableCloudAndSyncedContracts.forEach((function(n){return n.disabled(!1)})),r.showEditCloudAndSynced(!0),r._adminEditableContracts.forEach((function(n){return n.disabled(!1)})),r._adminEditableGdprContracts.forEach((function(n){return n.disabled(!1)})),r.showChangeManager(!0),(t.userFlags()&ut.userFlags.editableUpn)==1&&t.source()===ut.userSourceTypes.cloud&&r._adminEditableCloudOnlyContracts.forEach((function(n){return n.disabled(!1)})),r.showEdit(!0),r.showEditGdpr(!0),r._canEdit(!0))}))},n.prototype._initializeMfaAdminEditableCloudAndSyncedContractsPromises=function(){var n=this,t=this.context.container;nt.Permission.CheckPermission(nt.TargetObjectType.MultiFactorAuthentication,nt.ActionType.Update,t).then((function(t){t&&(n._mfaAdminEditableCloudAndSyncedContracts.forEach((function(n){return n.disabled(!1)})),n.showEditMfaCloudAndSynced(!0),n._canEdit(!0))}))},n.prototype._initializeGlobalAdminEditableContractsPromises=function(){var n=this,t=this.context.container;nt.Permission.CheckPermission(nt.TargetObjectType.UserProfileRestrictedProperties,nt.ActionType.Update,t).then((function(t){t&&(n._adminEditableGdprContracts.forEach((function(n){return n.disabled(!1)})),n.showEditGdpr(!0),n._canEdit(!0),n.isGlobalAdmin(!0));n.authenticationManageContactInformationText(t?rt.authenticationAdminManageContactInformationText:rt.authenticationManageContactInformationText)}))},n.prototype._initializeUserAdminEditableContractsPromises=function(){var n=this,t=this.context.container;nt.Permission.CheckPermission(nt.TargetObjectType.UserProfileRestrictedProperties,nt.ActionType.Read,t).then((function(t){t&&n.isUserAdmin(!0)}))},n.prototype._initializeSelfPromises=function(n){var t=this,i=this.context.parameters;n.then((function(n){var r=n.data();t.isSelfMode(r.userId()===i.userId)}))},n.prototype._initializeUserEditableContractsPromises=function(n,t,i,r){var u=this,f=this.context.parameters,e=[n,r,t,i];Q.all(e).then((function(n){var i=n[1],r=i.data(),e=n[2],o=n[3],t=u._getUserDetailsEntity.item(),s=t.dirSyncEnabled&&t.dirSyncEnabled()?!0:!1;s||(e&&o||r.userId()===f.userId)&&(u._userEditableContracts.forEach((function(n){return n.disabled(!1)})),t.sourceText&&t.sourceText()!==rt.userSourceOnPrem&&(u._allowRemoveRemoveThumbnailUrl=!0,t.hasThumbnail()&&t.imageUrl()&&t.imageUrl().length!==0&&u.showRemoveThumbnailUrl(!0)),u._canEdit(!0))}))},n.prototype._getSignInEventsSummaryQueryViewPromise=function(){var n=this,t=this.context.parameters;this.signinChart.loading(!0);this._getSignInEventsSummaryEntityView.fetch({startDateTime:this._chartStartDateTime,endDateTime:this._chartEndDateTime,userId:u.observable(t.userId),appId:null}).then((function(){var r=n._getSignInEventsSummaryEntityView.item(),t;i.notNullOrUndefined(r)&&(t=new ht.Series,t.name(ut.userProfileMetricSignins),t.values(r.activityData().map((function(n){return new ht.ChartItem(n.dateTime(),n.activityCount())}))),n._chartSeries([t]))})).catch((function(t){var i=at.defaultError;if(!!t&&!!t.errorData&&!!t.errorData.responseJSON&&!!t.errorData.responseJSON.ClientData&&!!t.errorData.responseJSON.ClientData.errorCode)switch(t.errorData.responseJSON.ClientData.errorCode){case tt.ReportAPIErrorCodes.Authentication_RequestFromUnsupportedUserRole:i=at.roleError;break;case tt.ReportAPIErrorCodes.Authentication_RequestFromNonPremiumTenantOrB2CTenant:i=at.subscriptionError}n.chartStatus(i)})).finally((function(){n.signinChart.loading(!1)}))},n.prototype._groupMembershipsCountData=function(){var n=this,t=this.context.parameters;this.groupMembershipsData(w.dotdotdot);this._getGroupMemberhipsCountEntityView.fetch(t.userId).then((function(){var t=n._getGroupMemberhipsCountEntityView.item();t.valueRange()===k.itemCountRangeMoreThan999?n.groupMembershipsData(d.membershipsCount1000plus):n.groupMembershipsData(t.value().toString())})).catch((function(){n.groupMembershipsData(b.unknown)}))},n.prototype._initializeDeleteUserPromise=function(){var n=this,t=this.context.container;nt.Permission.CheckPermission(nt.TargetObjectType.User,nt.ActionType.Delete,t).then((function(t){n._canDelete(t)}))},n.prototype._initializeInProductFeedback=function(){g.setBannerFeedbackItem(this.context.container,p.BladeNames.userProfileV2Blade)},n.prototype._initializeQuery=function(){var i=this.context,n=i.container,t=i.model;this._getGroupMemberhipsCountEntityView=t.groupsContext.groupMembershipsCountEntity.createView(n);this._getSignInEventsSummaryEntityView=t.reportsDataContext.signInEventsSummaryQuery.createView(n);this._getUserDetailsEntity=t.userDetailsEntity.createView(n);this._getUserEntity=t.userEntity.createView(n)},n.prototype._initializeToolbar=function(){var t=this.context.container,n;n=new i.ViewModels.Toolbars.Toolbar(t);this._editButton=this._createEditButton();this._saveButton=this._createSaveButton();this._discardButton=this._createDiscardButton();this._resetPasswordButton=this._createResetPasswordButton();this._deleteUserButton=this._createDeleteUserButton();n.setItems([]);t.commandBar=n},n.prototype._createEditButton=function(){var n=this,t=this.context.form;return new i.ViewModels.Toolbars.CommandButton({type:4,label:u.observable(),icon:u.observable(),command:{canExecute:u.pureComputed((function(){return!t.dirty()&&n.isLoadComplete()&&!n._saveInProgress()&&n._canEdit()})),execute:this._editProfile.bind(this)}})},n.prototype._createSaveButton=function(){var r=this,t=this.context.form,n=new i.ViewModels.Toolbars.CommandButton;return n.label(b.save),n.icon(i.Base.Images.Save()),n.command={canExecute:u.pureComputed((function(){return t.dirty()&&t.validationState()!==1&&t.validationState()!==3&&!r._saveInProgress()})),execute:this._saveChanges.bind(this)},n},n.prototype._createDiscardButton=function(){var t=this,r=this.context.form,n=new i.ViewModels.Toolbars.DialogButton;return n.label(b.discard),n.icon(i.Base.Images.Discard()),n.dialogOptions=new i.ViewModels.Dialogs.MessageBox(b.discardChangesDialogTitle,b.discardChangesDialogConfirmationText,4),n.command={canExecute:u.pureComputed((function(){return r.dirty()&&!t._saveInProgress()})),execute:this._discardChanges.bind(this)},n},n.prototype._createResetPasswordButton=function(){var t=this,r=this.context,f=r.parameters,e=r.container,n=new i.ViewModels.Toolbars.OpenBladeButton2;return n.label(rt.userDetailsResetPasswordCommandTitle),n.icon(i.Base.Images.Key()),n.id="UserProfileResetPasswordButton",u.reactor(e,(function(){n.disabled(t._isDeleteExecuting()||!t.isLoadComplete())})),n.selectable=new h.Selectable2({supplyBladeReference:function(){return new y.UserDetailsResetPasswordBladeReference({userId:f.userId,autoGeneratePasswordForUser:!0})}}),n},n.prototype._createDeleteUserButton=function(){var n=this;return new i.ViewModels.Toolbars.DialogButton({type:5,label:b.delete,icon:i.Base.Images.Delete(),dialogOptions:new i.ViewModels.Dialogs.MessageBox(null,rt.userConfirmDeleteMessage,4),command:{canExecute:u.pureComputed((function(){return!n._isDeleteExecuting()&&n.isLoadComplete()&&n._canDelete()})),execute:this._deleteUser.bind(this)}})},n.prototype._initializeControls=function(){var t=this,h=this.context,l=h.model,n=h.container,r=new ot.FullFileUploadContext,y={accept:"image/*",maxFiles:1,autoAddUploadTasks:!0,uploadContext:r,allowedFileExtensions:ut.imageJPGorPNGFormat};r.type=0;r.contentType=3;r.maxFileSize=ft.validationConstants.thumbnailPhotoMaxSize;this.thumbnailUpload=s.create(n,y);this.thumbnailUpload.uploadTasks.subscribe(n,(function(n){t._handleUploadedFile(n)}));this._dirtyableContracts.push(this.thumbnailUpload);this._userEditableContracts.push(this.thumbnailUpload);this.displayNameTextbox=a.create(n,{validations:[new v.Required(rt.userNameValidationRequired),new v.MaxLength(ut.validationsMaxLengthFormElements.userDisplayName,rt.userPropertyMaxLengthExceeded.format(ut.validationsMaxLengthFormElements.userDisplayName))]});this._dirtyableContracts.push(this.displayNameTextbox);this._adminEditableContracts.push(this.displayNameTextbox);this.objectIdCopyable=e.create(n,{readOnly:!0});this.userNameTextbox=a.create(n,{validations:[new v.Required(rt.userUPNValidationRequired),new v.RegExMatch(ut.validationsRegExFormElements.userUPN,rt.userUPNValidationInvalidCharacters),new v.Custom(null,function(n){return Q.resolve(ft.validateUpnLength(n))}),new v.Custom(null,function(t){return Q(ft.validateFormUserUPNIsInAllowedDomain(t,l,null,n)).then((function(n){return Q.resolve(n)}))}),new v.Custom(null,function(i){return i===t._getUserDetailsEntity.item().userPrincipalName()?Q.resolve({message:null,valid:!0}):Q(ft.validateFormUserUPNIsUnique(i,l,null,n))})]});this._dirtyableContracts.push(this.userNameTextbox);this._adminEditableCloudOnlyContracts.push(this.userNameTextbox);this.givenNameTextbox=a.create(n,{validations:[new v.MaxLength(ut.validationsMaxLengthFormElements.givenName,rt.userPropertyMaxLengthExceeded.format(ut.validationsMaxLengthFormElements.givenName))]});this._dirtyableContracts.push(this.givenNameTextbox);this._adminEditableContracts.push(this.givenNameTextbox);this.surameTextbox=a.create(n,{validations:[new v.MaxLength(ut.validationsMaxLengthFormElements.surname,rt.userPropertyMaxLengthExceeded.format(ut.validationsMaxLengthFormElements.surname))]});this._dirtyableContracts.push(this.surameTextbox);this._adminEditableContracts.push(this.surameTextbox);this.invitationUrlDockedBalloon=new i.ViewModels.Controls.DockedBalloon.ViewModel(n);this.invitationUrlDockedBalloon.type=i.ViewModels.Controls.DockedBalloon.Type.Info;this.invitationUrlDockedBalloon.content(rt.userProfileCopyableInvitationUrlInfoBalloonContent);this.invitationUrlCopyable=e.create(n,{readOnly:!0});this.resendInvitationButton=f.create(n,{text:rt.userProfileResendInvitationButtonLabel,onClick:function(){t._reInviteUser()}});this.jobTitleTextbox=a.create(n,{validations:[new v.MaxLength(ut.validationsMaxLengthFormElements.jobTitle,rt.userPropertyMaxLengthExceeded.format(ut.validationsMaxLengthFormElements.jobTitle))]});this._dirtyableContracts.push(this.jobTitleTextbox);this._adminEditableContracts.push(this.jobTitleTextbox);this.departmentTextbox=a.create(n,{validations:[new v.MaxLength(ut.validationsMaxLengthFormElements.department,rt.userPropertyMaxLengthExceeded.format(ut.validationsMaxLengthFormElements.department))]});this._dirtyableContracts.push(this.departmentTextbox);this._adminEditableContracts.push(this.departmentTextbox);this.managerTextbox=a.create(n,{readonly:!0});this._dirtyableContracts.push(this.managerTextbox);this.blockSignInSwitchOptionsGroup=c.create(n,{items:[{text:rt.userProfileBlockSignInYes,value:!1},{text:rt.userProfileBlockSignInNo,value:!0}]});this._dirtyableContracts.push(this.blockSignInSwitchOptionsGroup);this._adminEditableCloudAndSyncedContracts.push(this.blockSignInSwitchOptionsGroup);this.usageLocationDropDown=o.create(n,{items:u.observableArray([])});this._dirtyableContracts.push(this.usageLocationDropDown);this._adminEditableCloudAndSyncedContracts.push(this.usageLocationDropDown);this.streetAddressTextbox=a.create(n,{validations:[new v.MaxLength(ut.validationsMaxLengthFormElements.streetAddress,rt.userPropertyMaxLengthExceeded.format(ut.validationsMaxLengthFormElements.streetAddress))]});this._dirtyableContracts.push(this.streetAddressTextbox);this._adminEditableContracts.push(this.streetAddressTextbox);this.stateTextbox=a.create(n,{validations:[new v.MaxLength(ut.validationsMaxLengthFormElements.state,rt.userPropertyMaxLengthExceeded.format(ut.validationsMaxLengthFormElements.state))]});this._dirtyableContracts.push(this.stateTextbox);this._adminEditableContracts.push(this.stateTextbox);this.countryTextbox=a.create(n,{validations:[new v.MaxLength(ut.validationsMaxLengthFormElements.country,rt.userPropertyMaxLengthExceeded.format(ut.validationsMaxLengthFormElements.country))]});this._dirtyableContracts.push(this.countryTextbox);this._adminEditableContracts.push(this.countryTextbox);this.officeTextbox=a.create(n,{validations:[new v.MaxLength(ut.validationsMaxLengthFormElements.office,rt.userPropertyMaxLengthExceeded.format(ut.validationsMaxLengthFormElements.office))]});this._dirtyableContracts.push(this.officeTextbox);this._adminEditableContracts.push(this.officeTextbox);this.cityTextbox=a.create(n,{validations:[new v.MaxLength(ut.validationsMaxLengthFormElements.city,rt.userPropertyMaxLengthExceeded.format(ut.validationsMaxLengthFormElements.city))]});this._dirtyableContracts.push(this.cityTextbox);this._adminEditableContracts.push(this.cityTextbox);this.zipTextbox=a.create(n,{validations:[new v.MaxLength(ut.validationsMaxLengthFormElements.zipCode,rt.userPropertyMaxLengthExceeded.format(ut.validationsMaxLengthFormElements.zipCode))]});this._dirtyableContracts.push(this.zipTextbox);this._adminEditableContracts.push(this.zipTextbox);this.officePhoneTextbox=a.create(n,{validations:[new v.RegExMatch(w.emptyStringRegexOr+ut.officePhoneRegex.source,rt.officePhoneInvalidFormat),new v.MaxLength(ut.validationsMaxLengthFormElements.officePhone,rt.userPropertyMaxLengthExceeded.format(ut.validationsMaxLengthFormElements.officePhone))]});this._dirtyableContracts.push(this.officePhoneTextbox);this._adminEditableContracts.push(this.officePhoneTextbox);this.mobilePhoneTextbox=a.create(n,{validations:[new v.RegExMatch(w.emptyStringRegexOr+ut.authenticationPhoneRegex.source,rt.authenticationPhoneInvalidFormat),new v.MaxLength(ut.validationsMaxLengthFormElements.authenticationPhone,rt.userPropertyMaxLengthExceeded.format(ut.validationsMaxLengthFormElements.authenticationPhone))]});this._dirtyableContracts.push(this.mobilePhoneTextbox);this._adminEditableContracts.push(this.mobilePhoneTextbox);this.authenticationPhoneTextbox=a.create(n,{validations:[new v.RegExMatch(w.emptyStringRegexOr+ut.authenticationPhoneRegex.source,rt.authenticationPhoneInvalidFormat),new v.MaxLength(ut.validationsMaxLengthFormElements.authenticationPhone,rt.userPropertyMaxLengthExceeded.format(ut.validationsMaxLengthFormElements.authenticationPhone))]});this._dirtyableContracts.push(this.authenticationPhoneTextbox);this._mfaAdminEditableCloudAndSyncedContracts.push(this.authenticationPhoneTextbox);this.authenticationEmailAddressTextbox=a.create(n,{validations:[new v.RegExMatch(w.emptyStringRegexOr+w.emailRegex.source,rt.userEmailInvalidFormat),new v.MaxLength(ut.validationsMaxLengthFormElements.email,rt.userPropertyMaxLengthExceeded.format(ut.validationsMaxLengthFormElements.email))]});this._dirtyableContracts.push(this.authenticationEmailAddressTextbox);this._mfaAdminEditableCloudAndSyncedContracts.push(this.authenticationEmailAddressTextbox);this.authenticationAlternatePhoneTextbox=a.create(n,{validations:[new v.RegExMatch(w.emptyStringRegexOr+ut.authenticationPhoneRegex.source,rt.authenticationPhoneInvalidFormat),new v.MaxLength(ut.validationsMaxLengthFormElements.authenticationPhone,rt.userPropertyMaxLengthExceeded.format(ut.validationsMaxLengthFormElements.authenticationPhone))]});this._dirtyableContracts.push(this.authenticationAlternatePhoneTextbox);this._mfaAdminEditableCloudAndSyncedContracts.push(this.authenticationAlternatePhoneTextbox);this.authenticationAlternateEmailAddressTextbox=a.create(n,{validations:[new v.RegExMatch(w.emptyStringRegexOr+w.emailRegex.source,rt.userEmailInvalidFormat),new v.MaxLength(ut.validationsMaxLengthFormElements.email,rt.userPropertyMaxLengthExceeded.format(ut.validationsMaxLengthFormElements.email))]});this._dirtyableContracts.push(this.authenticationAlternateEmailAddressTextbox);this._mfaAdminEditableCloudAndSyncedContracts.push(this.authenticationAlternateEmailAddressTextbox);this.ageGroupDropDown=o.create(n,{items:ct});this.ageGroupDropDown.dirty.subscribe(n,(function(n){n&&t.legalAgeGroupClassificationData(rt.userProfileRecalculateLegalAgeGroupClassificationDataMessage)}));this._dirtyableContracts.push(this.ageGroupDropDown);this._adminEditableGdprContracts.push(this.ageGroupDropDown);this.consentProvidedForMinorDropDown=o.create(n,{items:lt});this.consentProvidedForMinorDropDown.dirty.subscribe(n,(function(n){n&&t.legalAgeGroupClassificationData(rt.userProfileRecalculateLegalAgeGroupClassificationDataMessage)}));this._dirtyableContracts.push(this.consentProvidedForMinorDropDown);this._adminEditableGdprContracts.push(this.consentProvidedForMinorDropDown);this._adminEditableContracts.forEach((function(n){return n.disabled(!0)}));this.showChangeManager(!1);this._adminEditableCloudOnlyContracts.forEach((function(n){return n.disabled(!0)}));this._adminEditableCloudAndSyncedContracts.forEach((function(n){return n.disabled(!0)}));this._adminEditableGdprContracts.forEach((function(n){return n.disabled(!0)}));this._mfaAdminEditableCloudAndSyncedContracts.forEach((function(n){return n.disabled(!0)}));this._userEditableContracts.forEach((function(n){return n.disabled(!0)}))},n.prototype._initializeMode=function(n){var t=this,r=this.context.container;this.viewEditMode.subscribe(r,(function(n){n===st.view&&(t._editButton.label(b.edit),t._editButton.icon(i.Base.Images.Edit()),r.commandBar.setItems([t._editButton,t._resetPasswordButton,t._deleteUserButton]));n===st.edit&&(t._editButton.label(b.view),t._editButton.icon(i.Base.Images.Properties()),t._resetEdit(),r.commandBar.setItems([t._editButton,t._saveButton,t._discardButton]))}));this.viewEditMode(n)},n.prototype._editProfile=function(){var n=this.viewEditMode();return this.viewEditMode(n===st.edit?st.view:st.edit),Q()},n.prototype._deleteUser=function(n){var s=this,f=this.context,r=f.parameters,h=f.container,e=f.model,o;if(n===6){var c=this._getUserDetailsEntity.item(),u={displayName:c.displayName()},t=new i.Hubs.Notifications.ClientNotification({title:rt.deleteUserNotificationProgressDescription.format(u),description:rt.deleteUserNotificationProgressDescription.format(u),status:i.Hubs.Notifications.NotificationStatus.InProgress});return t.publish(),this._isDeleteExecuting(!0),o=Q(e.DeleteUser(r.userId)),o.then((function(){t.title=rt.deleteUserNotificationSuccessLabel;t.description=rt.deleteUserNotificationSuccessDescription.format(u);t.status=i.Hubs.Notifications.NotificationStatus.Success;e.userDeletedNotifier.notifySubscribers(r.userId);e.crossAreaNotifiers.userDeletedNotifier.notifySubscribers(r.userId);i.UI.AssetManager.notifyAssetDeleted(p.AssetTypes.UserPinned.name,r.userId);h.closeCurrentBlade()})).catch((function(){t.title=rt.deleteUserNotificationErrorLabel;t.description=rt.deleteUserNotificationErrorDescription.format(u);t.status=i.Hubs.Notifications.NotificationStatus.Error})).finally((function(){t.publish();s._isDeleteExecuting(!1)})),o}return Q()},n.prototype._saveChanges=function(){var u=this,s=this.context.model,o;if(this._saveInProgress())return Q();this._saveInProgress(!0);var f=this._getUserDetailsEntity.item(),n={},c={},e={},l={},h={displayName:f.displayName()},t=new i.Hubs.Notifications.ClientNotification({title:rt.saveUserProfileNotificationProgressDescription.format(h),description:rt.saveUserProfileNotificationProgressDescription.format(h),status:i.Hubs.Notifications.NotificationStatus.InProgress}),a=!1;t.publish();this.thumbnailUpload.dirty()&&(c[yt.isThumbnailUpdated]=!0,c[yt.imageDataToUpload]=this._imageDataToUpload);this.displayNameTextbox.dirty()&&(n[et.UserProfilePartFormDataFields.displayName]=this.displayNameTextbox.value());this.userNameTextbox.dirty()&&(f.userFlags()&ut.userFlags.editableUpn)!=0&&(n[et.UserProfilePartFormDataFields.userPrincipalName]=this.userNameTextbox.value());this.givenNameTextbox.dirty()&&(n[et.UserProfilePartFormDataFields.givenName]=this.givenNameTextbox.value());this.surameTextbox.dirty()&&(n[et.UserProfilePartFormDataFields.surname]=this.surameTextbox.value());this.jobTitleTextbox.dirty()&&(n[et.UserWorkInfoPartFormDataFields.jobTitle]=this.jobTitleTextbox.value());this.departmentTextbox.dirty()&&(n[et.UserWorkInfoPartFormDataFields.department]=this.departmentTextbox.value());this.managerTextbox.dirty()&&(l[et.UserWorkInfoPartFormDataFields.manager]=this._managerData().managerId);this.blockSignInSwitchOptionsGroup.dirty()&&(n[et.UserProfilePartFormDataFields.accountEnabled]=this.blockSignInSwitchOptionsGroup.value());this.usageLocationDropDown.dirty()&&(n[et.UserProfilePartFormDataFields.usageLocation]=this.usageLocationDropDown.value());this.streetAddressTextbox.dirty()&&(n[et.UserWorkInfoPartFormDataFields.streetAddress]=this.streetAddressTextbox.value());this.stateTextbox.dirty()&&(n[et.UserWorkInfoPartFormDataFields.state]=this.stateTextbox.value());this.countryTextbox.dirty()&&(n[et.UserWorkInfoPartFormDataFields.country]=this.countryTextbox.value());this.officeTextbox.dirty()&&(n[et.UserWorkInfoPartFormDataFields.physicalDeliveryOfficeName]=this.officeTextbox.value());this.cityTextbox.dirty()&&(n[et.UserWorkInfoPartFormDataFields.city]=this.cityTextbox.value());this.zipTextbox.dirty()&&(n[et.UserWorkInfoPartFormDataFields.postalCode]=this.zipTextbox.value());this.officePhoneTextbox.dirty()&&(n[et.UserWorkInfoPartFormDataFields.officePhone]=this.officePhoneTextbox.value());this.mobilePhoneTextbox.dirty()&&(n[et.UserWorkInfoPartFormDataFields.mobilePhone]=this.mobilePhoneTextbox.value());(this.authenticationPhoneTextbox.dirty()||this.authenticationEmailAddressTextbox.dirty()||this.authenticationAlternatePhoneTextbox.dirty())&&(e[et.UserProfilePartFormDataFields.authenticationPhoneNumber]=this.authenticationPhoneTextbox.value(),e[et.UserProfilePartFormDataFields.authenticationEmail]=this.authenticationEmailAddressTextbox.value(),e[et.UserProfilePartFormDataFields.authenticationAlternativePhoneNumber]=this.authenticationAlternatePhoneTextbox.value(),e[yt.isAuthenticationContactInfoUpdated]=!0);this.authenticationAlternateEmailAddressTextbox.dirty()&&(n[et.UserProfilePartFormInferredDataFields.otherMails]=[this.authenticationAlternateEmailAddressTextbox.value()]);this.ageGroupDropDown.dirty()&&(n[et.UserProfilePartFormDataFields.ageGroup]=this.ageGroupDropDown.value());this.consentProvidedForMinorDropDown.dirty()&&(n[et.UserProfilePartFormDataFields.consentProvidedForMinor]=this.consentProvidedForMinorDropDown.value());o=[];o.push(r.keys(n).length?s.userProfileUpdateProperties(f.objectId(),n):null);o.push(r.keys(c).length?s.userProfileUpdateImageProperties(f.objectId(),c):null);o.push(r.keys(e).length?s.userProfileUpdateMfaProperties(f.objectId(),e):null);o.push(r.keys(l).length?s.userProfileUpdateManagerProperties(f.objectId(),l):null);Q.allSettled(o).then((function(n){var r=0,f=0,e="";pt.forEach((function(t){var u=n[t.arrayPosition];u.state==="fulfilled"?i.isNull(u.value)||(f=f+1):(e+=r!==0?", ":"",e+=t.errorMessage,r=r+1)}));r===0?(t.title=rt.saveUserProfileNotificationSuccessLabel,t.description=rt.saveUserProfileNotificationSuccessDescription.format(h),t.status=i.Hubs.Notifications.NotificationStatus.Success,a=!0,u._clearDirty()):(t.status=i.Hubs.Notifications.NotificationStatus.Error,f===0?(t.title=rt.saveUserProfileNotificationErrorLabel,t.description=rt.saveUserProfileNotificationErrorDescription.format(h)):(t.title=rt.saveUserProfileNotificationPartialErrorLabel,t.description=rt.saveUserProfileNotificationPartialErrorDescription.format(h.displayName,e)))})).finally((function(){u._getUserDetailsEntity.refresh().then((function(){s.updateUserCaches(u._getUserDetailsEntity.item());a&&(u._getManagerData(),u._initializeImageData(),u._displayUser())})).finally((function(){u._saveInProgress(!1)}));t.publish()}))},n.prototype._discardChanges=function(n){return n===6?(this._resetEdit(),this._getManagerData(),this._initializeImageData(),this._clearDirty(),Q()):Q()},n.prototype._resetEdit=function(){var n=this._getUserDetailsEntity.item(),t;this.displayNameTextbox.value(n.displayName());this.userNameTextbox.value(n.displayUserPrincipalName());this.givenNameTextbox.value(n.givenName());this.surameTextbox.value(n.surname());this.jobTitleTextbox.value(n.jobTitle());this.departmentTextbox.value(n.department());this.blockSignInSwitchOptionsGroup.value(n.accountEnabled());this.usageLocationDropDown.value(n.usageLocation());this.streetAddressTextbox.value(n.streetAddress());this.stateTextbox.value(n.state());this.countryTextbox.value(n.country());this.officeTextbox.value(n.physicalDeliveryOfficeName());this.cityTextbox.value(n.city());this.zipTextbox.value(n.postalCode());this.officePhoneTextbox.value(n.telephoneNumber());this.mobilePhoneTextbox.value(n.mobile());this.authenticationPhoneTextbox.value(n.authenticationPhoneNumber());this.authenticationEmailAddressTextbox.value(n.authenticationEmail());this.authenticationAlternatePhoneTextbox.value(n.authenticationAlternativePhoneNumber());this.authenticationAlternateEmailAddressTextbox.value(n.alternateEmailAddress());t=i.findIndex(ct,(function(t){return t.value===n.ageGroup()?!0:!1}));this.ageGroupDropDown.value(ct[t>=0?t:0].value);t=i.findIndex(lt,(function(t){return t.value===n.consentProvidedForMinor()?!0:!1}));this.consentProvidedForMinorDropDown.value(lt[t>=0?t:0].value);this.legalAgeGroupClassificationData(this._getLegalAgeGroupLoacalizeText(n.legalAgeGroupClassification()))},n.prototype._clearDirty=function(){this._dirtyableContracts.forEach((function(n){return n.dirty(!1)}))},n.prototype._displayUser=function(){var n=this._getUserDetailsEntity.item(),r=n.displayName(),t;this.title(r);this.displayNameData(r);this.objectIdCopyable.value(n.objectId());this.userTypeData(n.userType());this.userNameData(n.displayUserPrincipalName());this.sourceData(n.sourceText());this.givenNameData(n.givenName());this.surameData(n.surname());this.jobTitleData(n.jobTitle());this.departmentData(n.department());this.blockSignInSwitchData(n.accountEnabled()?rt.userProfileBlockSignInNo:rt.userProfileBlockSignInYes);this._displayUsageLocationData();this.streetAddressData(n.streetAddress());this.stateData(n.state());this.countryData(n.country());this.officeData(n.physicalDeliveryOfficeName());this.cityData(n.city());this.zipData(n.postalCode());this.officePhoneData(n.telephoneNumber());this.mobilePhoneData(n.mobile());this.authenticationPhoneData(n.authenticationPhoneNumber());this.authenticationEmailAddressData(n.authenticationEmail());this.authenticationAlternatePhoneData(n.authenticationAlternativePhoneNumber());this.authenticationAlternateEmailAddressData(n.alternateEmailAddress());t=i.findIndex(ct,(function(t){return t.value===n.ageGroup()?!0:!1}));this.ageGroupData(ct[t>=0?t:0].text);t=i.findIndex(lt,(function(t){return t.value===n.consentProvidedForMinor()?!0:!1}));this.consentProvidedForMinorData(lt[t>=0?t:0].text);this.legalAgeGroupClassificationData(this._getLegalAgeGroupLoacalizeText(n.legalAgeGroupClassification()));this._userEmptyPropertyViewValues.forEach((function(n){i.isNullOrWhiteSpace(n())&&n(ut.userProfileEmptyPropertyValue)}))},n.prototype._initializeImageData=function(){var n=this._getUserDetailsEntity.item(),t=n.imageUrl();this._defaultThumbnailUrl=n.defaultImageUrl();this.thumbnailUrl(t);this._imageDataToUpload=null;this.showRemoveThumbnailUrl(this._allowRemoveRemoveThumbnailUrl&&n.hasThumbnail()&&t&&t.length!==0)},n.prototype._displayUsageLocationData=function(){var u=this._getUserDetailsEntity.item(),t,n,r;i.notNullOrUndefined(u)&&(t=u.usageLocation(),i.notNullOrUndefined(t)&&(n=this.usageLocationDropDown.items(),i.notNullOrUndefined(n)&&(r=i.findIndex(n,(function(n){return n.value===t?!0:!1})),r>=0&&this.usageLocationData(n[r].text))))},n.prototype._handleUploadedFile=function(n){var t=this;n.forEach((function(n){n.uploadInfo.status()===1&&n.resume().then((function(){n.getNextChunk().then((function(i){t.thumbnailUrl(i.content);t._imageDataToUpload=i.content;t._allowRemoveRemoveThumbnailUrl&&t.showRemoveThumbnailUrl(!0);t.thumbnailUpload.value(null);t.thumbnailUpload.dirty(!0);n.complete()}))}),(function(){}))}))},n.prototype._initializeResendInvitationData=function(){var r=this,u=this.context.container,n=this._getUserDetailsEntity.item(),i=n.userType&&n.userType()===ut.userTypes.guest&&n.sourceText?!0:!1,t=!1;i&&(t=n.sourceText()===rt.userSourceInvitedUser?!0:!1,this.invitationAcceptedData(t?b.no:b.yes));this.isGuestUser(i);this.isInvitedGuestUser(t);this.invitationUrlVisible(!1);this.invitationUrlCopyable.value.subscribe(u,(function(){r.invitationUrlVisible(!0)}))},n.prototype._reInviteUser=function(){var n=this.context,t=n.container,i=n.model,r=new it.UserCreationService(t,i),u=this._getUserDetailsEntity.item();r.ReInviteUser2(u,this.invitationUrlCopyable)},n.prototype._initializeManagerId=function(){var n=this,t=this.context.container;this._managerData.subscribe(t,(function(t){i.notNullOrUndefined(t.managerDisplayName)?n.managerData(t.managerDisplayName):i.notNullOrUndefined(t.managerId)?n.managerData(t.managerId):n.managerData("");n.managerTextbox.value(n.managerData())}))},n.prototype._getManagerData=function(){var t=this,n=this._getUserDetailsEntity.item().manager();i.notNullOrUndefined(n)&&n.length>0?(this.managerData(w.dotdotdot),this._getUserEntity.fetch({userId:n}).then((function(){var i=t._getUserEntity.item();t._managerData({managerId:n,managerDisplayName:i.displayName()})})).catch((function(){t._managerData({managerId:n,managerDisplayName:null})}))):this._managerData({managerId:null,managerDisplayName:null})},n.prototype._initializeChart=function(){var e=this.context.container,o=Date.now(),n=new Date(o),t=new Date(n.getFullYear(),n.getMonth(),n.getDate(),0,0,0),s=new i.ViewModels.Controls.Visualization.Chart.MetricRuleMetric({aggregationScope:1,aggregationType:1,unit:"",showBarColor:!0}),h=new ht.MetricRule({scope:0,metrics:u.observableArray([s])}),r=new i.ViewModels.Controls.Visualization.Chart.LineChartSeriesView,f=new i.ViewModels.Controls.Visualization.Chart.LineChartView;t.setDate(t.getDate()-ut.userProfileDaysOfChart);this._chartStartDateTime=u.observable(t);this._chartEndDateTime=u.observable(n);this._chartSeries=u.observableArray([]);this.signinChart=new ht.ViewModel(e);this.signinChart.series=this._chartSeries;r.seriesName(ut.userProfileMetricSignins);f.seriesView([r]);this.signinChart.views([f]);this.signinChart.xAxis.scale(2);this.signinChart.xAxis.showGridLines(!1);this.signinChart.xAxis.min=this._chartStartDateTime;this.signinChart.xAxis.max=this._chartEndDateTime;this.signinChart.xAxis.position(3);this.signinChart.yAxis.scale(1);this.signinChart.yAxis.showGridLines(!1);this.signinChart.yAxis.autoScaleUnit(!0);this.signinChart.yAxis.position(4);this.signinChart.legendPosition(0);this.signinChart.interactionBehavior(ht.InteractionBehavior.XSlider_Off);this.signinChart.metricsRules([h]);this.signinChart.metrics.visible(!1)},n.prototype._getLegalAgeGroupLoacalizeText=function(n){switch(n){case ut.legalAgeGroupClassification.minorWithoutParentalConsent:return rt.legalAgeGroupMinorWithoutParent;case ut.legalAgeGroupClassification.minorWithParentalConsent:return rt.legalAgeGroupMinorWithParent;case ut.legalAgeGroupClassification.adult:return rt.legalAgeGroupAdult;case ut.legalAgeGroupClassification.notAdult:return rt.legalAgeGroupNotAdult;case ut.legalAgeGroupClassification.minorNoParentalConsentRequired:return rt.legalAgeGroupMinorNoParent;default:return rt.legalAgeGroupUndefined}},n})();vt=__decorate([l.Decorator({htmlTemplate:"../../Templates/UserProfileV2.html",styleSheets:["../../Styles/UserProfileStyles.css"],isPinnable:!1})],vt);t.UserProfileV2Blade=vt}));
define("_generated/adapters/blade/UserProfileV2BladeAdapter",["require","exports","o","Fx/Composition/ViewModelAdapters","Users/ViewModels/UserProfile/UserProfileV2"],(function(n,t,i,r,u){"use strict";i.defineProperty(t,"__esModule",{value:!0});var f=(function(n){function t(t,i,r){return n.call(this,t,i,r,u.UserProfileV2Blade)||this}return __extends(t,n),t})(r.ViewModelAdapter);t.UserProfileV2BladeAdapter=f}));
define("_generated/Blades/UserProfileStyles.css",["require","exports"],(function(){"use strict";return".ext-userprofile-flexcolumn{display:flex;flex-direction:column}.ext-userprofile-flexrow{display:flex;flex-direction:row}.ext-userprofile-section-loading{height:16px;width:16px}.ext-userprofile-header-displayName{font-size:30px;margin-bottom:4px}.ext-userprofile-header-userName{font-size:15px;font-weight:bolder;margin-bottom:14px}.ext-userprofile-section-line{background-color:#cecece;height:1px;margin-bottom:15px;margin-top:15px}.ext-userprofile-section-header{font-size:15px;font-weight:bolder;margin-bottom:12px}.ext-userprofile-section-header-edit-filler{width:10px}.ext-userprofile-section-header-edit{font-weight:normal}.ext-userprofile-section-column-filler{width:20px;flex-shrink:0}.ext-userprofile-section-column-edit{margin-right:20px}.ext-userprofile-section-column{width:25%}.ext-userprofile-section-column-header{font-size:11px;height:14px;margin-bottom:4px}.ext-userprofile-textdata{height:23px}.ext-userprofile-authnoaccess{padding:10px;width:fit-content}.ext-userprofile-column-jobinfo-manager-header{justify-content:space-between}.ext-userprofile-thumbnail{height:90px;width:90px}.ext-userprofile-button{display:inherit}.ext-userprofile-balloon{height:14px}div.ext-userprofile-balloon span{vertical-align:top}.ext-userprofile-chart-chart{height:125px}.ext-userprofile-chart-error-line{background-color:#cecece;height:1px}.ext-userprofile-chart-error-data{align-items:center;display:flex;flex-direction:column;height:123px;justify-content:center}"}));
define("_generated/Blades/UserProfileV2Blade",["require","exports","_generated/Blades/UsersAreaStyles.css","_generated/Blades/UserProvisioning.css","_generated/Blades/UserProfileStyles.css","_generated/Blades/Upsell.css","_generated/Blades/SupportRequestProblemDetailsAreaStyles.css","_generated/Blades/SpotlightStyles.css","_generated/Blades/SingleSignOn.css","_generated/Blades/SharedAreaStyles.css","_generated/Blades/Settings.css","_generated/Blades/SelectorAndGridStyles.css","_generated/Blades/PoliciesAreaStyles.css","_generated/Blades/PasswordResetAreaStyles.css","_generated/Blades/NotificationsAreaStyles.css","_generated/Blades/MultifactorAuthentication.css","_generated/Blades/MdmApps.css","_generated/Blades/ManagedApps.css","_generated/Blades/LoginTenantBranding.css","_generated/Blades/Licenses.css","_generated/Blades/GroupsAreaStyles.css","_generated/Blades/EnterpriseApps.css","_generated/Blades/Domains.css","_generated/Blades/DirectoriesAreaStyles.css","_generated/Blades/DevicesAreaStyles.css","_generated/Blades/CustomAppAddButtonParts.css","_generated/Blades/ClassicPolicies.css","_generated/Blades/AppList.css","_generated/Blades/ApplicationsStyles.css","_generated/Blades/ApplicationProxy.css","_generated/adapters/blade/UserProfileV2BladeAdapter"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st){"use strict";var ht;return (function(n){n.blade={name:"UserProfileV2Blade",inputs:["userId"],viewModelName:"Users$UserProfileV2BladeAdapter",lenses:[],pinnable:!1,initialDisplayState:2,style:8,toolbar:{source:{valuesFrom:[{referenceType:0,property:"content.commandBar"}]}},templateBlade:{htmlTemplate:null,partSize:9,htmlTemplateInline:{file:"UserProfileV2.html",content:'<div class="msportalfx-padding"> <div class="ext-userprofile-flexcolumn"> <div class="ext-userprofile-header-displayName msportalfx-text-ellipsis"><span data-bind="text:displayNameData"><\/span><span>&nbsp;<\/span><\/div> <div class="ext-userprofile-header-userName"><span data-bind="text:userNameData"><\/span><span>&nbsp;<\/span><\/div> <div class="ext-userprofile-flexrow"> <div class="ext-userprofile-flexrow ext-userprofile-section-column"> <div class="ext-userprofile-flexcolumn"> <div><img data-bind="attr: { src: thumbnailUrl }" class=\'ext-thumbnailborder-user ext-userprofile-thumbnail\'/><\/div> <div class="ext-userprofile-section-column-header"> <!-- ko if: viewEditMode() === 0 --> &nbsp; <!-- /ko --> <!-- ko if: viewEditMode() === 1 --> <!-- ko if: !showRemoveThumbnailUrl() --> &nbsp; <!-- /ko --> <!-- ko if: showRemoveThumbnailUrl() --> <a data-bind="text:removeText, fxclick:removeThumbnailUrlClick"><\/a> <!-- /ko --> <!-- /ko --> <\/div> <!-- ko if: viewEditMode() === 0 --> <div class="ext-userprofile-textdata">&nbsp;<\/div> <div class="ext-userprofile-section-column-header">&nbsp;<\/div> <!-- /ko --> <!-- ko if: viewEditMode() === 1 --> <div data-bind=\'pcControl:thumbnailUpload\'><\/div> <div class="ext-userprofile-section-column-header msportalfx-text-muted-50" data-bind="text:thumbnailUploadInfoText"><\/div> <!-- /ko --> <\/div> <div class="ext-userprofile-section-column-filler"><\/div> <\/div> <div class="ext-userprofile-flexcolumn ext-userprofile-section-column"> <div class="ext-userprofile-section-column-header msportalfx-text-ellipsis msportalfx-text-muted-50" data-bind="text:signinChartText"><\/div> <div class="ext-userprofile-flexrow"> <!-- ko if: chartStatus() === 0 --> <div class="ext-userprofile-chart-chart" data-bind="pcControl: signinChart, fxclick:onChartClick"><\/div> <!-- /ko --> <!-- ko if: chartStatus() !== 0 --> <div class="ext-userprofile-flexcolumn"> <div class="ext-userprofile-chart-error-line"><\/div> <div class="ext-userprofile-chart-error-data"> <!-- ko if: chartStatus() === 1 --> <div data-bind="text:chartErrorDefaultLine"><\/div> <!-- /ko --> <!-- ko if: chartStatus() === 2 --> <div> <span data-bind="text:chartErrorRoleLine"><\/span>&nbsp; <a href="https://docs.microsoft.com/azure/active-directory/active-directory-assign-admin-roles-azure-portal" target="_blank"><span data-bind="text:chartRoleMoreInfo"><\/span><\/a> <\/div> <!-- /ko --> <!-- ko if: chartStatus() === 3 --> <div data-bind="text:chartErrorSubscriptionLine"><\/div> <div><a data-bind="text:chartErrorSubscriptionLineFreeTrial, fxclick:onChartTryBuyProduct"><\/a><\/div> <!-- /ko --> <\/div> <div class="ext-userprofile-chart-error-line"><\/div> <\/div> <!-- /ko --> <div class="ext-userprofile-section-column-filler"><\/div> <\/div> <\/div> <div class="ext-userprofile-flexcolumn ext-userprofile-section-column"> <div class="ext-userprofile-section-column-header msportalfx-text-ellipsis msportalfx-text-muted-50" data-bind="text:groupMembershipsText"><\/div> <div class="ext-userprofile-textdata"> <a data-bind="text:groupMembershipsData, fxclick:groupMembershipsClick"><\/a> <\/div> <\/div> <div class="ext-userprofile-flexcolumn ext-userprofile-section-column"><\/div> <\/div> <div class="ext-userprofile-section-line"><\/div> <div class="ext-userprofile-section-header ext-userprofile-flexrow"> <div data-bind="text:identityText"><\/div> <!-- ko if: viewEditMode() === 0 --> <!-- ko if: showEdit() && isLoadComplete() --> <div class="ext-userprofile-section-header-edit-filler"><\/div> <div class="ext-userprofile-section-header-edit"><a data-bind="text:editText, fxclick:editTextClick"><\/a><\/div> <!-- /ko --> <!-- /ko --> <\/div> <div class="ext-userprofile-flexrow"> <div class="ext-userprofile-flexcolumn ext-userprofile-section-column"> <div class="ext-userprofile-section-column-header msportalfx-text-ellipsis msportalfx-text-muted-50" data-bind="text:displayNameText"><\/div> <!-- ko if: viewEditMode() === 0 --> <div class="ext-userprofile-flexrow"> <div data-bind="text:displayNameData" class="ext-userprofile-textdata msportalfx-text-ellipsis"><\/div> <div class="ext-userprofile-section-column-filler"><\/div> <\/div> <!-- /ko --> <!-- ko if: viewEditMode() === 1 --> <div class="ext-userprofile-section-column-edit" data-bind="pcControl: displayNameTextbox"><\/div> <!-- /ko --> <\/div> <div class="ext-userprofile-flexcolumn ext-userprofile-section-column"> <div class="ext-userprofile-section-column-header msportalfx-text-ellipsis msportalfx-text-muted-50" data-bind="text:givenNameText"><\/div> <!-- ko if: viewEditMode() === 0 --> <div class="ext-userprofile-flexrow"> <div data-bind="text:givenNameData" class="ext-userprofile-textdata msportalfx-text-ellipsis"><\/div> <div class="ext-userprofile-section-column-filler"><\/div> <\/div> <!-- /ko --> <!-- ko if: viewEditMode() === 1 --> <div class="ext-userprofile-section-column-edit" data-bind="pcControl: givenNameTextbox"><\/div> <!-- /ko --> <\/div> <div class="ext-userprofile-flexcolumn ext-userprofile-section-column"> <div class="ext-userprofile-section-column-header msportalfx-text-ellipsis msportalfx-text-muted-50" data-bind="text:surameText"><\/div> <!-- ko if: viewEditMode() === 0 --> <div class="ext-userprofile-flexrow"> <div data-bind="text:surameData" class="ext-userprofile-textdata msportalfx-text-ellipsis"><\/div> <div class="ext-userprofile-section-column-filler"><\/div> <\/div> <!-- /ko --> <!-- ko if: viewEditMode() === 1 --> <div class="ext-userprofile-section-column-edit" data-bind="pcControl: surameTextbox"><\/div> <!-- /ko --> <\/div> <div class="ext-userprofile-flexcolumn ext-userprofile-section-column"><\/div> <\/div> <div class="ext-userprofile-flexrow"> <div class="ext-userprofile-flexcolumn ext-userprofile-section-column"> <div class="ext-userprofile-section-column-header msportalfx-text-ellipsis msportalfx-text-muted-50" data-bind="text:userNameText"><\/div> <!-- ko if: viewEditMode() === 0 --> <div class="ext-userprofile-flexrow"> <div data-bind="text:userNameData" class="ext-userprofile-textdata msportalfx-text-ellipsis"><\/div> <div class="ext-userprofile-section-column-filler"><\/div> <\/div> <!-- /ko --> <!-- ko if: viewEditMode() === 1 --> <div class="ext-userprofile-section-column-edit" data-bind="pcControl: userNameTextbox"><\/div> <!-- /ko --> <\/div> <div class="ext-userprofile-flexcolumn ext-userprofile-section-column"> <div class="ext-userprofile-section-column-header msportalfx-text-ellipsis msportalfx-text-muted-50" data-bind="text:userTypeText"><\/div> <div data-bind="text:userTypeData" class="ext-userprofile-textdata msportalfx-text-ellipsis"><\/div> <\/div> <div class="ext-userprofile-flexcolumn ext-userprofile-section-column"> <!-- ko if: isGuestUser() --> <div class="ext-userprofile-section-column-header msportalfx-text-ellipsis msportalfx-text-muted-50" data-bind="text:invitationAcceptedText"><\/div> <div data-bind="text:invitationAcceptedData" class="ext-userprofile-textdata msportalfx-text-ellipsis"><\/div> <!-- /ko --> <\/div> <div class="ext-userprofile-flexcolumn ext-userprofile-section-column"><\/div> <\/div> <div class="ext-userprofile-flexrow"> <div class="ext-userprofile-flexcolumn ext-userprofile-section-column"> <div class="ext-userprofile-section-column-header msportalfx-text-ellipsis msportalfx-text-muted-50" data-bind="text:objectIdText"><\/div> <div class="ext-userprofile-section-column-edit" data-bind="pcControl: objectIdCopyable"><\/div> <\/div> <div class="ext-userprofile-flexcolumn ext-userprofile-section-column"> <div class="ext-userprofile-section-column-header msportalfx-text-ellipsis msportalfx-text-muted-50" data-bind="text:sourceText"><\/div> <div class="ext-userprofile-flexrow"> <div data-bind="text:sourceData" class="ext-userprofile-textdata msportalfx-text-ellipsis"><\/div> <div class="ext-userprofile-section-column-filler"><\/div> <\/div> <\/div> <div class="ext-userprofile-flexcolumn ext-userprofile-section-column"> <!-- ko if: isInvitedGuestUser() --> <!-- ko if: invitationUrlVisible() --> <div class="ext-userprofile-flexrow"> <div class="ext-userprofile-section-column-header msportalfx-text-muted-50" data-bind="text:invitationUrlIdText"><\/div> <div class="ext-userprofile-balloon" data-bind="pcControl: invitationUrlDockedBalloon"><\/div> <\/div> <div class="ext-userprofile-section-column-edit" data-bind="pcControl: invitationUrlCopyable"><\/div> <!-- /ko --> <div class="ext-userprofile-section-column-header msportalfx-text-muted-50">&nbsp;<\/div> <div data-bind="pcControl: resendInvitationButton" class="ext-userprofile-button"><\/div> <!-- /ko --> <\/div> <div class="ext-userprofile-flexcolumn ext-userprofile-section-column"><\/div> <\/div> <div class="ext-userprofile-section-line"><\/div> <div class="ext-userprofile-section-header ext-userprofile-flexrow"> <div data-bind="text:jobInfoText"><\/div> <!-- ko if: viewEditMode() === 0 --> <!-- ko if: showEdit() && isLoadComplete() --> <div class="ext-userprofile-section-header-edit-filler"><\/div> <div class="ext-userprofile-section-header-edit"><a data-bind="text:editText, fxclick:editTextClick"><\/a><\/div> <!-- /ko --> <!-- /ko --> <\/div> <div class="ext-userprofile-flexrow"> <div class="ext-userprofile-flexcolumn ext-userprofile-section-column"> <div class="ext-userprofile-section-column-header msportalfx-text-ellipsis msportalfx-text-muted-50" data-bind="text:jobTitleText"><\/div> <!-- ko if: viewEditMode() === 0 --> <div class="ext-userprofile-flexrow"> <div data-bind="text:jobTitleData" class="ext-userprofile-textdata msportalfx-text-ellipsis"><\/div> <div class="ext-userprofile-section-column-filler"><\/div> <\/div> <!-- /ko --> <!-- ko if: viewEditMode() === 1 --> <div class="ext-userprofile-section-column-edit" data-bind="pcControl: jobTitleTextbox"><\/div> <!-- /ko --> <\/div> <div class="ext-userprofile-flexcolumn ext-userprofile-section-column"> <div class="ext-userprofile-section-column-header msportalfx-text-ellipsis msportalfx-text-muted-50" data-bind="text:departmentText"><\/div> <!-- ko if: viewEditMode() === 0 --> <div class="ext-userprofile-flexrow"> <div data-bind="text:departmentData" class="ext-userprofile-textdata msportalfx-text-ellipsis"><\/div> <div class="ext-userprofile-section-column-filler"><\/div> <\/div> <!-- /ko --> <!-- ko if: viewEditMode() === 1 --> <div class="ext-userprofile-section-column-edit" data-bind="pcControl: departmentTextbox"><\/div> <!-- /ko --> <\/div> <div class="ext-userprofile-flexcolumn ext-userprofile-section-column"> <div class="ext-userprofile-flexrow ext-userprofile-column-jobinfo-manager-header"> <div class="ext-userprofile-section-column-header msportalfx-text-muted-50" data-bind="text:managerText"><\/div> <!-- ko if: viewEditMode() === 1 --> <!-- ko if: showChangeManager() --> <div class="ext-userprofile-flexrow"> <div class="ext-userprofile-section-column-header"> <a data-bind="text:removeText, fxclick:removeManagerClick"><\/a> &nbsp; <a data-bind="text:changeManagerText, fxclick:changeManagerClick"><\/a> <\/div> <div class="ext-userprofile-section-column-filler"><\/div> <\/div> <!-- /ko --> <!-- /ko --> <\/div> <!-- ko if: viewEditMode() === 0 --> <div class="ext-userprofile-textdata msportalfx-text-ellipsis"><a data-bind="text:managerData, fxclick:managerDataClick"><\/a><\/div> <!-- /ko --> <!-- ko if: viewEditMode() === 1 --> <div class="ext-userprofile-section-column-edit" data-bind="pcControl: managerTextbox"><\/div> <!-- /ko --> <\/div> <div class="ext-userprofile-flexcolumn ext-userprofile-section-column"><\/div> <\/div> <div class="ext-userprofile-section-line"><\/div> <div class="ext-userprofile-section-header ext-userprofile-flexrow"> <div data-bind="text:settingsText"><\/div> <!-- ko if: viewEditMode() === 0 --> <!-- ko if: showEditCloudAndSynced() && isLoadComplete() --> <div class="ext-userprofile-section-header-edit-filler"><\/div> <div class="ext-userprofile-section-header-edit"><a data-bind="text:editText, fxclick:editTextClick"><\/a><\/div> <!-- /ko --> <!-- /ko --> <\/div> <div class="ext-userprofile-flexrow"> <div class="ext-userprofile-flexcolumn ext-userprofile-section-column"> <div class="ext-userprofile-section-column-header msportalfx-text-ellipsis msportalfx-text-muted-50" data-bind="text:blockSignInSwitchText"><\/div> <!-- ko if: viewEditMode() === 0 --> <div class="ext-userprofile-flexrow"> <div data-bind="text:blockSignInSwitchData" class="ext-userprofile-textdata msportalfx-text-ellipsis"><\/div> <div class="ext-userprofile-section-column-filler"><\/div> <\/div> <!-- /ko --> <!-- ko if: viewEditMode() === 1 --> <div class="ext-userprofile-section-column-edit" data-bind="pcControl: blockSignInSwitchOptionsGroup"><\/div> <!-- /ko --> <\/div> <div class="ext-userprofile-flexcolumn ext-userprofile-section-column"> <div class="ext-userprofile-section-column-header msportalfx-text-ellipsis msportalfx-text-muted-50" data-bind="text:usageLocationText"><\/div> <!-- ko if: viewEditMode() === 0 --> <div class="ext-userprofile-flexrow"> <div data-bind="text:usageLocationData" class="ext-userprofile-textdata msportalfx-text-ellipsis"><\/div> <div class="ext-userprofile-section-column-filler"><\/div> <\/div> <!-- /ko --> <!-- ko if: viewEditMode() === 1 --> <div class="ext-userprofile-section-column-edit" data-bind="pcControl: usageLocationDropDown"><\/div> <!-- /ko --> <\/div> <div class="ext-userprofile-flexcolumn ext-userprofile-section-column"><\/div> <div class="ext-userprofile-flexcolumn ext-userprofile-section-column"><\/div> <\/div> <div class="ext-userprofile-section-line"><\/div> <div class="ext-userprofile-section-header ext-userprofile-flexrow"> <div data-bind="text:contactInfoText"><\/div> <!-- ko if: viewEditMode() === 0 --> <!-- ko if: showEdit() && isLoadComplete() --> <div class="ext-userprofile-section-header-edit-filler"><\/div> <div class="ext-userprofile-section-header-edit"><a data-bind="text:editText, fxclick:editTextClick"><\/a><\/div> <!-- /ko --> <!-- /ko --> <\/div> <div class="ext-userprofile-flexrow"> <div class="ext-userprofile-flexcolumn ext-userprofile-section-column"> <div class="ext-userprofile-section-column-header msportalfx-text-ellipsis msportalfx-text-muted-50" data-bind="text:streetAddressText"><\/div> <!-- ko if: viewEditMode() === 0 --> <div class="ext-userprofile-flexrow"> <div data-bind="text:streetAddressData" class="ext-userprofile-textdata msportalfx-text-ellipsis"><\/div> <div class="ext-userprofile-section-column-filler"><\/div> <\/div> <!-- /ko --> <!-- ko if: viewEditMode() === 1 --> <div class="ext-userprofile-section-column-edit" data-bind="pcControl: streetAddressTextbox"><\/div> <!-- /ko --> <\/div> <div class="ext-userprofile-flexcolumn ext-userprofile-section-column"> <div class="ext-userprofile-section-column-header msportalfx-text-ellipsis msportalfx-text-muted-50" data-bind="text:stateText"><\/div> <!-- ko if: viewEditMode() === 0 --> <div class="ext-userprofile-flexrow"> <div data-bind="text:stateData" class="ext-userprofile-textdata msportalfx-text-ellipsis"><\/div> <div class="ext-userprofile-section-column-filler"><\/div> <\/div> <!-- /ko --> <!-- ko if: viewEditMode() === 1 --> <div class="ext-userprofile-section-column-edit" data-bind="pcControl: stateTextbox"><\/div> <!-- /ko --> <\/div> <div class="ext-userprofile-flexcolumn ext-userprofile-section-column"> <div class="ext-userprofile-section-column-header msportalfx-text-ellipsis msportalfx-text-muted-50" data-bind="text:countryText"><\/div> <!-- ko if: viewEditMode() === 0 --> <div class="ext-userprofile-flexrow"> <div data-bind="text:countryData" class="ext-userprofile-textdata msportalfx-text-ellipsis"><\/div> <div class="ext-userprofile-section-column-filler"><\/div> <\/div> <!-- /ko --> <!-- ko if: viewEditMode() === 1 --> <div class="ext-userprofile-section-column-edit" data-bind="pcControl: countryTextbox"><\/div> <!-- /ko --> <\/div> <div class="ext-userprofile-flexcolumn ext-userprofile-section-column"> <div class="ext-userprofile-section-column-header msportalfx-text-ellipsis msportalfx-text-muted-50" data-bind="text:officeText"><\/div> <!-- ko if: viewEditMode() === 0 --> <div class="ext-userprofile-flexrow"> <div data-bind="text:officeData" class="ext-userprofile-textdata msportalfx-text-ellipsis"><\/div> <div class="ext-userprofile-section-column-filler"><\/div> <\/div> <!-- /ko --> <!-- ko if: viewEditMode() === 1 --> <div class="ext-userprofile-section-column-edit" data-bind="pcControl: officeTextbox"><\/div> <!-- /ko --> <\/div> <\/div> <div class="ext-userprofile-flexrow"> <div class="ext-userprofile-flexcolumn ext-userprofile-section-column"> <div class="ext-userprofile-section-column-header msportalfx-text-ellipsis msportalfx-text-muted-50" data-bind="text:cityText"><\/div> <!-- ko if: viewEditMode() === 0 --> <div class="ext-userprofile-flexrow"> <div data-bind="text:cityData" class="ext-userprofile-textdata msportalfx-text-ellipsis"><\/div> <div class="ext-userprofile-section-column-filler"><\/div> <\/div> <!-- /ko --> <!-- ko if: viewEditMode() === 1 --> <div class="ext-userprofile-section-column-edit" data-bind="pcControl: cityTextbox"><\/div> <!-- /ko --> <\/div> <div class="ext-userprofile-flexcolumn ext-userprofile-section-column"> <div class="ext-userprofile-section-column-header msportalfx-text-ellipsis msportalfx-text-muted-50" data-bind="text:zipText"><\/div> <!-- ko if: viewEditMode() === 0 --> <div class="ext-userprofile-flexrow"> <div data-bind="text:zipData" class="ext-userprofile-textdata msportalfx-text-ellipsis"><\/div> <div class="ext-userprofile-section-column-filler"><\/div> <\/div> <!-- /ko --> <!-- ko if: viewEditMode() === 1 --> <div class="ext-userprofile-section-column-edit" data-bind="pcControl: zipTextbox"><\/div> <!-- /ko --> <\/div> <div class="ext-userprofile-flexcolumn ext-userprofile-section-column"> <div class="ext-userprofile-section-column-header msportalfx-text-ellipsis msportalfx-text-muted-50" data-bind="text:officePhoneText"><\/div> <!-- ko if: viewEditMode() === 0 --> <div class="ext-userprofile-flexrow"> <div data-bind="text:officePhoneData" class="ext-userprofile-textdata msportalfx-text-ellipsis"><\/div> <div class="ext-userprofile-section-column-filler"><\/div> <\/div> <!-- /ko --> <!-- ko if: viewEditMode() === 1 --> <div class="ext-userprofile-section-column-edit" data-bind="pcControl: officePhoneTextbox"><\/div> <!-- /ko --> <\/div> <div class="ext-userprofile-flexcolumn ext-userprofile-section-column"> <div class="ext-userprofile-section-column-header msportalfx-text-ellipsis msportalfx-text-muted-50" data-bind="text:mobilePhoneText"><\/div> <!-- ko if: viewEditMode() === 0 --> <div class="ext-userprofile-flexrow"> <div data-bind="text:mobilePhoneData" class="ext-userprofile-textdata msportalfx-text-ellipsis"><\/div> <div class="ext-userprofile-section-column-filler"><\/div> <\/div> <!-- /ko --> <!-- ko if: viewEditMode() === 1 --> <div class="ext-userprofile-section-column-edit" data-bind="pcControl: mobilePhoneTextbox"><\/div> <!-- /ko --> <\/div> <\/div> <div class="ext-userprofile-section-line"><\/div> <div class="ext-userprofile-section-header ext-userprofile-flexrow"> <div data-bind="text:authenticationContactInfoText"><\/div> <!-- ko if: viewEditMode() === 0 --> <!-- ko if: showEditMfaCloudAndSynced() && isLoadComplete() --> <div class="ext-userprofile-section-header-edit-filler"><\/div> <div class="ext-userprofile-section-header-edit"><a data-bind="text:editText, fxclick:editTextClick"><\/a><\/div> <!-- /ko --> <!-- /ko --> <\/div> <!-- ko ifnot: isLoadComplete() --> <div class="ext-userprofile-section-loading" data-bind="image: loadingImage"><\/div> <!-- /ko --> <!-- ko if: isLoadComplete() --> <!-- ko ifnot: isSelfMode() --> <!-- ko ifnot: isGlobalAdmin() --> <!-- ko ifnot: isUserAdmin() --> <div class="ext-userprofile-authnoaccess msportalfx-bgcolor-k0s2" data-bind="text:authenticationManageNoAccessText"><\/div> <!-- /ko --> <!-- /ko --> <!-- /ko --> <!-- ko ifnot: isSelfMode() --> <!-- ko if: isGlobalAdmin() || isUserAdmin() --> <div class="ext-userprofile-flexrow"> <div class="ext-userprofile-flexcolumn ext-userprofile-section-column"> <div class="ext-userprofile-section-column-header msportalfx-text-ellipsis msportalfx-text-muted-50" data-bind="text:authenticationPhoneText"><\/div> <!-- ko if: viewEditMode() === 0 --> <div class="ext-userprofile-flexrow"> <div data-bind="text:authenticationPhoneData" class="ext-userprofile-textdata msportalfx-text-ellipsis"><\/div> <div class="ext-userprofile-section-column-filler"><\/div> <\/div> <!-- /ko --> <!-- ko if: viewEditMode() === 1 --> <div class="ext-userprofile-section-column-edit" data-bind="pcControl: authenticationPhoneTextbox"><\/div> <!-- /ko --> <\/div> <div class="ext-userprofile-flexcolumn ext-userprofile-section-column"> <div class="ext-userprofile-section-column-header msportalfx-text-ellipsis msportalfx-text-muted-50" data-bind="text:authenticationEmailAddressText"><\/div> <!-- ko if: viewEditMode() === 0 --> <div class="ext-userprofile-flexrow"> <div data-bind="text:authenticationEmailAddressData" class="ext-userprofile-textdata msportalfx-text-ellipsis"><\/div> <div class="ext-userprofile-section-column-filler"><\/div> <\/div> <!-- /ko --> <!-- ko if: viewEditMode() === 1 --> <div class="ext-userprofile-section-column-edit" data-bind="pcControl: authenticationEmailAddressTextbox"><\/div> <!-- /ko --> <\/div> <div class="ext-userprofile-flexcolumn ext-userprofile-section-column"><\/div> <div class="ext-userprofile-flexcolumn ext-userprofile-section-column"><\/div> <\/div> <!-- /ko --> <!-- /ko --> <!-- ko if: isGlobalAdmin() || isUserAdmin() --> <!-- ko if: !isUserAdmin() || !isSelfMode() --> <div class="ext-userprofile-flexrow"> <!-- ko if: !isSelfMode() --> <div class="ext-userprofile-flexcolumn ext-userprofile-section-column"> <div class="ext-userprofile-section-column-header msportalfx-text-ellipsis msportalfx-text-muted-50" data-bind="text:authenticationAlternatePhoneText"><\/div> <!-- ko if: viewEditMode() === 0 --> <div class="ext-userprofile-flexrow"> <div data-bind="text:authenticationAlternatePhoneData" class="ext-userprofile-textdata msportalfx-text-ellipsis"><\/div> <div class="ext-userprofile-section-column-filler"><\/div> <\/div> <!-- /ko --> <!-- ko if: viewEditMode() === 1 --> <div class="ext-userprofile-section-column-edit" data-bind="pcControl: authenticationAlternatePhoneTextbox"><\/div> <!-- /ko --> <\/div> <!-- /ko --> <div class="ext-userprofile-flexcolumn ext-userprofile-section-column"> <div class="ext-userprofile-section-column-header msportalfx-text-ellipsis msportalfx-text-muted-50" data-bind="text:authenticationAlternateEmailAddressText"><\/div> <!-- ko if: viewEditMode() === 0 --> <div class="ext-userprofile-flexrow"> <div data-bind="text:authenticationAlternateEmailAddressData" class="ext-userprofile-textdata msportalfx-text-ellipsis"><\/div> <div class="ext-userprofile-section-column-filler"><\/div> <\/div> <!-- /ko --> <!-- ko if: viewEditMode() === 1 --> <div class="ext-userprofile-section-column-edit" data-bind="pcControl: authenticationAlternateEmailAddressTextbox"><\/div> <!-- /ko --> <\/div> <div class="ext-userprofile-flexcolumn ext-userprofile-section-column"><\/div> <div class="ext-userprofile-flexcolumn ext-userprofile-section-column"><\/div> <!-- ko if: isSelfMode() --> <div class="ext-userprofile-flexcolumn ext-userprofile-section-column"><\/div> <!-- /ko --> <\/div> <!-- /ko --> <!-- /ko --> <!-- ko if: isSelfMode() --> <div class="ext-userprofile-textdata msportalfx-text-ellipsis"> <span data-bind="text:authenticationManageContactInformationText"><\/span> <a data-bind="attr: {href: authenticationManageContactInformationUrl}, text: authenticationManageContactInformationUrlText" target="_blank"><\/a> <\/div> <!-- /ko --> <!-- /ko --> <div class="ext-userprofile-section-line"><\/div> <div class="ext-userprofile-section-header ext-userprofile-flexrow"> <div data-bind="text:minorsAndConsentSectionLabelText"><\/div> <!-- ko if: viewEditMode() === 0 --> <!-- ko if: showEditGdpr() && isLoadComplete() --> <div class="ext-userprofile-section-header-edit-filler"><\/div> <div class="ext-userprofile-section-header-edit"><a data-bind="text:editText, fxclick:editTextClick"><\/a><\/div> <!-- /ko --> <!-- /ko --> <\/div> <div class="ext-userprofile-flexrow"> <div class="ext-userprofile-flexcolumn ext-userprofile-section-column"> <div class="ext-userprofile-section-column-header msportalfx-text-ellipsis msportalfx-text-muted-50" data-bind="text:ageGroupText"><\/div> <!-- ko if: viewEditMode() === 0 --> <div class="ext-userprofile-flexrow"> <div data-bind="text:ageGroupData" class="ext-userprofile-textdata msportalfx-text-ellipsis"><\/div> <div class="ext-userprofile-section-column-filler"><\/div> <\/div> <!-- /ko --> <!-- ko if: viewEditMode() === 1 --> <div class="ext-userprofile-section-column-edit" data-bind="pcControl: ageGroupDropDown"><\/div> <!-- /ko --> <\/div> <div class="ext-userprofile-flexcolumn ext-userprofile-section-column"> <div class="ext-userprofile-section-column-header msportalfx-text-ellipsis msportalfx-text-muted-50" data-bind="text:consentProvidedForMinorText"><\/div> <!-- ko if: viewEditMode() === 0 --> <div class="ext-userprofile-flexrow"> <div data-bind="text:consentProvidedForMinorData" class="ext-userprofile-textdata msportalfx-text-ellipsis"><\/div> <div class="ext-userprofile-section-column-filler"><\/div> <\/div> <!-- /ko --> <!-- ko if: viewEditMode() === 1 --> <div class="ext-userprofile-section-column-edit" data-bind="pcControl: consentProvidedForMinorDropDown"><\/div> <!-- /ko --> <\/div> <div class="ext-userprofile-flexcolumn ext-userprofile-section-column"> <div class="ext-userprofile-section-column-header msportalfx-text-ellipsis msportalfx-text-muted-50" data-bind="text:legalAgeGroupClassificationText"><\/div> <div class="ext-userprofile-flexrow"> <div data-bind="text:legalAgeGroupClassificationData" class="ext-userprofile-textdata msportalfx-text-ellipsis"><\/div> <div class="ext-userprofile-section-column-filler"><\/div> <\/div> <\/div> <div class="ext-userprofile-flexcolumn ext-userprofile-section-column"><\/div> <\/div> <\/div> <\/div> '},styleSheets:[{file:"Blades/ApplicationProxy.css",content:st},{file:"Blades/EnterpriseApps.css",content:nt},{file:"Blades/EnterpriseApps.css",content:nt},{file:"Blades/AppList.css",content:et},{file:"Blades/CustomAppAddButtonParts.css",content:ut},{file:"Blades/ManagedApps.css",content:b},{file:"Blades/MdmApps.css",content:w},{file:"Blades/Settings.css",content:c},{file:"Blades/SingleSignOn.css",content:s},{file:"Blades/SharedAreaStyles.css",content:h},{file:"Blades/DevicesAreaStyles.css",content:rt},{file:"Blades/DirectoriesAreaStyles.css",content:it},{file:"Blades/Domains.css",content:tt},{file:"Blades/SharedAreaStyles.css",content:h},{file:"Blades/GroupsAreaStyles.css",content:g},{file:"Blades/Licenses.css",content:d},{file:"Blades/LoginTenantBranding.css",content:k},{file:"Blades/MultifactorAuthentication.css",content:p},{file:"Blades/NotificationsAreaStyles.css",content:y},{file:"Blades/PasswordResetAreaStyles.css",content:v},{file:"Blades/SelectorAndGridStyles.css",content:l},{file:"Blades/SelectorAndGridStyles.css",content:l},{file:"Blades/ClassicPolicies.css",content:ft},{file:"Blades/PoliciesAreaStyles.css",content:a},{file:"Blades/Upsell.css",content:f},{file:"Blades/ApplicationsStyles.css",content:ot},{file:"Blades/SharedAreaStyles.css",content:h},{file:"Blades/SpotlightStyles.css",content:o},{file:"Blades/SupportRequestProblemDetailsAreaStyles.css",content:e},{file:"Blades/SharedAreaStyles.css",content:h},{file:"Blades/UserProvisioning.css",content:r},{file:"Blades/SharedAreaStyles.css",content:h},{file:"Blades/UsersAreaStyles.css",content:i},{file:"Blades/UserProfileStyles.css",content:u}],isV2:!0},attributes:1}})(ht||(ht={})),ht}))