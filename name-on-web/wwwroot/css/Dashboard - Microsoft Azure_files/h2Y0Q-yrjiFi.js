var __extends=this&&this.__extends||(function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}})();define("WebsitesExtension/TypeScript/ContinuousDeployment/Commands/ConfigurePerformanceTestCommandViewModel",["require","exports","f","o","ko","Websites/ClientResources/GeneralResources","WebsitesExtension/TypeScript/Utility/Utility.Notifications","WebsitesExtension/TypeScript/ExtensionAssets/Constants","WebsitesExtension/TypeScript/Utility/Utility.Website","WebsitesExtension/TypeScript/Utility/Utility.Urls","WebsitesExtension/TypeScript/Models/WebsiteResourceId","WebsitesExtension/TypeScript/ContinuousDeployment/Models/ProviderType"],(function(n,t,i,r,u,f,e,o,s,h,c,l){"use strict";r.defineProperty(t,"__esModule",{value:!0});var a=(function(n){function t(t,r,
h){var c=n.call(this,t)||this;return c._dataContext=h,c._container=t,c.icon(i.Base.Images.GearAlternate()),c._appSettingsView=h.websiteDataConfig.appSettingsCache.createView(t),c.resourceId=u.observable(""),c._baseSiteResourceId=u.observable(),c._slotConfigNamesView=h.websiteDataConfig.slotConfigNamesCache.createView(t),c._scmInfoEntityView=h.websitesData.scmInfoCache.createView(t),c.loadTestCollector=new i.ViewModels.ParameterCollector(t,{receiveResult:function(n){var l,t,r,a,i,h;if(n){l=c._appSettingsView.item().properties();t=s.upsertAppSetting(l,o.LoadTesting.performanceVersionKey,o.LoadTesting.performanceVersionValue);t=s.upsertAppSetting(t,o.LoadTesting.performanceTestConfigKey,n);r=c._appSettingsView.item();r.properties=u.observable(t);a=c._slotConfigNamesView.item().properties();i=s.upsertSlotConfigNameAppSettings(a,o.LoadTesting.performanceTestConfigKey);i=s.upsertSlotConfigNameAppSettings(i,o.LoadTesting.performanceVersionKey);h=c._slotConfigNamesView.item();h.properties=u.observable(
i);var v=e.start(f.loadTestNotificationTitle,f.loadTestNotificationDesc),y=c._dataContext.websiteDataConfig.updateAppSettings(c.resourceId(),r),p=c._dataContext.websiteDataConfig.updateSlotConfigNames(c._baseSiteResourceId(),h);Q.all([y,p]).then((function(){e.success(v,f.loadTestNotificationSuccess)}),(function(n){e.failure(v,f.loadTestNotificationFailure,n)}))}}}),c.enabled=u.pureComputed((function(){var n=c._scmInfoEntityView.item();return!!n&&n.ScmType()!==l.ProviderType.None&&n.ScmType()!==l.ProviderType.VSTSRM})),c}return __extends(t,n),t.prototype.onInputsSet=function(n){var r,t;return n?(r=c.WebsiteResourceId.fromCsmResourceId(n.ResourceId),this.resourceId(n.ResourceId),t=i.ViewModels.Services.ResourceTypes.parseResourceDescriptor(this.resourceId()),this._baseSiteResourceId(h.getWebsiteCsmId(t.subscription,t.resourceGroup,t.resources[0])),Q.all([this._slotConfigNamesView.fetch(this._baseSiteResourceId()),this._appSettingsView.fetch(n.ResourceId),this._scmInfoEntityView.fetch(r)])):null}
,t})(i.ViewModels.OpenBladeCommand);t.ConfigurePerformanceTestCommandViewModel=a}))