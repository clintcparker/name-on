define("Shared/FilterableColumns/ColumnChooserBlade",["require","exports","f","o","a","ko","_generated/BladeReferences","Fx/Controls/Button","CommonResources","Policies/Utilities/StringHelpers","Fx/Composition/TemplateBlade"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";function rt(n,t){var r=a.Extensions.SelectableRow,u={selectableRow:{selectionMode:3,activateOnSelected:f.observable(!1),rowSelect:function(n,i){var r=i.selected,u;r&&t.push(r.item);i.unselected&&(u=i.unselected.map((function(n){return n.item})),t.removeAll(u))}}},i=new a.ViewModel(n,null,r,u),e=[{itemKey:"description",name:f.observable(s.columnChooserColumn),format:a.Format.HtmlBindings,formatOptions:{htmlBindingsTemplate:"<div>\n    <span data-bind='text: settings.item.description, attr: { title: settings.item.description }' class='msportalfx-text-ellipsis ext-activitygrid-type-name'><\/span>\n    <span data-bind='pcDockedBalloon: settings.item.infoBalloon' class='ext-activitygrid-type-balloon'><\/span>\n<\/div>"},activatable:f.observable(!0),sortable:!1,sortOrder:f.observable(0),width:f.observable("100%")}];return i.columns=f.observableArray(e),i.showHeader=!1,i.summary=f.observable(s.columnChooser),ut(n,i,f.observable(!1)),i}function b(n,t){t?n.noRowsMessage(s.loading):n.noRowsMessage(s.noColumns)}function ut(n,t,i){t.noRowsMessage=f.observable(s.noColumns);i!==null&&i!==undefined&&(b(t,i()),i.subscribe(n,(function(n){b(t,n)})))}function k(n){return n&&n.length>0}function d(n,t){var r,i,u;return n&&(i=n.blade,i&&(u=t(i),r=f.unwrap(u))),r||""}function g(){}function nt(n,t){h.isNullOrWhiteSpace(t)||n(t)}function ft(n,t,r,u){var p=f.observable(k(t())),b=[],o,c,l,a,v,y,h;return f.reactor(n,t,(function(n){b=n;p(k(n))})),u&&(v=u.choosing,y=u.chosen,h=u.command,h&&(o=h.label||s.chooseColumns,c=h.icon||w.Columns(),l=h.ariaLabel||o,a=h.tooltip||s.chooseColumnsTooltip)),o=o||s.chooseColumns,c=c||w.Columns(),l=l||o,a=a||s.chooseColumnsTooltip,v=v||g,y=y||g,new it.CommandButton({label:o,ariaLabel:l,tooltip:a,icon:c,command:{canExecute:p,execute:function(){var t=r(),f=b.map((function(n){var u=n.name,f,r;return u&&(f=u()),r=n.id,{columnId:r,description:f,infoBallonText:n.infoBalloonText,selected:i.findIndex(t,(function(n){return n===r}))>=0,selectable:n.selectable}}));return v(t),n.openContextPane(new e.ColumnChooserBladeReference({title:d(u,(function(n){return n.title})),subtitle:d(u,(function(n){return n.subtitle})),columns:f},function(n,t){var i;t?(i=t.chosenColumnIds,r(i)):i=null;y(i)}))}}})}var l;r.defineProperty(t,"__esModule",{value:!0});var tt=i.Base,v=i.ViewModels,y=v.Controls,p=y.DockedBalloon,a=y.Lists.Grid,w=tt.Images,it=v.Toolbars;t.buildColumnsButton=ft;l=(function(){function n(){this.title=f.observable(s.chooseColumns);this.subtitle=f.observable()}return n.prototype.onInitialize=function(){var a=this.context,i=a.container,e=a.parameters,r,n,u,c,t,v,l;for(nt(this.title,e.title),nt(this.subtitle,e.subtitle),r=f.observableArray([]),n=rt(i,r),this.grid=n,n.items(e.columns.map((function(n){var r=n.infoBallonText,t;return h.isNullOrWhiteSpace(r)||(t=new p.ViewModel(i),t.type=p.Type.Info,t.content(n.infoBallonText)),{columnId:f.observable(n.columnId),description:f.observable(n.description),infoBalloon:t,initiallySelected:n.selected,selectable:n.selectable}}))),u=0,c=n.items();u<c.length;u++)t=c[u],t.initiallySelected&&(r.push(t),v=n.getRowMetadata(t),l=v,l.selected(!0),t.selectable||l.disabled(!0));return this.okButton=o.create(i,{text:s.ok,disabled:!1,onClick:function(){var n=r(),t=n.map((function(n){return n.columnId()})),u={chosenColumnIds:t};i.closeCurrentBlade(u)}}),Q()},n})();l=__decorate([c.Decorator({htmlTemplate:"./ColumnChooserBlade.html",styleSheets:["./ColumnChooserStyles.css"],isPinnable:!1}),c.ReturnsData.Decorator()],l);t.ColumnChooserBlade=l}))