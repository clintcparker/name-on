define("MsPortalImpl/Base/Base.ImplUtils",["require","exports","f","i","o"],(function(n,t,i,r,u){"use strict";function rt(n,t){t=t||{};var i=t.requireHttps||!1,r=i?nt:g;return r.test(n)}function ut(n){var t="data-extensionname",i="["+t+"]["+t+"!='']";return $(n).closest(i).attr(t)||"fx"}function ft(n){var t;return typeof n=="string"?t=n:n&&(t=ut(n)),t||"fx"}function a(n,t,r,u,f){var o=ft(t),e;f&&(u+=" "+JSON.stringify(f));e=i.getLogFriendlyMessage(u);try{d.client.log(o,{level:r,code:0,area:n.normalize(),message:e})}catch(s){console.error(e)}}function et(n,t,r,u){u=u?i.extend2(n.contextData,u):n.contextData;a(n.localRequire,n.windowContext,t,r,u)}function o(n){n===void 0&&(n="");var t={},i=n.indexOf("?"),r=i>-1?n.substr(i+1):n,u=r.split("&");return u.forEach((function(n){if(n&&!n.match(/^\=+$/)){var i=n.split("="),r=i.shift(),u=i.length>0?i.join("="):"";t[r]=u}})),t}function s(n){var i="",t="";return tt(n,(function(n,r){i+="{0}{1}={2}".format(t,n,r);t||(t="&")})),i}function f(n){var t=n.toString().match(/^([^\:\/]+)\:\/\//);return t?t[1]+":":""}function e(n){var t;if(n=n.toString(),t=f(n),!t)return"";var i=n.substr(t.length+2),u=i.indexOf("/"),r=u>0?i.substr(0,u):i;return!r||r.indexOf("@")>0?"":r.replace(/\:.*/,"")}function y(n){var t=p(n),r=e(t),u=h(t),i=f(t),o=(i?i.length+2:0)+r.length+(u?u.length+1:0);return!r||!i?"":t.substr(o)}function h(n){var i=f(n),r=e(n),u,t;return!i||!r?"":(u=i.length+2+r.length,t=n.toString().substring(u).match(/^\:([0-9]+)/),!t)?"":t[1]}function p(n){var t=n.toString().replace(/\#.*/g,"").replace(/\?.*/,"");return!e(t)||!f(t)?"":t}function w(n){return(n=n.toString().replace(/\#.*/g,""),!n.match(/\?/))?"":n.replace(/.*\?/,"?")}function b(n){return(n=n.toString(),!n.match(/\#/))?"":n.replace(/[^\#]*\#/,"#").replace(/\?.*/,"")}function k(n){var t=n.indexOf("#"),i=t===-1?-1:n.substr(t).indexOf("?");return t===-1?"":i===-1?"":n.substr(t+i)}var v;u.defineProperty(t,"__esModule",{value:!0});var d=r.Rpc,c="^([Hh][Tt][Tt][Pp][Ss]",l="://(?::)?@?(([dw.-]+)(?::(d+))?)?)([/\\w.()-]*)?(?:([?][^#]*)?(#.*)?).*$",g=new RegExp(c+"?"+l),nt=new RegExp(c+l),tt=i.forEachKey,it=i.isEmpty;t.validateAbsoluteHttpUri=rt;t.logToExtension=a;t.log=et;v=(function(){function n(n){n===void 0&&(n="");this._hashQs={};this._qs={};n=n.toString();this._protocol=f(n);this._host=e(n);this._port=h(n);this._pathname=y(n);this._hash=b(n);this._qsPart=w(n);this._qs=o(this._qsPart);this._hashQsPart=k(n);this._hashQs=o(this._hashQsPart)}return n.prototype.getQueryStringValue=function(n){return this._qs[n]||""},n.prototype.setHashQueryStringValue=function(n,t){return this._hashQs[n]=t,this},n.prototype.deleteHashQueryStringValue=function(n){return delete this._hashQs[n],this},n.prototype.clearHashQueryStringIfEmpty=function(){return it(this._hashQs)&&(this._hashQsPart=""),this},n.prototype.getHashQueryStringValue=function(n){return this._hashQs[n]||""},n.prototype.setHash=function(n){return this._hash=n,this},n.prototype.isHashEmpty=function(){return this.hash===""||this.hash==="#"},n.prototype.toString=function(){return this.href},u.defineProperty(n.prototype,"href",{get:function(){return this.path+this.queryString+this.hash+this.hashQueryString},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"host",{get:function(){return this._host},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"path",{get:function(){return(this.protocol?this.protocol+"//":"")+this.host+(this.port?":"+this.port:"")+this.pathname},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"pathname",{get:function(){return this._pathname},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"port",{get:function(){return this._port},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"protocol",{get:function(){return this._protocol},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"queryString",{get:function(){var n=s(this._qs);return n||this._qsPart?"?"+n:""},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"hash",{get:function(){return this._hash||this.hashQueryString?"#"+(this._hash||"").replace(/^\#/,""):""},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"hashQueryString",{get:function(){var n=s(this._hashQs);return this._hashQsPart||n?"?"+n:""},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"hashWithHashQueryString",{get:function(){return this.hash+this.hashQueryString},enumerable:!0,configurable:!0}),n.prototype.getHashParts=function(){if(!this._cachedHashParts||this._partsBasedHash!==this.hash){this._partsBasedHash=this.hash;var n=this.hash.match(/^\#([^\/]*)?(\/[^\/]*)?(\/.*)?|$/),t=n[1]||"",i=(n[2]||"").slice(1),r=n[3]||"";this._cachedHashParts=t[0]==="@"?{tenant:t.slice(1),category:i,rest:r.slice(1)}:{tenant:"",category:t,rest:i+r}}return this._cachedHashParts},n})();t.Uri=v;t.queryStringToMap=o;t.mapToQueryString=s;t.getProtocol=f;t.getHost=e;t.getPathnameSegment=y;t.getPort=h;t.getPathSegment=p;t.getQueryStringSegment=w;t.getHashSegment=b;t.getHashQueryStringSegment=k}));
define("MsPortalImpl/Base/Base.BrowserDetection",["require","exports"],(function(){"use strict";var n;return (function(n){function s(){var n=/AppleWebKit\/([\d.]+)/.exec(t);if(n)return parseFloat(n[1])}function h(n){return window.matchMedia(n).matches}function c(){var t="-webkit- -moz- -o- -ms-".split(" "),n;return"ontouchstart"in window?!0:(n="("+t.join("touch-enabled),(")+"touch-enabled)",h(n))}var t=window.navigator.userAgent,e=/Firefox\//i.test(t),r=/Chrome[ /]/i.test(t),i=/Edge\//i.test(t),u=/MSIE /i.test(t),f=/Trident\//i.test(t),o=/Safari/i.test(t);n.safari_11_webKitVersion=604;n.isFirefox=e;n.isChrome=r&&!i;n.isEdge=i;n.isIe=u||f||i;n.isIe11=!u&&f&&!i;n.isSafari=o&&!r&&!i;n.webKitVersion=s()||0;n.isTouch=c()})(n||(n={})),n}));
define("MsPortalImpl/Base/Base.CssSelectorParser",["require","exports"],(function(){"use strict";var n;return (function(n){function f(n){return n=n.replace("::after",":after").replace("::before",":before"),r=function(n,t){return t},l(n||"",!1)}function e(n){var t=n.map((function(n){return n.value}));return t.join("")}var a;n.parseCssSelector=f;n.subselectorToString=e;var i=jQuery.find,u=i.selectors,o=i.selectors.match,r;
/*!
         * -----------------------------------------------------------------------------
         * The portion of this file from here until "End of jQuery code snippet" is code
         * derived from the jQuery JavaScript Library v2.0.3 - http://jquery.com/
         * Copyright 2005, 2013 jQuery Foundation, Inc. and other contributors
         * Released under the MIT license - http://jquery.org/license
         * Date: 2013-07-03T13:30Z
         */
var t="[\\x20\\t\\r\\n\\f]",s=new RegExp("^"+t+"+|((?:^|[^\\\\])(?:\\\\.)*)"+t+"+$","g"),h=new RegExp("^"+t+"*,"+t+"*"),c=new RegExp("^"+t+"*([>+~]|"+t+")"+t+"*"),l=function(n,t){var l,e,v,a,f,y,p,w=r[n+" "];if(w)return t?0:w.slice(0);for(f=n,y=[],p=u.preFilter;f;){(!l||(e=h.exec(f)))&&(e&&(f=f.slice(e[0].length)||f),y.push(v=[]));l=!1;(e=c.exec(f))&&(l=e.shift(),v.push({value:l,type:e[0].replace(s," ")}),f=f.slice(l.length));for(a in u.filter)(e=o[a].exec(f))&&(!p[a]||(e=p[a](e)))&&(l=e.shift(),v.push({value:l,type:a,matches:e}),f=f.slice(l.length));if(!l)break}return t?f.length:f?i.error(n):r(n,y).slice(0)};
/*!
         * End of jQuery code snippet
         * -----------------------------------------------------------------------------
         */
a=undefined})(n||(n={})),n}));
define("MsPortalImpl/Base/Base.Sanitization",["require","exports","f","o","MsPortalImpl/Base/Base.ImplUtils"],(function(n,t,i,r,u){"use strict";function v(n){var t=f[n.reason]||"Unknown";u.log(n.provenanceContext,2,"Sanitization error found: "+t,{Tag:n.tag,Attribute:n.attr,Binding:n.binding,Value:n.val})}function e(n){return n===""||u.validateAbsoluteHttpUri(n)||c.test(n)}function y(n){return e(n)||o.test(n)}function p(n){return n===""||o.test(n)}function w(n){return n===""||l.test(n)}function b(n){var t=e(n);return t||a.error("Disallowed URI: "+n),t}function k(){return s}var s;r.defineProperty(t,"__esModule",{value:!0});var h=i.Base.Diagnostics,c=/^(vstfs:|ftp:|ftps:|sftp:|)\/\/|mailto:/,o=/^#/,l=/^(data:image)\//,a=h.createLog(n),f=[];f[1]="Invalid attribute";f[2]="Invalid CSS class name";f[3]="Invalid CSS property";f[4]="Invalid tag";f[5]="Unknown or prohibited binding";f[6]="Invalid binding value";t.logError=v;t.validateUriOrBlank=e;t.validateLinkUri=y;t.validateLocalUriOnly=p;t.validateDataImage=w;t.sanitizeUri=b;s=["alt","border","colspan","rowspan","span","disabled","height","width","lang","spellcheck","title","cx","cy","d","rx","ry","x","y","x1","x2","y1","y2","fill","fill-rule","opacity","points","stroke","stroke-dasharray","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-width","transform","vector-effect","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-current","aria-disabled","aria-expanded","aria-haspopup","aria-hidden","aria-invalid","aria-label","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","role",];t.getWhitelistedAttr=k}));
define("MsPortalImpl/Base/Base.EventTypes",["require","exports","f","o"],(function(n,t,i,r){"use strict";r.defineProperty(t,"__esModule",{value:!0});var u=undefined,f={doubleclick:"dblclick",mousewheel:"wheel",fxrightclick:"rightclick",animationstart:u,blur:u,change:u,click:u,contextmenu:u,dragover:u,dragstart:u,dragend:u,dragenter:u,dragleave:u,drop:u,focus:u,hashchange:u,input:u,keydown:u,keypress:u,keyup:u,mousedown:u,mouseenter:u,mouseleave:u,mousemove:u,mouseout:u,mouseover:u,mouseup:u,popstate:u,resize:u,scroll:u,selectstart:u,transitionend:u,focusin:u,focusout:u,remove:u,fxactionbarclick:u,fxactionbarvalidationtargetupdated:u,fxactionbarvalidationtargetmutated:u,fxautosettings:u,fxbladerepos:u,fxbladestatusbarclicked:u,fxbreadcrumbclick:u,fxbreadcrumbupdate:u,fxcontextmenu:u,fxcontextmenurequest:u,fxcontextpaneclosing:u,fxcopybuttonclick:u,fxcreatepart:u,fxdashboardactivity:u,fxensurebladevisible:u,fxenterorganizemode:u,fxerrorpartclicked:u,fxexitorganizemode:u,fxhomebuttonclick:u,fxloadingontopbar:u,fxopeninnewtab:u,fxpaneresize:u,fxpartcreated:u,fxpartgallerypivotinitialized:u,fxpeekmode:u,fxportalcontrolloadfailed:u,fxreadyforfocus:u,fxrearrange:u,fxregistermenu:u,fxrotatetheme:u,fxselectableactivated:u,fxsettingsbuttonclick:u,fxshowstartboard:u,fxshowjourney:u,fxsizechange:u,fxsizechanged:u,fxsummarycollapsed:u,fxtoastclick:u,fxunpin:u,touchcancel:u,touchend:u,touchmove:u,touchstart:u,pointerdown:u};i.forEachKey(f,(function(n,t){f[n]=t||n}));t.default=f}));
define("MsPortalImpl/Base/Telemetry",["require","exports","f","o"],(function(n,t,i){"use strict";var r;return (function(n){function t(n,t){i.extendArrayIntoMap(n,t)}var r,u,f;(function(n){t(n,["Asset","Blade","BrowseBlade","BrowseManager","BrowserRefresh","Dashboard","DashboardFilters","Desktop","DirectoryPane","FeedbackPane","FormControl","Gallery","HelpBlade","HelpPane","KeyboardShortcuts","Lens","NotificationHub","PartGallery","Resource","ResourceSummary","Search","Shell","SideBar","StartBoardPart","SettingsBlade","SettingsPane","TileAction","ToastTray","TopBar",])})(r=n.Source||(n.Source={})),(function(n){t(n,["ActionBarClicked","AddPartByDragDrop","AvatarMenuOpenBilling","AvatarMenuOpenFeedback","AvatarMenuOpenAccessDetails","AvatarMenuOpenContactInfo","AvatarMenuOpen","AvatarMenuSignOut","AvatarMenuSwitchTenant","BladeClosed","BladeLoaded","BladeFullOpened","BladeOpened","BladeFullReady","BladeFullRevealed","BladeReady","BladeRevealed","BladeRebind","BladeLoadErrored","BladeCollapse","MenuCollapse","BreadCrumbClicked","BreadCrumbHomeClicked","BrowseAssetsCollected","BrowseCanceled","BrowseFeedback","BrowseSaved","BrowseStarted","BrowseItemActivated","BrowseRecentItemRemoved","BrowseItemDeactivated","BrowseTypeActivated","BrowseTypeDeactivated","CommandExecuted","ConsoleClosed","ConsoleMaximized","ConsoleMinimized","OpenFileShare","ConsoleOpened","ConsoleRestored","CustomClick","CustomizeModeEntered","CustomizeModeExited","DashboardDiscard","DashboardEditCommandClicked","DashboardPublish","DashboardPublishNew","DashboardSaveACopy","DashboardView","DashboardViewTime","DashboardDelete","DashboardPinPart","DashboardNavigation","DashboardFiltersAdd","DashboardFiltersValueSet","DashboardFiltersRemoved","DashboardFiltersLoaded","DeepLinkVisited","DialogClosed","DialogOpened","DirectoryPaneSwitchTenant","DockBlades","ExtensionSignedOut","ExtensionTooManyErrors","ExtensionVersionChanged","FeedbackSmileyClicked","FirstVisited","FormFocused","FormBlurred","GenericFeedback","HashChanged","HelpBladeOpen","HelpMenuOpen","HelpMenuOpenLegal","HelpMenuOpenKeyboardShortcuts","HelpMenuOpenSupportRequest","HelpMenuOpenManageSupportRequest","HomeButtonClicked","ManagementPartnerBladeOpen","NotificationMenuOpen","NotificationMenuNotificationClick","SearchFeedback","SearchSession","SearchExecuted","SearchAllResourcesExecuted","SearchAllRecentsExecuted","SearchResourceGroupsExecuted","SearchMarketplaceExecuted","SearchResultOpened","JourneyDeactivated","JourneyOpened","JourneyScroll","KeyboardShortcutExecuted","LinkClicked","NPSDismissed","NPSScoreClicked","NPSShown","NPSSubmitted","NPSOpenSurvey","OnInputsSetResolved","Opened","ShellVersionChanged","SideBarLoaded","SideBarBrowseMenuOpened","SideBarBrowseMenuViewInitialized","SideBarBrowseMenuViewChanged","SideBarFavorite","SideBarFavoriteMoved","SideBarItemOpened","SideBarNewMenuOpened","SideBarUnFavorite","SideBarViewChanged","PartClick","PartGalleryLearnRelatedResources","PartGalleryOpenRelatedResources","PartGalleryStart","PartGalleryItemsLoaded","PartLoaded","PartLoadedNoExtensionDerived","PartPosition","PartReady","PartRevealed","PartErrored","PartMigrated","PartUpdated","PortalInitializeLanguage","PortalInitializeWelcome","PortalRedirect","RelexDisconnected","RelexOnReloadSet","ResourceSummaryCopyProperty","ResourceSummaryAction","RestoreJourney","ResultOpened","NotificationClicked","RecommendationClicked","RecommendationSurfaced","RecommendationAdded","Redirect","RedirectFallback","RotateTheme","SelectedTheme","SelectedHighContrastMode","SeeAll","SettingsBladeOpen","SettingsBladeSwitchLanguage","SettingsBladeSwitchRegionalFormat","SettingsBladeSwitchTheme","SettingsBladeToggleNotificationToasts","SettingsBladeToggleRelex","SettingsBladeToggleCommandLabels","SettingsBladeRestoreDefaults","SettingsPaneDeleteSettings","SettingsPaneOpen","SettingsPaneSwitchLanguage","SettingsPaneSwitchRegionalFormat","SettingsPaneSwitchTheme","SettingsPaneSwitchIdleTimeout","SettingsPaneToggleNotificationToasts","SettingsPaneToggleRelex","SettingsPaneToggleDblClickTheme","SettingsPaneToggleCommandLabels","SettingsPaneRestoreDefaults","StackLayoutMoveNext","StackLayoutMovePrevious","StartBoardPartLoaded","StartButtonClicked","StartFileDownload","TileActionClicked","ToastClicked","UnhandledExtensionError","UnknownNetworkError","HelpPaneOpen","HelpPaneFeedback","HelpPaneRequestContent","HelpMenuOpenWelcomeSequence","WhatsNewBladeOpen","UpdateContactabilityClose","UpdateContactabilityPrivacyPolicyClick","UpdateContactabilityUpdateEmailClick",])})(u=n.Action||(n.Action={})),(function(n){t(n,["Default","Failed","Redirect","Succeeded","FailedToGetBlade","FailedPreCheck","FailedToLoadExtension","FailedInvalidUIDefinition","Search","StartBoardRestored","JourneyRestored","PortalScrolled",])})(f=n.ActionModifier||(n.ActionModifier={}))})(r||(r={})),r}));
define("MsPortalImpl/Services/Services.SettingsProcessor",["require","exports","f","o","MsPortalImpl/Base/Telemetry"],(function(n,t,i,r,u){"use strict";var f;return (function(n){var f=i.Base.Diagnostics.Telemetry,e=(function(){function n(n){this._deferred=Q.defer();this.initialized=this._deferred.promise;this.flush=Q;this._lifetimeManager=n.createChildLifetime()}return n.prototype.init=function(n,i,e,o,s){var l=this,a=f.startTrace({source:u.Source.Shell,action:o}),h={},c=r.keys(i),v=this._lifetimeManager;c.forEach((function(r){h[r]=t.Default;i[r].subscribe(v,(function(i){h[r]!==t.ServerInProgress&&(h[r]=t.FromUser,n.setSetting(e,r,i),s&&n.flushSettings())}))}));this.flush=function(){return n.flushSettings()};n.queryStore(e).then((function(n){n=n||{};c.forEach((function(r){var u=n[r];u!==undefined&&h[r]===t.Default&&(h[r]=t.ServerInProgress,i[r](u),h[r]=t.ServerComplete)}));f.completeTrace(a);l._deferred.resolve(i)}))},n})(),t;n.SettingsProcessor=e,(function(n){n[n.Default=0]="Default";n[n.ServerInProgress=1]="ServerInProgress";n[n.ServerComplete=2]="ServerComplete";n[n.FromUser=3]="FromUser"})(t||(t={}))})(f||(f={})),f}));
define("MsPortalImpl/Services/Services.GeneralSettings",["require","exports","f","i","ko","MsPortalImpl/Services/Services.SettingsProcessor"],(function(n,t,i,r,u,f){"use strict";var e;return (function(n){function h(u){if(e&&!i.isTestMode)throw new Error(t+" has already been called.");e=!0;r.Rpc.client.registerObjectFactory(r.Constants.RpcMethods.getSettings,{allowedOrigin:null,allowRemoteChanges:!1,handler:function(){return Q.resolve(n.settings)}});n.processor.init(u,n.settings,o,t)}var o=0,t="InitializeGeneralSettingsInternal",e=!1,s=new r.TriggerableLifetimeManager;n.processor=new f.SettingsProcessor(s);n.settings={rawLocale:u.observable(""),"fxs-theme":u.observable(),npsTimeMs:u.observable(0),sideBarCollapsedKey:u.observable(!1),notificationToastEnabledKey:u.observable(!0),whatsNewEnabledKey:u.observable(!0),sideBarBrowseDisplayModeKey:u.observable(0),whatsNewVersion:u.observable(0),userConsentForNpsContact:u.observable(!1),highContrastKey:u.observable(0),idleTimeoutMins:u.observable(0),dblClickThemeEnabledKey:u.observable(!0),optIntoNewBrowse:u.observable(i.isFeatureEnabled("defaulttoartbrowse"))};n.init=h})(e||(e={})),e}));
define("_generated/Less/MsPortalImpl/Themes/Themes.Blue.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxs-theme-blue{background-color:#215b7d}.fxs-theme-blue .fxs-startboard-button,.fxs-theme-blue .fxs-startboard-header,.fxs-theme-blue .fxs-startboard-message-container{color:#fff}.fxs-theme-blue .fxs-startboard-button-icon{fill:#fff}")}));
define("_generated/Less/MsPortalImpl/Themes/Themes.LightMode.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxs-mode-light .azc-formControl,.fxs-mode-light .fxs-portal-border,.fxs-mode-light .msportalfx-docking-footer{border-color:#bbb}.fxs-mode-light .fxs-blade-locked,.fxs-mode-light .fxs-portal-background{background-color:#fff}.fxs-mode-light .fxs-bladecontent-unlocked,.fxs-mode-light .fxs-portal-background-secondary{background-color:#eee}.fxs-mode-light .fxs-bladestyle-create,.fxs-mode-light .fxs-bladestyle-help{background-color:#fff}.fxs-mode-light .fxs-portal-background-primary{background-color:#015cda}.fxs-mode-light .fxs-portal-text{color:#252525}.fxs-mode-light .fxs-portal-text-primary{color:#015cda}.fxs-mode-light .fxs-portal-title{color:#444}.fxs-mode-light .fxs-portal-bg-txt-br{color:#252525;border-color:#bbb;background-color:#fff}.fxs-mode-light .fxs-portal-focus:focus{background-color:#f5fcfe}.fxs-mode-light .fxs-portal-selected{background-color:#e5f8fd}.fxs-mode-light .fxs-portal-activated{background-color:rgba(85,179,255,.2)}.fxs-mode-light .fxs-portal-hover:hover{background-color:rgba(85,179,255,.1)}.fxs-mode-light .fxs-portal-hover:active{background-color:rgba(85,179,255,.2)}.fxs-mode-light .fxs-portal-svg{fill:#252525}.fxs-mode-light .fxs-portal-svg-secondary{fill:#444}.fxs-mode-light .fxs-tile-overlay{background-color:rgba(255,255,255,.4)}.fxs-mode-light .fxc-infoBox-image-container{background-color:#bbb}.fxs-mode-light .azc-node-fill{fill:#94caff}.fxs-mode-light .azc-node-fill-focused,.fxs-mode-light .azc-node-fill-hovered{fill:#47a5ff}.fxs-mode-light .azc-node-bg{background-color:#94caff}.fxs-mode-light .azc-node-bg-focused,.fxs-mode-light .azc-node-bg-hovered{background-color:#47a5ff}.fxs-mode-light .azc-chart{fill:#fff;stroke:#ccc}.fxs-mode-light .azc-chart text{fill:#515151}.fxs-mode-light .azc-chart text.azc-chart-axis-slider-text{fill:#252525}.fxs-mode-light .azc-external-hovered:not(.azc-row-disabled){background-color:#e6eef7}.fxs-mode-light .azc-header{background-color:#bbb;color:#252525}.fxs-mode-light .azc-formControl{background-color:#fff}.fxs-mode-light .azc-input{color:#252525}.fxs-mode-light .azc-formControl.azc-br-focused,.fxs-mode-light .azc-formControl.azc-br-focused.fxs-br-dirty,.fxs-mode-light .azc-formControl:focus{border-color:#0058ad}.fxs-mode-light .azc-bg-default{background-color:#fff}.fxs-mode-light .azc-bg-light{background-color:#e6e6e6}.fxs-mode-light .azc-bg-muted{background-color:#b3b3b3}.fxs-mode-light .azc-bg-muted-80-10{background-color:#333}.fxs-mode-light .azc-bg-console{background-color:#191919}.fxs-mode-light .azc-bg-hover{background-color:#99bcde}.fxs-mode-light .azc-bg-disabled{background-color:#e6e6e6}.fxs-mode-light .azc-bg-inverted{background-color:#4d4d4d}.fxs-mode-light .azc-bg-hover-muted:hover{background-color:grey}.fxs-mode-light .azc-br-muted{border-color:#ccc}.fxs-mode-light .azc-br-muted-80-10{border-color:#333}.fxs-mode-light .azc-br-active{border-color:#252525}.fxs-mode-light .azc-br-strong{border-color:grey}.fxs-mode-light .azc-br-focused,.fxs-mode-light .azc-br-focused.azc-br-edited,.fxs-mode-light .azc-br-focused.fxs-br-dirty,.fxs-mode-light .azc-br-focused.fxs-br-error,.fxs-mode-light .azc-br-hovered,.fxs-mode-light .azc-br-selected{border-color:#0058ad}.fxs-mode-light .azc-br-top-hovered{border-top-color:#0058ad}.fxs-mode-light .azc-br-bottom-hovered{border-bottom-color:#0058ad}.fxs-mode-light .azc-br-inverted{border-color:#4d4d4d}.fxs-mode-light .azc-stroke-muted{stroke:grey}.fxs-mode-light .azc-stroke-heavy{stroke:#666}.fxs-mode-light .azc-stroke-default{stroke:#fff}.fxs-mode-light .azc-stroke-selected{stroke:#0058ad}.fxs-mode-light .azc-fill-default,.fxs-mode-light svg.azc-fill-default{fill:#fff}.fxs-mode-light .azc-fill-heavy,.fxs-mode-light .azc-fill-hovered-heavy:hover{fill:#666}.fxs-mode-light .azc-fill-text{fill:#252525}.fxs-mode-light .azc-fill-hover{fill:#d9e6f3}.fxs-mode-light .azc-fill-selected{fill:#b3cde6}.fxs-mode-light .azc-fill-primary svg{fill:#0058ad}.fxs-mode-light .azc-scrollbar-default,.fxs-mode-light .azc-scrollbar-default:hover{-ms-scrollbar-track-color:#e6e6e6;-ms-scrollbar-face-color:#b3b3b3}.fxs-mode-light .azc-scrollbar-default::-webkit-scrollbar,.fxs-mode-light .azc-scrollbar-default:hover::-webkit-scrollbar{background:0 0}.fxs-mode-light .azc-scrollbar-default::-webkit-scrollbar-track-piece,.fxs-mode-light .azc-scrollbar-default:hover::-webkit-scrollbar-track-piece{background:0 0}.fxs-mode-light .azc-scrollbar-default::-webkit-scrollbar-thumb,.fxs-mode-light .azc-scrollbar-default:hover::-webkit-scrollbar-thumb{background:#b3b3b3}.fxs-mode-light .azc-text-muted{color:#757575}.fxs-mode-light .azc-text-console{color:#e6e6e6}.fxs-mode-light .azc-text-primary,.fxs-mode-light a.azc-text-primary{color:#0058ad}.fxs-mode-light .azc-text-disabled,.fxs-mode-light a.azc-text-disabled{color:#929292}.fxs-mode-light .azc-text-inverted{color:#fff}.fxs-mode-light .azc-fill-disabled svg{fill:#929292!important}.fxs-mode-light .fxc-grid2.fxs-grid-selection tbody td.fxc-grid-activatable{color:#015cda}.fxs-mode-light .fxc-grid2.fxs-grid-selection.fxc-pseudoHover tbody tr.fxc-grid-row:not([aria-disabled=true]):not(.fxs-portal-selected):not(.fxs-portal-activated){background-color:rgba(85,179,255,.1)}.fxs-mode-light .fxc-grid2.fxs-grid-selection.fxc-pseudoHover tbody tr.fxc-grid-row:not([aria-disabled=true])~tr.fxc-grid-row:not([aria-disabled=true]):not(.fxs-portal-selected):not(.fxs-portal-activated):not(:hover),.fxs-mode-light .fxs-blade-has-activation .fxc-grid2.fxs-grid-selection tr:not(.fxs-portal-activated){background-color:transparent}.fxs-mode-light .fxs-blade-has-activation .fxc-grid2.fxs-grid-selection .fxs-portal-activated{background-color:rgba(85,179,255,.2)}.fxs-mode-light .msportalfx-bg-muted-5{background-color:#f2f2f2}.fxs-mode-light .msportalfx-bg-muted{background-color:#e6e6e6}.fxs-mode-light .msportalfx-bg-default{background-color:#fff}.fxs-mode-light .msportalfx-text-default{color:#252525}.fxs-mode-light .msportalfx-text-white{color:#fff}.fxs-mode-light .msportalfx-text-muted-50{color:#444}.fxs-mode-light .msportalfx-fill{fill:#252525}.fxs-mode-light .msportalfx-bgcolor-paletteLightGray{background-color:#e6e6e6}.fxs-mode-light .msportalfx-highlight{color:#000;background-color:#fff100}.fxs-mode-light .msportalfx-brdr-color:hover,.fxs-mode-light .msportalfx-brdr-selected{border-color:#00bcf2}.fxs-mode-light .msportalfx-border{border-color:#bbb}.fxs-mode-light .msportalfx-text-primary{color:#015cda}.fxs-mode-light .msportalfx-link-primary{color:#015cda!important;fill:#015cda}.fxs-mode-light .fxs-graph-fill{fill:#fff!important}.fxs-mode-light .azc-dockedballoon-validation{border-color:rgba(127,127,127,.7)}.fxs-mode-light .azc-has-focus .azc-dockedballoon-validation{border-color:#0058ad}.fxs-mode-light .fxs-bladestyle-create .msportalfx-form .fxs-br-dirty{border-color:#bbb}.fxs-mode-light .fxs-bladestyle-create .msportalfx-form .fxs-br-dirty.azc-br-focused{border-color:#0058ad}.fxs-mode-light .fxs-bladestyle-create .msportalfx-form .azc-is-edited .azc-dockedballoon-validation{border-color:#bbb}.fxs-mode-light .azc-validation-messages,.fxs-mode-light .fxs-text-error,.fxs-mode-light .msportalfx-text-error{color:#b40e1b}.fxs-mode-light .fxs-portal-selected.azc-bg-disabled{background-color:#acd6e2}.fxs-mode-light .fxs-button-default{background-color:#fff;border-color:#015cda;color:#015cda;fill:#015cda}.fxs-mode-light .fxs-button-default .fxs-button-icon .fxs-portal-svg{fill:#015cda}.fxs-mode-light .fxs-button-default:hover{color:#016afe;fill:#016afe;border-color:#016afe;background-color:rgba(127,127,127,.1)}.fxs-mode-light .fxs-button-default:hover .fxs-button-icon .fxs-portal-svg{fill:#016afe}.fxs-mode-light .fxs-button-default:active{color:#014db7;fill:#014db7;border-color:#014db7;background-color:rgba(127,127,127,.1)}.fxs-mode-light .fxs-button-default:active .fxs-button-icon .fxs-portal-svg{fill:#014db7}.fxs-mode-light .fxs-portal-button-primary{background-color:#015cda;border-color:#015cda;color:#fff;fill:#fff}.fxs-mode-light .fxs-portal-button-primary .fxs-button-icon .fxs-portal-svg{fill:#fff}.fxs-mode-light .fxs-portal-button-primary:hover{background-color:#016afe;border-color:#016afe}.fxs-mode-light .fxs-portal-button-primary:active{background-color:#014db7;border-color:#014db7}.fxs-mode-light .fxs-button-disabled,.fxs-mode-light .fxs-button-disabled:active,.fxs-mode-light .fxs-button-disabled:focus,.fxs-mode-light .fxs-button-disabled:hover{cursor:default;background-color:rgba(127,127,127,.1);border-color:transparent;outline:0;color:rgba(127,127,127,.7);fill:rgba(127,127,127,.7)}.fxs-mode-light .fxs-button-disabled .fxs-button-icon .fxs-portal-svg{fill:rgba(127,127,127,.7)}.fxs-mode-light .fxs-button-disabled:active .fxs-button-icon .fxs-portal-svg,.fxs-mode-light .fxs-button-disabled:focus .fxs-button-icon .fxs-portal-svg,.fxs-mode-light .fxs-button-disabled:hover .fxs-button-icon .fxs-portal-svg{fill:rgba(127,127,127,.7)}.fxs-mode-light .fxs-portal-button-primary.fxs-portal-optionPicker-dirty{background-color:#68217a;border-color:#68217a}.fxs-mode-light .fxs-button-default.fxs-portal-optionPicker-dirty{border-color:#68217a;color:#68217a}.fxs-mode-light .fxs-button-default.fxs-portal-optionPicker-disabled{background-color:#fff;border-color:rgba(127,127,127,.7);color:rgba(127,127,127,.7)}.fxs-mode-light .fxs-portal-button-primary.fxs-portal-optionPicker-disabled{border-color:rgba(127,127,127,.7);color:rgba(127,127,127,.7)}.fxs-mode-light .azc-radio-circle{border-color:#7f7f7f;background-color:#fff}.fxs-mode-light .azc-noRadio .azc-radio-circle:active,.fxs-mode-light .azc-noRadio .azc-radio-circle:hover{border-color:#161616}.fxs-mode-light input[type=radio]:checked~.azc-radio-circle:after{background-color:#015cda}.fxs-mode-light .azc-radio .fxs-portal-optionPicker-disabled{color:rgba(127,127,127,.7)}.fxs-mode-light .azc-radio .fxs-portal-optionPicker-disabled .azc-radio-circle{border-color:rgba(127,127,127,.7)}.fxs-mode-light .azc-radio .fxs-portal-optionPicker-disabled input[type=radio]:checked~.azc-radio-circle:after{background-color:rgba(127,127,127,.7)}.fxs-mode-light .azc-checkBox{border-color:#7f7f7f;background-color:#fff}.fxs-mode-light .azc-checkBox:active,.fxs-mode-light .azc-checkBox:hover{border-color:#161616}.fxs-mode-light .azc-checkBox.azc-control-disabled,.fxs-mode-light .azc-input{border-color:rgba(127,127,127,.7)}.fxs-mode-light .azc-checkBox.azc-control-disabled .azc-checkBox-svg{fill:rgba(127,127,127,.7)}.fxs-mode-light .azc-checkBox.azc-control-disabled .azc-disabled{background-color:#fff}.fxs-mode-light .azc-checkBox .azc-checkBox-svg{fill:#015cda}.fxs-mode-light .azc-text-label,.fxs-mode-light .azc-text-sublabel{color:#595959}.fxs-mode-light .msportalfx-form-formelement-disabled .azc-text-label,.fxs-mode-light .msportalfx-form-formelement-disabled .azc-text-sublabel{color:rgba(127,127,127,.7)}.fxs-mode-light .azc-disabled,.fxs-mode-light .azc-disabled:focus,.fxs-mode-light .azc-disabled:hover,.fxs-mode-light input.azc-disabled{color:rgba(127,127,127,.7);background-color:rgba(127,127,127,.1);border-color:rgba(127,127,127,.7);fill:rgba(127,127,127,.1)}.fxs-mode-light .azc-control ::-webkit-input-placeholder{color:rgba(127,127,127,.7)}.fxs-mode-light .azc-control ::-moz-placeholder{color:rgba(127,127,127,.7)}.fxs-mode-light .azc-control :-ms-input-placeholder{color:rgba(127,127,127,.7)}.fxs-mode-light .fxs-copyfield .fxc-copyablelabel-copyimage{fill:#252525}.fxs-mode-light .fxc-tabs-container.fxc-tabs-block>.fxc-tabs-itemslist li.azc-br-active{border-bottom-color:#fff!important}.fxs-mode-light .fxs-bladestyle-create .msportalfx-form .azc-optionPicker li.fxs-bg-dirty{background-color:rgba(85,179,255,.2)!important}.fxs-mode-light .azc-br-focused{border-color:#0058ad!important}")}));
define("_generated/Less/MsPortalImpl/Themes/Themes.Reset.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,':link img,:visited img,a img,fieldset,img,legend{border:0}body,fieldset,legend{margin:0;padding:0}img,svg{overflow:hidden}.fxs-display-none{display:none!important}.fxs-hide-accessible-label{overflow:hidden;position:fixed;top:-1000px;left:-1000px;width:0;height:0}a,abbr,acronym,address,applet,article,aside,audio,b,big,blockquote,body,canvas,caption,center,cite,code,dd,del,details,dfn,div,dl,dt,em,embed,fieldset,figcaption,figure,footer,form,h1,h2,h3,h4,h5,h6,header,hgroup,html,i,iframe,img,ins,kbd,label,legend,li,mark,menu,nav,object,ol,output,p,pre,q,ruby,s,samp,section,small,span,strike,strong,sub,summary,sup,table,tbody,td,tfoot,th,thead,time,tr,tt,u,ul,var,video{font-size:100%;font-weight:inherit}code,p,pre{font-size:12px}body,button,input,p,select,textarea{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_normal,"Segoe WP",Tahoma,Arial,sans-serif;font-weight:400}body,html{height:100%}[type=button],[type=reset],[type=submit],button{font-size:12px;background:0 0;color:inherit}img{max-height:100%;max-width:100%}[contentEditable=true]:not([tabindex="-1"]):focus,[tabindex="0"]:focus,a[href]:not([tabindex="-1"]):focus,area[href]:not([tabindex="-1"]):focus,button:not([disabled]):not([tabindex="-1"]):focus,iframe:not([tabindex="-1"]):focus,input:not([disabled]):not([tabindex="-1"]):focus,select:not([disabled]):not([tabindex="-1"]):focus,textarea:not([disabled]):not([tabindex="-1"]):focus{outline-offset:-1px}tbody tr[tabindex]:not([tabindex=\'-1\']):focus{box-shadow:none}a{text-decoration:none}p{line-height:18px}b,strong{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_bold,"Segoe UI Bold","Segoe WP Bold","Segoe WP",Tahoma,Arial,sans-serif;font-weight:700}code,pre{font-family:Consolas,"Courier New",monospace}textarea{overflow:auto}hr{border-width:1px 0 0;border-top-style:solid}[data-bind*=fxClick],[data-bind*=fxclick],[role=link],[role=button]{cursor:pointer}@-moz-document url-prefix(http){::-moz-placeholder{opacity:1}::-moz-focus-inner{border:0;padding:0}button:focus,input[type=button]:focus{outline-width:1px;outline-style:dashed}}@supports (outline-offset:-1px){:focus{outline:#00bcf2 dashed 1px}}')}));
define("MsPortalImpl/Base/Themes",["require","exports","f","ko","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Telemetry","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Services/Services.GeneralSettings","_generated/Less/MsPortalImpl/Themes/Themes.Reset.css","_generated/Less/MsPortalImpl/Themes/Themes.Blue.css","_generated/Less/MsPortalImpl/Themes/Themes.LightMode.css"],(function(n,t,i,r,u,f,e,o){"use strict";var s;return (function(t){function ht(n,t,i,r){return new w(n,t,i,r)}function h(n,t,i,r,u){return{colorCode:n,imageUri:b.getContentUri(it+t),name:i,title:r,mode:u}}function c(n,t,i){d({source:n,action:t,data:i})}var b=i.Base.Resources,k=i.Base.Diagnostics.Telemetry,d=k.trace,w;t.extLightClass="ext-mode-light";t.extDarkClass="ext-mode-dark";t.extHcActiveClass="ext-mode-highcontrast";t.extHcLightClass="ext-highcontrast-light";t.extHcDarkClass="ext-highcontrast-dark";var l=window,g="fxs-theme-",nt="fxs-mode-light "+t.extLightClass,tt="fxs-mode-dark "+t.extDarkClass,a="fxs-mode-highcontrast "+t.extHcActiveClass,v="fxs-highcontrast-dark "+t.extHcDarkClass,y="fxs-highcontrast-light "+t.extHcLightClass,s=u.Themes.Names,it="Content/Images/MsPortalImpl/Themes/",p="_generated/Less/MsPortalImpl/Themes/Themes.{0}.css",rt="(-ms-high-contrast: active)",ut="(-ms-high-contrast: black-on-white)",ft="(-ms-high-contrast: white-on-black)",et=window.fx.environment,ot={name:"HighContrastMode",mode:1},st={name:"HighContrastMode",mode:0};t.createManager=ht;w=(function(){function t(n,t,i,u){var p=this,et=h("#f1f1f8","Theme_Light.png","light",s.light,0),ht=h("#333","Theme_Dark.png","dark",s.dark,1),ct=this._themes=[h("#0078d6","Theme_Azure.png","azure",s.azure,0),h("#215b7d","Theme_Blue.png","blue",s.blue,0),et,ht,],w=ct.map((function(n){return n.name})).indexOf((i()||this.getDefaultTheme()).name),d,b,lt,at,it,k;~w||(w=1);this.currentTheme=i;i(ct[w]);this.highContrastMode=u;this._themeIndex=w;r.explicitComputed(n,[i,u],(function(){var n=i(),s,h;n=n||p._themes[p._themeIndex=0];var r=u(),e=r!==0,f=r===2,o=r===1;e&&(n=f?ht:et);s=p._injectStyles(n);h=f?p._injectStyles(ot):o?p._injectStyles(st):Q({});Q.all([h,s]).then((function(){var i=n.mode?tt:nt;t.removeClass(d).addClass(d=g+n.name+" "+i).toggleClass(a,e).toggleClass(v,f).toggleClass(y,o)}))}));c(f.Source.Shell,f.Action.SelectedTheme,i().name);u()!==0&&c(f.Source.Shell,f.Action.SelectedHighContrastMode,u());u.subscribe(n,(function(){c(f.Source.Shell,f.Action.SelectedHighContrastMode,u())}));t.on(e.default.fxrotatetheme,(function(){var n,t;o.settings.dblClickThemeEnabledKey()&&(n=i().name,p.rotateTheme(),t=i().name,c(f.Source.Shell,f.Action.RotateTheme,{fromTheme:n,toTheme:t}))}));it=[b=l.matchMedia(rt),lt=l.matchMedia(ut),at=l.matchMedia(ft),];k=function(){lt.matches?u(1):at.matches||b.matches?u(2):u(0)};b.media!=="not all"&&(it.forEach((function(n){return n.addListener(k)})),b.matches&&k());n.registerForDispose((function(){t.off(e.default.fxrotatetheme).removeClass(d+" "+a+" "+v+" "+y);it.forEach((function(n){return n.removeListener(k)}))}))}return t.prototype.getThemes=function(){return this._themes},t.prototype.rotateTheme=function(){var n=this._themes,t=this._themeIndex=((this._themeIndex||0)+1)%n.length;this.currentTheme(n[t])},t.prototype.getDefaultTheme=function(){var t=et.chrome.defaultTheme,n;return t&&(n=this._themes.filter((function(n){return n.name===t})),n&&n.length>0)?n[0]:this._themes[1]},t.prototype._injectStyles=function(t){var r=t.name,u=t.mode,f=r.charAt(0).toUpperCase()+r.slice(1),e=u?"DarkMode":"LightMode",o=[p.format(f),p.format(e),];return Q.all(o.map((function(t){return i.require(t,n)})))},t})()})(s||(s={})),s}));
define("MsPortalImpl/Base/Base.CssSanitizer",["require","exports","f","o","a","MsPortalImpl/Base/Base.Sanitization","MsPortalImpl/Base/Base.CssSelectorParser","MsPortalImpl/Base/Themes","MsPortalImpl/Base/Base.BrowserDetection","MsPortalImpl/Base/Base.ImplUtils"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";function p(n){return n==="cssFloat"?"float":(n||"").replace(/([A-Z])/g,"-$1").toLowerCase()}function tt(n){var t=n.toLowerCase().match(nt).reduce((function(n,t,i){return i>0?(t=t.charAt(0).toUpperCase()+t.slice(1),n+t):n+t}));return t==="float"&&(t="cssFloat"),t}function w(n){return"css-scope-"+n.replace(g,"")}function it(t){var r="."+w(t.name),i=[];return t.styleSheets=(t.styleSheets||[]).map((function(n){return b(n,r,i)})),i.forEach((function(i){var r="Sanitization error found in style sheet in extension: {0}\nInvalid CSS property - {1}\nCSS rule: {2}".format(t.name,i.errorMessage,i.rule.cssText);h.logToExtension(n,t.name,2,r)})),!i.length}function rt(n,t,i){t.insertRule(".ignored1 { {0} }".format(n),0);t.insertRule(".ignored2 {}",1);var r=t.cssRules[0],u=t.cssRules[1];return r.type===CSSRule.STYLE_RULE?(d(r.style,u,i),u.style.cssText):(i.push("Not a style rule: "+n),null)}function b(n,t,r){var u=document.implementation.createHTMLDocument(""),e=u.createElement("style");u.body.appendChild(e);var s=st(n,u),h=s.filter((function(n){return n.type===CSSRule.STYLE_RULE})),c=h.map((function(n){var i=ut(n,e.sheet,t,r);return i?i.cssText:null})),f=c.join("\n");return[o.extLightClass,o.extDarkClass,o.extHcActiveClass,o.extHcLightClass,o.extHcDarkClass].forEach((function(n){var r=["{0} {1}","{1} {0}"].map((function(i){return i.format(t,"."+n)}));f=i.replaceAll(f,r[0],r[1])})),f}function k(n,t,i){i.push.apply(i,n.map((function(n){return{rule:t,errorMessage:n}})))}function ut(n,t,i,r){var e=[],o=ft(n.selectorText,i,e),u,f;return k(e,n,r),o?(t.insertRule(o+" {}",0),u=t.cssRules[0],f=[],d(n.style,u,f),k(f,n,r),u):null}function d(n,i,r){for(var o,c,l=ct(n),h=0,v=l.length;h<v;h++){var f=l[h],e=n.getPropertyValue(f),y=n.getPropertyPriority(f);if(e!=="initial"){var p=ot(y,r),a=null,s=null;t.stylePolicy.hasOwnProperty(f)?(a=f,o=t.stylePolicy[f],o===1?s=e:o instanceof u?(c=o.indexOf(e),c>=0&&(s=o[c])):typeof o=="function"&&o(e)&&(s=e),s?i.style.setProperty(f,e,p):r.push("Disallowed style value. Property name: {0}, value: {1}".format(a,e))):r.push("Disallowed style property. Property name: "+f)}}}function ft(n,t,i){var r,u=[];try{r=e.parseCssSelector(n)}catch(f){return i.push("Malformed selector: "+n+"\nException: "+f.toString()),null}return r.forEach((function(n){et(n,i)&&u.push(t+" "+e.subselectorToString(n))})),u.join(", ")}function et(n,t){return!n.some((function(n){if(n.type==="CLASS"){if(n.value&&!i.startsWith(n.value,".ext-")&&!i.startsWith(n.value,".fxt-"))return t.push("Selectors can only refer to extension-specific class names (those starting with .ext- or .fxt-)"),!0}else if(n.type==="ID")return t.push("Selectors cannot refer to elements by ID"),!0}))}function ot(n,t){return n?(t.push("Disallowed CSS priority value: "+n),""):n}function st(n,t){var i=t.createElement("style");t.body.appendChild(i);i.type="text/css";i.textContent=n;var r=i.sheet,f=r&&r.cssRules;return f?u.prototype.slice.call(f,0):[]}function ht(n){return n==="none"||n==="uppercase"||n==="lowercase"}function l(n,t){t.forEach((function(t){n[t]=1}))}function ct(n){for(var i,u=[],r=0,f=n.length;r<f;r++)if(i=n[r],!a[i]){if(c[i]&&!(i in t.stylePolicy))return lt(n);u.push(i)}return u}function lt(n){for(var i,r=[],t=y.length-1;t>=0;t--)i=y[t],n[i]&&r.push(p(i));return r}var v,c,a;r.defineProperty(t,"__esModule",{value:!0});v=["align-content","align-items","align-self","background","background-attachment","background-clip","background-color","background-image","background-origin","background-position","background-repeat","background-size","border","border-bottom","border-bottom-color","border-bottom-left-radius","border-bottom-right-radius","border-bottom-style","border-bottom-width","border-collapse","border-color","border-left","border-left-color","border-left-style","border-left-width","border-image-outset","border-image-repeat","border-image-slice","border-image-source","border-image-width","border-radius","border-right","border-right-color","border-right-style","border-right-width","border-spacing","border-style","border-top","border-top-color","border-top-left-radius","border-top-right-radius","border-top-style","border-top-width","border-width","bottom","box-shadow","box-sizing","clear","clip-path","color","content","counter-increment","counter-reset","cursor","display","fill","fill-rule","fill-opacity","filter","flex","flex-basis","flex-direction","flex-flow","flex-grow","flex-shrink","flex-wrap","float","font-size","font-stretch","font-style","font-variant","font-weight","height","justify-content","left","line-height","list-style-position","list-style-type","margin","margin-left","margin-top","margin-right","margin-bottom","max-height","max-width","min-height","min-width","opacity","order","outline","outline-color","outline-style","outline-width","overflow","overflow-x","overflow-y","padding","padding-top","padding-left","padding-right","padding-bottom","pointer-events","right","stop-color","stop-opacity","stroke","stroke-dasharray","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","table-layout","text-align","text-decoration","text-transform","text-overflow","top","transform","transform-origin","transition","transition-delay","transition-duration","transition-property","transition-timing-function","vertical-align","visibility","white-space","width","word-break","word-wrap",];t.stylePolicy={};v.forEach((function(n){t.stylePolicy[n]=1}));t.stylePolicy.position=["relative","absolute","static","inherit"];t.stylePolicy["text-transform"]=ht;var g=/\W/g,nt=/[a-z|A-Z]+/g,y=r.keys(t.stylePolicy).map(tt);t.domStylePropertyToCssProperty=p;t.getScopeName=w;t.sanitizeDefinition=it;t.sanitizeStyleDeclarationString=rt;t.sanitizeStyleSheetText=b;c={};l(c,["background-position-x","background-position-y",]);s.isChrome||s.isSafari?l(c,["background-repeat-x","background-repeat-y","font-variant-alternate","font-variant-caps","font-variant-east-asian","font-variant-ligatures","font-variant-numeric","text-decoration-color","text-decoration-line","text-decoration-style","-webkit-border-horizontal-spacing","-webkit-border-vertical-spacing",]):s.isFirefox&&l(c,["-moz-border-top-colors","-moz-border-right-colors","-moz-border-bottom-colors","-moz-border-left-colors","font-variant-caps","font-variant-ligatures","font-variant-numeric","font-variant-position","overflow-wrap","text-decoration-color","text-decoration-line","text-decoration-style",]);a={};s.isIe&&l(a,["enable-background","list-style-image",])}));
define("MsPortalImpl/Base/Base.KnockoutBindingSanitizer",["require","exports","ko","MsPortalImpl/Base/Base.CssSanitizer","MsPortalImpl/Base/Base.Sanitization","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u,f){"use strict";var e;return (function(n){function d(n){return k[n]||n}function a(n,r,u,f,e){var s=[],c=i.expressionRewriting.parseObjectLiteral(r),o=!0;return c.forEach((function(i){var c=(i.key||"").trim(),l=d(c),r=b[l],a,y;r||l.substring(0,h.length)!==h||(r=t);r?(a=(i.value||"").trim(),y=r(a,f),y!==null?s.push(v(l)+": "+y):(o=!1,e.push({provenanceContext:n,reason:6,tag:u,binding:c,val:a}))):(o=!1,e.push({provenanceContext:n,reason:5,tag:u,binding:c}))})),o?s.join(", "):null}function nt(n,t,i,r){var f=/^\s*ko\s([\s\S]*)/.exec(t),u;return f?(u=a(n,f[1],"comment",i,r),u===null?" ko ":" ko "+u+" "):/^\s *\/ko/.test(t)?" /ko ":null}function v(n){return n&&!l.exec(n)&&(g.exec(n)||(n="'"+n.replace("'","\\'")+"'")),n}function t(n){var r=e(n),t,i;if(r!==null)return r;for(t=0;t<c.length;t++)if(i=n.split(c[t]),i.length===2&&e(i[0].trim())&&e(i[1].trim()))return n;return null}function tt(n,i,u){var h=r.domStylePropertyToCssProperty(n),f=u.style[h],e=l.exec(i),s=e?i.slice(1,-1):null,o=!1;return f===1?o=!!e||t(i)===i:f instanceof Array?o=!!e&&f.includes(s):typeof f=="function"&&(o=!!e&&f(s)),o}function e(n){return/^\!?([\$_a-z0-9\.'\-"\[\]]|\(\))+$/i.test(n)||/^\{\s*\}$/.test(n)?n:null}function o(n){return y(n,(function(n,i){return!!t(i)}))}function y(n,t){return function(r,u){var o=i.expressionRewriting.parseObjectLiteral(r),f=[],e=!0;return o.forEach((function(i){var r=(i.key||"").trim(),o=(i.value||"").trim();n(r,u)&&t(r,o,u)?f.push(v(r)+": "+o):e=!1})),e?"{ "+f.join(", ")+" }":null}}function p(n){return o((function(t){return n.includes(t)}))}function w(n){return/^"[^"]*"$/.test(n)||/^'[^']*'$/.test(n)?n:null}function it(n){return function(t){var i=!!n.first((function(n){return t==='"'+n+'"'||t==="'"+n+"'"}));return i?t:null}}function s(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return function(n,i){for(var u,r=0;r<t.length;r++)if(u=t[r](n,i),u!==null)return u;return null}}var u=s(t,o((function(){return!0}))),b={checked:t,click:t,clickBubble:t,commands:s(t,o((function(){return!0}))),disable:t,enable:t,event:p([f.default.click,"keypress","afterkeypress"]),foreach:s(t,p(["data","as"])),formElement:u,fxclick:t,fxParameterCollector:t,htmlTemplate:u,"if":t,ifnot:t,image:t,options:t,optionsText:w,optionsValue:w,sanitizedAttr:u,sanitizedCss:u,sanitizedHtml:t,selectedOptions:t,style:y((function(n,t){return t.style.hasOwnProperty(r.domStylePropertyToCssProperty(n))}),tt),submit:t,text:t,uniqueName:t,visible:t,value:t,valueUpdate:it(["afterkeyup"]),"with":t},k={attr:"sanitizedAttr",css:"sanitizedCss",html:"sanitizedHtml"},h="pc",c=["===","==","!==","!=","<=","<",">=",">","&&","||","-","+","*","/"],l=/^("([^"\\]|\\.)*"|'([^'\\]|\\.)*')$/,g=/^[a-z_$][a-z0-9_$]*$/i;n.sanitizeBindingAttribute=a;n.sanitizeBindingComment=nt})(e||(e={})),e}));
define("MsPortalImpl/Base/Base.LruMap",["require","exports","f","o","a"],(function(n,t,i,r){"use strict";r.defineProperty(t,"__esModule",{value:!0});var u=(function(){function n(n){this._map=r.create(null);this._count=0;this._lastAccessed=0;this._capacity=n}return n.prototype.count=function(){return this._count},n.prototype.contains=function(n){return!!this._map[n]},n.prototype.trim=function(n){var u=this,t,r;(typeof n!="number"&&(n=this._capacity),t=this.count()-n,typeof n!="number"||t<1)||(r=this._lastAccessed-n+1,i.forEachKey(this._map,(function(n,t,i){t.lastAccessed<r&&i.push(t)}),[]).sort((function(n,t){return t.lastAccessed-n.lastAccessed})).some((function(n){return delete u._map[n.key],t--,t<1})),this._count=n)},n.prototype.getOrAdd=function(n,t){var r=this._map[n],i;if(r)r.lastAccessed=++this._lastAccessed,i=r.data;else if(t)i=t(n),this.addOrUpdate(n,i);else throw new Error("Unable to find item with key: '"+n+"'.");return i},n.prototype.addOrUpdate=function(n,t,i){var r=this._map[n];return r?(r.data=t,r.lastAccessed=++this._lastAccessed):(this._map[n]={key:n,data:t,lastAccessed:++this._lastAccessed},this._count++,i||this.trim()),!r},n.prototype.remove=function(n){this._map[n]&&(this._count--,delete this._map[n])},n})();t.LruMap=u}));
define("MsPortalImpl/Base/Base.KnockoutTemplateSanitizer",["require","exports","f","o","MsPortalImpl/Base/Base.KnockoutBindingSanitizer","MsPortalImpl/Base/Base.CssSanitizer","MsPortalImpl/Base/Base.Sanitization","MsPortalImpl/Base/Base.LruMap"],(function(n,t,i,r,u,f,e,o){"use strict";function y(n,t,i,r){var u=i&&i.htmlTemplateInline;u&&l(n,t,u,r,(function(){u.content=null}))}function nt(n,t,i){(t.lenses||[]).forEach((function(r){(r.partInstances||[]).forEach((function(r){y(n,t.name+"/"+r.name,r.inline,i)}))}))}function tt(n,t){var r=n.name;i.forEachKey(n.htmlTemplates,(function(i,u){l(r,i,u,t,(function(){delete n.htmlTemplates[i]}))}));(n.partsCatalog||[]).forEach((function(n){var i=n.htmlTemplateInline;i&&l(r,""+n.name,i,t,(function(){i.content=null}))}))}function l(i,r,u,f,e){var o=t.sanitizeHTML({value:u.content,localRequire:n,windowContext:i,contextData:{File:u.file,TemplateKey:r}}),s=!o.errors.length,h=s||f===0;h?u.content=o.sanitizedMarkup:e()}function it(n,t){function rt(i,r,u,f,e,o){if(!t&&i===s.validateKOBindingString)return null;if(i===1)return r;if(typeof i=="object")return r in i?r:null;if(i instanceof Function){var c=i(r,u,f,e,h,o,n);return typeof c=="boolean"?c===!0?r:null:typeof c=="string"?c:null}return null}function g(t,r,u){var f,s;if(typeof u=="object")for(f in u)if(s=u[f],t.hasAttribute(f)&&!r.hasAttribute(f)){var h=t.getAttribute(f),e=[],o=rt(s,h,t.nodeName.toUpperCase(),f,r,e);o!==null&&r.setAttribute(f,o);e.length>0?e.forEach((function(n){i.push(n)})):o===null&&i.push({provenanceContext:n,reason:1,tag:t.nodeName.toUpperCase(),attr:f,val:h})}}function nt(e,o){var c=e.nodeName.toUpperCase(),s,y,p,rt,l,a,ft,v,tt;e.nodeType===Node.ELEMENT_NODE&&(b||(b=e!==r.body))&&(w[c]?(s=document.createElement(c),g(e,s,w[c]),g(e,s,it),y=e.getAttribute("style"),y&&(p=[],rt=f.sanitizeStyleDeclarationString(y,d,p),p.forEach((function(t){i.push({provenanceContext:n,reason:3,tag:c,attr:"style",val:t})})),s.setAttribute("style",rt)),o.appendChild(s),o=s):i.push({provenanceContext:n,reason:4,tag:c}));for(var k=0,ut=e.childNodes,et=ut.length;k<et;k++){l=ut[k];switch(l.nodeType){case Node.TEXT_NODE:o.appendChild(document.createTextNode(l.textContent));break;case Node.ELEMENT_NODE:nt(l,o);break;case Node.COMMENT_NODE:a=h.comments;ft=!t&&a===u.sanitizeBindingComment;!ft&&a&&a instanceof Function&&(v=[],tt=a(n,l.textContent,h,v),tt!==null&&o.appendChild(document.createComment(tt)),v.length>0&&v.forEach((function(n){i.push(n)})))}}return o}var r=document.implementation.createHTMLDocument(""),tt=document.createDocumentFragment(),a=document.createElement("div"),p=h.elements,w=p.tags,it=p.global,i=[],b=!1,y=n.value,o,d,l;return tt.appendChild(a),v.forEach((function(n){y=k(y,n,c+n)})),r.body.innerHTML=y||"",o=r.createElement("style"),o.setAttribute("type","text/css"),r.head.appendChild(o),d=o.sheet,nt(r.body,a),i.forEach(e.logError),l=a.innerHTML,v.forEach((function(n){l=k(l,c+n,n)})),{sanitizedMarkup:l,errors:i}}function p(n){var t=new o.LruMap(100);return{cache:t,func:function(i,r,u){var f="";return typeof i=="string"?f=i:i&&(f=i.value||""),t.getOrAdd(f,(function(){return i&&typeof i!="string"||(i={value:f,localRequire:r,windowContext:u}),it(i,n)}))}}}function k(n,t,i){if(!n)return n;var r=new RegExp("(\\s+)"+t+"(\\s*\\=)","g");return n.replace(r,"$1"+i+"$2")}function d(n,t){var i={};return i[c+n]=t,i}var h,w,b;r.defineProperty(t,"__esModule",{value:!0});var g=/^(msportalfx|ext-|lang-|fxt-)[_\-a-zA-Z0-9]+$/,a=i.getUniqueId().toLowerCase(),s={validateLinkUri:e.validateLinkUri,validateUriOrBlank:e.validateUriOrBlank,validateLocalUriOnly:e.validateLocalUriOnly,validateClassNames:function(n,i,r,u,f,e,o){for(var l=/[_\-a-z0-9]+/ig,h,c=[],s;h=l.exec(n);)s=h[0],t.isAllowedCssClassName(s)?c.push(s):e.push({provenanceContext:o,reason:2,tag:i,val:s});return c.join(" ")||null},validateKOBindingString:function(n,t,i,r,f,e,o){return u.sanitizeBindingAttribute(o,n,t,f,e)},mapName:function(n,t,i,r){return r.setAttribute(i,"TemplateSanitizer"+a+"_"+n),!1}},v=["src",],c="data-sanitizer-"+a+"-";t.sanitizeInlineTemplate=y;t.sanitizeBladeDefinition=nt;t.sanitizeDefinition=tt;t.isAllowedCssClassName=function(n){return typeof n=="string"&&g.test(n)};h=(function(){function i(t){return t.length?n(t):1}function n(n){var t={};return n.forEach((function(n){var u,r;if(typeof n=="string")t[n]=1;else for(u in n)r=n[u],t[u]=r instanceof Function?r:i(r)})),t}var r=["ABBR","ADDRESS","B","BLOCKQUOTE","BR","CAPTION","CITE","CODE","COL","COLGROUP","DD","DEL","DFN","DIV","DL","DT","EM","FIELDSET","H1","H2","H3","H4","H5","H6","HR","I","INS","LABEL","LEGEND","OL","P","PRE","Q","S","SMALL","SPAN","STRONG","SUB","SUP","TABLE","TBODY","TD","TFOOT","TH","THEAD","TR","U","UL",{A:["target",{href:s.validateLinkUri},]},{BUTTON:["value"]},{IMG:[d("src",s.validateUriOrBlank)]},{INPUT:[{type:["text","password","radio","checkbox","submit"]},"checked","maxlength","value"]},{LI:["value"]},{OPTION:["label","selected","value"]},{SELECT:["multiple","size"]},{TEXTAREA:["rows","cols"]},{TIME:["datetime"]},{SVG:["viewBox","focusable",{"xmlns:xlink":s.validateUriOrBlank},{"xmlns:svg":s.validateUriOrBlank},{xmlns:s.validateUriOrBlank}]},{CIRCLE:["r"]},"DEFS","DESC",{ELLIPSE:["id"]},{G:["id"]},{LINE:["id"]},"METADATA",{PATH:["id"]},{POLYGON:["id"]},{POLYLINE:["id"]},{RECT:["id"]},{STOP:["offset"]},{TEXT:["id","font-size"]},"TITLE",{USE:["id",{"xlink:href":s.validateLocalUriOnly}]},{VIDEO:["controls","poster"]},{SOURCE:[d("src",s.validateUriOrBlank),"type"]},],o=(t=[{"data-bind":s.validateKOBindingString},{"class":s.validateClassNames},{name:s.mapName},"data-click-telemetry",{"data-activatable":["true","false"]},"data-activate-info",]).concat.apply(t,e.getWhitelistedAttr()),t;return{style:f.stylePolicy,elements:{tags:n(r),global:n(o)},comments:u.sanitizeBindingComment}})();w=p(!0);b=p(!1);t.sanitizeHTML=w.func;t.sanitizeHtmlWithoutKOBindings=b.func}));
define("MsPortalImpl.Controls/Controls/Base/WidgetBinding",["require","exports","f","o","ko"],(function(n,t,i,r,u){"use strict";function c(n,t){var i;return f(n)||(i=u.unwrap(n)),f(i)?t:i}function l(n,t){var r=s([n.$disabled,t.$disabled]),i=y([n.$tabIndex,t.$tabIndex],[t.$disabled]),f=u.pureComputed((function(){return i()===null?null:-1}));return{$disabled:r,$tabIndex:i,$focusIndex:f}}function e(n){return u.contextFor($(n)[0])}function o(n){return new u.bindingContext(n)}function p(n,t){return o(n).extend({$disabled:t.$disabled,$tabIndex:t.$tabIndex,$focusIndex:t.$focusIndex})}function a(n,t,i,r){var u=r||e(n);return u=u?u.createChildContext(t):o(t),i&&(u=u.extend(i)),u}function v(n,t){var i=l(n,t);return n.extend(i)}function w(n){var t=e(n);return t||(t=o(null)),f(t.$disabled)&&(t=t.extend({$disabled:u.pureComputed(i.wrap(!1))})),f(t.$tabIndex)&&(t=t.extend({$tabIndex:u.pureComputed(i.wrap(0))})),f(t.$focusIndex)&&(t=t.extend({$focusIndex:u.pureComputed(i.wrap(-1))})),t}function s(n){return u.pureComputed((function(){for(var r,t=!1,i=0;i<n.length;i++)r=c(n[i],!1),t=t||r;return t}))}function y(n,t){var i=s(t);return u.pureComputed((function(){for(var r,f=i(),t=0,u=0;u<n.length;u++)r=c(n[u],0),t===null||r===null?t=null:f||t<0||r<0?r<0?t=r:t<0||(t=-1):t=r;return t}))}var f,h;r.defineProperty(t,"__esModule",{value:!0});f=i.isUndefined;t.getContext=e;t.createIsolatedContext=p;t.createChildContext=a;t.createChainedContext=v;t.contextFor=w;t.chainDisabledProperties=s;t.chainTabindexProperties=y;u.bindingHandlers.context={init:function(){return{controlsDescendantBindings:!0}},update:function(n,t,i,r,f){var e=u.unwrap(t()),o=u.ignoreDependencies((function(){var t=l(f,e);return a(n,r,t,f)}));u.applyBindingsToDescendants(o,n)}};u.virtualElements.allowedBindings.context=!0;h=u.bindingHandlers.template;u.bindingHandlers.template={init:function(n,t,i,r,u){return h.init(n,t,i,r,u)},update:function(n,t,i,r,f){var l=t(),e=u.unwrap(l),o,s,c;return e=typeof e=="string"?{name:l}:u.utils.extend({},e),o=e.context,o&&(f=u.ignoreDependencies((function(){return typeof o=="function"&&(o=o(e.data||r)),v(f,o)})),delete e.context),s=f.$ctl,c=s&&s.templateEngine,c&&e.name&&!e.templateEngine&&(e.templateEngine=c),t=function(){return e},h.update(n,t,i,r,f)}}}));
define("Viva.Controls/Controls/Base/Viva.KnockoutExtensions",["require","exports","f","ko","MsPortalImpl.Controls/Controls/Base/WidgetBinding"],(function(n,t,i,r,u){"use strict";var f;return (function(){function f(t){return function(i,u,f,e,s){var c=r.unwrap(u()),l,y,a,v,h;if(c&&(l=c.text,y=c.visible,a=c.disabled,v=c.handler),!c||!l||!y||!a||!v||!c.execute)throw new Error("Command");h=n.text[t];h&&h(i,(function(){return l}),f,e,s);h=n.value[t];h&&h(i,(function(){return l}),f,e,s);h=n.visible[t];h&&h(i,(function(){return y}),f,e,s);h=n.disable[t];h&&h(i,(function(){var u=a()||r.unwrap(s.$disabled||!1),n=v(),f=n?n.canExecute():!1,t=u||!f;return i&&o(i).toggleClass("azc-command-disabled",t),t}),f,e,s);h=n.click[t];h&&h(i,(function(){return function(){var n=v();n&&!a()&&n.canExecute()&&c.execute()}}),f,e,s)}}function e(n){var t=u.createIsolatedContext(n.$data,n);return t.createChildContext=function(t){return u.createIsolatedContext(t,n)},t}var o=jQuery,n=r.bindingHandlers,t;n.azcCommand={init:f("init"),update:f("update")};n.stopBindings={init:function(n,t){var i=r.unwrap(t());return{controlsDescendantBindings:i}}};n.privateTemplate={init:function(t,i,r,u,f){return n.template.init(t,i,r,u,e(f))},update:function(t,i,r,u,f){return n.template.update(t,i,r,u,e(f))}};t={};n.vivaControl={registerCallback:function(n){var r=i.getUniqueId();return t[r]=n,r},unregisterGuid:function(n){delete t[n]},init:function(u,f,e,o,s){var h=r.unwrap(f()),c=t[h];return r.utils.domNodeDisposal.addDisposeCallback(u,(function(){var t=c().ltm;n.vivaControl.unregisterGuid(h);i.disposeDisposable.apply(i,t)})),n.privateTemplate.init(u,c,e,o,s)},update:function(i,u,f,e,o){var s=r.unwrap(u()),h=t[s];return n.privateTemplate.update(i,h,f,e,o)}}})(f||(f={})),f}));
define("Viva.Controls/Util/Viva.Util.Private",["require","exports","o"],(function(n,t,i){"use strict";var r;return (function(n){var t=null,r,u=window,f=(function(){function n(n){this._prefixCode=";;;";this._dataTransfer=n}return i.defineProperty(n.prototype,"dropEffect",{get:function(){return this._dataTransfer.dropEffect},set:function(n){if(n!=="none"&&n!=="copy"&&n!=="link"&&n!=="move")throw new Error("Drop effect must be either none, copy, link, or move.");this._dataTransfer.dropEffect=n},enumerable:!0,configurable:!0}),i.defineProperty(n.prototype,"effectAllowed",{get:function(){return this._dataTransfer.effectAllowed},set:function(n){if(n!=="none"&&n!=="copy"&&n!=="copyLink"&&n!=="copyMove"&&n!=="link"&&n!=="linkMove"&&n!=="move"&&n!=="all"&&n!=="uninitialized")throw new Error("Effect allowed must be either none, copy, copyLink, copyMove, link, linkMove, move, all, or uninitialized.");this._dataTransfer.effectAllowed=n},enumerable:!0,configurable:!0}),i.defineProperty(n.prototype,"types",{get:function(){var n=this._dataTransfer.types,u,f,e,o;if(t===null&&this.getData(""),t)return f=this._getLegacyData(),o=i.keys(f).some((function(n){return f[n]!==""})),i.keys(o?f:r);if(n&&!n.forEach)for(e=n,n=[],u=0;u<e.length;u++)n.push(e[u]);return n},enumerable:!0,configurable:!0}),i.defineProperty(n.prototype,"files",{get:function(){return this._dataTransfer.files},enumerable:!0,configurable:!0}),n.isLegacyDataTransfer=function(){if(t===null){var n=u.DataTransfer||u.Clipboard;return!n.prototype.setDragImage}return t},n.prototype.setDragImage=function(n,t,i){this._dataTransfer.setDragImage&&this._dataTransfer.setDragImage(n,t,i)},n.prototype.addElement=function(n){this._dataTransfer.addElement&&this._dataTransfer.addElement(n)},n.prototype.getData=function(n){if(this._checkFormat(n),t)return this._getLegacyDataTransfer(n);try{return t=!1,this._dataTransfer.getData(n)}catch(i){return t=!0,this.getData(n)}},n.prototype.setData=function(n,i){if(this._checkFormat(n),t)this._setLegacyDataTransfer(n,i);else try{t=!1;this._dataTransfer.setData(n,i)}catch(r){t=!0;this.setData(n,i)}},n.prototype.clearData=function(n){if(this._checkFormat(n),t)this._clearLegacyDataTransfer(n);else try{t=!1;this._dataTransfer.clearData(n)}catch(i){t=!0;this.clearData(n)}},n.prototype._checkFormat=function(n){if(n&&n.toLowerCase()!==n)throw new Error("Format must be in lowercase.");},n.prototype._getLegacyData=function(){var n=this._dataTransfer.getData("Text");return n&&n.substr(0,this._prefixCode.length)===this._prefixCode?JSON.parse(n.substr(this._prefixCode.length)):{Text:n}},n.prototype._stringifyLegacyData=function(n){return this._prefixCode+JSON.stringify(n)},n.prototype._getLegacyDataTransfer=function(n){return this._getLegacyData()[n]||""},n.prototype._setLegacyDataTransfer=function(n,t){var i=this._getLegacyData();i[n]=t;r=i;this._dataTransfer.setData("Text",this._stringifyLegacyData(i))},n.prototype._clearLegacyDataTransfer=function(n){if(r={},n){var t=this._getLegacyData();delete t[n];r=t}this._dataTransfer.setData("Text",this._stringifyLegacyData(r))},n})();n.DataTransfer2=f;document.addEventListener("dragend",(function(){r={}}),!1)})(r||(r={})),r}));
define("Viva.Controls/Util/Viva.Util",["require","exports","f","o","ko","$","Viva.Controls/Util/Viva.Util.Private"],(function(n,t,i,r,u,f,e){"use strict";var o;return (function(n){function l(n,t){var f=n.tagName,i,r,u;switch(f){case"TABLE":i="tr";break;case"TR":i="td";break;case"UL":i="li";break;default:i="span"}t&&(u=n.getAttribute("aria-live"),n.setAttribute("aria-live","assertive"));r=document.createElement(i);n.appendChild(r);n.removeChild(r);t&&(u?n.setAttribute("aria-live",u):n.removeAttribute("aria-live"))}function a(n,t){var i=n.parents().filter((function(){var n=f(this),t=n.css("overflow-x"),i=n.css("overflow-y");return(t!=="hidden"||i!=="hidden")&&(t!=="visible"||i!=="visible")}));return t&&(i=i.add(window)),i}function v(n){if(n){var r=f(n),i=void 0;if(r.attr(t.dataControlAttribute))return n;if(i=r.closest("["+t.dataControlAttribute+"='true']"),i.length>0)return i[0]}return null}function h(n){var r=f(n),i;return r.attr(t.dataCanFocusAttribute)&&(i=n[t.dataCanFocusAttribute],i)?i():!1}function o(n,t,i){var f=0,r,e,u;do{if(r=null,u=n.find(t+":eq("+f+")"),u.length>0&&(r=u[0],e=i(r),e&&h(r)))return!0;f++}while(!c(r));return!1}function y(n,t){t===void 0&&(t=!0);var i=r.keys(n);return t?i.sort((function(n,t){return n<t?1:-1})):i}function p(n,t){var i,f,r,u;if(t.length<=n.length){for(i=-1,f=function(r){var u=t[r];return i=n.firstIndex((function(n){return n===u}),i+1),i<0?{value:!1}:void 0},r=0;r<t.length;r++)if(u=f(r),typeof u=="object")return u.value;return!0}return!1}function w(n,i){var f="["+t.dataFocusFirstAttribute+"='true']",e=":not("+f+")",u="["+t.dataCanFocusAttribute+"='true']",s=function(n){return n},r=!1;return i&&(r=o(n,u+f,i),r||(r=o(n,u+e,i))),r||(r=o(n,u+f,s),r||(r=o(n,u+e,s))),r}function b(n,t){var i=t||n.type;return f.Event(n,{type:i,target:n.target,ctrlKey:n.ctrlKey,shiftKey:n.shiftKey,currentTarget:n.currentTarget,isImmediatePropagationStopped:n.isImmediatePropagationStopped,isPropagationStopped:n.isPropagationStopped,preventDefault:n.preventDefault,stopImmediatePropagation:n.stopImmediatePropagation,stopPropagation:n.stopPropagation})}function k(n,t,i){for(var s=i?i.length:0,r,e,f,o=0;o<s;o++)r=i[o],e=t[r]||u.observable(),f=n[r],e(u.isObservable(f)?f.peek():f),t[r]||(t[r]=e)}function d(n,t){var i=n.indexOf(t)<0;return i&&n.push(t),!i}function g(n){var t=n.getAttribute("class");return t?new s(t):new s}function nt(n,t){n.setAttribute("class",t._fields.join(" "))}function tt(t){var i=f(t);return i.length?i[0].getBoundingClientRect():n.defaultBox}var c=i.isNullOrUndefined,f=jQuery,t,s;(function(n){n.dataCanFocusAttribute="data-canfocus";n.dataFocusFirstAttribute="data-focus-first";n.dataEditableAttribute="data-editable";n.dataControlAttribute="data-control";n.dataActivatableAttribute="data-activatable";n.dataActivateInfoAttribute="data-activate-info"})(t=n.Constants||(n.Constants={}));n.forceScreenRead=l;n.getScrollableParents=a;n.findContainingControl=v;n.executeSetFocusOn=h;n.getObjectBasicShape=y;n.shapeContains=p;n.setFocusToFirstFocusableChild=w;n.cloneEvent=b;n.fillObserableFields=k;n.existsOrRegisterId=d;s=(function(){function n(n){n===void 0&&(n=null);this._fields=n?n.split(" "):[]}return n.prototype.add=function(n){this._fields.indexOf(n)<0&&this._fields.push(n)},n.prototype.remove=function(n){while(this._fields.indexOf(n)>=0)this._fields.splice(this._fields.indexOf(n),1)},n.prototype.contains=function(n){return this._fields.indexOf(n)>=0},r.defineProperty(n.prototype,"length",{get:function(){return this._fields.length},enumerable:!0,configurable:!0}),n.prototype.toggle=function(n){return this._fields.indexOf(n)>=0?(this.remove(n),!1):(this.add(n),!0)},n.prototype.item=function(n){return this._fields[n]},n.prototype.toString=function(){return this._fields.toString()},n})();n.DOMTokenListShim=s;n.getClassList=g;n.setClassList=nt;n.DataTransfer=e.DataTransfer2;n.defaultBox={top:0,left:0,width:0,height:0};n.getBox=tt})(o||(o={})),o}));
define("_generated/Less/MsPortalImpl.Controls/Controls/Base.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxc-base-fill-container-width{width:100%}.fxc-base-fill-container-height{height:100%}.fxc-base-loading{position:relative;height:100%}.fxc-base-loading .fxc-base-loadingImage{position:absolute;top:calc(50% - 30px / 2);left:calc(50% - 30px / 2)}")}));
define("MsPortalImpl.Controls/Controls/Base/Base",["require","exports","f","i","a","ko","Viva.Controls/Util/Viva.Util","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","_generated/Less/MsPortalImpl.Controls/Controls/Base.css","Viva.Controls/Controls/Base/Viva.KnockoutExtensions"],(function(n,t,i,r,u,f,e,o,s){"use strict";var h;return (function(t){function a(n,t){return i.first(c(n,t))||null}function c(n,i){var r=n.data(t.widgetTypesDataKey)||[];return i&&(r=r.filter((function(n){return n instanceof i}))),r}var u,h,l;t.widgetTypesDataKey="fxWidgetTypes";u="remove.fxWidget";h="fxs-display-none";t.getWidget=a;t.getWidgets=c;l=(function(){function c(u,e,c){var b,k,l,y,p,a,d,w,v;if(c===void 0&&(c={}),b=this,this._destroyIds=[],this._currentCssClass="",!u||!u.length)throw new Error("You must specify an element to associate a control to it. Your element is either null or an empty collection.");this.element=u;k=this.ltm=new r.TriggerableLifetimeManager;this.vmBasicOption={ltm:k};this.bindingContext=c.bindingContext;l=u.data(t.widgetTypesDataKey);l||u.data(t.widgetTypesDataKey,l=[]);l.push(this);y=e.controlType;y!==0&&y!==94&&(p=void 0,a=u.attr("data-bind")||"",a.length&&a.indexOf("visible")>=0&&(d=f.expressionRewriting.parseObjectLiteral(a)||[],p=d.some((function(n){return n.key==="visible"}))),p||(w=e.visible,w&&w.subscribeAndRun(this.ltm,(function(n){i.isNullOrUndefined(n)||u.toggleClass(h,!n)}))));v=e&&e.cssClass;v&&(v.subscribeAndRun(this.ltm,(function(t){t&&(s.isAllowedCssClassName(t)?(u.addClass(t),b._currentCssClass=t):o.logToExtension(n,u,2,"Invalid control css class name: "+t))})),v.subscribe(this.ltm,(function(n){n&&u.removeClass(n)}),null,"beforeChange"));this._registerDispose()}return c.prototype.isDisposed=function(){return this._destroyIds.length>0},c.prototype.dispose=function(){var i,n;this._checkExistsOrRegisterDestroyId(null)||(this.ltm&&this.ltm.dispose(),i=this.element,i.removeClass(h+" "+this._currentCssClass),n=i.data(t.widgetTypesDataKey),n&&(n.splice(n.indexOf(this),1),n.length||i.removeData(t.widgetTypesDataKey)),this._disposeCallback&&(this._unregisterDispose(),this._disposeCallback=null))},c.prototype._checkExistsOrRegisterDestroyId=function(n){return e.existsOrRegisterId(this._destroyIds,n)},c.prototype._cleanDescendants=function(){f.utils.cleanDescendantNodes(this.element)},c.prototype._cleanElement=function(){for(var i,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];i=this.element;this._cleanDescendants();t.length&&i.removeClass(t.join(" "));i.empty()},c.prototype._registerDispose=function(){var n=this,t=this.element;if(this.bindingContext)f.utils.domNodeDisposal.addDisposeCallback(t[0],this._disposeCallback=function(){n.dispose()});else t.on(u,this._disposeCallback=function(i){i.target!==t[0]||n._destroyTriggered||(n._destroyTriggered=!0,n.dispose())})},c.prototype._unregisterDispose=function(){var n=this.element,t=this._disposeCallback;this.bindingContext?f.utils.domNodeDisposal.removeDisposeCallback(n[0],t):n.off(u,t)},c})();t.Widget=l})(h||(h={})),h}));
define("MsPortalImpl.Controls/Controls/Base/OptionsBase",["require","exports","f","o","ko","$","MsPortalImpl.Controls/Controls/Base/Base","MsPortalImpl.Controls/Controls/Base/WidgetBinding","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","_generated/Less/MsPortalImpl.Controls/Controls/Base.css"],(function(n,t,i,r,u,f,e,o,s){"use strict";var h;return (function(t){var a=i.Base,y=a.Promises.CancelationToken,p=a.Promises.makeCancelable,w=i.Errors,h=jQuery,v="fxc-base",c="fxc-base-fill-container-width",l="fxc-base-fill-container-height",f=[],b=(function(t){function e(n,i,r){var e=t.call(this,n,i,r)||this,s,h,p;e._addDisposablesToCleanUp=function(n){return e.ltm.registerForDispose(n)};e.vm=i;e._options=i;e._widgets=[];e._waitToken=new y;e._createOptions=u.utils.extend({isTrusted:!1,fillBehavior:0},r);e.isTrusted=e._createOptions.isTrusted;n.addClass(v);switch(e._createOptions.fillBehavior){case 1:n.addClass(c);break;case 2:n.addClass(l);break;case 3:n.addClass(c+" "+l)}s=f.length;s&&(h=f[s-1],h.push(e));var w=e.tabindex=u.observable(0),b=e.disabled=u.observable(!1),a=e.bindingContext||o.getContext(n)||{};return e.$disabled=o.chainDisabledProperties([a.$disabled,b,i.disabled]),p=e.$tabIndex=o.chainTabindexProperties([a.$tabIndex,w],[i.disabled]),e.$focusIndex=u.pureComputed((function(){return p()===null?null:-1})),e}return __extends(e,t),e.prototype.dispose=function(){var n,r;this._checkExistsOrRegisterDestroyId(t.prototype.dispose)||(this._waitToken.cancel(new w.DisposedCanceledError),this._widgets&&(this._widgets.forEach((function(n){n&&n.dispose()})),this._widgets=null),this.element.removeClass(v+" "+c+" "+l).removeAttr("role"),n=f.length,n&&(r=f[n-1],i.remove(r,this)),t.prototype.dispose.call(this))},r.defineProperty(e.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),e.prototype.widget=function(){return this.element},r.defineProperty(e.prototype,"widgets",{get:function(){return this._widgets},enumerable:!0,configurable:!0}),e.prototype.awaitContentRevealed=function(){return Q(!1)},e.beginTracking=function(n){n===void 0&&(n=[]);f.push(n)},e.endTracking=function(){return f.pop()},e.prototype.trigger=function(n,t,i,r){var f=this.options[n],u=this.element;return i=i||{},t=t||h.Event(n),t.type=n,t.target=r||u[0],u.trigger(t,i),!(h.isFunction(f)&&f.apply(u[0],[t].concat(i))===!1||t.isDefaultPrevented())},e.prototype.waitFor=function(n){return p(n,this._waitToken)},e.prototype.sanitizeTemplate=function(t){return t&&!this.isTrusted?s.sanitizeHTML(t,n).sanitizedMarkup:t},e.prototype._bindDescendants=function(n,t){var i,r,f;n===void 0&&(n={});i=this.options;r=h(t||this.element)[0];u.utils.extend(n,{data:i,func:this});f=o.createChildContext(r,n,{$ctl:this,$vm:i,$disabled:this.$disabled,$tabIndex:this.$tabIndex,$focusIndex:this.$focusIndex},this.bindingContext);u.applyBindingsToDescendants(f,r)},e.prototype._bindElement=function(n,t){var i=h(t)[0],r=o.createChildContext(i,n,{$ctl:this,$vm:n,$disabled:this.$disabled,$tabIndex:this.$tabIndex,$focusIndex:this.$focusIndex},this.bindingContext);u.applyBindings(r,i)},e.prototype._isRtl=function(){return h("html").attr("dir")==="rtl"},e})(e.Widget);t.Widget=b})(h||(h={})),h}));
define("MsPortalImpl.Controls/Controls/Base/WidgetBindingHandler",["require","exports","ko","MsPortalImpl.Controls/Controls/Base/Base"],(function(n,t,i,r){"use strict";var u;return (function(n){function t(n,t){return t=t||{controlsDescendantBindings:!0},{init:function(){return t},update:function(t,u,f,e,o){var s=i.unwrap(u());i.ignoreDependencies((function(){var i=r.getWidget($(t),n);i!==null&&i.dispose();s&&(i=new n($(t),s,{bindingContext:o}))}))}}}n.getBindingHandler=t})(u||(u={})),u}));
define("MsPortalImpl.Controls/Controls/ResourceFilterHelper",["require","exports","f","i","o","ko","FxHubs/RpcEndPoints"],(function(n,t,i,r,u,f,e){"use strict";function v(n){o=o||[];o.push(n)}function p(n){if(n){var t=o,i=t&&t.first((function(t){return t.id===n.id}));i&&t.remove(i);o=t.length?t:[]}}function w(){return t.Internal.assetTypeService.assetTypes().forEach((function(n){v(n)})),o}function b(n,i){t.Internal.assetTypeService=n;n.assetTypes.subscribeArrayChanges(c,(function(n){v(n)}),(function(n){p(n)}));i.registerForDispose(c)}function k(n){var r=[],t,u;return n&&n.length?(t=f.observable(),r=n.map((function(n){return{name:n.compositeDisplayName.plural,key:n.resourceType.toLowerCase(),keywords:n.keywords}})),t(i.stableSort(r,(function(n,t){return n.name.localeCompareIgnoreCase(t.name)}))),t):(t=l,t||(t=f.observable(),l=t,u=o?o:w(),r=(u||[]).filter((function(n){var i=n.assetTypeManifest.browseType,t=n.assetTypeManifest.resourceType,r=i===1&&!n.assetTypeManifest.privateBrowse&&n.lowerCaseResourceType!==h.Constants.ResourceTypes.ResourceGroups.toLowerCase();return r&&!(t&&(t.routingType===s.Tenant||t.routingType===s.ProviderProxy||t.routingType===s.Extension))})).map((function(n){return{name:n.compositeDisplayName.plural,key:n.lowerCaseResourceType,keywords:n.assetTypeManifest.keywords&&n.assetTypeManifest.keywords.split(",")}})),t(i.stableSort(r,(function(n,t){return n.name.localeCompareIgnoreCase(t.name)})))),t)}function d(){var n=a;return n?Q.resolve(n):Q(e.Location.locationEndpoint.invoke(r.Rpc.client,h.Constants.ExtensionNames.Hubs,{onlyAllowedRegions:!0})).then((function(t){var r=i.forEachKey(t,(function(n,t,i){i.push({displayName:t,name:n})}),[]);return n=i.stableSort(r,(function(n,t){return n.displayName.localeCompareIgnoreCase(t.displayName)})),a=n,Q.resolve(n)}))}var o,l,a;u.defineProperty(t,"__esModule",{value:!0});var h=i.Base,y=r.TriggerableLifetimeManager,s=i.Extension.ResourceRoutingType,c=new y;t.Internal={};t.initialize=b;t.getResourceTypes=k;t.getLocations=d}));
define("_generated/Less/MsPortalImpl.Controls/Controls/SimpleButton.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxc-simplebutton{display:inline-block;-webkit-user-select:none;min-width:80px;text-align:center;line-height:22px;position:relative}.fxs-button-icon{display:inline-block;height:12px;width:12px}.fxs-button-icon-left{margin-right:5px}.fxs-button-icon-right{margin-left:5px}.fxs-button-spinner{height:10px;width:10px;display:inline-block;position:absolute;right:8px}.fxs-button-text-hide{display:none}")}));
define("MsPortalImpl.Controls/Controls/SimpleButton",["require","exports","f","o","ko","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl.Controls/Controls/Base/OptionsBase","_generated/Less/MsPortalImpl.Controls/Controls/SimpleButton.css"],(function(n,t,i,r,u,f,e,o){"use strict";var s;return (function(n){var h=i.disposeDisposable,t="fxc-simplebutton",s="fxs-button-text",c="<span>"+i.encodeAttribute(e.Button.validating)+"<\/span><div class='fxs-button-spinner' data-bind='image: MsPortalFx.Base.Images.Loading.Spinner()'><\/div>",l='<div class=\'fxs-button fxt-button\' role=\'button\' data-bind=\'visible: data.visible, css: { "fxs-button-disabled": $disabled, "fxs-portal-button-primary": data.primary, "fxs-button-default": !ko.unwrap(data.primary), "fxs-inner-dotted-border": !ko.unwrap($disabled) }, attr: { tabindex: $tabIndex, "aria-disabled": $disabled, title: data.text }\'><!-- ko if: data.icon() && data.icon().position === 0 --><div class=\'fxs-button-icon fxs-button-icon-left\' data-bind=\'image: MsPortalFx.Base.Images.CustomImageWithOptions(data.icon().image, {customClass: "fxs-escapeShadow"})\'><\/div><!-- /ko -->'+("<span class="+s+" data-bind='text: data.text'><\/span>")+"<!-- ko if: data.icon() && data.icon().position === 1 --><div class='fxs-button-icon fxs-button-icon-right' data-bind='image: MsPortalFx.Base.Images.CustomImageWithOptions(data.icon().image, {customClass: \"fxs-escapeShadow\"})'><\/div><!-- /ko --><!-- ko if: data.loading -->"+("<div class=fxs-button-validating>"+c+"<\/div>")+"<!-- /ko --><\/div>",a=(function(n){function i(i,r,u){var f=n.call(this,i,r,u)||this,e;return f._events=[],f.element.addClass(t).html(l),e=f.element.findByClassName("fxs-button"),f.options.ariaLabel.subscribeAndRun(f.ltm,(function(n){e.attr("aria-label",n?n:null)})),f.options.loading.subscribeAndRun(f.ltm,(function(n){e.findByClassName(s).toggleClass("fxs-button-text-hide",n)})),f._attachEvents(),f._bindDescendants(),f}return __extends(i,n),r.defineProperty(i.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),i.prototype.dispose=function(){this._checkExistsOrRegisterDestroyId(n.prototype.dispose)||(this._detachEvents(),this._cleanElement(t),n.prototype.dispose.call(this))},i.prototype._attachEvents=function(){var n=this,t,i;this._detachEvents();t=function(n){return u.isObservable(n)?n():n};i=function(i){i.stopPropagation();i.preventDefault();!t(n.$disabled)&&n.options.onClick&&t(n.options.onClick)()};this._events.push(this.element.setEvents([f.default.click,i,],[f.default.keypress,function(n){(n.keyCode===13||n.keyCode===32)&&i(n)},]))},i.prototype._detachEvents=function(){h(this._events);this._events=[]},i})(o.Widget);n.Widget=a})(s||(s={})),s}));
define("MsPortalImpl/Base/JQueryHelper",["require","exports","i"],(function(){"use strict";var n;return (function(n){function e(n,t){return n.find("."+t)}function u(n){return n.addClass(t)}function i(n){return n.removeClass(t)}function o(n,t){var r=t?i:u;return r(n)}function f(n){return!!n.offsetParent}function s(n){return n.toArray().some(f)}function h(){return r}function c(n,i){return $(n).find(i+r).filter((function(i,r){var u=$(r).parentsUntil(n,"."+t);return!u.length}))}function l(n,t){return i(n),n.show(t)}var t="fxs-display-none",r=":not(.fxs-display-none)";n.findByClassName=e;n.hide=u;n.unhide=i;n.toggle=o;n.isElementVisible=f;n.isVisible=s;n.getUnhideSelector=h;n.filterVisible=c;n.forceShow=l})(n||(n={})),n}));
define("MsPortalImpl.Controls/Fields/Base/FormValidation",["require","exports","f","i","ko","$","MsPortalImpl/Base/JQueryHelper"],(function(n,t,i,r,u,f,e){"use strict";var o;return (function(t){function y(n,t,r){t===void 0&&(t=!0);r===void 0&&(r=!1);var u=l(n,r),f=u.map((function(n){return n.field})),e=u.map((function(n){return n.viewmodel})).filter(i.identity);return(t&&this.gridEnableValidation(e),f.length===0)?Q(!0):a(f)}function p(n){n.forEach((function(n){var t=n&&n.rowMetadata;t&&t.editState&&t.editState()&&n.performValidation&&!n.performValidation()&&n.performValidation(!0)}))}function w(n,t,i,e){var c=f(n),a;if(c.attr(o,"true"),c.data(r,e),c.data(s,t),c.data(h,i),a=c.closest(".fxs-part-content"),a.length){var p=a.parent(),v=u.dataFor(p[0]),y=v&&v.context,l=y&&y.validateElements;l&&l.push(n);e.ltm.registerForDispose((function(){l&&l.remove(n);c.data(r,null);c.data(s,null);c.data(h,null)}))}}function c(n,t,i){return n.filter((function(n){var u=f(n);return n&&n.hasAttribute(o)&&u.closest(".fxs-suppresschildvalidation").length<1&&u.data(r)&&(!t||t(n))&&(i||e.isElementVisible(n))})).map((function(n){var t=f(n);return{viewmodel:t.data(s),widgetviewmodel:t.data(h),field:t.data(r)}}))}function l(n,t,i){t===void 0&&(t=!1);var u=function(n){var t=f(n).data(r);return t&&(!i||i(n))};return n.length?c(n.find("["+o+"]").toArray(),u,t):[]}function a(n){var t=[];return n.filter((function(n){return n.triggerValidation})).map((function(n){t.push(n.triggerValidation())})),Q.all(t).then((function(n){return n.every(v)}))}var f=jQuery,v=i.identity,b=i.Base.Diagnostics.createLog(n);t.ensureFormFieldValidation=y;t.gridEnableValidation=p;var o="data-validatable",r="field",s="viewmodel",h="widgetviewmodel";t.markFormFieldElement=w;t.gatherFormFieldsFromElements=c;t.gatherFormFields=l;t.performFieldValidation=a})(o||(o={})),o}));
define("MsPortalImpl/AsyncLoader",["require","exports","f","i","o","FxHubs/RpcEndPoints"],(function(n,t,i,r,u,f){"use strict";function o(t,r){return function(){return i.tryImmediateResolve(i.require(t,n),(function(n){return n[r]}))}}function h(n){return function(t){return i.tryImmediateResolve(n(),(function(n){return t.get(n)}))}}function l(n){function t(t,u){return function(f,e){return t.register(n.get(r.Rpc.Client),u,(function(t,r){return i.tryImmediateResolve(o(f,e)(),(function(i){return i({diContainer:n,messageArg:t,messageContext:r})}))})),null}}var u={"./UI/Hubs/UI.ResourceMapManager":{mapAssetIdToResourceId:t(e.mapAssetIdToResourceIdEndPoint),mapResourceIdToAssetId:t(e.mapResourceIdToAssetIdEndPoint),mapResourceIdToDynamicSelectionAndIcon:t(e.mapResourceIdToDynamicSelectionAndIconEndPoint),getResourceAssetInformation:t(e.getResourceAssetInformationEndPoint),getResourceAssetInformationForHubs:t(f.AssetTypes.getResourceAssetInformationEndPoint),getResource:t(e.getResourceEndPoint),getResourceGroup:t(e.getResourceGroupEndPoint),signalResourcesChanged:t(e.signalResourcesChangedEndPoint)},"./Base/Base.Router":{rpcGetDashboardDeepLink:t(c.getDashboardDeepLinkEndPoint)},"./Services/Services.EditScopeManagement":{loadSerializedEditScope:t(s.loadSerializedEditScopeEndPoint),saveSerializedEditScope:t(s.saveSerializedEditScopeEndPoint),updateEditScopeIsSavingState:t(s.updateEditScopeIsSavingStateEndPoint)},"./Services/Services.GalleryEndpoints":{getLocalGalleryPackages:t(e.getLocalGalleryPackagesEndpointsDefinition),registerLocalGalleryPackages:t(e.registerLocalGalleryPackagesEndpointDefinition)}};i.forEachKey(u,(function(n,t){i.forEachKey(t,(function(t,i){i(n,t)}))}))}u.defineProperty(t,"__esModule",{value:!0});var s=r.Data,e=r.Extension,c=i.ViewModels;t.resourceMapManager=h(o("./UI/Hubs/UI.ResourceMapManager","ResourceMapManager"));t.patchMetadataSource=h(o("./Extension/ExtensionPatch","PatchMetadataSource"));t.galleryPackageMetadataSource=h(o("./GalleryPackage/GalleryPackageMetadataSource","GalleryPackageMetadataSource"));t.armDashboardClient=o("./UI/Dashboard/Arm/ArmDashboardClient","ArmDashboardClient");t.registerRpc=l}));
define("MsPortalImpl/Base/Base.Events",["require","exports","f","o"],(function(n,t,i,r){"use strict";function f(){var n=document;return!!(n.fullscreenElement||n.webkitFullscreenElement||n.mozFullScreenElement||n.msFullscreenElement)}function e(){var n=document,t=n.exitFullscreen||n.webkitExitFullscreen||n.mozCancelFullScreen||n.msExitFullscreen;t&&t.call(n)}function o(){var n=document.documentElement,t=n.requestFullscreen||n.webkitRequestFullscreen||n.mozRequestFullScreen||n.msRequestFullscreen;t&&t.call(n)}function u(n){return n._handle}function s(n,t){var r=i.find(t(),(function(t){return u(t)===n}));return r||(r={_handle:n},t.push(r)),r}r.defineProperty(t,"__esModule",{value:!0});t.fxpinmultipleparts="fxpinmultipleparts";t.fullscreen="fullscreenchange MSFullscreenChange mozfullscreenchange webkitfullscreenchange";t.isFullscreen=f;t.exitFullscreen=e;t.requestFullscreen=o;t.unwrapFxElement=u;t.getOrCreateFxElement=s}));
define("MsPortalImpl/Base/Base.SvgHelper",["require","exports","f","o","MsPortalImpl/Base/Base.BrowserDetection","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Base/Base.Sanitization"],(function(n,t,i,r,u,f,e){"use strict";var o;return (function(t){function v(n,t){var i=n.getAttribute("class");n.setAttribute("class",(i?i+" ":"")+t)}function b(n,t){n.setAttribute("class",(n.getAttribute("class")||"").split(" ").filter((function(n){return n&&n!==t})).join(" "))}function s(n,t){for(var i=0,r=n.length;i<r;++i)t(n[i])}function k(n,i){var r,f,u,e,y;return i.customClass&&(r=a(i.customClass),(r.startsWith("ext-")||r.startsWith("msportalfx")||r.startsWith("fxt-"))&&!r.includes(" ")&&s(n.getElementsByClassName(t.SvgPlaceholderClass),(function(n){return v(n,r)}))),i.description&&(f=o.createElementNS(c,"desc"),f.textContent=a(i.description),u=n.getElementsByTagName("title")[0],u&&u.parentNode.insertBefore(f,u.nextSibling)),i.title?(e=a(i.title),e&&s(n.getElementsByTagName("title"),(function(n){n.textContent||(n.textContent=n.textContent||e)}))):(y=[],s(n.getElementsByTagName("title"),(function(n){return n&&!n.textContent&&y.push(n)})),y.forEach((function(n){return n.remove()}))),i._badgeWidth||(s(n.getElementsByClassName(t.SvgPlaceholderClass),(function(n){return b(n,t.SvgPlaceholderClass)})),s(n.querySelectorAll("[class='']"),(function(n){return n.removeAttribute("class")}))),l(n.firstElementChild||h.cloneNode(),n.innerHTML)}function ht(n,t){var i=g[n],r;return i||(i=t?et:ft,i.innerHTML=n,t||(r=[],s(i.querySelectorAll(st),(function(n){r.push(n)})),r.forEach((function(n){return n.remove()})),s(i.querySelectorAll("*"),(function(n){for(var i=n.attributes,r=[],f=function(n){var t=i[n].name;ot[t]||r.push(t)},t=0,u=i.length;t<u;++t)f(t,u);r.forEach((function(t){return n.removeAttribute(t)}))}))),g[n]=i.cloneNode(!0)),i.cloneNode(!0)}function ct(i,r,u,p){var ct,nt,at,et,g,yt,it,st,lt,gt,vt;if(r=r||i.options||{},ct=i&&i.type,nt=i&&i.data,ct!==0&&nt){if(ct===2)return e.sanitizeUri(nt)?(at=a(r.title||""),et=o.createElement("img"),at?et.setAttribute("alt",at):et.setAttribute("aria-hidden","true"),et.setAttribute("src",rt(nt)),et):(f.logToExtension(n,u,2,"Image has failed to load as an invalid uri was passed in : "+nt),l(h.cloneNode(),w))}else return l(h.cloneNode(),w);if(g=ht(nt,p||ct!==1,u),!g.hasChildNodes())return f.logToExtension(n,u,2,"Svg has failed to load, imageData: "+nt),l(h.cloneNode(),w);if(yt=t.SvgsPalettes[r.palette],r.palette&&s(g.getElementsByClassName(t.SvgPlaceholderClass),(function(n){return v(n,yt)})),r.isLogo||(s(g.querySelectorAll("[fill]"),(function(n){return n.removeAttribute("fill")})),g.getElementsByClassName(t.SvgsPalettes[99]).length||s(g.getElementsByClassName(t.SvgPlaceholderClass),(function(n){return v(n,"fxs-portal-svg")}))),tt||r.customClass||/msportalfx-svg-c0(5|7)|-animated(\s|'|")|(\s|'|")ext-/.test(g.outerHTML))return k(g,r);if(it=d.get(g.outerHTML),it)it=it.cloneNode(!0);else{var pt=ut(),ft=h.cloneNode(),wt=o.createElement("div");v(ft,t.SvgPlaceholderClass);ft.setAttribute("height","100%");ft.setAttribute("width","100%");ft.appendChild(o.createElementNS(c,"title"));wt.appendChild(ft);var bt=h.cloneNode(),kt=o.createElementNS(c,"defs"),ot=o.createElementNS(c,"symbol"),dt=o.createElementNS(c,"use");for(dt.setAttribute("href","#"+pt),ft.appendChild(dt),d.set(g.outerHTML,(it=wt).cloneNode(!0)),st=g.getElementsByTagName("svg")[0]||g,lt=0,gt=st.attributes.length;lt<gt;++lt)vt=st.attributes[lt],ot.setAttribute(vt.name,vt.value);while(st.hasChildNodes())ot.appendChild(st.firstChild);ot.setAttribute("id",pt);b(ot,t.SvgPlaceholderClass);kt.appendChild(ot);bt.appendChild(kt);y.appendChild(bt)}return k(it,r)}var it=i.Base,lt=it.Diagnostics,rt=i.encodeAttribute,a=i.encodeHtml,p=window,c="http://www.w3.org/2000/svg",o=p.document,l,y,nt,tt;t.SvgPlaceholderClass="msportalfx-svg-placeholder";t.SvgBadgeClass="msportalfx-svg-badge";t.SvgsPalettes=[];t.SvgsPalettes[0]="";t.SvgsPalettes[2]="msportalfx-svg-palette-black";t.SvgsPalettes[3]="msportalfx-svg-palette-blue";t.SvgsPalettes[1]="msportalfx-svg-palette-white";t.SvgsPalettes[4]="msportalfx-svg-palette-green";t.SvgsPalettes[5]="msportalfx-svg-palette-gray";t.SvgsPalettes[99]="msportalfx-svg-palette-inherit";t.SvgsPalettes[100]="msportalfx-svg-disabled";l=p.SVGElement&&"outerHTML"in SVGElement.prototype?function(n){return n}:function(n,t){return n.outerHTML=t,n};y=o.createElement("div");y.setAttribute("id","FxSymbolContainer");o.head.appendChild(y);var ut=i.getIdGenerator("FxSymbol"),d=new i.Map,ft=o.implementation.createHTMLDocument("").body,et=o.createElement("div"),g=r.create(null),h=o.createElementNS(c,"svg"),w=(function(){var n=o.createElement("div");return n.appendChild(h),n.innerHTML})(),ot=["aria-hidden","aria-labelledby","class","clip-path","clip-rule","cx","cy","d","enable-background","fill","fill-opacity","fill-rule","filter","focusable","gradientTransform","gradientUnits","height","id","mask","offset","opacity","points","r","role","rx","ry","stop-color","stop-opacity","stroke","stroke-dasharray","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","transform","viewBox","viewbox","width","x","x1","x2","xml:space","xmlns","xmlns:svg","xmlns:xlink","y","y1","y2",i.isFeatureEnabled("sanitizesvghref")?"":"xlink:href",].reduce((function(n,t){return t&&(n[t]=!0,n[t.toUpperCase()]=!0),n}),p.Object.create(null)),st="*:not("+["circle","clipPath","defs","ellipse","g","image","line","linearGradient","mask","path","polygon","radialGradient","rect","stop","svg","symbol","title","use",].join("):not(")+")";nt=i.isFeatureEnabled("fulldiagnostics");tt=u.isIe||u.isSafari||nt;t.getSvgReferenceOrFallBackToData=ct})(o||(o={})),o}));
define("MsPortalImpl/Base/Base.ImageHelper",["require","exports","f","o","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","MsPortalImpl/Base/Base.Sanitization","MsPortalImpl/Base/Base.SvgHelper"],(function(n,t,i,r,u,f,e){"use strict";function s(t,r,u){var c=t&&t.type,f=t&&t.options||{},l,v,p,a,w,y;return c===0||c===1||c===2?(v=e.getSvgReferenceOrFallBackToData(t,f,r),l=Q(v.hasChildNodes()||v.tagName.toLowerCase()==="img"?[v]:[])):(p=t&&t.data&&Q((y={},y[c]=t,y)),l=(p||i.require("MsPortalImpl/Base/Base.ImageLibrary")).then((function(t){var p,l,v;if(c>=999)return p=!f.title?"":h(f.title,n).sanitizedMarkup,l=document.createElement("img"),l.setAttribute("alt",p),l.setAttribute("aria-hidden",(!f.title).toString()),l.setAttribute("src",o(t[c]&&t[c].data)),[l];var s=e.getSvgReferenceOrFallBackToData(t[c],f,r,!0),a=s.tagName.toLowerCase()==="svg"?s:s.getElementsByTagName("svg")[0],y=f._badgeWidth;return y&&(v=a&&a.getAttribute("class").indexOf(e.SvgPlaceholderClass)>-1&&a||s.querySelector("svg."+e.SvgPlaceholderClass),v&&(v.setAttribute("class",v.getAttribute("class").replace(e.SvgPlaceholderClass,e.SvgBadgeClass)),typeof y=="number"&&v.setAttribute("style","width:"+y+"%; height:"+y+"%"))),a&&i.forEachKey(u,(function(n,t){return a.setAttribute(n,t)})),s.childElementCount?[s]:[]}))),f.badge&&(a=f.badge.width,a&&typeof a=="number"||(a=40),w=i.extend2(f.badge.image,{options:{_badgeWidth:a}}),l=Q.all([l,s(w,r)]).then((function(n){return[].concat.apply([],n)}))),l}function c(n){var t=null;return n&&n.type===2&&f.sanitizeUri(n.data)&&(t=o(n.data)),t}r.defineProperty(t,"__esModule",{value:!0});var o=i.encodeAttribute,h=u.sanitizeHTML;t.GetImageData=s;t.GetImageUri=c}));
define("MsPortalImpl/Base/Base.ItemCache",["require","exports","f"],(function(n,t,i){"use strict";var r;return (function(n){function u(n){return function(t){return n(t.item)}}function c(n){var t=r();return t-n}function f(n){return{age:r(),item:n}}function e(n,t){var i;return n&&(t&&(n.age=r()),i=n.item),i}function b(n,i){var r=(y++).toString();return t.set(r,i),n.registerForDispose((function(){t.delete(r)})),r}function k(n){return t.get(n)}var s=window,h=i.remove,p=i.find,w=i.findIndex,r=Date.now,o=(function(){function n(n,t){n===void 0&&(n=12e4);var i=this;this._map=t;this._maxAge=n;this._timer=s.setTimeout((function(){return i._reduceCache()}),1e3)}return n.prototype.dispose=function(){this.flush()},n.prototype.hasEntry=function(n){return n in this._map},n.prototype.getEntry=function(n){return e(this._map[n],!0)},n.prototype.peekEntry=function(n){return e(this._map[n])},n.prototype.removeEntry=function(n){n in this._map&&this._delete(n)},n.prototype._removeEach=function(n){for(var t in this._map)n.call(this,t)&&this._delete(t)},n.prototype.removeEach=function(n){this._removeEach(n)},n.prototype.flush=function(){this._removeEach()},n.prototype._delete=function(n){delete this._map[n]},n.prototype._isExpired=function(n){return c(this._map[n].age)>this._maxAge},n.prototype._reduceCache=function(){this._removeEach(this._isExpired)},n})(),l,a,v,t,y;n.BaseItemCache=o;l=(function(n){function t(t){t===void 0&&(t=12e4);var i=this,r={};return i=n.call(this,t,r)||this,i._cache=r,i}return __extends(t,n),t.prototype.addEntry=function(n,t){this._cache[n]=f(t)},t})(o);n.ItemCache=l;a=(function(n){function t(t){t===void 0&&(t=12e4);var i=this,r={};return i=n.call(this,t,r)||this,i._cache=r,i}return __extends(t,n),t.prototype.addEntry=function(n,t,i){this.removeEntry(n);var r=f(t);r.mgr=i;this._cache[n]=r},t.prototype._delete=function(t){this._cache[t].mgr.dispose();n.prototype._delete.call(this,t)},t})(o);n.LifetimeItemCache=a;v=(function(){function n(n){n===void 0&&(n=12e4);var t=this;this._cache=[];this._maxAge=n;this._timer=s.setTimeout((function(){return t._reduceCache()}),1e3)}return n.prototype.dispose=function(){this.clear()},n.prototype.first=function(n,t){var i=p(this._cache,u(n));return e(i,!t)},n.prototype.peekFirst=function(n){return this.first(n,!0)},n.prototype.pushEntry=function(n){this._cache.push(f(n))},n.prototype.removeEntry=function(n){this.removeFirst((function(t){return i.deepEquals(t,n)}))},n.prototype.removeFirst=function(n){var t=w(this._cache,u(n));t>=0&&this._cache.splice(t,1)},n.prototype.removeEach=function(n){h(this._cache,u(n))},n.prototype.clear=function(){this._cache=[]},n.prototype._isEntryExpired=function(n){return c(n.age)>this._maxAge},n.prototype._reduceCache=function(){var n=this;h(this._cache,(function(t){return n._isEntryExpired(t)}))},n})();n.ItemArrayCache=v;t=new i.Map;y=1;n.rotAdd=b;n.rotFind=k})(r||(r={})),r}));
define("MsPortalImpl/Base/Base.KeyboardHelper",["require","exports","o"],(function(){"use strict";var n;return (function(n){function o(n){switch(n){case 18:case 17:case 40:case 35:case 27:case 36:case 37:case 34:case 33:case 39:case 16:case 9:case 38:return!0;default:return!1}}function s(n){return(n.altKey&&1)|(n.metaKey&&2)|(n.shiftKey&&4)|(n.ctrlKey&&8)}function h(n,r){var f=n?t:i;return f[r]||u[r]}var e=window,f=/Firefox\//i.test(e.navigator.userAgent),r,u,t,i;(function(n){n[n.Equals=f?61:187]="Equals";n[n.Minus=f?173:189]="Minus"})(r=n.VariableKeyCode||(n.VariableKeyCode={})),(function(n){n[n.Alt=18]="Alt";n[n.Backslash=220]="Backslash";n[n.Backspace=8]="Backspace";n[n.Comma=188]="Comma";n[n.Control=17]="Control";n[n.Delete=46]="Delete";n[n.Down=40]="Down";n[n.End=35]="End";n[n.Enter=13]="Enter";n[n.Equals=r.Equals]="Equals";n[n.Escape=27]="Escape";n[n.F1=112]="F1";n[n.F2=113]="F2";n[n.F10=121]="F10";n[n.Home=36]="Home";n[n.Left=37]="Left";n[n.Menu=93]="Menu";n[n.Minus=r.Minus]="Minus";n[n.PageDown=34]="PageDown";n[n.PageUp=33]="PageUp";n[n.Period=190]="Period";n[n.Right=39]="Right";n[n.Shift=16]="Shift";n[n.Slash=191]="Slash";n[n.Space=32]="Space";n[n.Tab=9]="Tab";n[n.Up=38]="Up";n[n.A=65]="A";n[n.B=66]="B";n[n.C=67]="C";n[n.D=68]="D";n[n.E=69]="E";n[n.F=70]="F";n[n.G=71]="G";n[n.H=72]="H";n[n.I=73]="I";n[n.J=74]="J";n[n.K=75]="K";n[n.L=76]="L";n[n.M=77]="M";n[n.N=78]="N";n[n.O=79]="O";n[n.P=80]="P";n[n.Q=81]="Q";n[n.R=82]="R";n[n.S=83]="S";n[n.T=84]="T";n[n.U=85]="U";n[n.V=86]="V";n[n.W=87]="W";n[n.X=88]="X";n[n.Y=89]="Y";n[n.Z=90]="Z";n[n.Num0=48]="Num0";n[n.Num1=49]="Num1";n[n.Num2=50]="Num2";n[n.Num3=51]="Num3";n[n.Num4=52]="Num4";n[n.Num5=53]="Num5";n[n.Num6=54]="Num6";n[n.Num7=55]="Num7";n[n.Num8=56]="Num8";n[n.Num9=57]="Num9";n[n.NumPad0=96]="NumPad0";n[n.NumPad1=97]="NumPad1";n[n.NumPad2=98]="NumPad2";n[n.NumPad3=99]="NumPad3";n[n.NumPad4=100]="NumPad4";n[n.NumPad5=101]="NumPad5";n[n.NumPad6=102]="NumPad6";n[n.NumPad7=103]="NumPad7";n[n.NumPad8=104]="NumPad8";n[n.NumPad9=105]="NumPad9"})(u||(u={}));n.isNonWrittenCharacter=o;n.getModifierKeys=s;t=[];t[192]="~";t[219]="{";t[221]="}";t[220]="|";t[59]=":";t[188]="<";t[r.Equals]="+";t[r.Minus]="_";t[49]="!";t[50]="@";t[51]="#";t[52]="$";t[53]="%";t[54]="^";t[55]="&";t[56]="*";t[57]="(";t[48]=")";t[190]=">";t[191]="?";t[32]="SHIFT+SPACE";t[40]="SHIFT+Down";t[38]="SHIFT+Up";i=[];i[220]="\\";i[188]=",";i[r.Minus]="-";i[49]="1";i[50]="2";i[51]="3";i[52]="4";i[53]="5";i[54]="6";i[55]="7";i[56]="8";i[57]="9";i[48]="0";i[190]=".";i[32]="SPACE";i[191]="/";n.mapKeyCodeToString=h})(n||(n={})),n}));
define("MsPortalImpl/Base/Base.KnockoutExtensions",["require","exports","f","o","ko","$","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u,f,e){"use strict";r.defineProperty(t,"__esModule",{value:!0});u.bindingHandlers.commands={update:function(n,t){var i=u.unwrap(t()),r,o;if(i&&i.group){r=f(n);o=function(n){var o=u.unwrap(i.viewModel),t=f.Event(e.default.fxrightclick);t.clientX=n.clientX;t.clientY=n.clientY;r.trigger(t,{commandGroup:i.group,viewModel:o,entityType:2});n.preventDefault();n.stopPropagation()};r.on(e.default.fxcontextmenurequest,o);u.utils.domNodeDisposal.addDisposeCallback(n,(function(){r.off(e.default.fxcontextmenurequest,o)}))}}};u.bindingHandlers.fxclick={init:function(n,t,r,f,e){var o=function(){return u.unwrap(t())};i.tryImmediateResolve(i.require("MsPortalImpl/UI/Compositions/UI.Composition.Selectable2Registrar"),(function(t){t.attachFxClickHandler(n,e,o)}))}};u.bindingHandlers.visible={update:function(n,t){var i=u.unwrap(t());f(n).toggleClass("fxs-display-none",!i)}};u.bindingHandlers.keyedCss={update:function(n,t){var r=[],e=[];i.forEachKey(u.unwrap(t()),(function(t,f){var o=u.unwrap(f);if(typeof o!="string")i.forEachKey(o,(function(n,t){u.unwrap(t)?r.push(n):e.push(n)}));else{t="_fxCss_"+t;var h=u.utils.domData.get(n,t)||[],s=o.split(" ").filter(i.identity)||[],c=u.utils.compareArrays(h,s,{sparse:!0});c.forEach((function(n){undefined===n.moved&&(n.status==="added"?r.push(n.value):n.status==="deleted"&&e.push(n.value))}));u.utils.domData.set(n,t,s)}}));f(n).removeClass(e.join(" ")).addClass(r.join(" "))}}}));
define("_generated/Less/MsPortalImpl/Widgets/CopyField.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxs-copyfield{display:none;position:absolute;width:24px;top:0;right:0}.fxs-copyfield .fxc-copyablelabel{padding:0}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-textbox{display:none}.fxs-copyfield-container .fxs-copyfield,.fxs-copyfield-container.fxs-copyfield-copied .fxs-copyfield .fxc-copyablelabel-textbox{display:block}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-textbox .azc-input{padding:0;border:0;margin:0;height:auto;background-color:transparent}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-copybutton.azc-button{padding:0;margin:0;background-color:transparent}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-copybutton.azc-button:hover{background-color:transparent}.fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-copybutton.azc-button .fxc-copyablelabel-copyimage{padding:2px 6px 6px 2px}.fxs-copyfield-container .fxs-copyfield-wrapper{position:absolute;top:0;right:0;width:24px;height:24px}.fxs-copyfield-container.fxs-copyfield-copied .fxc-copyablelabel{padding-right:24px}.fxs-copyfield-container.fxs-copyfield-copied .fxs-copyfield,.fxs-copyfield-container.fxs-copyfield-copied .fxs-copyfield-wrapper{width:100%}.fxs-copyfield-container.fxs-copyfield-copied .fxs-copyfield .fxc-copyablelabel-copybutton{margin-right:-24px}.fxs-part-resourcesummary .fxs-copyfield .fxc-copyablelabel .fxc-copyablelabel-textbox .azc-input{font-size:13px}")}));
define("MsPortalImpl/Base/Base.KnockoutExtensions.Copy",["require","exports","f","i","o","ko","MsPortalImpl/Base/Base.EventTypes","_generated/Less/MsPortalImpl/Widgets/CopyField.css"],(function(n,t,i,r,u,f,e){"use strict";function a(n,t,r,u){var l="fxs-copyfield",a="fxs-copyfield-copied",s=$(t),o=$('<div class="'+l+'-wrapper" data-bind="stopBindings: true"><\/div>'),v=$('<div data-bind="pcCopyableLabel: $data" class="'+l+'"><\/div>'),h;v.appendTo(o);o.appendTo(s);h=new c.Forms.CopyableLabel.ViewModel(n,u);h.readOnly(!0);f.reactor(n,(function(){var n=f.unwrap(r);h.value(n);s.toggleClass("fxs-copyfield-container",!i.isNullOrWhiteSpace(n))}));f.applyBindingsToDescendants(h,o[0]);n.registerForDispose([s.setEvents([e.default.fxcopybuttonclick,function(){s.addClass(a)},],[e.default.mouseleave,function(){s.removeClass(a)},]),function(){o&&(f.utils.cleanDescendantNodes(o),o.remove())},])}function o(n,t,i){function h(){u&&(u.dispose(),u=null);r&&(clearTimeout(r),r=null)}var c=$(n),u,r,o={};o[e.default.mouseenter]=function(){r||(r=setTimeout((function(){h();a(u=new s,n,t(),i)}),l))};o[e.default.mouseleave]=h;c.on(o);f.utils.domNodeDisposal.addDisposeCallback(n,(function(){h();c.off(o)}))}u.defineProperty(t,"__esModule",{value:!0});var s=r.TriggerableLifetimeManager,h=i.Base,c=i.ViewModels.Controls,v=h.Diagnostics.createLog(n),l=100;t.initializeCopyBinding=o;f.bindingHandlers.copy={init:o}}));
define("MsPortalImpl/ViewModels/ViewModels.BladeCaller",["require","exports","f"],(function(){"use strict";var n;return (function(n){function r(t,r,u){var e=r.additionalInputArguments=r.additionalInputArguments||[],f;r.outputArguments=r.outputArguments||[];f=t+i;e.push({property:n.bindingName_bladeCallId,valuesFrom:[{referenceType:u,property:f+n.bindingName_bladeCallId}]});e.push({property:n.bindingName_bladeCallerParams,valuesFrom:[{referenceType:u,property:f+n.bindingName_bladeCallerParams}]});r.outputArguments.push({property:n.bindingName_bladeCallerResult,valuesFrom:[{referenceType:1,property:n.bindingName_bladeCallerResult}]})}function u(t){t.inputs=t.inputs||[];t.inputs.push(n.bindingName_bladeCallId,n.bindingName_bladeCallerParams)}function f(t,r,u,f){var o=r.inputs=r.inputs||[],e;if(r.outputs=r.outputs||[],r.bindings=r.bindings||[],f.inline)e=f.inline.bindings=f.inline.bindings||[];else if(f.reference)e=f.reference.bindings=f.reference.bindings||[];else throw new Error("Part is neither inline nor a reference, so cannot add blade callable bindings");o.push(n.bindingName_bladeCallId);e.push({property:n.bindingName_bladeCallId,valuesFrom:[{referenceType:1,property:n.bindingName_bladeCallId}]});o.push(n.bindingName_bladeCallerParams);e.push({property:n.bindingName_bladeCallerParams,valuesFrom:[{referenceType:1,property:n.bindingName_bladeCallerParams}]});r.outputs.push(n.bindingName_bladeCallerResult);r.bindings.push({property:n.bindingName_bladeCallerResult,valuesFrom:[{referenceType:0,property:t+i+n.bindingName_bladeCallerResult,part:u}]})}var t="internal_",i=".";n.bindingName_bladeCallId=t+"bladeCallId";n.bindingName_bladeCallerParams=t+"bladeCallerParams";n.bindingName_bladeCallerResult=t+"bladeCallerResult";n.addCallerBindings=r;n.addCallablePartInputs=u;n.addCallableBindings=f})(n||(n={})),n}));
define("MsPortalImpl/Extension/DefinitionPreprocessor",["require","exports","f","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","MsPortalImpl/ViewModels/ViewModels.BladeCaller"],(function(n,t,i,r,u){"use strict";var f;return (function(n){function it(n,t,i){r.sanitizeDefinition(n,o);var u=n;return u.partTypeMap=u.partTypeMap||{},u.bladeMap=u.bladeMap||{},(u.partsCatalog||[]).forEach((function(n){return w(u,t,n,i||{})})),(u.blades||[]).forEach((function(n){return b(u,t,n,i||{})})),ot(n),u}function y(n,t){n&&n.extension&&(n.extension=t[n.extension]||n.extension)}function p(n,t){n&&n.length&&n.forEach((function(n){n.bladeExtension&&(n.bladeExtension=t[n.bladeExtension]||n.bladeExtension)}))}function rt(n,t,i){if(!n.requireConfig)throw new Error("requireConfig is not provided. Extension's requireConfig must be set to fetch the custom control from the extension");return i.requireConfig=n.requireConfig,i}function w(n,t,i,u){return i.processed?i:(u=u||{},y(i.reference,u),p(i.details,u),n.partTypeMap[i.name.toLowerCase()]=i,i.assetTypeDefinition=(t.assetTypes||[]).first((function(n){return n.partName===i.name})),f(i.details,0),i.parameterProvider&&k(i),lt(n,i),r.sanitizeInlineTemplate(n.name,i.name,i,o),i.processed=!0,i)}function b(n,t,u,f){if(f=f||{},u.processed)return u;i.isFeatureEnabled("pinnable_default_off")&&i.isNullOrUndefined(u.pinnable)&&(u.pinnable=!!u.pinnedPart);u.attributes&2&&(u.optionalInputs=u.optionalInputs||[],u.optionalInputs.push("_provisioningContext"));u.templateBlade&&ct(u);u.menuBlade&&ft(u);u.frameBlade&&et(u);(u.lenses||[]).forEach((function(n){(n.partInstances||[]).forEach((function(n){y(n.reference,f);p(n.inline&&n.inline.details,f)}))}));n.bladeMap[u.name.toLowerCase()]=u;u.assetTypeDefinition=(t.assetTypes||[]).first((function(n){return n.bladeName===u.name}));st(u);u.effectiveInputs||(u.effectiveInputs=u.viewModelInputs||[]);var e=ut(u);return n.partTypeMap[e.name.toLowerCase()]=e,r.sanitizeBladeDefinition(n.name,u,o),u.processed=!0,u}function ut(t){var r=n.PinPrefix+t.name,i;return t.pinnedPart||(t.pinnedPart=r),i={name:r,viewModel:n.PinVMPrefix+t.name,partKind:e.Button,inputs:t.inputs,initialSize:2,details:[{blade:t.name,isMultiple:!1,invocationInputArguments:[{valuesFrom:[{property:"container.selectable.value",referenceType:0}]}],additionalInputArguments:[]}],bindings:[],viewStateProperties:["container.selectable.isSelected"],commandGroup:t.commandGroup,commandGroupReference:t.commandGroupReference,assetIdInputProperty:t.assetIdInputProperty,assetType:t.assetType},(t.inputs||[]).forEach((function(t){i.bindings.push({property:n.collisionPrefix+t,valuesFrom:[{property:t,referenceType:1}]})})),(t.optionalInputs||[]).forEach((function(t){t!==d.ReferrerInfo&&i.bindings.push({property:n.collisionPrefix+t,optional:!0,valuesFrom:[{property:t,referenceType:1}]})})),t.viewModelInputs&&t.viewModelInputs.forEach((function(n){n.property===t.assetIdInputProperty&&i.bindings.push(n)})),i}function t(n,t,i,r){t&&t.forEach((function(t){var u=!r&&i&&i.indexOf(t)>-1;n.inputs.push(t);n.bindings.push({property:t,optional:r,isIdentityInput:u,valuesFrom:[{referenceType:1,property:t}]})}))}function s(n,t,i,r,u,f,o,s,h,c,l){return{name:n,inline:{bindings:[],details:[],inputs:[],partKind:c||e.Custom,viewModel:t.viewModelName,htmlTemplate:i,htmlTemplateInline:r,assetType:t.assetType,assetIdInputProperty:t.assetIdInputProperty,initialSize:u,viewStateProperties:[],shareVmWithParentBlade:!0,partState:f,styleSheets:s,permissions:h,isV2:l},parameterProvider:o}}function ft(n){var u=n.name,e=n.menuBlade.isV2,r=s(u,n,undefined,{content:"<div data-bind='pcControl: "+(e?"viewModel._msPortalFxMenu":"menu")+"' class='ext-menublade-part'><\/div>",file:u+i.getUniqueId()},9,undefined,!1,[],undefined),f;t(r.inline,n.inputs,n.templateKeyInputs);t(r.inline,n.optionalInputs,[],!0);f={name:u,partInstances:[r]};n.lenses.splice(0,0,f);n.effectiveInputs=r.inline.bindings;i.isNullOrUndefined(n.pinnable)&&(n.pinnable=!0)}function et(n){var r=n.name,i=s(r,n,undefined,undefined,9,n.frameBlade.partState,!1,[],n.permissions,e.Frame),u;t(i.inline,n.inputs,n.templateKeyInputs);t(i.inline,n.optionalInputs,[],!0);n.toolbar={source:{valuesFrom:[{referenceType:0,part:r,property:"content.commandBar"}]}};u={name:r,partInstances:[i]};n.lenses.splice(0,0,u);n.effectiveInputs=i.inline.bindings}function ot(n){n.startBoardParts&&n.startBoardParts.forEach((function(n){n.inline&&f(n.inline.details,0)}));n.commandsCatalog&&n.commandsCatalog.forEach((function(n){f([n.details],4)}));n.commandGroups&&n.commandGroups.forEach((function(n){n.commands&&n.commands.forEach((function(n){f([n.details],4)}))}))}function st(n){n.lenses&&n.lenses.forEach((function(t){t.partInstances&&t.partInstances.forEach((function(t){t.inline&&(t.parameterProvider&&k(t.inline),f(t.inline.details,0));ht(n,t.name,t)}))}))}function f(n,t){n&&n.filter((function(n){return n&&!!n.parameterCollector})).forEach((function(n){u.addCallerBindings(n.parameterCollector+".bladeCaller",n,t)}))}function k(n){n.editScopeType=n.editScopeType||"PDLEditScope";n.inputs=n.inputs||[];n.inputs.push(h);u.addCallablePartInputs(n)}function ht(n,t,i){if(i.parameterProvider&&(n.attributes|=1,u.addCallableBindings(c+".bladeCallable",n,t,i),n.actionBar)){n.actionBar.bindings=n.actionBar.bindings||[];var r=n.actionBar.bindings.some((function(n){return n.property==="input"}));r||n.actionBar.bindings.push({property:"input",valuesFrom:[{referenceType:0,part:t,property:c+".defaultActionBarInput"}]});n.templateBlade||(i.inline||i.reference).bindings.push({property:h,valuesFrom:[{referenceType:2,property:"content.output"}]})}}function ct(n){var i=n.templateBlade,r=s(n.name,n,i.htmlTemplate,i.htmlTemplateInline,i.partSize?i.partSize:8,i.partState,i.parameterProvider,i.styleSheets,n.permissions,null,i.isV2),u,f;n.lenses=n.lenses||[];n.lenses.push({name:"TemplateBladeVirtualLens",partInstances:[r]});n.locked=!0;u=r.inline;t(u,n.inputs,n.templateKeyInputs);t(u,n.optionalInputs,[],!0);f=n.effectiveInputs=u.bindings;n.outputs&&n.outputs.forEach((function(t){n.bindings=n.bindings||[];n.bindings.push({property:t,valuesFrom:[{referenceType:0,property:"content."+t,part:r.name}]})}));n.editScopeType&&f.push({property:"editScopeId",valuesFrom:[{referenceType:1,property:"editScopeId"}]});n.actionBar&&(n.actionBar.source={valuesFrom:[{referenceType:0,part:r.name,property:"content.actionBar"}]});n.toolbar&&(n.toolbar.source={valuesFrom:[{referenceType:0,part:r.name,property:"content.commandBar"}]});u.details=i.details}function lt(n,t){var i=t.reference,u,r,f;i&&(u=i.partTypeName===tt&&(i.extension===l||!i.extension&&n.name===l),u&&(r=i.bindings,f=r.first((function(n){return n.property===a})),f||(r.push({property:a,valuesFrom:[{referenceType:9,property:v}],optional:!0}),t.inputDefinitions.push({name:v,type:nt.TimeRangeValueType,optional:!0}))))}var d=i.Base.Constants.BladeParameterNames,at=i.Extension,g=i.Parts,e=g.PartKind,nt=i.Composition.Configuration,h="internal_parameterProviderActionBarOutput",c="content.parameterProvider",o=i.isDevelopmentMode?1:0;n.PinPrefix="InferredBladePinPart";n.PinVMPrefix="Shell."+n.PinPrefix;n.collisionPrefix="inferredBladePinPartInputs.";var l="Microsoft_Azure_Insights",tt="MetricsSummaryPart",a="timeRange",v="_msPortalFxTimeRange";n.preprocessDefinition=it;n.processControl=rt;n.processPart=w;n.processBlade=b})(f||(f={})),f}));
define("MsPortalImpl/Extension/Extension.Definition.Locator",["require","exports","f","i","o","ko","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Extension/DefinitionPreprocessor"],(function(n,t,i,r,u,f,e,o){"use strict";function v(n,t){for(var u=[],i=n,r;i;)u.unshift(i.getCacheKeyPart()),i=i.parent;return r=u.join("-"),t?r:r.toLowerCase()}function st(n,t){for(var r=[],i=n;i;)r.unshift(i.getCacheFriendlyKeyPart(t)),i=i.parent;return r.join(t)}function nt(n,t){return n.definition.partTypeMap[t.toLowerCase()]}function b(n,t){var i="<InvalidJsonString>";try{i=JSON.stringify(t)}catch(r){}return et.error("{0} JSON: {1}".format(n,i)),a.forExtension("##ErrorDeserializingLocator##-{0}".format(i))}function ht(n){return n&&(l=n),l}function k(n,t,i,r,u){return"["+n+"]"+t+"-"+i+"-"+r+"-"+u}function ct(n,t){c[k(t.type,t.fromExtension||n,t.fromPart,t.fromBlade,t.fromLens)]=i.extend({toExtension:n},t)}function lt(){l={};c={}}function at(n,t,i){var r=ft.buildResourceTypeFromResourceId(t);return it(n,r,i)}function it(n,t,i){var u=t.toLowerCase(),r=n.getExtensions().some((function(n){var r=n.getManifest("assetTypes"),t=r&&r.assetTypes.first((function(n){return n.resourceType&&n.resourceType.resourceTypeName&&n.resourceType.resourceTypeName.toLowerCase()===u&&n.browseType!==3}));return t&&(i.extensionName=n.name,i.value=t),!!t}));return r||(i.error="Unable to locate extension for resource type '{0}'.".format(t),i.value=null),r}var l,c,s,y,a,p,tt,rt;u.defineProperty(t,"__esModule",{value:!0});var w=r.Extension,d=i.Base.Constants,ut=i.Base.Diagnostics,vt=i.Extension,ft=i.ViewModels.Services.ResourceTypes,h={extensionNotFound:"Unable to locate extension '{0}'.",bladeNotFound:"Unable to locate blade '{0}' in extension definition.",actionBarNotFound:"Unable to locate action bar '{0}' in extension definition.",partInstanceNotFound:"Unable to locate part instance '{0}' in extension definition.",partTypeNotFound:"Unable to locate part type '{0}' in extension definition.",commandTypeNotFound:"Unable to locate command type '{0}' in extension definition.",lensNotFound:"Unable to locate lens '{0}' in extension definition.",assetTypeNotFound:"Unable to locate asset type '{0}' in extension definition.",commandGroupNotFound:"Unable to locate command group '{0}' in extension definition.",commandNotFound:"Unable to locate command '{0}' in extension definition.",hubNotFound:"Unable to locate hub '{0}' in extension definition."},et=ut.createLog(n),ot="{0} Search path:'{1}'.",g=o.PinPrefix;l={};c={};t.redirects=ht;t.addPartRedirect=ct;t.clearRedirects=lt,(function(n){n[n.Extension=0]="Extension";n[n.Blade=1]="Blade";n[n.Lens=2]="Lens";n[n.AssetType=3]="AssetType";n[n.CommandGroup=4]="CommandGroup";n[n.PartInstance=5]="PartInstance";n[n.PartType=6]="PartType";n[n.StartboardPartInstance=7]="StartboardPartInstance";n[n.BladeActionBar=8]="BladeActionBar";n[n.Command=9]="Command";n[n.ExtensionManifest=10]="ExtensionManifest";n[n.Hub=11]="Hub";n[n.CustomLens=12]="CustomLens";n[n.CommandType=13]="CommandType";n[n.BladeRedirect=14]="BladeRedirect";n[n.PartInstanceRedirect=15]="PartInstanceRedirect";n[n.PartTypeRedirect=16]="PartTypeRedirect"})(s=t.LocatorType||(t.LocatorType={}));y=(function(n){function t(t,i,r){var u=n.call(this,r)||this;return u.source=i,u.data=t,u}return __extends(t,n),t})(i.Errors.Error);t.LocatorError=y;a=(function(){function n(n,t,i,r,u,f,e){this.type=n;this.name=t;this.parent=u;this.enumerate=i;this.getValue=f;this.getValueAsync=e;this.errorMessageFormat=r}return n.forExtensionManifest=function(n){return new p(s.ExtensionManifest,n,function(n){return n.getExtensions()||[]},h.extensionNotFound)},n.forExtension=function(n){return new p(s.Extension,n,function(n){return n.initializedExtensions},h.extensionNotFound)},n.fromJSON=function(t){var i;if(!t||typeof t!="object")return b("Locator object is invalid.",t);var r=t.parent?n.fromJSON(t.parent):null,u=s[t.type],f="with{0}".format(u);if(!r&&t.type!==s.Extension&&t.type!==s.ExtensionManifest)return b("Locator with name '{0}' has no parent.".format(t.name),t);switch(t.type){case s.Extension:return i=l[t.name]||t.name,n.forExtension(i);case s.ExtensionManifest:return i=l[t.name]||t.name,n.forExtensionManifest(i)}return f in r?r[f](t.name):b("Unknown locator type: {0}.".format(u),t)},n.prototype.getCacheKeyPart=function(){return"["+this.type+"]"+this.name},n.prototype.getCacheFriendlyKeyPart=function(n){return n===void 0&&(n="/"),""+s[this.type]+n+this.name},n.prototype.withBlade=function(t){return new n(s.Blade,t,undefined,h.bladeNotFound,this,function(n,t){return n.definition.bladeMap[t.toLowerCase()]},function(n){return n.getBladeDefinition(t)})},n.prototype.withPartInstance=function(t){return new n(s.PartInstance,t,function(n){return n.partInstances},h.partInstanceNotFound,this)},n.forPartInstanceRedirect=function(t,r,u,f){var e=k(5,t,r,u,f);return new n(s.PartInstanceRedirect,e,undefined,h.assetTypeNotFound,undefined,function(){return c[e]&&i.extend({name:e},c[e])})},n.forPartTypeRedirect=function(t,r){var u=k(4,t,r);return new n(s.PartTypeRedirect,u,undefined,h.assetTypeNotFound,undefined,function(){return c[u]&&i.extend({name:u},c[u])})},n.prototype.withBladeActionBar=function(t){return new n(s.BladeActionBar,t,function(n){return n.actionBar?[n.actionBar]:[]},h.actionBarNotFound,this)},n.prototype.withStartboardPartInstance=function(t){return new n(s.StartboardPartInstance,t,function(n){return n.definition.startBoardParts},h.partInstanceNotFound,this)},n.prototype.withPartType=function(t){return new n(s.PartType,t,undefined,h.partTypeNotFound,this,nt,function(n){if(i.startsWith(t,g)){var r=t.substr(g.length);return n.getBladeDefinition(r).then((function(){return nt(n,t)}))}return n.getPartDefinition(t)})},n.prototype.withCommandType=function(t){return new n(s.CommandType,t,function(n){return n.definition.commandsCatalog},h.commandTypeNotFound,this)},n.prototype.withLens=function(t){return new n(s.Lens,t,function(n){return n.lenses},h.lensNotFound,this)},n.prototype.withCustomLens=function(t){return new n(s.CustomLens,t,function(){return[{name:t,partInstances:[]},]},"N/A",this)},n.prototype.withAssetType=function(t){return new n(s.AssetType,t,function(n){return n.getManifest("assetTypes").assetTypes},h.assetTypeNotFound,this)},n.prototype.withBladeRedirect=function(t){return new n(s.BladeRedirect,t,null,h.assetTypeNotFound,this,function(n){return n.getBladeRedirect(t)})},n.prototype.withCommandGroup=function(t){return new n(s.CommandGroup,t,function(n){return n.definition.commandGroups},h.commandGroupNotFound,this)},n.prototype.withCommand=function(t){return new n(s.Command,t,function(n){return n.commands},h.commandNotFound,this)},n.prototype.getExtensionLocator=function(){for(var t=this;t.parent;)t=t.parent;return t.type===s.ExtensionManifest?n.forExtension(t.name):t},n.prototype.toString=function(){return v(this,!0)},n.prototype.toFriendlyString=function(n){return n===void 0&&(n="/"),st(this,n)},n.prototype.equals=function(n){if(this.name&&n&&n.name&&this.name===n.name&&this.type===n.type){if(this.parent)return this.parent.equals(n.parent);if(!n.parent)return!0}return!1},n.prototype.toJSON=function(){return{name:this.name,type:this.type,parent:this.parent&&this.parent.toJSON()}},n.prototype.readFromIdentifiable=function(n){this.name=n.name},n})();t.Locator=a;p=(function(n){function t(t,i,r,u){var f=n.call(this,t,i,r,u)||this;return f.getValueAsync=function(n){return n.getExtensionByName(i)},f}return __extends(t,n),t.prototype.getCacheKeyPart=function(){var n=w.getWindowId(this);return"[{0}]{1}".format(this.type,n)},t.prototype.getCacheFriendlyKeyPart=function(n){n===void 0&&(n="/");var t=w.getWindowId(this);return"{0}{1}{2}".format(s[this.type],n,t)},t.prototype.equals=function(n){return this.name&&n&&w.isEqualDescriptor(this,n)&&this.type===n.type},t.prototype.readFromIdentifiable=function(n){this.name=n.name},t})(a);t.ExtensionLocator=p;tt=(function(){function t(n,t){this._extensionManager=n;this._cache=t||{}}return t.populateCache=function(n,t,i){return n[v(t)]=i,n},t.prototype.locateAsync=function(n){var u=this,t={},r,f,i;return this.tryLocate(n,t)?Q(t.value):(r=void 0,i=n.parent,i?(r=this.locateAsync(i),f=i.errorMessageFormat.format(i.name)):r=Q(this._extensionManager),r.then((function(i){if(f=n.errorMessageFormat.format(n.name),u.tryLocate(n,t))return t.value;if(n.getValueAsync)return n.getValueAsync(i);throw new y(n.type,n.toFriendlyString(),t.error);})).then((function(){if(u.tryLocate(n,t))return Q(t.value);throw new y(n.type,n.toFriendlyString(),t.error);})))},t.prototype.locate=function(t,i){var r={},u=null,f;return this.tryLocate(t,r)?u=r.value:(f=i||t.getExtensionLocator().name,e.logToExtension(n,f,2,r.error)),u},t.prototype.tryLocate=function(n,t){var r=v(n),u,i={},e=!1,f,o;return this._cache.hasOwnProperty(r)||(n.parent?this.tryLocate(n.parent,i):i.value=this._extensionManager,i.value&&(n.getValue?(f=n.getValue(i.value,n.name),f!==undefined&&(this._cache[r]=f)):(o=n.enumerate(i.value),this._fillCacheFromArray(o,n)))),u=this._cache[r],u?(t.value=u,e=!0):(t.error=ot.format(n.errorMessageFormat.format(n.name),n.toString()),i.error&&(t.error=i.error+"\n"+t.error)),e},t.prototype._fillCacheFromArray=function(n,t){var r=this,i=f.toJS(t);n&&n.forEach((function(n){i.readFromIdentifiable(n);var t=v(i);r._cache[t]=n}))},t})();t.DefinitionFinderImpl=tt;t.tryLocateAssetDefinitionFromResourceId=at;t.tryLocateAssetDefinitionFromResourceType=it;rt=d.BladeNames.Hubs.ResourceMenuBlade;t.hubsLocator=a.forExtension(d.ExtensionNames.Hubs);t.resourceMenu=t.hubsLocator.withBlade(rt)}));
define("MsPortalImpl/Services/Services.PortalIdentity",["require","exports","f","i","o","FxInternal/Di","MsPortalImpl/Resources/ImplScriptResources"],(function(n,t,i,r,u,f,e){"use strict";function p(n,t){return(n&t)===t}function w(n,t){var i={};t.forEach((function(n){if(n.tokenSettings&2){var t=n.features,r=(t&&t.allowedUserInfo||"").toLowerCase(),u=y[r]||0;i[s.getWindowId(n)]=u}}));s.getUserInfoEndPoint.register(h.client,null,(function(t,r){return n.getUserInfo(i[r.srcWindowId])}))}function b(){if(!o){var n=Q.defer();v.updateSubscriptionInfoEndPoint.register(h.client,[l],(function(t){n.resolve(t)}));o=n.promise}return o}var y,l,o;u.defineProperty(t,"__esModule",{value:!0});var a=r,s=a.Extension,h=r.Rpc,v=HubsExtension.Internal.Azure,c=(function(){function n(n){var t=!1;n||(n={},t=!0);n={displayName:n.displayName,firstName:n.firstName,lastName:n.lastName,avatarUri:n.avatarUri,defaultAvatarUri:n.defaultAvatarUri,tenantId:n.tenantId,tenantDomain:n.tenantDomain,perTenantId:n.perTenantId,changePasswordUri:n.changePasswordUri,isAnonymous:t,isOrgId:n.isOrgId,objectId:n.objectId,principalId:n.principalId};this.value=n}return n.prototype.getUserInfo=function(n){var t=this;return i.tryImmediateResolve(this.getTenants(),(function(r){var f=t.value.tenantId||"",l=r.tenants,s=f,h=f,a=f,u=l.first((function(n){return f.toLowerCase()===(n.id||"").toLowerCase()})),c,o;return u&&(s=(u.displayName||"").toLocaleLowerCase(),h=u.domainName,a=l.filter((function(n){return(n.displayName||"").toLocaleLowerCase()===s})).length>1?e.Services.PortalIdentity.tenantNameAndDomainFormat.format(u.displayName,h):u.displayName),c=i.isNullOrUndefined(n)?7:n,o={},p(c,3)&&i.extend(o,{email:t.value.displayName,givenName:t.value.firstName,surname:t.value.lastName}),p(c,4)&&i.extend(o,{directoryId:t.value.tenantId,directoryName:s,domainName:h,isOrgId:t.value.isOrgId,objectId:t.value.objectId,principalId:t.value.principalId,uniqueDirectoryName:a}),o}))},n.prototype.getTenants=function(){var r=this,n;return t.Internal.tenantsPromise||(n=Q.defer(),v.updateTenantInfoEndPoint.register(h.client,[l],(function(t){n.resolve(t.tenantInfo)})),t.Internal.tenantsPromise=n.promise),i.tryImmediateResolve(t.Internal.tenantsPromise,(function(n){var t=n.tenants.first((function(n){return(n.id||"").toLowerCase()===(r.value.tenantId||"").toLowerCase()})),i=r.value.tenantDomain;return t&&(t.displayName||(t.displayName=i),t.domainName||(t.domainName=i)),n}))},n.prototype.getSignedInUserTenant=function(){return this.value.tenantDomain||""},n.create=function(){return new n(null)},n.register=function(t,i){var r=new n(i);return t.set(n,r),r},n})();__decorate([f.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",c)],c,"create",null);t.SignedInUser=c;y={directory:4};l=s.getHubsWindowId();a.registerGlobalState({reset:function(){o=null}});t.initializeRpc=w;t.getSubscriptions=b;t.Internal={}}));
define("MsPortalImpl/Services/Services.Storage",["require","exports","f","o","a","Fx/DependencyInjection"],(function(n,t,i,r,u,f){"use strict";function a(){return e.forEach((function(n){var t=o[n.name];t.count=t.keySize=t.valueSize=0})),o}var l,h,c,e,o,s;r.defineProperty(t,"__esModule",{value:!0});l=i.Base.Diagnostics.createLog(n);h=JSON.stringify,(function(n){n[n.DesktopManager=2]="DesktopManager";n[n.AssetMruList=3]="AssetMruList";n[n.ExtensionManager=4]="ExtensionManager";n[n.Router=5]="Router";n[n.UserSettings_Journeys=6]="UserSettings_Journeys";n[n.UserSettings_EditScopes=7]="UserSettings_EditScopes";n[n.Relex=8]="Relex";n[n.ManifestVersions=9]="ManifestVersions";n[n.Redirect=10]="Redirect";n[n.Cdn=11]="Cdn";n[n.UserSettings_NewJourneys=12]="UserSettings_NewJourneys";n[n.Telemetry=13]="Telemetry";n[n.Dashboard=14]="Dashboard";n[n.Avatar=15]="Avatar";n[n.UserSettingsService=16]="UserSettingsService";n[n.HelpContent=17]="HelpContent";n[n.DashboardSession=18]="DashboardSession"})(c=t.ComponentName||(t.ComponentName={}));e=i.getEnumArray(c);o={};e.forEach((function(n){o[n.name]={count:0,keySize:0,valueSize:0}}));s=(function(){function n(){function t(n){return c[n]+"_"}function r(n,i){return t(n)+(i||"")}function n(n){return n===1?f:o}function u(n,t,i){for(var u,r=0;r<n.length;r++)u=n.key(r),t.call(i,n.getItem(u),u,n)}function s(n){var f=a(),t=0,o="",r;u(n,(function(n,r){var c=i.find(e,(function(n){return i.startsWith(r,n.name)})),u,s;c&&(u=f[c.name],u.count++,u.keySize+=r.length,s=h(n).length,u.valueSize+=s,s>t&&(t=s,o=r))}));try{r=h(f)}catch(s){r="Could not stringify the summary. Exception: "+i.getLogFriendlyMessage(s)}return"Summary: {0}. The longest value (key == {1}) took {2} bytes. The total storage length is {3}.".format(r,o,t,n.length)}var f=MsPortalImpl.sessionStorage,o=MsPortalImpl.localStorage;this.getValue=function(t,i,u){return n(u).getItem(r(t,i))};this.getAllComponentItems=function(i,r){var f=t(i),o=n(r),e={},s=f.length;return u(o,(function(n,t){if(t.startsWith(f)){var i=t.substring(s,t.length);e[i]=n}})),e};this.setValue=function(t,i,u,f){var o=n(f),h=r(t,i),e;try{o.setItem(h,u)}catch(c){e=new Error("Storage.setItem failed.");e.innerError=c;e.storageState=s(o);e.key=h||i;l.error(e)}};this.clearValue=function(t,i,u){var f=n(u),e=r(t,i),o=f.getItem(e);return f.removeItem(e),o};this.clearAllComponentItems=function(i,r){var o=t(i),f=n(r),e=[];u(f,(function(n,t){t.startsWith(o)&&e.push(t)}));e.forEach((function(n){return f.removeItem(n)}))};this.clearAll=function(){o.clear();f.clear()}}return n})();s=__decorate([f.Class(),__metadata("design:paramtypes",[])],s);t.StorageService=s}));
define("MsPortalImpl/UI/UI.DesktopManager",["require","exports","f","o"],(function(n,t,i,r){"use strict";r.defineProperty(t,"__esModule",{value:!0});t.DesktopManagerEvents={activeJourneyChanged:"activejourneychanged",journeyActivating:"journeyActivating",journeyDeactivated:"journeyDeactivated",journeyDiscarded:"journeyDiscarded",journeyCreating:"journeyCreating",journeyCreated:"journeyCreated",bladeOpening:"bladeOpening",bladeRebound:"bladeRebound",bladeClosed:"bladeClosed",settingsLoaded:"settingsLoaded"};t.isTraceEnabled=!!i.trace.desktop}));
define("MsPortalImpl/Base/Base.Router",["require","exports","f","i","o","ko","FxInternal/Di","FxHubs/ResourceProvider","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Services/Services.Storage","MsPortalImpl/Base/Telemetry","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/Base/Base.ImplUtils","FxHubs/MarketplaceRpc","MsPortalImpl/Services/Services.PortalIdentity","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){"use strict";function ri(n,t,r){var o={},f,e,u;try{for(f=0;f<n.length;){if(e=ii(n[f++]),!e)throw new Error("invalid decodeKey:"+e);u=ii(n[f++]);r&&u&&u.match(/^\s*\{.*\}\s*$/)&&(u=yt.safeJSONParse(u));o[e]=u}}catch(s){throw new i.Errors.Error({message:"Deep link "+t+" has illegal inputs",innerErrors:s});}return o}function fi(n,t){return function(){var r,u;try{t.apply(n,arguments)}catch(i){r=!0;i instanceof DOMException&&(u=i,(u.code===DOMException.SECURITY_ERR||u.name==="SecurityError")&&(r=!1));r&&st.error(i,0)}}}function w(){return new a.Uri(location.href)}function it(n){return n===void 0&&(n=w()),n.getHashParts().category.localeCompareIgnoreCase("dashboard")===0}function at(n){return n===void 0&&(n=w()),n.isHashEmpty()||it(n)}function yi(n){return n===void 0&&(n=w()),["asset","blade","create","resource"].indexOf(n.getHashParts().category)>=0}function vt(n,t){return(pt(n)+"dashboard/"+t).toLowerCase()}function pi(n,i,r,u){var f=vt(n,i),e;u=u||w();u.hash.toLowerCase()!=="#"+f&&(u.setHash(f),e=r?t.history_replaceState:lt,e(null,null,u.href))}function wi(n){return n===void 0&&(n=w()),it(n)?n.getHashParts().rest:""}function bi(n,t){return t===void 0&&(t=w()),n.getValue(b,ft,1)===t.hashWithHashQueryString&&n.getValue(b,g,1)||""}function ki(n,t,i,r,u){u===void 0&&(u="");var f=r;return f&&typeof f=="string"&&kt.isResourceManagerId(f)&&(f=f.substring(1)),new a.Uri(u).setHash("#{0}{1}/{2}/{3}/{4}".format(pt(n),"asset",t.name,i,f)).toString()}function di(n,t,i,r){var u="#{0}/{1}";return r&&(f.unwrap(r.additionalConfig)||{}).preview&&(u+="/preview"),new a.Uri(t).setHash(u.format("create",n)).toString()}function gi(n,t,r,u,e,o){e===void 0&&(e=!1);var s=new a.Uri(r),c=!0,h="";return(o&&(h="/"+o),i.forEachKey(u,(function(n,t){if(n!=="editScopeId"){var i=f.unwrap(t);if(i&&typeof i=="object")if(e)i=JSON.stringify(i);else{c=!1;return}i!==undefined&&(h+="/{0}/{1}".format(encodeURIComponent(n),encodeURIComponent(i||"")))}})),!c)?"":(s.setHash("#blade/{0}/{1}{2}".format(n.name,t,h)),s.href.length>2082)?"":s.toString()}function nr(n){return new yt.RouterImpl(n,r.Rpc.client)}function pt(n){var t=n.get(y.SignedInUser).getSignedInUserTenant();return t?"@"+t+"/":""}var ui,d,lt,yt;u.defineProperty(t,"__esModule",{value:!0});var wt=i.Base,rt=wt.Constants,ei=rt.BladeNames.Hubs,oi=rt.AssetNames,bt=wt.Diagnostics,si=bt.Telemetry,hi=i.Hubs.Notifications.NotificationStatus,ut=i.ViewModels,kt=ut.Services.ResourceTypes,dt=l.DesktopManagerEvents,ci=i.isFeatureEnabled,g="sessionStorageJourneyId",ft="sessionStorageDeepLink",nt=s.Shell,gt=nt.deepLinkInvalid,ni=nt.deepLinkErrorLoading,et=window,ot=et.fx.environment,ti=s.Portal.defaultPageTitle.format(s.NavBar.home,ot.branding.title),st=bt.createLog(n),b=h.ComponentName.Router,tt=si.trace,li=/^[\w-]+$/,k=et.history,ii=decodeURIComponent,ht=nt.deepLinkNotFound,ai=rt.ExtensionNames,ct=ai.Marketplace,vi=ci("sideBarAutoCollapsedInJourney");ui={linkFormat:"",invalidLink:"",unfoundAsset:"",noResourceAsset:""};d=r.getErrorMap(ui);lt=fi(k,k.pushState);t.history_replaceState=fi(k,k.replaceState);t.isDashboardRoute=it;t.isDashboardUri=at;t.isBladeUri=yi;t.getDashboardDeepLink=vt;t.updateDashboardUri=pi;t.getDashboardIdFromUri=wi;t.getStoredJourneyId=bi,(function(n){function f(n){try{return JSON.parse(n)}catch(t){return n}}function u(n,t,i,r){return{extension:n,assetType:t,detailBladeInputs:i,defaultMenuItemId:r}}function e(n){var t=(n||"").split("/"),r=t.length,u,i,f;return r<2?null:(i=r%2,i===1&&(u=t[2]),f=ri(t.slice(2+i),n,!0),{extension:t[0],detailBlade:t[1],detailBladeInputs:f,defaultMenuItemId:u})}n.safeJSONParse=f;var h=(function(){function n(n,t){var f=this,u;this._diContainer=n.diContainer;this._assetTypes=n.assetTypeService;this._desktop=n.desktop;this._extensions=n.extensionManager;this._notifications=n.notificationManager;this._storage=n.storageService;this._ltm=new r.TriggerableLifetimeManager;u={};this._getHandler=function(n){var t=n.getHashParts().category;return u[t]};i.forEachKey({asset:this._handleAssetRoute,blade:this._handleBladeRoute,create:this._handleCreateRoute,menu:this._handleMenuRoute,resource:this._handleResourceRoute,dashboard:this._handleDashboardRoute},(function(n,t){u[n]=function(n){return t.call(f,n)}}));ut.navigateToDashboardEndPoint.register(t,null,(function(n){var t=n[0],i=n[1];f.navigateToDashboard(t,i)}))}return n.prototype.route=function(n){return this._route(new a.Uri(n))},n.prototype._route=function(n,t){var u=this;return i.tryImmediateResolve(Q(),(function(){var e=t&&t.dashboardRouteHandled,f=t&&t.skipFocus,i;if(n.isHashEmpty()||it(n)&&e)u._handleStartBoardRoute(f);else return i=u._getHandler(n),i?i(n.getHashParts().rest,f):r.QReject("{0} is not a valid deep link".format(n.hashWithHashQueryString))}))},n.prototype.initialRoute=function(n,t){var f=this,r=w(),i,u;return i=this._getHandler(r)?this._route(r,{dashboardRouteHandled:!0,skipFocus:t.skipFocus}).catch(n):n(),this.startListening(),i=i.catch((function(n){st.warning(n,1,"Unable to load initial route.");f.goToDashboardOnInit("InitialRouteFailed")})),u=r.getHashParts().category,!u||u==="dashboard"?Q():i},n.prototype.startListening=function(){var n=this,t=this._desktop,i=this._isListening;i&&i.dispose();i=this._isListening=this._ltm.createChildLifetime();i.registerForDispose([$(window).setEvents([p.default.hashchange,function(){var t=w();n._route(t,!1).catch((function(){n._desktop.portalWidget.trigger(p.default.fxhomebuttonclick)}))}]),$(t.portalWidget.element).setEvents([p.default.fxhomebuttonclick,function(){n.navigateToDashboard("HomeClick")}]),$(t).setEvents([dt.activeJourneyChanged,function(){var r=w(),i=n._getActiveJourneyId(),u=n._storage.getValue(b,g,1),f=u===i||(k.state||{}).journeyId===i,e,o;f||i?(f||at(r)||u&&u!==i)&&(o=!0):(t.isJourneyLoading||(n._clearStorage(),at(r)||k.pushState({},ti,r.setHash("#").href),n._updateTitle()),e=!0);e||n._updateNavHistory({addToHistory:o});vi&&!f&&i&&t.portalWidget.getSideBarWidget().options.isCollapsed(!0)},],[dt.bladeRebound,function(){n._updateNavHistory()},]),])},n.prototype._clearStorage=function(){var n=this._storage;n.clearValue(b,g,1);n.clearValue(b,ft,1)},n.prototype.stopListening=function(){var n=this._isListening;n&&n.dispose();this._isListening=null},n.prototype.dispose=function(){this.stopListening();var n=this._ltm;n&&(n.dispose(),this._ltm=null)},n.prototype.navigateToDashboard=function(n,t){var i=!t?w():w().setHash(vt(this._diContainer,t)),r;tt({source:n||"Base.Router",action:c.Action.DashboardNavigation});r=t?i.href:i.setHash("#").clearHashQueryStringIfEmpty().href;k.pushState({},"",r);this._route(i)},n.prototype.goToDashboardOnInit=function(n,t){var i=this._desktop;return i.portalWidget.trigger(p.default.fxshowstartboard,null,{skipFocus:t}),i.getDashboardManager().then((function(t){var i=t.currentDashboardId();return t.switchDashboard({id:i,title:i},n)}))},n.prototype._handleStartBoardRoute=function(n){var u=this._getActiveJourneyId(),r=this._desktop,f=r.portalWidget,t,i;r.tryDeactivateJourney()&&(u||(t=f.getPanorama(),i=t&&t.getJourneyWidget(),i&&i.close()),this.goToDashboardOnInit("Router",n),this._updateTitle())},n.prototype._handleDashboardRoute=function(n,t){var i=this;return this._desktop.getDashboardManager().then((function(t){return t.switchDashboard({id:n,title:n},"Router")})).then((function(){i._handleStartBoardRoute(t)}))},n.prototype._handleBladeRoute=function(n,t){var f=this,r,u;return t=t||e(n),r=this._desktop,u=r.generateLoadingJourneyGuid(),i.tryImmediateResolve(r.createJourneyForBlade(t,u),i.identity,(function(t){return f._notify(ni.format(n)),Q.reject(t)}))},n.prototype._handleCreateRoute=function(n){var o=this,u=(n||"").split("/"),t,f,e,s;return u.length?(tt({source:c.Source.Gallery,action:c.Action.DeepLinkVisited,name:n}),t=u.shift(),f=ri(u,n),t!=="hub"&&t!=="Microsoft.Support"?i.require("./MsPortalImpl/UI/Compositions/UI.Composition.BladeOpener.Provisioning").then((function(r){var e=i.tryImmediateResolve(o._extensions.getExtensionByName(ct),(function(){return Q(v.getCreateFlow({marketplaceGalleryItemId:t,launchingContext:{source:["DeepLink"]},additionalConfig:f,alternateCreateFlowOptions:{useStackSelectionIfAvailable:!0}}))}));return Q.all([r.getMarketplaceItemAndInitialValues({marketplaceResults:e}),e,]).spread((function(t,r){var f=r.bladeSelection;return i.extend(f.detailBladeInputs,t),o._handleBladeRoute(n,{extension:f.extension,detailBlade:f.detailBlade,detailBladeInputs:f.detailBladeInputs,defaultMenuItemId:u[2]})}))})):(e="",this._extensions.initializedExtensions.some((function(n){return n.name===ct}))||(e="/useDelayedBlade/true/bladeWidth/1"),s="{0}/{1}/package/{2}/additionalConfig/{3}/selectedMenuItemId/undefined/createLanding/undefined{4}".format(ct,ei.CreateHubBlade,encodeURIComponent(t),encodeURIComponent(JSON.stringify(f)),e),this._handleBladeRoute(s))):(this._notify(gt.format(n)),r.QReject("Deep link "+n+" should be #{routeTypes.create}/{package-id}."))},n.prototype._handleMenuRoute=function(n){li.test(n)||d.linkFormat(n);var t=this._desktop.portalWidget.element.find(".fxs-menu-"+n.toLowerCase());return t.length!==1&&d.invalidLink(n),this._updateNavHistory({skipFocus:!0}),t.click(),Q()},n.prototype._handleAssetRoute=function(n){var h=this,t=n.split("/"),s,l;if(t=n.match(/([^\/]+)\/([^\/]+)\/(.+)/i),!t||t.length<4)return this._notify(gt.format(n)),r.QReject("'"+n+"' is invalid. Correct format is #asset/{ExtensionName}/{AssetType}/{AssetId}");var e=t[1],f=t[2],o=t[3];return typeof o=="string"&&kt.isResourceManagerId("/"+o)&&(o="/"+o),s=this._desktop,l=s.generateLoadingJourneyGuid(),i.tryImmediateResolve(this._extensions.getManifestByName(e),(function(n){e=n.name;var i=f.toLowerCase(),t=n.assetTypes.first((function(n){return n.name.toLowerCase()===i}));return t||(h._notify(ht.format(f)),d.unfoundAsset(f)),f=t.name,tt({source:c.Source.Asset,action:c.Action.DeepLinkVisited,name:e,data:f}),s.createJourneyForAsset(u(e,f,{},null),l,o)}),(function(n){h._notify(ht.format(e));throw n;}))},n.prototype._handleResourceRoute=function(n){var f=this,t,r,e,s;return n="/"+n.replace(/^\//,""),n=decodeURI(n),t=n.split("/"),r=null,t.length%2==0&&(r=t[t.length-1],n=n.substr(0,n.length-r.length-1)),e=this._desktop,s=e.generateLoadingJourneyGuid(),i.tryImmediateResolve(Q(),(function(){var t=o.buildResourceType(n);return i.tryImmediateResolve(f._assetTypes.getAssetTypeByResourceTypePromiseWithFallback(t),(function(t){var o=t.assetTypeManifest,h=o.name,l=t.extension,i=o.resourceType.resourceTypeName;return h||(f._notify(ht.format(i)),d.noResourceAsset(i)),tt({source:c.Source.Resource,action:c.Action.DeepLinkVisited,name:l,data:i||oi.NonAssetResource}),e.createJourneyForAsset(u(l,h,{},r),s,n)}))}),(function(t){f._notify(ni.format(n));throw t;}))},n.prototype._updateTitle=function(){var r=this._desktop,t=r.getActiveJourney(),u=r.startBoard,f=u&&u.getDashboard()||{},n;if(document.title=f.title?s.Portal.windowTitleFormat.format(f.title,ot.branding.title):ti,n=this._titleLifetime,n&&n.dispose(),t&&t.blades.length>0){n=this._titleLifetime=this._ltm.createChildLifetime();var i=t.blades[t.blades.length-1],e=i.isDefaultTitle(),o=i.title.subscribe(n,(function(n){et.document.title=s.Portal.windowTitleFormat.format(n,ot.branding.title)}));e||o.callback(i.title())}},n.prototype._getActiveJourneyId=function(){var n=this._desktop.getActiveJourney();return!n||n.isStartedWithContextBlade()?"":n.id},n.prototype._notify=function(n){var t=new Date;this._notifications.addClientNotification({title:nt.deepLinkInvalidTitle,description:n,status:hi.Error,timestamp:t,correlationIds:[t.getTime().toString()]})},n.prototype._updateNavHistory=function(n){var r=this,f=n&&n.addToHistory,e=n&&n.skipFocus,u=this._desktop.getActiveJourney();return u?i.tryImmediateResolve(u.getDeepLink(),(function(n){var o=r._getActiveJourneyId(),i,e,l;if(o){var s=u.blades,h=s[s.length-1],c=h&&h.bladeDefinition;c&&c.menuBlade||(i=w(),i.setHash(n),e=r._storage,e.setValue(b,g,o,1),e.setValue(b,ft,i.hashWithHashQueryString,1),i.href.toLowerCase()!==location.href.toLowerCase()&&(l=f?lt:t.history_replaceState,l({},document.title,i.href)),r._updateTitle())}}),(function(n){st.warning(new i.Errors.Error({message:"Failed to update address bar.",data:{id:r._getActiveJourneyId(),key:u.templateKey},innerErrors:n}))})):(this._handleStartBoardRoute(e),Q())},n})();n.RouterImpl=h})(yt=t.Internal||(t.Internal={}));t.getAssetDeepLink=ki;t.getGalleryDeepLink=di;t.getBladeDeepLink=gi;t.createRouter=nr;t.rpcGetDashboardDeepLink=e.defineHandler(ut.getDashboardDeepLinkEndPoint,(function(n){var t=window.location,i=new a.Uri(t.toString()),u=pt(n.diContainer),r=t.port;return[t.protocol,"//",i.host,r?":"+r:"",t.pathname,i.queryString,"#",u,n.messageArg].join("")}))}));
define("MsPortalImpl/Services/Services.Settings",["require","exports","f","i","o","Fx/DependencyInjection","FxHubs/HubsSettingsSchema","MsPortalImpl/Services/Services.Storage"],(function(n,t,i,r,u,f,e,o){"use strict";function ut(n){return function(t){this[t]=n}}function ht(){return i.map(h,i.identity)}function ct(n){return v[n+1e3]}function lt(n){return h[n]}function at(n,t){if(!t||!t.length)return Q({});var i=t.map((function(t){return n.queryStore(t)}),n);return Q.all(i).then((function(n){var i={};return n.forEach((function(n,r){i[t[r]]=n})),i}))}function vt(n,t,i){var r={};return r[t]=i,{store:n,settings:r}}function b(n){return JSON.parse(JSON.stringify(n))}function yt(n){var t=[n?n.flushSettings():Q(),d.Telemetry.flush(),d.Upload.flush(),],i=t.every((function(n){return!n||Q.isPromise(n)?!Q.isPending(n):n.state()!=="pending"}));return i?Q():Q.all(t)}var h,v,y,c;u.defineProperty(t,"__esModule",{value:!0});var l=i.Base,k=l.Net2,d=i.Base.Diagnostics,p=i.tryImmediateResolve;var ft=window,g=ft.fx,w=g.environment,nt=i.isFeatureEnabled,a=w.settingsBaseUri+"{0}"+w.settingsUriQuery,tt=a.format("/Update"),it=a.format("/Select"),et=a.format("/Clear"),ot=a.format("/ClearAll"),s=l.Diagnostics.createLog(n),rt=g.early,st=rt&&rt.preloadSettings;l.getVersionFromString(w.version).revision=0;h={General:0,Blade:1,Part:2,LensState:3,Startboard:4,SharedPart:5,HubsExtension:6,CrossTenant:7,JourneySession:8,EditScopeSession:9,Favorites:10,DashboardInventory:11,FileUpload:12,FirstVisited:14,StartupNotifications:15};v=i.forEachKey(h,(function(n,t,i){i[t]=n}),[]),(function(){for(var t,i,n=0;n<100;n++)t="Dashboard"+n,i=n+1e3,h[t]=i,v[i]=t})();t.getAllStoreIds=ht;t.getDashboardStoreName=ct;t.getDashboardStoreId=lt;t.queryStores=at,(function(n){function rt(n,t,i){return new c(new h(new f(e.createWithWriteDeleteBufferTimeout(n,i),t)))}function t(n){var t=v[n];if(!t)throw new Error("Invalid store: "+n);return t}function a(n,r){var u={},f;return i.forEachKey(r,(function(i,r){var e=t(i);u[e]=r;n&&delete n[e];f=u})),f}function y(n){var i={},t;return n.keys.forEach(ut(null),i),t={},t[n.store]=i,t}function ft(n,t){var f=i.merge(n,t),r={settingsToSet:{},settingsToDelete:{}};return r=f.reduce((function(n,t){return u(n.settingsToSet,n.settingsToDelete,t.settingsToSet),u(n.settingsToDelete,n.settingsToSet,t.settingsToDelete),n}),r),[r]}function u(n,t,r){i.forEachKey(r,(function(u){var f=parseInt(u),o=r[f],e;n&&(n[f]||(n[f]={}),w(o,n[f]));t&&(e=t[f],e&&(b(o,e),i.isEmpty(e)&&delete t[f]))}))}function w(n,t){i.forEachKey(n,(function(n,i){t[n]=i}))}function b(n,t){i.forEachKey(n,(function(n){delete t[n]}))}var d,f,g,e,h;n.createUserSettingsManager=rt;n.getSettingStoreName=t;n.convertSettingQueryToDictionary=y;n.updateDictionary=u;n.updateSettingsDictionary=w;n.sanitizeSettingsDictionary=b;d=(function(){function n(){this._maps={}}return n.prototype.setSettings=function(n){i.forEachKey(n.settings,(function(n,t,i){i.set(n,JSON.stringify(t))}),this._getMap(n.store))},n.prototype.queryStore=function(n){var i=this._getMap(n),t={};return i.forEach((function(n,i){t[i]=JSON.parse(n)})),Q(t)},n.prototype.deleteSettings=function(n){if(n.keys){var t=this._getMap(n.store);n.keys.forEach((function(n){t.delete(n)}))}},n.prototype.clearSettings=function(){return Q(this._maps={})},n.prototype.flushSettings=function(){return Q()},n.prototype.dispose=function(){},n.prototype._getMap=function(n){return this._maps[n]=this._maps[n]||new i.Map},n})();n.InMemorySettingsManagerImpl=d;f=(function(){function n(n,t){var i=this;this._baseManager=n;this._managersDictionary={};this._managers=[this._baseManager];t&&t.forEach((function(n){i._managers.push(n.manager);n.stores.forEach((function(t){i._managersDictionary[t]=n.manager}))}))}return n.prototype.queryStore=function(n){return this._getManager(n).queryStore(n)},n.prototype.deleteSettings=function(n){this._getManager(n.store).deleteSettings(n)},n.prototype.setSettings=function(n,t){this._getManager(n.store).setSettings(n,t)},n.prototype.clearSettings=function(){return Q.all(this._managers.map((function(n){return n.clearSettings()})))},n.prototype.flushSettings=function(){return this._baseManager.flushSettings()},n.prototype.dispose=function(){this._baseManager.dispose()},n.prototype._getManager=function(n){return this._managersDictionary[n]||this._baseManager},n})();n.RoutingSettingsManager=f;g=(function(){function n(n,t){t===void 0&&(t=st);var r=this;this._ajaxState=0;this._memoizedQueryStore=i.memoizeQ((function(n){var t=i.startTimer();return r._ajax(it,[n]).then((function(i){r._setAjaxState(1);var f=i&&i.content&&i.content[n]||{},u=t();return u>5e3&&s.warning("Request to store '"+n+"' took more than 5s to complete.\n                                                    Request time: "+u+"ms.\n                                                    Response size: "+(i&&i.jqXHR&&i.jqXHR.responseText.length)),f})).catch((function(n){return r._setAjaxState(2,n,"queryStore(duration:"+t()+")"),Q({})}))}));this._storageService=n;this._preloadStores=i.forEachKey(t,(function(n,t,u){u[n]=i.tryImmediateResolve(Q(t),(function(n){return r._setAjaxState(1),n}),(function(t){return i.Helpers.isXMLHttpRequestLike(t)&&k.isRetryable(t)||s.error(new i.Errors.Error({message:"Early Failed to preload store '"+n+"'.",innerErrors:t}),1),r._memoizedQueryStore(n)}))}),{})}return n.prototype._ajax=function(n,t){var u=this;return!t&&(n===tt||n===it)?Q.reject(r.createError("Invalid setting ajax call uri: "+n+", data: "+i.getObjectDescriptor(t))):Q(k.ajaxExtended({uri:n,headers:{"x-ms-user-settings-session":this._storageService.getValue(o.ComponentName.UserSettingsService,"x-ms-user-settings-session",1)||""},type:"POST",dataType:"json",data:t&&JSON.stringify(t),contentType:"application/json;charset=utf-8",performRetry:!0})).then((function(n){return u._storageService.setValue(o.ComponentName.UserSettingsService,"x-ms-user-settings-session",n.jqXHR.getResponseHeader("x-ms-user-settings-session"),1),n})).catchError(i.Errors.AjaxError,(function(r){return r.jqXHR.status===400?s.error("Setting _ajax 400 occurred. uri: "+n+", data: "+i.getObjectDescriptor(t,!0)+"."):r.jqXHR.status>=500&&s.error("Setting _ajax 5xx occurred. uri: "+n+", response: "+r.jqXHR.responseText+"."),Q.reject(r)}))},n.prototype._setAjaxState=function(n,t,r){n>this._ajaxState&&(this._ajaxState=n,n===2&&s.error(new i.Errors.Error({message:r+" Setting is transitioned into HasFailRequests state. All further querystore/updatesetting will be in-memory mode.",innerErrors:t})))},n.prototype.queryStore=function(n){var i=t(n);return this._ajaxState>=2?Q({}):this._preloadStores[i]||this._memoizedQueryStore(i)},n.prototype.clearSettings=function(){var n=this,t;return i.forEachKey(this._preloadStores,(function(t){delete n._preloadStores[t]})),this._memoizedQueryStore.clear(),t=i.startTimer(),this._ajax(nt("clearallusersettings")?ot:et).catch((function(i){n._setAjaxState(2,i,"clearSetting(duration:"+t()+"):")}))},n.prototype.updateSettings=function(n){var u=this,t,r;return this._ajaxState===1&&(t={save:a(this._preloadStores,n.settingsToSet),remove:a(this._preloadStores,n.settingsToDelete)},t.save||t.remove)?(r=i.startTimer(),this._ajax(tt,t).catch((function(n){return u._setAjaxState(2,n,"updateSettings(duration:"+r()+"):"),Q.reject(n)}))):Q()},n})();n.UserSettingsManagerImpl=g;e=(function(){function n(n,t,i,r){var u=this;this._primitiveSettingsManager=n;this._sequencer=t(ft,(function(n){return u._executeMethod(n[0])}),i,!0,{optionalDataInterval:r})}return n.createWithWriteDeleteBufferTimeout=function(t,i,r){var u=i!==undefined?i:5e3,f=r!==undefined?r:3e5;return new n(t,function(n,t,i,r,u){return new l.Debouncer(n,t,i,r,u)},u,f)},n.prototype.queryStore=function(n){return this._primitiveSettingsManager.queryStore(n)},n.prototype.setSettings=function(n,t){if(!i.isEmpty(n.settings)){var r={};r[n.store]=n.settings;this._sequencer.execute([{settingsToSet:r,settingsToDelete:{}}],t===1)}},n.prototype.deleteSettings=function(n,t){n.keys&&n.keys.length&&this._sequencer.execute([{settingsToDelete:y(n),settingsToSet:{}}],t===1)},n.prototype.flushSettings=function(){return this._sequencer.flush()},n.prototype.clearSettings=function(){var t=this,n=Q.defer();return this.flushSettings().finally((function(){t._primitiveSettingsManager.clearSettings().finally((function(){n.resolve()}))})),n.promise},n.prototype.dispose=function(){this.flushSettings()},n.prototype._executeMethod=function(n){return this._primitiveSettingsManager.updateSettings(n)},n})();n.SequencingSettingsManager=e;h=(function(){function n(n){var t=this;this._cache={};this._activeUpdatePromises=new i.Map;this._uniqueId=1;this._memoizedQueryPromises=i.memoizeQ((function(n){var i=t._verifySettings()?t._baseManager.queryStore(n):Q({});return p(i,(function(i){return t._updateCaches(n,i)}))}));this._baseManager=n}return n.prototype.queryStore=function(n){return this._memoizedQueryPromises(n)},n.prototype.setSettings=function(n,t,i){this._execute(this._setSettingsInternal,n,t,i)},n.prototype.dispose=function(){this._baseManager.dispose()},n.prototype._setSettingsInternal=function(n,t,i,r){var f=this,e=this._writeSettingsToCache(n,!0),u=function(){f._baseManager.setSettings(e,t)};r?(u(),this._resolveSetPromise(i)):this._executeIfBaseManagerCallIsAllowed(u,i)},n.prototype._resolveSetPromise=function(n){var t=this._activeUpdatePromises.get(n);t&&(t.resolve(),this._activeUpdatePromises.delete(n))},n.prototype._execute=function(n,t,i,r){var o=this,e=this._uniqueId++,u,f;this._activeUpdatePromises.set(e,Q.defer());t&&(u=t.store,f=function(){n.call(o,t,i,e,r)},this._cache[u]?f():p(this.queryStore(u),f))},n.prototype.deleteSettings=function(n,t){this._execute(this._deleteSettingsInternal,n,t)},n.prototype._deleteSettingsInternal=function(n,t,i){var r=this;this._deleteSettingsFromCache(n);this._executeIfBaseManagerCallIsAllowed((function(){r._baseManager.deleteSettings(n,t)}),i)},n.prototype.clearSettings=function(){var n=this,t=Q.defer();return this.flushSettings().finally((function(){return Q(n._baseManager.clearSettings()).finally((function(){n._cache={};n._memoizedQueryPromises.clear();t.resolve()}))})),t.promise},n.prototype.flushSettings=function(){var t=this,n=[];return this._activeUpdatePromises.forEach((function(t){return n.push(t)})),Q.all(n).then((function(){return t._baseManager.flushSettings()}))},n.prototype._updateCaches=function(n,t){return this._writeSettingsToCache({store:n,settings:t}),this._cache[n]},n.prototype._verifySettings=function(){return nt("inmemorysettings")?!1:!0},n.prototype._executeIfBaseManagerCallIsAllowed=function(n,t){n();this._resolveSetPromise(t)},n.prototype._deleteSettingsFromCache=function(n){var t=this._cache[n.store];n.keys&&t&&n.keys.forEach((function(n){delete t[n]}))},n.prototype._writeSettingsToCache=function(n,t){if(n){var r=this._cache[n.store]||(this._cache[n.store]={}),u={};return i.forEachKey(n.settings,(function(n,i){t&&(r[n]===i||JSON.stringify(r[n])===JSON.stringify(i))||(r[n]=u[n]=i)})),{store:n.store,settings:u}}return null},n})();n.CachingSettingsManagerImpl=h})(y=t.Internal||(t.Internal={}));c=(function(){function n(n){this._baseManager=n}return n.prototype.deleteSettings=function(n,t){this._baseManager.deleteSettings(n,t)},n.prototype.clearSettings=function(){return this._baseManager.clearSettings()},n.prototype.flushSettings=function(){return this._baseManager.flushSettings()},n.prototype.dispose=function(){this._baseManager.dispose()},n.prototype.queryStore=function(n,t){return p(this._baseManager.queryStore(n),(function(n){return t?n:b(n)}))},n.prototype.querySettings=function(n){return n.keys&&n.keys.length>0?this.queryStore(n.store,!0).then((function(t){var i={},r;return t&&(r=n.keys.filter((function(n){return n in t})),r.forEach((function(n){i[n]=t[n]}))),b(i)})):this.queryStore(n.store)},n.prototype.querySetting=function(n,t){return this.querySettings({store:n,keys:[t]}).then((function(n){if(n){var i=n[t];return i===undefined?null:i}return null}))},n.prototype.setSettings=function(n,t){this._baseManager.setSettings(b(n),t)},n.prototype.setSetting=function(n,t,i,r){this.setSettings(vt(n,t,i),r)},n.create=function(n){var t={manager:new y.InMemorySettingsManagerImpl,stores:[8,9,13,]};return y.createUserSettingsManager(new y.UserSettingsManagerImpl(n),[t])},n})();__decorate([f.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[o.StorageService]),__metadata("design:returntype",c)],c,"create",null);t.SettingsManager=c;t.flush=yt}));
define("MsPortalImpl/UI/UI.NavigationManager",["require","exports","f","o","FxInternal/Di","MsPortalImpl/Base/Telemetry","MsPortalImpl/Services/Services.PortalIdentity","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Base/JQueryHelper"],(function(n,t,i,r,u,f,e,o,s){"use strict";function y(n){return function(t){t?s.unhide(n):s.hide(n)}}var c,l;r.defineProperty(t,"__esModule",{value:!0});var a=i.Base,v=a.UriBuilder,p=a.Diagnostics,w=p.Telemetry,b=i.Helpers,k=f.Action,d=f.Source,h=window,g=w.trace,nt=i.pathJoin,tt=d.Shell;c=(function(){function n(n,t){this.portal=n;this.splashScreen=t;[n,t].forEach((function(n){var t=n.length;if(t!==1)throw new Error("Unexpected length '"+n.selector+"': "+t);}));this.showPortal=y(n);this.showSplash=y(t)}return n.create=function(){return new n($("#web-container"),$("body").find("> .fxs-splashscreen"))},n.prototype.dispose=function(){this.showPortal(!1)},n})();__decorate([u.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",c)],c,"create",null);t.RootElements=c;l=(function(){function n(n,t,r){var s=this,u;this.unloadCallbacks=[];this.unloadCallbacks.push((function(){return o.flush(t)}));u=function(){s.unloadCallbacks.forEach((function(n){return n()}))};h.addEventListener("unload",u);this.location=h.location;this.redirect=function(t){var i=t.uri,o=b.Deferred(),u;r.showSplash(!0);g({source:tt,action:k.PortalRedirect,actionModifier:f.ActionModifier.Redirect,data:i});u=function(){o.resolve()};t.skipFlushBuffers?u():(Q.all(s.unloadCallbacks.map((function(n){return n()}))).finally(u),h.setTimeout(u,5e3));Q.allSettled([t.delayPromise,o]).finally((function(){if(!i){var t=new v(location.href);t.path=nt("/",t.path,n.get(e.SignedInUser).value.tenantId,"/");i=t.toString()}location.href=i}))};this.openWindow=function(t){var r=h.open();return Q(t).then((function(t){var f;if(t){var u=new v(t),o=u.path,s=i.ensureSuffix(o,"/");i.localeCompareIgnoreCase(s,i.ensureSuffix(location.protocol+"//"+location.host,"/"))||(f=u.fragment,f.startsWith("#@")||(u.fragment="#@"+n.get(e.SignedInUser).getSignedInUserTenant()+(f[0]==="#"?"/"+f.slice(1):""),t=u.toString()))}r.location.href=t}))};this.dispose=function(){h.removeEventListener("unload",u)}}return n})();l=__decorate([u.Class(),__metadata("design:paramtypes",[u.Container,o.SettingsManager,c])],l);t.WindowManager=l}));
define("MsPortalImpl/UI/Hubs/UI.NotificationManager",["require","exports","f","i","o","a","ko","MsPortalImpl/Base/Base.Router","MsPortalImpl/Base/Telemetry","MsPortalImpl/UI/UI.NavigationManager"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";function ui(n){return ht=new ft(n)}function fi(){return ht}function lt(n,t){var i=o.getBladeDeepLink({name:t.extension},t.detailBlade,"",t.detailBladeInputs,!0);n.route(i)}function at(n){return k.getWindowId({name:n})}function ei(n){return at(n.name)}function b(n){return n&&n.trim()}function vt(n){if(n.additionalProperties||(n.additionalProperties={}),!n.additionalProperties[rt]){var t=n.asset,i=t&&t.assetId,r=void 0;st.isResourceManagerId(i)&&(r=st.parseResourceManagerDescriptor(i).subscription);n.additionalProperties[rt]=r}}function yt(n){return vt(n),r.ViewModels.getBladeSelection(it,g.BladeNames.AzureMonitoring.EventsBrowseBlade,{queryInputs:{notification:{title:n.title,timestamp:n.timestamp.toString(),subscriptionId:(n.additionalProperties||{})[rt]||null}}})}function oi(n,t,i){var p=t.isRecommendation?tt.RecommendationClicked:tt.NotificationClicked,e,u,r,s,f;if(wt(t,p),e=n.router,u=t.asset,u){var c=u.assetType,l=c.toLowerCase(),a=u.extensionName,y=a.toLowerCase(),w=i||!n.extensionManager.getExtension(it)||y===v.Billing.toLowerCase()&&l===et.SubscriptionDetail.toLowerCase()||y===ii.toLowerCase()&&l===et.Deployments.toLowerCase();if(w){e.route(o.getAssetDeepLink(n.diContainer,{name:a},c,u.assetId));return}}if(r=t.uri,r){s=t.uriAction||d.Resources.isUriAbsolute(r)&&ct||nt.NavigatePortal;s===ct?n.diContainer.get(h.WindowManager).openWindow(r):s===nt.OpenInCurrentTab?ni.location.href=r:e.route(r);return}f=t.linkedBlade;f||i||(f=yt(t));f&&lt(n.router,f)}function si(n){switch(n){case 0:return l.Error;case 1:return l.Warning;case 2:return l.Success;case 3:return c;case 4:return l.Information}}function wt(n,t){var u=n.additionalProperties||{},f=n.correlationIds,r;i.extend(u,{status:l[n.status],correlationId:f&&f.join(",")});r=n.asset;kt.trace({source:ti,action:t,assetType:r&&r.assetType||"UnknownAsset",data:u})}function a(n,t){if(n&&t)return at(n)+"."+t}var pt,ft;u.defineProperty(t,"__esModule",{value:!0});var bt=r.Constants,k=r.Extension,d=i.Base,g=d.Constants,et=g.AssetNames,v=g.ExtensionNames,ot=d.Diagnostics,kt=ot.Telemetry,dt=i.Hubs.Notifications,l=dt.NotificationStatus,gt=i.ViewModels,y=r.Hubs.Notifications,nt=y.ClientNotificationUriAction,p=r.NotificationManager,tt=s.Action,st=gt.Services.ResourceTypes,ni=window,hi=ot.createLog(n),ht,ti=s.Source.NotificationHub,ii=v.Hubs,it=v.AzureMonitoring,ri=k.getHubsWindowId(),w=k.getDescriptor,rt="subscriptionId",ct=nt.OpenInNewTab,c=l.InProgress,ut=u.keys;t.createNotificationManager=ui;t.getNotificationManager=fi;pt=(function(){function n(n,t){this.extensionWindowId=n;this.notificationDefinition=t}return n})();ft=(function(){function t(n){var t=this,u,f,o,s,c;this._listOfNotifications=e.observableArray();this._notificationDefinitions={};this._extensionNotifications={};this._serverEventToNotificationMap={};this._extensionsHeldByCorrelationId={};this._extensionsLoaded={};this._notificationsLifetime=new r.TriggerableLifetimeManager;this._services=n;u=n.rpcClient;f=function(n){return Q(t._extensionsLoaded[n]?!0:t.itemsPromise)};p.addNotificationsEndPoint.register(u,null,(function(n,i){var r=i.srcWindowId;r&&f(r).finally((function(){var i=n.notifications.map((function(n){return t._mapFxNotificationV1ToClientNotification(n)}));i=i.filter((function(n){return!!n}));i.forEach((function(n){return t._addOrUpdateNotification(n,r)}))}))}));p.addNotification2EndPoint.register(u,null,(function(n,i){var r=i.srcWindowId;r&&f(r).finally((function(){var i=t._mapNotificationV2ToClientNotification(r,n.id,n.name,n.status,n.subStatus,n.assetId,n.properties);t._addOrUpdateNotification(i,r)}))}));p.updateNotificationEndPoint.register(u,null,(function(n,i){f(i.srcWindowId).finally((function(){var i=t.notifications().first((function(t){return(t.correlationIds||[]).some((function(t){return t.toLowerCase()===n.id}))}));if(i){var u=n.propertyName.toLowerCase(),f=n.propertyValue,r=i.correlationIds;u==="correlationid"?(r||(i.correlationIds=r=[]),r.push(f),t._addOrUpdateNotification(i)):u==="percentcomplete"&&(i.percentComplete=f,t._addOrUpdateNotification(i))}}))}));o=function(n,r){var u=r.srcWindowId,f;u&&(f=i.merge(n),f.forEach((function(n){t._addOrUpdateNotification(n,u)})))};s=[ri];y.addClientNotificationDefinition.register(u,null,o);y.addClientNotificationsDefinition.register(u,null,o);p.addServerEventsEndPoint.register(u,s,(function(n,i){n.serverEvents.forEach((function(n){n&&f(i.srcWindowId).finally((function(){t._addServerEvent(n)}))}))}));y.showModalNotification.register(u,s,(function(i){var r=i.notification;return t.addClientNotification(r),t._services.getService("DialogManager").then((function(n){return t.addClientNotification(r),n.showModalDialog({title:r.title,description:r.description,buttons:2,defaultButtonText:i.primaryButtonText,cancelButtonText:i.secondaryButtonText,showErrorIcon:!0})})).then((function(u){var f=undefined;return u===4?f=i.primaryButtonClickAction:u===1&&(f=i.secondaryButtonClickAction),f===1?t.handleNotificationClick(r):f===2&&n.diContainer.get(h.WindowManager).redirect({uri:"/"}),u}))}));c=this._services.extensionManager;this.itemsPromise=i.memoizeQ((function(){return c.on("notifications",(function(n){return t._collectNotificationDefinitions(n)}))}));c.onLoad((function(n){return t._collectNotificationDefinitions(n.getManifest("notifications"))}))}return t.prototype.listenForClientNotifications=function(){var i=this,n=[],t=this._services;t.extensionManager.getExtensions().forEach((function(t){t.name===v.AzureInsights?n.push(t.getWindowId()):t.name===it&&n.push(t.getWindowId())}));t.rpcClient.registerRpcEndPoint(bt.RpcMethods.getClientNotifications,{allowedOrigin:n,handler:function(){return i.notifications()}})},t.prototype.addClientNotification=function(n){vt(n);this._addOrUpdateNotification(n)},t.prototype.showNotificationDetails=function(n){lt(this._services.router,yt(n))},t.prototype.handleNotificationClick=function(n,t){oi(this._services,n,t)},u.defineProperty(t.prototype,"notifications",{get:function(){return this._listOfNotifications},enumerable:!0,configurable:!0}),t.prototype.definitionCount=function(){return ut(this._notificationDefinitions).length},t.prototype.newDefinitionCount=function(){return ut(this._extensionNotifications).length},t.prototype.serverEventsCount=function(){return ut(this._serverEventToNotificationMap).length},t.prototype._setLoadedExtension=function(n){this._extensionsLoaded[n]=!0},t.prototype.removeNotification=function(n){var t=this.notifications().first((function(t){return(t.correlationIds||[]).some((function(t){return t===n}))}));t&&this.notifications.remove(t)},t.prototype._addOrUpdateNotification=function(t,r){var u=this,f;t&&b(t.title)&&b(t.description)&&(f=function(){t.clickable=e.observable(!!t.asset||!!t.linkedBlade||!!t.uri);t.descriptionAsHtml||(t.descriptionAsHtml=!1);(t.correlationIds||[]).length||(t.correlationIds=["clientNotification-"+i.getUniqueId()]);var n=u.notifications(),f=n.first((function(n){var i=n.correlationIds||[];return i.filter((function(n){return t.correlationIds.indexOf(n)!==-1})).length>0}));if(f)if(f.timestamp.getTime()<t.timestamp.getTime()||f.status===c)n.remove(f);else return;n.unshift(t);t.status!==c&&(n=i.stableSort(n,(function(n,t){return n.status===c?t.status===c?0:-1:t.status===c?1:t.timestamp.getTime()-n.timestamp.getTime()})));n.length>100&&n.pop();u.notifications(n);t.isRecommendation&&wt(t,tt.RecommendationAdded);r&&u._holdOntoExtension(r,t)},t.inlineForm?i.require(n.normalize("./UI.ActionableNotifications")).then((function(n){var i=u._notificationsLifetime;n.makeActionable(i,t,u._services);f()})):(t.formSection=undefined,f()))},t.prototype._addServerEvent=function(n){var t,i;n.source&&n.operationName&&(t=this._serverEventToNotificationMap[a(n.source,n.operationName)],t&&(i=this._mapNotificationV2ToClientNotification(t.extensionWindowId,n.correlationId,t.notificationName,n.status,n.subStatus,n.assetId,n.properties,n.timestamp,!0),i&&this.addClientNotification(i)))},t.prototype._collectNotificationDefinitions=function(n){var t=this,i=ei(n),f=n.name,u=n.notifications,r;return u&&u.forEach((function(n){var r=a(n.eventSource,n.eventType);t._notificationDefinitions[r]||(t._notificationDefinitions[r]=new pt(i,n))})),r=n.notifications2,r&&r.forEach((function(n){var u=n.name,o=a(f,u),r,e;t._extensionNotifications[o]=n;r=n.serverEvent;r&&r.operation&&r.source&&(e=a(r.source,r.operation),t._serverEventToNotificationMap[e]={extensionWindowId:i,notificationName:u})})),this._extensionsLoaded[i]=!0,!0},t.prototype._holdOntoExtension=function(n,t){var i=this,r=t.correlationIds,f,u;if(r)if(t.status===c){if(f=r.some((function(n){return!!i._extensionsHeldByCorrelationId[n]})),!f){var s=w(n),e=this._services,o=e.extensionManager.getExtension(s.name);o&&(u=e.rpcClient.acquireWindow(o.getWindowId(),600),r.forEach((function(n){i._extensionsHeldByCorrelationId[n]=u;u.onDispose((function(){i._extensionsHeldByCorrelationId[n]&&delete i._extensionsHeldByCorrelationId[n]}))})))}}else r.forEach((function(n){var t=i._extensionsHeldByCorrelationId[n];t&&t.dispose()}))},t.prototype._mapNotificationV2ToClientNotification=function(n,t,i,r,u,f,e,o,s){var p,c,h,l,v,y,b;if(s===void 0&&(s=!1),p=w(n),c=this._extensionNotifications[a(p.name,i)],c&&(l=c.messages.filter((function(n){return n.status.toLowerCase()===r.toLowerCase()})),u?h=l.first((function(n){return n.subStatus&&n.subStatus.toLowerCase()===u.toLowerCase()})):l.length===1&&(h=l[0]),h))return v=h.message,e&&(v=v.format(e)),y={title:h.title,description:v,timestamp:o||new Date,isRecommendation:!1,status:si(h.type),correlationIds:[t],additionalProperties:[],isServerEvent:s},!!(h.assetType||c.assetType)&&f&&(b=h.assetType||c.assetType,y.asset={extensionName:w(n).name,assetType:b,assetId:f}),y},t.prototype._mapFxNotificationV1ToClientNotification=function(n){var t=this._formatNotificationV1FromExtensionManifest(n),i,r;if(t)return i={title:t.label,description:t.description,timestamp:t.timestamp,isRecommendation:!1,percentComplete:t.percentOperationComplete,status:t.state,correlationIds:[],additionalProperties:{}},r=t.clientDetails,t.assetId&&r&&(i.asset={extensionName:w(r.assetOwner).name,assetType:r.assetType,assetId:t.assetId}),t.correlationId&&i.correlationIds.push(t.correlationId),t.operationId&&i.correlationIds.push(t.operationId),t.subscriptionId&&(i.additionalProperties.subscriptionId=t.subscriptionId),i},t.prototype._formatNotificationV1FromExtensionManifest=function(n){var i=n.eventType,u=n.source,r,t;return u&&i&&(r=this._notificationDefinitions[a(u,i)],t=void 0,r?(t=r.notificationDefinition,n.label=t.label,n.description=t.message.format(n.descriptionArgs),n.clientDetails=t.assetType?{assetOwner:r.extensionWindowId,assetType:t.assetType}:null):(n.label=n.label||i,n.description=n.description||i,n.assetId||(n.clientDetails=null))),b(n.label)&&b(n.description)?n:void 0},t})();t.NotificationManager=ft}));
define("MsPortalImpl/UI/Hubs/ViewModels/UI.Gallery.CsmCommand",["require","exports","f","o","ko","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/UI/Hubs/UI.NotificationManager"],(function(n,t,i,r,u,f,e){"use strict";r.defineProperty(t,"__esModule",{value:!0});var h=i.Azure.ResourceManager,v=i.Base,y=v.Diagnostics,c=i.Services.Gallery.Constants,s=f.Gallery.Notifications,o=y.createLog(n),l=c.GalleryParametersKey,a=i.clone,p=u.observable,w=(function(){function n(){this.status=p()}return n.prototype.execute=function(t){var f;if("data"in t&&"options"in t){if(f=t.data,l in f.outputParameters){var i=f.outputParameters[l],r=t.options[c.GalleryOptionsKey],u=r&&r.launchingContext||{},e=this._getGalleryItemId(r.galleryItem);if(e||(o.warning("Null GalleryItemId."),e=i.deploymentName),u=a(u,!0),u.oldCreateApi=!0,u.galleryItemId=u.galleryItemId||e,this._validateOptions(i,r,f)){var y=n._findPropInObject(i.selectedTemplateId,r.deploymentTemplateFileUris),p={subscriptionId:i.subscriptionId,deploymentName:i.deploymentName||r.deploymentName,resourceGroupName:i.resourceGroupName,resourceGroupLocation:i.resourceGroupLocation,resourceProviders:JSON.parse(i.resourceProviders||null),parameters:a(f.outputParameters[i.selectedTemplateId],!0),templateLinkUri:!i.templateJson&&y||undefined,templateJson:i.templateJson,deploymentMode:1,launchingContext:u},v=new Date;return h.Deployments.deployTemplate(p).then((function(n){if(n===void 0&&(n={}),n.deploymentStatusCode===h.DeploymentStatusCode.Success){var i=(n.deployment||{}).properties||{},t=new Date(i.timestamp&&i.timestamp.valueOf()||n.timestamp&&n.timestamp.valueOf());return t&&t.getTime()<=v.getTime()&&(t=new Date(v.getTime()+1)),{correlationId:i.correlationId||n.correlationId,timestamp:t}}return Q.reject()}))}return this._notify(s.createArgumentsValidationFailedMessage),Q.reject()}return this._notify(s.createOptionsNotSpecifiedMessage),o.error("Create options are not specified in the output parameters."),Q.reject()}return this._notify(s.createCommandMissingArgumentsMessage),o.error("The data or the options needed by the deployment command are not specified."),Q.reject()},n.prototype._validateOptions=function(t,i,r){var u="CsmCommand was rejected because ";if(t){if(!t.templateJson&&!t.selectedTemplateId)return o.error(u+"neither templateJson nor selectedTemplateId were specified."),!1;if(t.templateJson)try{JSON.parse(t.templateJson)}catch(f){return o.error(u+"templateJson was malformed."),!1}if(!t.subscriptionId)return o.error(u+"subscriptionId not specified."),!1;if(!t.resourceGroupName)return o.error(u+"resourceGroupName not specified."),!1;if(!t.resourceGroupLocation)return o.error(u+"resourceGroupLocation not specified."),!1;if(i){if("subscriptionId"in i&&i.subscriptionId!==t.subscriptionId)return o.error(u+"subscriptionId was changed in the create process."),!1;if("resourceGroupName"in i&&i.resourceGroupName!==t.resourceGroupName)return o.error(u+"resourceGroupName was changed in the create process."),!1;if("resourceGroupLocation"in i&&i.resourceGroupLocation!==t.resourceGroupLocation)return o.error(u+"resourceGroupLocation was changed in the create process."),!1}}else return o.error(u+"galleryParameters not specified."),!1;if(i){if(i.deploymentTemplateFileUris){if(!t.templateJson&&!n._findPropInObject(t.selectedTemplateId,i.deploymentTemplateFileUris))return o.error(u+"templateJson wasn't defined and selectedTemplateId isn't defined in the deploymentTemplateFileUris."),!1}else return o.error(u+"deploymentTemplateFileUris not specified."),!1;if(!("deploymentName"in i))return o.error(u+"deploymentName not specified."),!1}else return o.error(u+"configurationOptions not specified."),!1;return r?!0:(o.error(u+"create outputs not specified."),!1)},n._findPropInObject=function(n,t){n=n.toLowerCase();for(var i in t)if(t.hasOwnProperty(i)&&n===(i+"").toLowerCase())return t[i];return null},n.prototype._notify=function(n){var t={title:s.createResourceFailedLabel,description:n,status:i.Hubs.Notifications.NotificationStatus.Error};e.getNotificationManager().addClientNotification(t)},n.prototype._getGalleryItemId=function(n){var t=n&&n.id,r=(n||{}).launchingContext,i;return t=r&&r.galleryItemId||t,t&&(i=t.split("."),i.length>1&&(t="{0}.{1}".format(i[0],i[1]))),t},n.prototype._deployTemplate=function(n){var t=new Date;return h.deployTemplate(n).then((function(n){var i=n&&n.timestamp&&new Date(n.timestamp.valueOf());return i&&i.getTime()<=t.getTime()&&(i=new Date(t.getTime()+1)),{correlationId:n.correlationId,timestamp:i}}))},n})();t.CsmCommand=w}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.AvatarMenu.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,'.fxs-avatarmenu-tenant,.fxs-avatarmenu-tenant-uri,.fxs-avatarmenu-username{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-avatarmenu{-webkit-flex:0 0 auto;flex:0 0 auto;box-sizing:border-box}.fxs-avatarmenu-header{position:relative;display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;padding-left:20px;height:40px}.fxs-avatarmenu-username{font-size:14px;line-height:normal;max-width:146px}.fxs-avatarmenu-dropdown-title,.fxs-avatarmenu-tenant{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe WP",Tahoma,Arial,sans-serif;font-weight:600;font-size:10px;text-transform:uppercase}.fxs-avatarmenu-tenant{line-height:normal;opacity:.9;max-width:146px}.fxs-avatarmenu-tenant-container{text-align:right;-webkit-flex:1 1 auto;flex:1 1 auto}.fxs-avatarmenu-tenant-image{height:35px;width:35px;border:0;border-radius:35px;margin-left:11px;margin-right:5px;-webkit-flex:0 0 auto;flex:0 0 auto}.fxs-avatarmenu-tenant-name{-webkit-flex:0 0 100%;flex:0 0 100%}.fxs-avatarmenu-dropdown{width:220px}.fxs-avatarmenu-dropdown-title{padding:5px 20px 0}.fxs-avatarmenu-tenant-uri{font-size:12px;margin-top:5px}.fxs-avatarmenu-list-tenant a{display:block}.fxs-avatarmenu-list-system a{display:-webkit-flex;display:flex}.fxs-avatarmenu-scrollviewer{max-height:505px;overflow:auto}html[lang^=ja] .fxs-avatarmenu .fxs-avatarmenu-dropdown .fxs-avatarmenu-dropdown-title,html[lang^=ja] .fxs-avatarmenu .fxs-avatarmenu-header .fxs-avatarmenu-tenant,html[lang^=ko] .fxs-avatarmenu .fxs-avatarmenu-dropdown .fxs-avatarmenu-dropdown-title,html[lang^=ko] .fxs-avatarmenu .fxs-avatarmenu-header .fxs-avatarmenu-tenant,html[lang^=zh] .fxs-avatarmenu .fxs-avatarmenu-dropdown .fxs-avatarmenu-dropdown-title,html[lang^=zh] .fxs-avatarmenu .fxs-avatarmenu-header .fxs-avatarmenu-tenant{font-size:11px}')}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.ContextMenu.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxs-contextMenu{display:none;position:fixed;width:225px;padding:10px 0;box-sizing:border-box;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:300;max-height:100vh;overflow-x:hidden;overflow-y:auto;border-style:solid;border-width:1px}.fxs-contextMenu:focus{outline:0}.fxs-contextMenu.fxs-contextMenu-active{display:block}.fxs-contextMenu-item{display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;height:30px;padding:5px 25px;box-sizing:border-box;font-size:13px;line-height:normal;cursor:pointer}.fxs-contextMenu-text{-webkit-flex:1 1 auto;flex:1 1 auto;height:20px}.fxs-contextMenu-icon{-webkit-flex:0 0 auto;flex:0 0 auto;-webkit-align-content:flex-end;align-content:flex-end;height:21px;width:21px;display:-webkit-flex;display:flex;-webkit-justify-content:center;justify-content:center;-webkit-align-items:center;align-items:center}.fxs-contextMenu-icon>svg{height:16px;width:16px}.fxs-contextMenu-itemList{list-style-type:none;margin:0;padding:0}.fxs-contextMenu-extensioncommand .fxs-contextMenu-icon{display:none}.fxs-contextMenu-extensioncommand.fxs-contextMenu-itemDisabled{display:block}.fxs-contextMenu-itemDisabled{opacity:.5;cursor:text}.fxs-contextMenu-itemDisabled.fxs-contextMenu-item:hover{background-color:transparent}.fxs-contextMenu-form{padding:8px 20px;display:none}.fxs-contextMenu-form.fxs-contextMenu-active{display:block}.fxs-dialogballoon.azc-balloon{opacity:1;width:auto;max-width:550px}.fxs-dialogballoon.azc-balloon .azc-balloon-content{padding:0}.fxs-dialogballoon.azc-balloon.azc-balloon-box-bottom .azc-balloon-pointer{border-bottom-color:#464f59}.fxs-dialogballoon.azc-balloon.azc-balloon-box-top .azc-balloon-pointer{border-top-color:#3c454f}.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-hero,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-herotall,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-herowide,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-large,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-mini,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-normal,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-small,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-tall,.fxs-contextMenu-icon svg.msportalfx-contextmenu-grid-wide{height:20px;width:20px}.msportalfx-contextmenu-grid rect{display:none}.msportalfx-contextmenu-grid-hero .msportalfx-grid-rect-hero,.msportalfx-contextmenu-grid-herotall .msportalfx-grid-rect-herotall,.msportalfx-contextmenu-grid-herowide .msportalfx-grid-rect-herowide,.msportalfx-contextmenu-grid-large .msportalfx-grid-rect-large,.msportalfx-contextmenu-grid-mini .msportalfx-grid-rect-mini,.msportalfx-contextmenu-grid-normal .msportalfx-grid-rect-normal,.msportalfx-contextmenu-grid-small .msportalfx-grid-rect-small,.msportalfx-contextmenu-grid-tall .msportalfx-grid-rect-tall,.msportalfx-contextmenu-grid-wide .msportalfx-grid-rect-wide{display:block}")}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.ContextPane.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,'.fxs-contextpane{display:none;height:100%;position:relative;z-index:200}.fxs-contextpane-content{box-sizing:border-box;height:100%;overflow:auto}.fxs-contextpane-loadindicator{display:none;position:absolute;top:0;bottom:0;right:0;left:0;background:inherit}.fxs-contextpane-loading .fxs-contextpane-loadindicator{display:block}.fxs-contextpane-visible{display:-webkit-flex;display:flex;-webkit-flex-flow:column nowrap;flex-flow:column nowrap}.fxs-contextpane-title{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_light,"Segoe UI Light","Segoe WP Light","Segoe WP",Tahoma,Arial,sans-serif;font-weight:200;font-size:18px;line-height:30px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin-top:0}.fxs-sidebar-is-collapsed+.fxs-portal-contextpane-left .fxs-partgallery-container .fxs-partgallery-topcontainer,.fxs-sidebar-is-collapsed+.fxs-portal-contextpane-left2 .fxs-partgallery-container .fxs-partgallery2-topcontainer{overflow:visible}.fxs-contextpane-close,.fxs-contextpane-expand{cursor:pointer;border:0;background-color:transparent;margin:0;transition:background .2s ease-out;height:30px;width:30px;position:absolute;top:0}.fxs-contextpane-close svg,.fxs-contextpane-expand svg{display:block;height:16px;width:16px}.fxs-contextpane-close{right:0}.fxs-contextpane-close:hover{background:#ba141a;fill:#fff}.fxs-contextpane-expand{left:0;padding:8px 7px 9px 20px;width:100%}.fxs-contextpane-expand svg{height:18px;width:18px}.fxs-sidebar+.fxs-portal-contextpane-left{width:225px;max-width:225px;border-right:1px solid}.fxs-sidebar+.fxs-portal-contextpane-left2{width:380px;max-width:380px}.fxs-sidebar-is-collapsed+.fxs-portal-contextpane-left,.fxs-sidebar-is-collapsed+.fxs-portal-contextpane-left2{width:60px;max-width:60px}.fxs-sidebar-is-collapsed+.fxs-portal-contextpane-left2 .fxs-partgallery-container .fxs-partgallery2-partscontainer,.fxs-sidebar-is-collapsed+.fxs-portal-contextpane-left2 .fxs-partgallery-container .fxs-partgallery2-topcontainer>*{display:none}.fxs-sidebar-is-collapsed+.fxs-portal-contextpane-left2 .fxs-partgallery-container .fxs-partgallery2-topcontainer .fxs-partgallery2-title{display:block;white-space:nowrap;-webkit-transform:rotate(90deg) translateY(5px);transform:rotate(90deg) translateY(5px);-webkit-transform-origin:0;transform-origin:0}.fxs-sidebar-is-collapsed+.fxs-portal-contextpane-left .fxs-partgallery-container .fxs-partgallery-loading-status,.fxs-sidebar-is-collapsed+.fxs-portal-contextpane-left .fxs-partgallery-container .fxs-partgallery-partscontainer,.fxs-sidebar-is-collapsed+.fxs-portal-contextpane-left .fxs-partgallery-container .fxs-partgallery-topcontainer>*{display:none}.fxs-sidebar-is-collapsed+.fxs-portal-contextpane-left .fxs-partgallery-container .fxs-partgallery-topcontainer .fxs-partgallery-title{display:block;white-space:nowrap;-webkit-transform:rotate(90deg) translateY(3px);transform:rotate(90deg) translateY(3px);overflow:visible}.fxs-sidebar-is-collapsed+.fxs-portal-contextpane-left .fxs-contextpane-expand,.fxs-sidebar-is-collapsed+.fxs-portal-contextpane-left .fxs-contextpane-expand .fxs-contextpane-button-inner{height:100%;display:-webkit-flex;display:flex;-webkit-flex-flow:column nowrap;flex-flow:column nowrap}.fxs-portal-contextpane-right{position:absolute;right:0;box-shadow:0 5px 15px 2px rgba(0,0,0,.3);max-width:calc(100% - 225px)}.fxs-portal-contextpane-right.fxs-contextpane-loading{min-width:355px}.fxs-sidebar-is-collapsed~.fxs-portal-contextpane-right{max-width:calc(100% - 60px)}')}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.Control.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxc-base .fxs-tile-progress{background-color:inherit}.fxc-base .fxs-tile-progress .fxs-tile-progress-transparent{height:100%;width:100%;left:auto;top:auto}.fxc-base .fxs-tile-progress .fxs-tile-progress-transparent>div{margin:0;left:0;vertical-align:baseline}")}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.DropMenu.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxs-dropmenu{position:relative;-webkit-flex:0 0 auto;flex:0 0 auto;box-sizing:border-box;z-index:200}.fxs-dropmenu-button{border:none;padding:0;margin:0;background:0 0;cursor:pointer;display:-webkit-flex;display:flex;position:relative;height:100%;-webkit-align-items:center;align-items:center;-webkit-justify-content:center;justify-content:center}.fx-dropmenu-dropdown .fxs-dropmenu-list-system a{display:-webkit-flex;display:flex}.fx-dropmenu-dropdown .fxs-journeysmenu-journey-nodata{height:130px;width:100%}.fx-dropmenu-dropdown .fxs-journeysmenu-journey-nodata .fxs-journeysmenu-journey-nodata-content{font-size:12px;line-height:18px;margin:0 40px;padding-top:50px;text-align:center}.fxs-dropmenu-content{position:absolute}.fxs-dropmenu-content.fxs-dropmenu-defaultWidth{width:220px}.fxs-dropmenu-content.fxs-dropmenu-extendWidth{width:355px}.fxs-dropmenu-content ol,.fxs-dropmenu-content ul{list-style:none;padding:0;margin:0}.fxs-dropmenu-content li{white-space:nowrap}.fxs-dropmenu-content li a{-webkit-align-items:center;align-items:center;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;padding:10px 20px}.fxs-dropmenu-content li button.fxs-journeysMenu-discardButton{display:-webkit-flex;display:flex;-webkit-flex:0 0 auto;flex:0 0 auto;background:0 0;cursor:pointer;border:0;margin-right:5px;-webkit-align-items:center;align-items:center}.fxs-dropmenu-content li button.fxs-journeysMenu-discardButton img,.fxs-dropmenu-content li button.fxs-journeysMenu-discardButton svg{opacity:.2;height:15px;width:15px}.fxs-dropmenu-content li button.fxs-journeysMenu-discardButton:hover img,.fxs-dropmenu-content li button.fxs-journeysMenu-discardButton:hover svg{opacity:1}.fxs-dropmenu-content .fxs-dropmenu-list-content{-webkit-flex:1 1 auto;flex:1 1 auto;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-dropmenu-content .fxs-journeysmenu-journey{display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;margin-right:auto}.fxs-dropmenu-content .fxs-journeysmenu-journey-content{-webkit-flex:0 0 auto;flex:0 0 auto;padding:0 10px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-dropmenu-content .fxs-dropmenu-image{-webkit-flex:0 0 auto;flex:0 0 auto;height:16px;width:16px}.fxs-dropmenu-content .fxs-dropmenu-image img,.fxs-dropmenu-content .fxs-dropmenu-image svg{height:13px;width:13px}.fxs-dropmenu-content .fxs-dropmenu-line-separator{border-top-width:1px;border-top-style:solid}.fxs-journeysmenu-content{min-width:450px}.fxs-dropmenu-left{right:0}.fxs-dropmenu-right{left:0}.fxs-dropmenu-hidden{display:none}.fxs-dropmenu-invisible{visibility:hidden}.fxs-journeysmenu-list{display:-webkit-flex;display:flex}.fxs-journeysmenu-journey-wrapper{display:-webkit-flex;display:flex;-webkit-flex:1 1 auto;flex:1 1 auto}")}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.FlowLayout.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,'.fxs-flowlayout{position:relative}.fxs-flowlayout>.fxs-flowlayout-childcontainer{position:relative;transition:height .25s linear,width .25s linear 0s}.fxs-flowlayout>.fxs-flowlayout-childcontainer>.fxs-flowlayout-element{position:absolute}.fxs-flowlayout>.fxs-flowlayout-childcontainer>.fxs-flowlayout-drop-placeholder{position:absolute;background:rgba(0,0,0,.2)}.fxs-flowlayout-childcontainer>.fxs-tile{transition:height 125ms linear 125ms,width 125ms linear 0s,top 175ms ease-out,left 175ms ease-out,right 175ms ease-out}.fxs-flowlayout-resolutionguide{position:absolute;top:0;left:0;box-sizing:border-box;color:#fff;border-color:#fff;opacity:.7;border-width:1px;border-right-style:dashed;border-bottom-style:dashed;pointer-events:none;font-size:13px;line-height:normal}.fxs-flowlayout-resolutionguide::after{position:absolute;right:8px;bottom:5px}.fxs-flowlayout-resolutionguide-1024x768{height:768px;width:1024px}.fxs-flowlayout-resolutionguide-1024x768::after{content:"1024 x 768"}.fxs-flowlayout-resolutionguide-1366x768{height:768px;width:1366px}.fxs-flowlayout-resolutionguide-1366x768::after{content:"1366 x 768"}.fxs-flowlayout-resolutionguide-1440x900{height:900px;width:1440px}.fxs-flowlayout-resolutionguide-1440x900::after{content:"1440 x 900"}.fxs-flowlayout-resolutionguide-1920x1080{height:1080px;width:1920px}.fxs-flowlayout-resolutionguide-1920x1080::after{content:"1920 x 1080"}.fxs-flowlayout-resolutionguide-3840x2160{height:2160px;width:3840px}.fxs-flowlayout-resolutionguide-3840x2160::after{content:"3840 x 2160"}.fxs-drag-surface{position:fixed;margin:0;padding:0;top:0;left:0;right:0;bottom:0;overflow:hidden;background-color:transparent;pointer-events:none;z-index:199}.fxs-drag-disableTouchAction{-ms-touch-action:none;touch-action:none}.fxs-flowlayout-resizehandle{display:inline-block;padding:0 4px 4px 0;bottom:0;right:0}.fxs-flowlayout-resizehandle>div{height:12px;width:12px;border:2px solid rgba(125,125,125,.5);border-left-width:0;border-top-width:0}.fxs-flowlayout-livepreview,.fxs-flowlayout-resizehandle{position:absolute;cursor:se-resize;z-index:1}.fxs-flowlayout-livepreview{min-width:85px;min-height:85px;max-width:2245px;max-height:2245px;overflow:hidden}')}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.Panorama.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxs-panorama{position:relative;-ms-scroll-chaining:none}.fxs-panorama .fxs-journey-target,.fxs-panorama .fxs-startboard-target{position:absolute;top:0;left:0;height:100%;width:100%;z-index:0}.fxs-panorama>div[data-popup=true].azc-control{z-index:150}body.fxs-panning-cursor{cursor:ew-resize!important;cursor:-webkit-grabbing!important;cursor:-moz-grabbing!important;cursor:grabbing!important}.fxs-show-journey .fxs-startboard-target,.fxs-show-startboard .fxs-journey-target{display:none}.fxs-panorama-scrollbounce-onleft .fxs-startboard-layout,.fxs-panorama-scrollbounce-onleft>.fxs-journey-target{-webkit-transform:translateX(20px);transform:translateX(20px)}.fxs-panorama-scrollbounce-onright .fxs-startboard-layout,.fxs-panorama-scrollbounce-onright>.fxs-journey-target{-webkit-transform:translateX(-20px);transform:translateX(-20px)}.fxs-panorama-scrollbounce-reset .fxs-startboard-layout,.fxs-panorama-scrollbounce-reset>.fxs-journey-target{-webkit-transform:translateX(0);transform:translateX(0)}.fxs-panorama-scrollbounce-onleft .fxs-startboard-layout,.fxs-panorama-scrollbounce-onleft>.fxs-journey-target,.fxs-panorama-scrollbounce-onright .fxs-startboard-layout,.fxs-panorama-scrollbounce-onright>.fxs-journey-target,.fxs-panorama-scrollbounce-reset .fxs-startboard-layout,.fxs-panorama-scrollbounce-reset>.fxs-journey-target{transition:transform .333s ease!important}")}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.Search.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,"@-webkit-keyframes fxs-indicator-animatedEllipses{0%{opacity:1}30%{opacity:.6}60%{opacity:.3}}@keyframes fxs-indicator-animatedEllipses{0%{opacity:1}30%{opacity:.6}60%{opacity:.3}}.fxs-topbar-search{height:40px}.fxs-topbar-search .fxs-box-wrapper{margin-top:6px;margin-right:6px}.fxs-topbar-search .fxs-menu{margin-right:6px;top:34px}.fxs-search-text{white-space:normal;overflow:hidden;text-overflow:ellipsis}.fxs-search{position:relative}.fxs-search.fxs-search-expanded{padding:0 0 0 10px;position:relative}.fxs-search.fxs-search-expanded .fxs-box-wrapper{display:inline-block}.fxs-search.fxs-search-expanded .fxs-search-icon{display:none}.fxs-search .fxs-box-wrapper{position:relative;padding:0;display:none}.fxs-search .fxs-box-wrapper.fxs-searching .fxs-indicator{display:inline-block}.fxs-search .fxs-box-wrapper.fxs-searching .fxs-searchbox .azc-input{padding:0 60px 0 32px}.fxs-search div.fxs-icon{position:absolute;padding:5px 7px}.fxs-search div.fxs-icon svg{height:18px;width:18px;-webkit-flex:0 0 auto;flex:0 0 auto;fill:#fff}.fxs-search .fxs-cross{height:28px;width:20px;position:absolute;font-size:20px;top:-2px;right:0;cursor:pointer;color:#fff}.fxs-search .fxs-searchbox{height:28px;width:400px}.fxs-search .fxs-searchbox .azc-input{border:0;font-size:14px;padding:0 20px 0 32px;height:28px}.fxs-search .fxs-searchbox .azc-input::-ms-clear{display:none}.fxs-search .fxs-indicator{height:28px;width:40px;position:absolute;display:none;top:0;padding-top:4px;right:20px}.fxs-search .fxs-indicator>div{display:inline-block;height:6px;width:6px;-webkit-animation:fxs-indicator-animatedEllipses 1.5s infinite;animation:fxs-indicator-animatedEllipses 1.5s infinite;background:#aab3bd;margin:0 2.5px}.fxs-search .fxs-indicator>div:nth-child(1){-webkit-animation-delay:0s;animation-delay:0s}.fxs-search .fxs-indicator>div:nth-child(2){-webkit-animation-delay:.2s;animation-delay:.2s}.fxs-search .fxs-indicator>div:nth-child(3){-webkit-animation-delay:.4s;animation-delay:.4s}@media all and (min-width:1000px){.fxs-search{padding:0 0 0 10px;position:relative}.fxs-search .fxs-box-wrapper{display:inline-block}.fxs-search .fxs-search-icon{display:none}}")}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.SideBar.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,'.fxs-sidebar,.fxs-sidebar-bar{height:100%;box-sizing:border-box}.fxs-sidebar{z-index:201;position:relative;font-size:13px;border-right-width:1px;border-right-style:solid}.fxs-sidebar ul{padding:0;margin:0;list-style:none}.fxs-sidebar ul.fxs-sidebar-favorites{padding-bottom:20px}.fxs-sidebar button{font-family:inherit;margin:0;cursor:pointer;font-size:inherit}.fxs-sidebar-bar{width:225px;display:-webkit-flex;display:flex;-webkit-flex-direction:column;flex-direction:column}.fxs-sidebar-bottom,.fxs-sidebar-top{-webkit-flex:0 0 auto;flex:0 0 auto;overflow:hidden}.fxs-sidebar-middle{min-height:0;overflow-y:auto;overflow-x:hidden;-webkit-overflow-scrolling:touch}@-moz-document url-prefix(){.fxs-sidebar-is-collapsed .fxs-sidebar-middle{width:80px}}@supports (-webkit-appearance:none) and (not (-ms-ime-align:auto)) and (not (-moz-appearance:none)){.fxs-sidebar-is-collapsed .fxs-sidebar-middle{width:80px}}.fxs-sidebar-bar{overflow:hidden}.fxs-sidebar-is-collapsed .fxs-sidebar-middle{-ms-overflow-style:none}.fxs-sidebar-is-collapsed .fxs-sidebar-improvedflyout.fxs-sidebar-flyout{max-width:calc(100vw - 85px);position:absolute;top:0;bottom:0;left:100%}.fxs-sidebar-button-flex{display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center}.fxs-sidebar-favorites-section{display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;padding:2px 0;margin:20px 0 10px;min-height:17px}.fxs-sidebar-create{height:37px;padding:0 20px;width:100%;box-sizing:border-box;border-right:none;border-left:none;border-top-width:1px;border-top-style:solid;border-bottom-width:1px;border-bottom-style:solid}.fxs-sidebar-improvedsidebar .fxs-sidebar-create{height:37px;padding:0 20px;width:100%;border:none}.fxs-sidebar-post-divider,.fxs-sidebar-pre-divider{border-bottom-width:1px;border-bottom-style:solid;height:0;margin:0 5px}.fxs-sidebar-myfavorites{text-transform:uppercase;color:#aab3bd;font-family:az_ea_font,"Segoe UI",wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe WP",Tahoma,Arial,sans-serif;font-weight:600;font-size:10px;word-break:keep-all}.fxs-sidebar-pre-divider{width:15px}.fxs-sidebar-post-divider{width:150px}.fxs-sidebar-flyout-is-hidden{display:none}.fxs-sidebar-create-label{margin-left:10px}.fxs-sidebar-create-icon{display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;height:18px}.fxs-sidebar-create-icon svg{height:18px;width:18px}.fxs-sidebar-browse{padding:0 20px;height:40px;border:none}.fxs-sidebar-favorites .fxs-sidebar-icon{padding-left:20px}.fxs-sidebar-item{display:-webkit-flex;display:flex;-webkit-flex:1 1 auto;flex:1 1 auto;-webkit-align-items:center;align-items:center;min-height:40px}.fxs-sidebar-item:hover .fxs-sidebar-handle svg{display:block}.fxs-sidebar-defaultviewenabled .fxs-sidebar-favorites .fxs-sidebar-item:first-child{border-bottom-width:1px;border-bottom-style:solid;height:37px}.fxs-sidebar-item-link{display:-webkit-flex;display:flex;-webkit-flex:1 1 auto;flex:1 1 auto;-webkit-align-items:center;align-items:center;width:100%;height:40px;-webkit-user-drag:none}.fxs-sidebar-icon{-webkit-flex:0 0 18px;flex:0 0 18px;display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;height:18px}.fxs-sidebar-icon img,.fxs-sidebar-icon svg{height:18px;width:18px}.fxs-sidebar-flyout .fxs-sidebar-label,.fxs-sidebar-label{-webkit-flex:1 1 auto;flex:1 1 auto;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin-left:10px}.fxs-sidebar-item-icon{-webkit-flex:0 0 auto;flex:0 0 auto;display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;-webkit-justify-content:center;justify-content:center;height:100%;width:30px;cursor:pointer}.fxs-sidebar-item-icon svg{height:14px;width:14px}.fxs-sidebar-collapse-button{display:-webkit-flex;display:flex;height:44px;width:100%;-webkit-align-items:center;align-items:center;padding-left:20px;border:none}.fxs-sidebar-collapse-button svg{height:18px;width:18px}.fxs-sidebar-collapse-button-flip svg{-webkit-transform:rotate(90deg)!important;transform:rotate(90deg)!important}.fxs-sidebar-improvedsidebar .fxs-sidebar-collapse-button{display:-webkit-flex;display:flex;height:18px;width:100%;border:none;padding-left:0}.fxs-sidebar-improvedsidebar .fxs-sidebar-collapse-button svg{height:8px;width:8px;-webkit-transform:rotate(-90deg);transform:rotate(-90deg);margin-left:auto}.fxs-sidebar-browse-label{padding-right:5px;margin-left:10px}.fxs-sidebar-improvedsidebar .fxs-sidebar-browse-icon{display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;padding-top:3px}.fxs-sidebar-improvedsidebar .fxs-sidebar-browse-icon svg{height:18px;width:18px;-webkit-transform:none;transform:none}.fxs-sidebar-browse-icon{display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;padding-top:3px}.fxs-sidebar-browse-icon svg{height:15px;width:15px;-webkit-transform:rotate(90deg);transform:rotate(90deg)}.fxs-sidebar-star-icon{padding-right:10px}.fxs-sidebar-star-icon svg{height:12px;width:12px}.fxs-sidebar-show-if-expanded{display:block}.fxs-sidebar-show-if-collapsed{display:none}.fxs-sidebar-content{height:65px;padding:0 20px 5px}.fxs-sidebar-external{-webkit-flex:0 0 12px;flex:0 0 12px;margin:0 10px;padding-top:4px;width:12px}.fxs-sidebar-external svg{height:12px;width:12px}.fxs-sidebar-handle{-webkit-flex:0 0 20px;flex:0 0 20px;-webkit-justify-content:center;justify-content:center;-webkit-align-items:center;align-items:center;margin-left:auto;cursor:move}.fxs-sidebar-handle svg{display:none;height:16px;width:16px;-webkit-transform:rotate(90deg);transform:rotate(90deg)}.fxs-sidebar-is-collapsed .fxs-sidebar-bar{width:60px}.fxs-sidebar-is-collapsed .fxs-sidebar-show-if-collapsed{display:block}.fxs-sidebar-is-collapsed .fxs-sidebar-show-if-expanded{display:none}.fxs-sidebar-is-collapsed .fxs-sidebar-post-divider,.fxs-sidebar-is-collapsed .fxs-sidebar-pre-divider{width:15px}.fxs-sidebar-is-collapsed .fxs-sidebar-star-icon{padding-right:0}')}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.StackLayout.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxs-stacklayout{display:-webkit-flex;display:flex}.fxs-stacklayout.fxs-stacklayout-vertical{-webkit-flex-direction:column;flex-direction:column}.fxs-stacklayout.fxs-stacklayout-horizontal{-webkit-flex-direction:row;flex-direction:row;height:100%}.fxs-stacklayout-child{-webkit-flex:0 0 auto;flex:0 0 auto}")}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.StartBoard.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,'.fxs-portal-fullscreen .fxs-tile-actionbar-actionlist,.fxs-startboard-loading .fxs-startboard-layout,.fxs-startboard-loading .fxs-startboard-message-container{visibility:hidden}.fxs-startboard{display:-webkit-flex;display:flex;-webkit-flex-flow:column nowrap;flex-flow:column nowrap;overflow:hidden}.fxs-startboard .fxs-startboard-message-container,.fxs-startboard.fxs-startboard-notfound>.fxs-startboard-layout{display:none}.fxs-startboard.fxs-startboard-notfound .fxs-startboard-message-container{display:block}.fxs-startboard-header{display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;-webkit-flex:0 0 auto;flex:0 0 auto;width:100%;height:45px;padding:0 25px 0 40px;box-sizing:border-box}.fxs-startboard-header .fxs-startboard-title-next{display:block}.fxs-startboard-header .fxs-startboard-button-text{font-size:12px}.fxs-startboard-header .fxs-startboard-button-icon{height:12px;width:12px;-webkit-align-items:center;align-items:center;-webkit-justify-content:center;justify-content:center;-webkit-flex:0 0 12px;flex:0 0 12px}.fxs-startboard-header .fxs-startboard-dropdown .fxs-startboard-button-icon{height:16px;width:16px;margin:4px 8px;-webkit-flex:0 0 auto;flex:0 0 auto}.fxs-startboard-header .fxs-startboard-dropdown .fxs-startboard-button-icon>svg{-webkit-flex:0 0 16px;flex:0 0 16px}.fxs-startboard-header .fxs-startboard-title{max-width:300px}.fxs-startboard-header .fxs-startboard-title-edit{padding:0 5px 2px;margin:0 -6px -2px;border-width:1px;border-style:solid;color:inherit;background-color:transparent;width:300px;transition:border .12s}.fxs-startboard-header .fxs-startboard-title-edit:active,.fxs-startboard-header .fxs-startboard-title-edit:hover{border-color:inherit}.fxs-startboard-header .fxs-startboard-button{position:relative}.fxs-startboard-header .fxs-startboard-button,.fxs-startboard-header .fxs-startboard-title{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-align:left}.fxs-startboard-header .fxs-startboard-button,.fxs-startboard-header .fxs-startboard-dropdown{font-size:13px;line-height:20px}.fxs-startboard-header .fxs-startboard-title,.fxs-startboard-header .fxs-startboard-title-edit{font-size:24px;line-height:normal}.fxs-startboard-header .fxs-startboard-actions,.fxs-startboard-header .fxs-startboard-migration{height:40px;-webkit-align-items:center;align-items:center;-webkit-flex:0 0 auto;flex:0 0 auto}.fxs-startboard-header .fxs-startboard-fileUpload-overlay{position:absolute;top:0;left:0;width:100%;height:100%;opacity:0;display:block;cursor:pointer}.fxs-startboard-header .fxs-startboard-item-focused{outline:#00bcf2 dashed 1px;outline-offset:-1px}.fxs-startboard-header ::-webkit-file-upload-button{cursor:pointer}.fxs-startboard-layout{padding:25px 40px;overflow:auto;-webkit-flex:1 1 auto;flex:1 1 auto}.fxs-startboard-layout .fxs-flowlayout-childcontainer{padding-bottom:25px;padding-right:25px}.fxs-startboard-dropdown{-webkit-flex:0 1 auto;flex:0 1 auto;min-width:32px;max-width:560px}.fxs-startboard-button{-webkit-flex:0 0 auto;flex:0 0 auto;border:0;margin:0 5px;padding:4px 5px;height:20px;background-color:transparent;box-sizing:content-box;display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;min-width:0}.fxs-startboard-button:not([aria-disabled]):hover{cursor:pointer}.fxs-startboard-button .fxs-startboard-button-text{margin-left:5px}.fxs-startboard-button .fxs-startboard-button-icon{height:16px;width:16px}.fxs-startboard-button:hover,.fxs-startboard-dropdown:hover{background:rgba(255,255,255,.15)}.fxs-startboard-button-browse{padding:0!important}.fxs-startboard-dropdown>.fxs-dropmenu,.fxs-startboard-dropdown>.fxs-dropmenu .fxs-dropmenu-button{width:100%}.fxs-startboard-dropdown .fxs-dropmenu-content{overflow-x:hidden;overflow-y:auto;min-width:400px;max-width:560px;min-height:35px;max-height:480px}.fxs-startboard-item-container{display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;min-width:0}.fxs-startboard-dropdown .fxs-dropmenu-list-system .fxs-startboard-dropdown-item{padding:7px 25px 8px}.fxs-startboard-dropdown-item+.fxs-startboard-dropdown-item::before{content:"";position:absolute;top:0;width:calc(100% - 50px);border-top-width:1px;border-top-style:solid;border-color:rgba(125,125,125,.5)}.fxs-startboard-item-title{-webkit-flex:1 1 auto;flex:1 1 auto;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-startboard-item-icon{-webkit-flex:0 0 auto;flex:0 0 auto;height:14px;width:14px;padding-right:5px}.fxs-startboard-dropdown-item{position:relative;height:35px;box-sizing:border-box;cursor:pointer}.fxs-startboard-dropdown-item.fxs-startboard-dropdown-browseall{height:auto;cursor:default}.fxs-startboard-dropdown-subscriptions{white-space:normal}.fxs-startboard-actions,.fxs-startboard-dropdown,.fxs-startboard-header:not(.fxs-startboard-header-normal) .fxs-startboard-title-edit,.fxs-startboard-migration{display:none}.fxs-startboard-header-normal .fxs-startboard-actions,.fxs-startboard-header-normal .fxs-startboard-dropdown{display:-webkit-flex;display:flex}.fxs-startboard-header-migration .fxs-startboard-actions,.fxs-startboard-header-migration .fxs-startboard-dropdown,.fxs-startboard-header-normal .fxs-startboard-migration,.fxs-startboard-header-normal .fxs-startboard-title-next{display:none}.fxs-startboard-header-migration .fxs-startboard-migration{display:-webkit-flex;display:flex}.fxs-startboard-header-migration .fxs-startboard-title-next{display:block}.fxs-startboard-message-container{padding:55px 40px}.fxs-startboard-message-title{font-size:32px;margin-bottom:20px}.fxs-startboard-message-body{font-size:17px}.fxs-startboard-notfound .fxs-startboard-button{display:none}.fxs-startboard-notfound .fxs-startboard-button-delete,.fxs-startboard-notfound .fxs-startboard-button-new{display:-webkit-flex;display:flex}.fxs-topbar-dashboard-changed .fxs-startboard-header-item{display:none}.fxs-topbar-dashboard-changed .fxs-startboard-title-next{display:block}.fxs-startboard-loadanimation{display:none;-webkit-align-items:center;align-items:center;-webkit-justify-content:center;justify-content:center;position:absolute;height:100%;width:100%}.fxs-startboard-loading .fxs-startboard-loadanimation{display:-webkit-flex;display:flex}.fxs-startboard-loading .fxs-startboard-header-item{display:none}.fxs-startboard-loading .fxs-startboard-title-next{display:block}.fxs-startboard-loading .fxs-startboard-layout .fxs-tile .fxs-part-content{display:none}@media all and (max-width:1300px){.fxs-startboard-button-text{display:none}}.fxs-portal-fullscreen .fxs-sidebar,.fxs-portal-fullscreen .fxs-topbar{display:none!important}.fxs-portal-fullscreen .fxs-portal-main{height:100%}.fxs-portal-fullscreen .fxs-startboard-button{display:none}.fxs-portal-fullscreen .fxs-startboard-button-fullscreen{display:-webkit-flex;display:flex}.fxs-portal-fullscreen .fxs-startboard-dropdown{display:none}.fxs-portal-fullscreen .fxs-startboard-title-next{display:block}.fxs-portal-fullscreen .fxs-tile::after{content:"";display:block;position:absolute;top:0;bottom:0;left:0;right:0}')}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.Tile.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxs-tile-progress-transparent{height:12px;position:absolute;top:0;z-index:195;overflow:hidden}.fxs-tile-progress-transparent>div{margin-left:6px}.fxs-tile-progress-transparent>div::after{height:4px;width:4px;background:#000}.fxs-tile{height:175px;width:175px;position:relative;box-shadow:none}.fxs-tile .fxs-tile-actionbar{z-index:196}.fxs-tile .fxs-tile-container{width:100%;height:100%}.fxs-tile.fxs-tilesize-mini{height:85px;width:85px}.fxs-tile.fxs-tilesize-small{height:85px;width:175px}.fxs-tile.fxs-tilesize-tall{height:355px;width:175px}.fxs-tile.fxs-tilesize-wide{height:175px;width:355px}.fxs-tile.fxs-tilesize-normal{height:175px;width:175px}.fxs-tile.fxs-tilesize-large{height:355px;width:355px}.fxs-tile.fxs-tilesize-herotall{height:535px;width:355px}.fxs-tile.fxs-tilesize-herowide{height:355px;width:535px}.fxs-tile.fxs-tilesize-hero{height:535px;width:535px}.fxs-tile.fxs-tilesize-herowidefitheight{height:auto;width:535px}.fxs-tile.fxs-tilesize-fullwidthfitheight{height:auto;width:100%}.fxs-tile.fxs-tilesize-fullwidthfitheight .fxs-part,.fxs-tile.fxs-tilesize-fullwidthfitheight .fxs-part-content{height:auto}.fxs-tile.fxs-tilesize-fullwidthfitheight,.fxs-tile.fxs-tilesize-herowidefitheight{margin-bottom:5px}.fxs-tile.fxs-tilesize-fullwidthfitheight:last-child,.fxs-tile.fxs-tilesize-herowidefitheight:last-child{margin-bottom:0}.fxs-tile.fxs-tilesize-fittocontainer{height:100%;width:100%}.fxs-tile.fxs-tilesize-fittocontainer>.fxs-part{overflow:auto}.fxs-tile div.fxs-tile-overlay{display:none;position:absolute;width:100%;top:0;bottom:0;cursor:pointer}.fxs-blade-content-container .fxs-bladecontent-unlocked .fxs-tile .fxs-part{box-shadow:0 2px 2px rgba(0,0,0,.25)}.fxs-blade-content-container .fxs-bladestyle-context .fxs-tile .fxs-part,.fxs-blade-content-container .fxs-bladestyle-contextaction .fxs-tile .fxs-part,.fxs-blade-content-container .fxs-bladestyle-create .fxs-tile .fxs-part,.fxs-blade-content-container .fxs-bladestyle-help .fxs-tile .fxs-part{box-shadow:none}")}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.TileActionBar.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxs-tile-actionbar-actionlist{display:-webkit-flex;display:flex;-webkit-flex-flow:row nowrap;flex-flow:row nowrap}.fxs-tile-actionbar-actionlist:empty{height:25px;visibility:hidden}.fxs-tile-actionbar-action{-webkit-flex:0 0 auto;flex:0 0 auto;display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;-webkit-justify-content:center;justify-content:center;box-sizing:border-box;height:25px;width:25px;padding:6px;background-color:transparent;cursor:pointer;border:0;transition:background .1s ease-out}.fxs-tile-actionbar-action>svg{height:13px;width:13px}.fxs-tile .fxs-tile-actionbar{position:absolute;right:0;cursor:default}.fxs-tile-actionbar-command-unpinfromstartboard{display:none}.fxs-desktop-organize .fxs-tile-actionbar-command-unpinfromstartboard{display:-webkit-flex;display:flex}")}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.Toast.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,'.fxs-toast-description,.fxs-toast-time,.fxs-toast-title{overflow:hidden;text-overflow:ellipsis}.fxs-nps .fxs-nps-commentstitle,.fxs-nps .fxs-nps-link-survey,.fxs-nps .fxs-nps-submit,.fxs-toast-title.fxs-toast-link:hover{text-decoration:underline}.fxs-toast{position:fixed;top:80px;right:20px;width:355px;list-style-type:none;margin:0}.fxs-toast-header,.fxs-toast-item{display:-webkit-flex;margin-bottom:5px}.fxs-toast-content,.fxs-toast-wrapper{-webkit-flex:1 1 auto;flex:1 1 auto;padding:10px}.fxs-toast-item{display:flex;position:relative}.fxs-toast-header{display:flex;-webkit-align-items:center;align-items:center;padding-top:5px}.fxs-toast-icon svg{height:14px;width:14px}.fxs-toast-title{-webkit-flex:1 1 auto;flex:1 1 auto;margin-left:10px;max-width:254px;white-space:nowrap}.fxs-toast-time{white-space:nowrap;max-width:60px;-webkit-flex:0 0 auto;flex:0 0 auto}.fxs-toast-close{position:absolute;top:0;right:0;background:0 0;border:none;padding:5px;cursor:pointer}.fxs-toast-close svg{height:12px;width:12px}.fxs-toast-description{font-size:12px;line-height:18px;width:335px;position:relative}.fxs-toast-progressbar{margin-top:10px;max-height:5px}.fxs-nps .fxs-nps-title{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe WP",Tahoma,Arial,sans-serif;font-weight:600;margin-bottom:7px}.fxs-nps .fxs-nps-score{display:-webkit-flex;display:flex}.fxs-nps .fxs-nps-score span{-webkit-flex:1 1 auto;flex:1 1 auto;border:1px solid #c5cbd1;text-align:center;height:23px;line-height:23px;font-size:11px;margin-right:6px;display:inline-block;cursor:pointer}.fxs-nps .fxs-nps-score span.fxs-nps-score-selected,.fxs-nps .fxs-nps-score span:hover{background:#00bcf2;border-color:#00bcf2}.fxs-nps .fxs-nps-score span:last-child{margin-right:0}.fxs-nps .fxs-nps-help{color:#758393;display:flex;margin-bottom:10px;font-size:12px;width:335px}.fxs-nps .fxs-nps-help span:last-child{margin-left:auto}.fxs-nps .fxs-nps-survey{font-size:12px}.fxs-nps .fxs-nps-comments{margin-top:6px;margin-bottom:18px;width:319px;border:1px solid #c5cbd1;height:100px;padding:7px}.fxs-nps .fxs-nps-checkbox{margin:10px 5px 0 10px;padding:0;vertical-align:bottom;width:14px;height:14px}.fxs-nps .fxs-nps-button-holder{border-top:1px solid #dcdfe2;margin-left:-10px}.fxs-nps .fxs-nps-submit{margin:15px 10px 5px;background-color:#00bcf2;border-color:#00bcf2;color:#fff}')}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.TopBar.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxs-topbar-devmode .fxs-trim-hover:hover,.fxs-topbar-exitdevmode.fxs-trim-hover:hover,.fxs-topbar-reportbug.fxs-trim-hover:hover{background-color:#fff0d1!important}.fxs-topbar{height:40px;position:relative;z-index:250;-webkit-flex:0 0 auto;flex:0 0 auto;font-size:13px}.fxs-topbar-brand{-webkit-flex:0 0 auto;flex:0 0 auto;margin:0 0 0 13px;padding:0;height:100%}.fxs-topbar .fxs-topbar-journey-icon{border:none}.fxs-topbar .fxs-topbar-journey-icon svg{height:16px;width:16px;margin-top:4px}.fxs-topbar-content{width:100%;height:100%;position:absolute;top:0;display:-webkit-flex;display:flex;-webkit-align-content:center;align-content:center;-webkit-align-items:center;align-items:center}.fxs-topbar-internal{height:40px;min-width:85px;max-width:225px;box-sizing:border-box;padding:0 12px;line-height:40px;text-align:center;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-topbar-exitdevmode,.fxs-topbar-reportbug{display:-webkit-flex;display:flex;height:40px;width:auto;-webkit-flex:0 0 auto;flex:0 0 auto;-webkit-align-items:center;align-items:center;-webkit-justify-content:center;justify-content:center;padding:0 2px}.fxs-topbar-home{display:inline-block;font-size:20px;padding:0 7px;height:100%;line-height:40px}.fxs-topbar-button{display:-webkit-flex;display:flex;height:40px;width:40px;-webkit-flex:0 0 auto;flex:0 0 auto;-webkit-align-items:center;align-items:center;-webkit-justify-content:center;justify-content:center;border-right:1px solid rgba(128,128,128,.4)}.fxs-topbar-button svg{height:20px;width:20px;-webkit-flex:0 0 auto;flex:0 0 auto}.fxs-desktop-organize .fxs-topbar-exit-customize{visibility:visible;top:0}.fxs-topbar-dashboard-message,.fxs-topbar-exit-customize-message{font-size:14px}.fxs-topbar-dashboard .fxs-button,.fxs-topbar-exit-customize-button{-webkit-flex:0 0 auto;flex:0 0 auto;margin-left:10px}.fxs-topbar-dashboard-view{display:none}.fxs-show-journey .fxs-topbar-dashboard-view{display:block}.fxs-show-journey .fxs-topbar-dashboard-discard,.fxs-show-journey .fxs-topbar-dashboard-save{display:none}.fxs-topbar-notifications{position:relative}.fxs-topbar-dashboard,.fxs-topbar-exit-customize{display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;-webkit-justify-content:center;justify-content:center;-webkit-flex:1 1 auto;flex:1 1 auto;position:absolute;top:-40px;z-index:250;visibility:hidden;width:100%;height:100%;transition:top .3s ease .1ms}.fxs-topbar-dashboard-changed .fxs-topbar-dashboard{top:0;visibility:visible}.fxs-topbar-console,.fxs-topbar-dashboard-changed .fxs-topbar-exit-customize{display:none}.fxs-topbar-placeholder{-webkit-flex:1 1 auto;flex:1 1 auto}")}));
define("MsPortalImpl/Widgets/Widgets.WidgetBase",["require","exports","i","o","a","ko","$","MsPortalImpl/Base/Base.EventTypes","_generated/Less/MsPortalImpl/Widgets/Widgets.AvatarMenu.css","_generated/Less/MsPortalImpl/Widgets/Widgets.ContextMenu.css","_generated/Less/MsPortalImpl/Widgets/Widgets.ContextPane.css","_generated/Less/MsPortalImpl/Widgets/Widgets.Control.css","_generated/Less/MsPortalImpl/Widgets/Widgets.DropMenu.css","_generated/Less/MsPortalImpl/Widgets/Widgets.FlowLayout.css","_generated/Less/MsPortalImpl/Widgets/Widgets.Panorama.css","_generated/Less/MsPortalImpl/Widgets/Widgets.Search.css","_generated/Less/MsPortalImpl/Widgets/Widgets.SideBar.css","_generated/Less/MsPortalImpl/Widgets/Widgets.StackLayout.css","_generated/Less/MsPortalImpl/Widgets/Widgets.StartBoard.css","_generated/Less/MsPortalImpl/Widgets/Widgets.Tile.css","_generated/Less/MsPortalImpl/Widgets/Widgets.TileActionBar.css","_generated/Less/MsPortalImpl/Widgets/Widgets.Toast.css","_generated/Less/MsPortalImpl/Widgets/Widgets.TopBar.css"],(function(n,t,i,r,u,f,e,o){"use strict";var s;return (function(n){var u=(function(){function n(){this.disabled=f.observable(!1)}return n})(),t;n.ViewModel=u;t=(function(){function n(t,r){var u=this,f;if(!t||t.length===0)throw new Error("You must specify an element to associate a widget to it. Your element is either null or an empty collection.");this.options=r;f=this._ltm=new i.TriggerableLifetimeManager;this.element=e(t[0]);f.registerForDispose(t.setEvents([n.widgetRemoveEvent,function(n){n.target!==t[0]||u._disposeTriggered||(u._disposeTriggered=!0,u.dispose())},]));t.data(n._widgetTypesDataKey)||t.data(n._widgetTypesDataKey,[]);t.data(n._widgetTypesDataKey).push(this)}return n.prototype.setFocus=function(){},n.prototype.dispose=function(){this._ltm&&(this._ltm.dispose(),this._ltm=null);var i=this.element,t=i.data(n._widgetTypesDataKey);t&&(t.splice(t.indexOf(this),1),t.length===0&&i.removeData(n._widgetTypesDataKey))},r.defineProperty(n.prototype,"ltm",{get:function(){return this._ltm},enumerable:!0,configurable:!0}),n.getWidget=function(t,i){var r=n.getWidgets(t,i);return r?r[0]||null:null},n.getWidgets=function(t,i){var r=t.data(n._widgetTypesDataKey)||[];return i?r.filter((function(n){return n instanceof i})):r},n.prototype.trigger=function(n,t,i){var u=this.options[n],r=this.element;return i=i||{},t=t||e.Event(n),t.type=n,t.target=r[0],r.trigger(t,i),!(e.isFunction(u)&&u.apply(r[0],[t].concat(i))===!1||t.isDefaultPrevented())},n.prototype.getTelemetrySource=function(){return null},n.prototype._bindDescendants=function(n){var t={data:this.options,func:this},i=n?e.extend(null,t,n):t;f.applyBindingsToDescendants(i,this.element[0])},n.prototype._cleanDescendants=function(){f.utils.cleanDescendantNodes(this.element)},n.prototype._cleanElement=function(){for(var i,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this._cleanDescendants();i=this.element;t.length>0&&i.removeClass(t.join(" "));i.empty()},n.prototype._isRtl=function(){return e("html:first").attr("dir")==="rtl"},n})();t.widgetRemoveEvent=o.default.remove+".fxWidget";t._widgetTypesDataKey="fxWidgetTypes";n.Widget=t})(s||(s={})),s}));
define("MsPortalImpl/Base/Base.KnockoutExtensions.FxParameterCollector",["require","exports","f","o","ko","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/UI/Hubs/ViewModels/UI.Gallery.CsmCommand","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Resources/ImplScriptResources"],(function(n,t,i,r,u,f,e,o,s){"use strict";function p(){return h||(h=i.require("MsPortalImpl/UI/Hubs/UI.CreateManager")),h}function w(n,t){u.bindingHandlers.fxParameterCollector={init:function(){return{controlsDescendantBindings:!1}},update:function(i,r){var f=u.unwrap(r());f&&new l($(i),f,n,t)}}}var c,l;r.defineProperty(t,"__esModule",{value:!0});var v=i.Base.Constants.ExtensionNames.Hubs,y=i.Base.Diagnostics.createLog(n),a=s.Part.Provisioning,h;c=(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t})(o.ViewModel);t.ViewModel=c;l=(function(n){function t(t,r,o,s){var k=n.call(this,t,r||new c)||this,h=r.privatePcPrBI,l=k.ltm,w,b;return h.triggerProvisioningInStartboardPart.subscribe(l,(function(n){var t;if(n){var r=h.provisioningPartExtensionName(),u=h.provisioningPartName(),e=f.Locator.forExtension(r).withPartType(u);r===v&&(n=i.clone(n,!0));o.addPartToStartBoard({originPartLocator:e,model:n,modelContainsSensitiveData:!0,initialSize:2});t=o.getActiveJourney();t&&h.forceDiscardJourney()&&o.forceDiscardJourney(t.id)}})),w=function(){h.provisioningCommand(new e.CsmCommand)},h.triggerProvisioningCommand.subscribe(l,w),h.triggerProvisioningCommand.peek()&&u.ignoreDependencies(w),h.provisioningAttempted.subscribe(l,(function(n){if(n){var t=o.getActiveJourney();t&&h.forceDiscardJourney()&&o.forceDiscardJourney(t.id)}})),b=function(n){n&&(n.galleryParameters?p().then((function(t){return t.processResourceGroupChange(s,n.galleryParameters,n.configurationOptions,n.deploymentResponse).then((function(){return h.provisioningCompleted({succeeded:!0})}),(function(n){return h.provisioningCompleted({succeeded:!1,statusUnavailable:n===a.deploymentStatusUnavailable,pollingFailed:n===a.pollingFailed,errorMessage:n})}))})):y.error("galleryParameters should be specified in the provisioningStarted object."))},h.provisioningStarted.subscribe(l,(function(n){return b(n)})),b(h.provisioningStarted()),k}return __extends(t,n),t})(o.Widget);t.Widget=l;t.initialize=w}));
define("MsPortalImpl/Svg/Startup/Warning.svg",[],(function(){"use strict";return{type:9,data:"<svg viewBox='0 0 9 9' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M8.267 8H.733c-.6 0-.916-.623-.62-1.129L2.014 3.53 3.896.384c.302-.507.903-.514 1.197-.008L7.001 3.65l1.882 3.229C9.183 7.383 8.881 8 8.267 8z' class='msportalfx-svg-c10'/><circle cx='4.5' cy='6.178' r='.615' class='msportalfx-svg-c01'/><path d='M4.623 2.428H3.98l.164 2.85h.774l.165-2.85z' class='msportalfx-svg-c01'/><\/g><\/svg>"}}));
define("MsPortalImpl/Widgets/Widgets.Common",["require","exports","f","i","ko","$","MsPortalImpl.Controls/Controls/Base/Base","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Svg/Startup/Warning.svg","MsPortalImpl/Base/Base.SvgHelper","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u,f,e,o,s,h,c,l){"use strict";var a;return (function(t){function tt(){if(!k){var n=f("<div style='width:50px;height:50px;overflow:auto'><div><\/div><\/div>").appendTo("body"),t=n.children();k=t.innerWidth()-t.height(99).innerWidth();n.remove()}return k}function it(n,t,i){var e,o,s;t===void 0&&(t=0);i===void 0&&(i=!1);var r=n.getBoundingClientRect(),u=document.documentElement,f=!0;return i||(e=v.innerWidth||u.clientWidth,f=r.left>=0&&r.right<=e),o=v.innerHeight||u.clientHeight,s=r.top+t>=0&&r.bottom+t<=o,{elementRect:r,fullyVisible:s&&f}}function rt(n,t){var i,r;if(!n||!t){y.error("Cannot register a template with an undefined "+(n?"content":"name")+".");return}if(!/^[a-z][a-z0-9]*$/ig.test(n)){y.error("Name '"+n+"' is invalid. Name must start with a letter and can only contain letters and numbers.");return}if(i=f("body"),i.find("#"+n).length){y.error("A template with name '"+n+"' was already registered.");return}r=f("<script id="+n+" type='text/html'/>").text(t);i.append(r)}function d(n){function r(t){var i=t.element;return n===i||f.contains(n,i)}var i=b.first(r),t;return i?i.promise:(t=w.get(n)||a.first((function(t){return f.contains(n,t.element)})),t)?t.promise.then((function(){return d(n)})):Q()}function ut(n){if(n){if(!f.contains(v.document.documentElement,n))return Q.reject(new i.Errors.CanceledError("container is not in documentElement"))}else return r.QReject("container is "+n);return d(n)}function ft(n){n&&f.contains(v.document.documentElement,n)&&a.filter((function(t){var i=t.element;return n===i||f.contains(n,i)})).forEach((function(n){i.remove(a,n);n&&n.dispose()}))}function et(n,t,i,r,u){var s=f(r),h=e.getWidget(s),c,o;return h!==null&&h.dispose(),u&&(c=new i.Widget(s,u,{bindingContext:t,services:n}),o=c,o.awaitContentRevealed)?o.awaitContentRevealed():void 0}function ot(t,r,u){var h,c,e,s;p.isInstanceOfErrorType(t,p.CanceledError)||(t&&(h=i.getLogFriendlyMessage(t),c=t.stack),e=u?"Failed to load the control module '"+u+"'.":"",h&&(e+="\r\n Error: "+h),s=f(r),s.closest("[class^='ext-']").length||s.closest("[class*=' ext-']").length?o.logToExtension(n,r,2,e):y.error(e,1),s.html(nt),Q.nextTick((function(){s.trigger(l.default.fxportalcontrolloadfailed,new i.Errors.Error({message:e,stack:c,innerErrors:t}))})))}function st(n,t,r){return t=t||{controlsDescendantBindings:!0},{init:function(){return t},update:function(t,f,e,o,s){var h=u.unwrap(f());u.ignoreDependencies((function(){var e,o=i.tryImmediateResolve(i.require(n),(function(n){if(!e)return et(r,s,n,t,h)}),(function(r){if(!e&&!i.Errors.isInstanceOfErrorType(r,p.CanceledError))return ot(r,t,n),Q.reject(r)})),c,l,f;Q.isFulfilled(o)||(c=function(){i.remove(a,f,-1);w.delete(t);e&&i.remove(b,f,-1)},l=function(){e=!0;c()},u.utils.domNodeDisposal.addDisposeCallback(t,l),f={element:t,promise:o,dispose:l},Q.isPending(o)&&(a.push(f),w.set(t,f)),f.promise=o.catch((function(n){return b.push(f),Q.reject(n)})).finally(c))}))}}}var g=i.Base.Diagnostics,p=i.Errors,v=window,nt="<span class='fxs-portal-controlloadfailed'>"+c.getSvgReferenceOrFallBackToData(h).outerHTML+i.encodeHtml(s.PartError.title)+"<\/span>",y=g.createLog(n),a=[],w=new i.Map,b=[],k;t.getBrowserScrollbarWidth=tt;t.isElementFullyInViewport=it;t.registerKoTemplate=rt;t.waitForBindings=ut;t.cancelBindings=ft;t.getAsyncBindingHandler=st})(a||(a={})),a}));
define("MsPortalImpl/Base/Base.KnockoutExtensions.HtmlTemplateBinding",["require","exports","f","i","ko","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","MsPortalImpl.Controls/Controls/Base/WidgetBinding","MsPortalImpl/Widgets/Widgets.Common","MsPortalImpl.Controls/Controls/Base/Base"],(function(n,t,i,r,u,f,e,o,s){"use strict";var h;return (function(){function a(){return{controlsDescendantBindings:!0}}function v(t,i,r,o,s,l,a){var v=h(i()),y=v,p,w,b;v!==null&&typeof v=="object"&&(y=h(v.html),w=v.data,p=h(w),b=h(v.isolated));u.ignoreDependencies((function(){if(y&&!l){var i=f.sanitizeHTML({value:y,localRequire:n,windowContext:t,contextData:{BindingName:a}});y=i.sanitizedMarkup}b?s=e.createIsolatedContext(p||o,s):w&&(s=s.createChildContext(p));c.cleanDescendantNodes(t);c.setHtml(t,y);u.applyBindingsToDescendants(s,t)}))}function b(n){return/(&.*?;)|(<.*?>)/.test(n)}var h=u.unwrap,c=u.utils,t=u.bindingHandlers,y="htmlTemplate",l="untrustedHtml",p="trustedHtml",w=i.Base.Diagnostics.createLog(n);t[y]={init:a,update:function(n,t,i,r,u){v(n,t,i,r,u,!1,y)}};t[l]={init:a,update:function(n,t,i,r,u){var f=u.$ctl,e=f&&f.isTrusted;return v(n,t,i,r,u,e,l)}};t["untrustedContent"]={init:a,update:function(n,f,e,h,a){var v=u.unwrap(f())||"";return u.ignoreDependencies((function(){var u,y,p;return v.controlType?u="pcControl":v.htmlTemplate?(u=l,v={html:v.htmlTemplate,data:v.viewModel}):b(v)?(u=l,v={html:v},y=r.createError("untrustedContent Binding",{data:{message:"Html is not allowed in this binding, please pass in an HtmlContent object if you wish to use html here: "+v}}),w.warning(y)):u="text",f=function(){return v},o.cancelBindings(n),p=s.getWidget($(n)),i.disposeDisposable(p),c.cleanDescendantNodes(n),c.setHtml(n,null),t[u].update(n,f,e,h,a)}))}};t[p]={init:a,update:function(n,t,i,r,u){return v(n,t,i,r,u,!0,p)}}})(h||(h={})),h}));
define("MsPortalImpl/Base/Base.KnockoutExtensions.Image",["require","exports","f","ko","MsPortalImpl/Base/Base.ImageHelper"],(function(n,t,i,r,u){"use strict";var f;return (function(){function f(n,t){$(n).empty().append(t.map((function(n){return n.cloneNode(!0)})))}var t={"aria-hidden":"true",role:"presentation",focusable:"false"},n=!i.isFeatureEnabled("nokosvgcaching")&&new i.Map;r.bindingHandlers.image={init:function(){return{controlsDescendantBindings:!0}},update:function(e,o){var h=r.unwrap(o()),c,s;h&&(c=JSON.stringify(h),s=n&&n.get(c),s||(s=u.GetImageData(h,e,t),n&&n.set(c,s)),i.tryImmediateResolve(s,(function(n){f(e,n)})))}}})(f||(f={})),f}));
define("MsPortalImpl/Base/Base.KnockoutExtensions.OverrideComputed",["require","exports","ko"],(function(n,t,i){"use strict";var r;return (function(){i.extenders.allowOverride||(i.extenders.allowOverride=function(n,t){var r,u,f=i.computed(t,{read:n,write:function(t){u=t;r||n(t)}});return f.override=function(t){r=!0;n(t)},f.restoreLastWrittenValue=function(){r=!1;n(u)},u=n(),f})})(r||(r={})),r}));
define("MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedAttrBinding",["require","exports","f","o","ko","MsPortalImpl/Base/Base.Sanitization","MsPortalImpl/Base/Base.ImplUtils"],(function(n,t,i,r,u,f,e){"use strict";var o;return (function(){function o(n,t){var i=u.unwrap(n()),r=c(i,t);return function(){return r}}function c(n,t){if(n&&typeof n=="object"){var e={};return r.getOwnPropertyNames(n).forEach((function(r){if(i.isSerializableProperty(r)){var o=u.unwrap(n[r]);if(f.getWhitelistedAttr().indexOf(r)>-1)e[r]=o?o:null;else switch(r){case"href":case"poster":case"src":o?f.validateUriOrBlank(o)||r==="src"&&f.validateDataImage(o)?e[r]=o:t.push('The value "'+o+'" is not a valid absolute URI, which should start with "http://" or "https://".'):e[r]=null;break;default:t.push("The attribute '{0}' is not allowed.".format(r))}}})),e}return null}var s=i.Base,l=s.Diagnostics,h="Sanitization error found in 'sanitizedAttr' binding\nTag name: {0}; Binding attribute: \"{1}\"\nMessage: {2}",t=u.bindingHandlers;t.sanitizedAttr={init:function(n,i,r,u,f){var e=t.attr,s;return e.init?(s=o(i,[]),e.init(n,s,r,u,f)):null},update:function(i,r,u,f,s){var c=[],a=o(r,c),l;return c.length>0&&(l=c.reduce((function(n,t){var r=i.getAttribute("data-bind")||"None",u=h.format(String(i.tagName),r,t);return n+(u+"\n")}),""),e.logToExtension(n,i,2,l)),t.attr.update(i,a,u,f,s)}}})(o||(o={})),o}));
define("MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedCssBinding",["require","exports","f","o","a","ko","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer","MsPortalImpl/Base/Base.ImplUtils"],(function(n,t,i,r,u,f,e,o){"use strict";var s;return (function(){function h(n,t){var i=f.unwrap(n()),r=l(i,t);return function(){return r}}function l(n,t){var f;if(n&&typeof n=="object")return f={},r.getOwnPropertyNames(n).forEach((function(r){i.isSerializableProperty(r)&&(e.isAllowedCssClassName(r)?f[r]=n[r]:r&&t.push(r))})),f;var o=String(n||""),s=o.split(" "),h=u.prototype.map.call(s,(function(n){return n=String(n||""),e.isAllowedCssClassName(n)?n:(n&&t.push(n),"")}));return h.join(" ")}function a(t,i){var r=t.getAttribute("data-bind")||"None",u=c.format(String(t.tagName),r,i.join(", "));o.logToExtension(n,t,2,u)}var c="Sanitization error found in 'sanitizedCss' binding\nTag name: {0}; Binding attribute: \"{1}\"\nDisallowed class name(s): {2}",s=f.bindingHandlers,t=s.css;s.sanitizedCss={init:function(n,i,r,u,f){if(t.init){var e=h(i,[]);return t.init(n,e,r,u,f)}return null},update:function(n,i,r,u,f){var e=[],o=h(i,e);return e.length&&a(n,e),t.update(n,o,r,u,f)}}})(s||(s={})),s}));
define("MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedHtmlBinding",["require","exports","f","ko","MsPortalImpl/Base/Base.KnockoutTemplateSanitizer"],(function(n,t,i,r,u){"use strict";var f;return (function(){var t=r.bindingHandlers,f=t.html;t.sanitizedHtml={init:function(n,t,i,r,u){return f.init(n,t,i,r,u)},update:function(t,e,o,s,h){var c=r.unwrap(e());(c===null||c===undefined)&&(c="");var l=c.toString().substring(0,1e5),a=u.sanitizeHtmlWithoutKOBindings(l,n,t),v=i.wrap(a.sanitizedMarkup);return f.update(t,v,o,s,h)}};t.html=t.sanitizedHtml;t.unsanitizedHtml=f})(f||(f={})),f}));
define("MsPortalImpl/Base/Base.Pipeline",["require","exports","f"],(function(n,t,i){"use strict";var r;return (function(n){function u(){function u(t){n.push(t)}function f(t,r,u,f){function e(n,e,o,s){return u(e,o,s)?i.require(t,f).then((function(t){return r(n,t,e,o,s)})):undefined}n.push(e)}function e(t,i,r,u){return n.map((function(n){return n(t,i,r,u)}))}var n=[],r={registerFactory:u,registerAsyncFactory:f,getHandlers:e,createPipeline:undefined};return r.createPipeline=function(n,i,u){return t(n,r,i,u)},r}function t(n,t,i,r){function u(u){function c(t){t=t.filter((function(n){return!!n}));var i=f(t);return e(i,u,n,h).finally((function(){h.dispose()}))}var h=n.createChildLifetime(),s=t.getHandlers(h,i,r,u),o;return(s.forEach((function(n,t){Q.isPromise(n)&&(o||(o=[]),o[t]=n.then((function(n){s[t]=n})))})),o)?Q.all(o.filter((function(n){return!!n}))).then((function(){return c(s)})):c(s)}return{startTask:u}}function f(n){for(var i=[],r=Math.max.apply(Math,n.map((function(n){return n.length}))),u=function(t){n.forEach((function(n){n[t]&&i.push({e:t,f:n[t]})}))},t=0;t<r;t++)u(t);return i}function e(n,t,i,u){function a(i){var r;try{r=n[f].f(l,t)}catch(u){return Q.reject(u)}return o?undefined:r&&f<n.length?r.then(i):r}function h(){var t=undefined;for(f++;f<n.length&&!o;f++)if(t=a(h),t)break;return t}var f=-1,e,o=!1,c=r++,s=function(){o=!0},l={indicateTaskComplete:s,taskId:c,lifetime:u};return i.registerForDispose(s),e=h(),e||(e=Q.resolve(undefined)),e}var r=1;n.createDescriptor=u;n.createPipelineInstance=t})(r||(r={})),r}));
define("MsPortalImpl/Base/Base.Selectable2",["require","exports","f","i","o","a","ko","MsPortalImpl/Base/Base.ItemCache","MsPortalImpl/Base/Base.Pipeline"],(function(n,t,i,r,u,f,e,o,s){"use strict";function d(n){var t=new r.TriggerableLifetimeManager;return n.setLifetimeReference(1,t),{selectable:n,dispose:function(){t.dispose()}}}function g(n){return p(n)}function p(n){var i="Selectable",t=l.disposableData(n,i),r;return t||(r=new y(n),t=d(r),l.disposableData(n,i,t)),t.selectable}function nt(n,t){if(t){var i=n.options||{},r=n.metadata||{},u=r.outputParameters||[];return i.onClosed||u.length?!1:!w(n)}return!0}function tt(n,t){var i=n.bladeReference,u=n.flags,s=n.operationId,f=i.parameters,e=i.metadata||{},o=n.reason===3,h=nt(i,o),r=0;return h||(r|=2),o&&(r|=4),u&2&&(r|=8),u&4&&(r|=128),{detailBlade:i.bladeName,extension:i.extensionName,detailBladeInputs:f?f:{},openInContextPane:!!(u&1)||e.isContextBlade,persistentContextPane:e.persistentContextPane,flags:r,operationId:s,onClosed:t}}function it(n){return n.parents("["+h+"]")}function rt(n,t,i){var r=o.rotAdd(n,t);i.attr(h,r);n.registerForDispose((function(){i.removeAttr(h)}))}function ut(n,t){t=t.attr(h)?t:it(t);var i=t.attr(h);return o.rotFind(i)}function w(n){var t=a(n);return t&&t.type===20560}function ft(n){var t=a(n);return t&&t.type===19792}var y,h;u.defineProperty(t,"__esModule",{value:!0});var l=i.Base.ProxiedObservables,a=r.shellInterface,v=window,b=500,k=1,c=s.createDescriptor();c.registerAsyncFactory("./Base.Selectable2.Pipeline",(function(n,t,i,r){return t.openBladeHandler(i,r)}),(function(){return!0}),n);c.registerAsyncFactory("../UI/Compositions/UI.Composition.BladeOpener.Selectable2",(function(n,t,i,r){return t.parameterCollectorHandler(i,r)}),(function(n,t){return t.openBladeRequest?w(t.openBladeRequest.bladeReference):!0}),n);c.registerAsyncFactory("../UI/Compositions/UI.Composition.BladeOpener.Provisioning",(function(n,t,i,r){return t.openBladeHandler(i,r)}),(function(n,t){return t.openBladeRequest?ft(t.openBladeRequest.bladeReference):!0}),n);y=(function(n){function t(t){function ut(n){if(n){if(n.operationId in y){delete y[n.operationId];return}if((n.reason===3||n.reason===4)&&(rt=!0,s(!0),rt=!1),n.reason===4){g(n.operationId,!!(n.flags&2),n.initialWidth);return}(n.reason===2||n.reason===3)&&(l.openBladeRequest=n,it.startTask({}))}}var u=n.call(this)||this,d,g,nt;u.id=k++;u.callbacks=e.observableArray();var o=e.observable(),a=r.shellInterface(t),s=e.observable(!1),l={selectable:u,selectedValue:o,openBladeRequest:undefined,extensionVm:a},it=c.createPipeline(u,{},l),y={},h,p,w=0,rt=!1;return u.setLifetimeReference=function(n,t){n===(w&n)&&(w|=n,t.registerForDispose({dispose:function(){w^=n;w||u.dispose()}}))},u.value=e.computed(u,{read:function(){var n=s()?o():undefined;return n!==undefined?(p&&p!==h&&(p=h),h=d.peek()):h&&(p=h,h=undefined),n},write:function(n){n===undefined&&(s(!1),o(undefined))}}),u.getBladeSelection=function(n){var f,t=n.bladeReference,i=n.operationId,r=t&&t.options&&t.options.onClosed;return r&&i&&(u.callbacks.push({id:i,fn:r}),f=function(n,t){Q(r(n,t)).finally((function(){u.callbacks.remove((function(n){return n.id===i}))}))}),tt(n,f)},d=a.request,g=function(n,t,r){var f=u.createChildLifetime(),h=v.setTimeout((function(){var u=16;u|=t?8:0;o({operationId:n||i.getUniqueId(),flags:u,initialWidth:r})}),b),e=function(){f.dispose()};o.subscribe(f,e);s.subscribe(f,e);f.registerForDispose((function(){v.clearTimeout(h)}))},u.isSelected=e.computed(u,{read:function(){return s()},write:function(n){if(s()!==n)if(s(n),n===!0){var t=i.getUniqueId();g(t);l.openBladeRequest=undefined;it.startTask({operationId:t})}else o(undefined)}}),u.onClick=function(){u.isSelected(!0)},u.invokeClickCallback=function(n,t,i,r,u,f,e){t.invokeClickHandler(n,i,r,a,u,f,e)},u.fetchRequest=function(n){return Q(a.fetchRequest(n)).then((function(n){return n&&n.operationId in y&&(delete y[n.operationId],n=null),l.openBladeRequest=n,n}))},u.getOutputProperties=function(){var n=l.openBladeRequest.bladeReference.metadata,t=n&&n.outputParameters;return f.isArray(t)?t:[]},u.getOutputsChangedHandler=function(){var n=l.openBladeRequest.bladeReference;return function(t){r.invokeCallback(n,"onOutputsChanged",[t])}},nt=function(n){return n?{item:n.selectedItem,metadata:n.controlMetadata}:undefined},u.activationState=e.computed(u,(function(){u.value();var n=nt(p),t=nt(h);return{previous:n,current:t}})),u.notifyBladeOpenCompleted=function(n,t){a.result({operationId:n,success:t})},u.cancel=function(n){var t=o();t&&t.operationId===n&&(t.flags&16&&(y[n]=!0),s(!1),o(undefined),u.notifyBladeOpenCompleted(n,!1))},d.subscribeAndRun(u,ut),u}return __extends(t,n),t.prototype.isClickable=function(){return!0},t})(r.TriggerableLifetimeManager);t.createListSelectable=g;t.getOrCreate=p;h="data-fxselectable";t.setSelectableContext=rt;t.findExtensionViewModel=ut}));
define("MsPortalImpl/Base/Base.Selectable2.ClickContext",["require","exports","f","i","ko"],(function(n,t,i,r,u){"use strict";var f;return (function(t){function f(){return i.require("../UI/Compositions/UI.Composition.Selectable2Registrar",n)}function e(n,t,i){var r=u.observable();return{onClick:function(u){if(r())r().onClick(u);else f().then((function(f){r()||r(f.getListSelectableWithClickHandler(n,t,i));r().onClick(u)}))},activationState:u.pureComputed((function(){return r()?r().activationState():{previous:undefined,current:undefined}}))}}function o(n,t,i){function l(){o&&(o=!1,e().onClick());s&&(s=!1,e().isSelected(!0))}function h(){f().then((function(r){if(!e()){var u=r.getSelectableWithClickHandler(n,t,i);u.registerForDispose(c);e(u)}l()}))}function p(){e()?e().onClick():(o=!0,h())}var c=new r.TriggerableLifetimeManager,e=u.observable(),o,s,a=u.computed(c,{read:function(){return e()?e().isSelected():(h(),!1)},write:function(n){e()&&e().isSelected(n);n&&(s=!0,h())}}),v=u.pureComputed((function(){return e()?e().isClickable():!1})),y=u.pureComputed((function(){return e()?e().value():undefined}));return{isSelected:a,isClickable:v,value:y,onClick:p}}t.getListSelectableWithClickHandler=e;t.getSelectableWithClickHandler=o})(f||(f={})),f}));
define("MsPortalImpl/Base/Base.SelectableSet2",["require","exports","f","i","o","a","ko"],(function(n,t,i,r,u,f,e){"use strict";function rt(n){var i="SelectableSet",t=b.disposableData(n,i);return t||(t=new v(n),b.disposableData(n,i,t)),t}function ut(n){return n instanceof v?n.selectedItems():n.selectableItems().filter((function(n){return n.isSelected()}))}function ft(n){return n?!!n._msPortalFxSelectableSet:!1}function o(){return{added:[],removed:[]}}function g(n,t){var r=o(),u=n.peek(),f=u.length,i;return f&&(t?(i=!1,t.forEach((function(t){var f=u.firstIndex((function(n){return s(n,t)}));f>=0&&(i||(n.valueWillMutate(),i=!0),u.splice(f,1),r.removed.push(t))})),i&&n.valueHasMutated()):r.removed=n.removeAll()),r}function a(n,t,i,r,u,f){var e=o(),h=n.peek(),c,l;return u?h.length&&n.removeAll():t.peek().length===0?h.length>0&&(e.removed=n.removeAll()):(c=!1,l=[],e.removed=h.slice(0),t.peek().forEach((function(n){var t,r,u;i&&(t=et(i,n));r=ot(e.removed,n);r>=0&&(u=e.removed.splice(r,1)[0],t?t.data!==u.data&&(c=!0):t=u);t&&(l.push(t),r<0&&e.added.push(t))})),(e.removed.length||e.added.length||c)&&n(l)),r&&(e.removed=e.removed.concat(r.filter((function(n){return f.some((function(t){return s(n.id,t)&&!e.removed.some((function(n){return s(t,n.id)}))}))})))),e}function nt(n,t,i,r){var u=o(),e,h,f;return!i&&t.length>1&&(t=t.slice(0,1)),e=n.peek(),h=e.length,t=t.filter((function(n){return!e.some((function(t){return s(t,n)}))})),u.added=t,u.added.length&&(f=void 0,f=i?r?[0,0]:[h,0]:[0,h],f=f.concat(u.added),u.removed=n.splice.apply(n,f)),u}function et(n,t,i){var u,f=l(t),r;return k(f)||(r=l(n),r&&(u=r.first((function(n){var t=n.id;return(!i||i(n))&&s(t,f)})))),u}function ot(n,t,i){var u=-1,f=l(t),r;return k(f)||(r=l(n),r&&(u=r.firstIndex((function(n){var t=n.id;return(!i||i(n))&&s(t,f)})))),u}function p(n){return{id:n.id,data:n.data}}var w,v;u.defineProperty(t,"__esModule",{value:!0});var tt=r.TriggerableLifetimeManager,c=r.Po,b=i.Base.ProxiedObservables,it=i.ViewModels,s=it.Internal.Selection2.compareIds,k=i.isNullOrUndefined,y=e.observable,h=e.observableArray,l=e.utils.peekObservable,d;(function(n){n.None=1;n.Single=2;n.Multiple=3})(d=t.ActivationModeInternal||(t.ActivationModeInternal={}));t.getSelectableSet2=rt;t.getSelectedItems=ut;t.isSelectableSet2=ft;w=(function(){function n(n,t,i,r,u,f){this.ids=n;this.includeAll=t;this._allowMultiple=r;this._prepend=u;this._onChanged=f;this.itemsArePinnable=y(!0);this.items=h();this.excludedIds=i;this.excludedItems=h()}return n.prototype.addAll=function(){var r=this._allowMultiple,u=this.includeAll.peek(),i=!1,n,t;r&&(this.excludedIds.removeAll(),u||(this.includeAll(!0),i=!0),n=this.ids,n.peek().length&&n.removeAll(),t=this.items,t.peek().length&&t.removeAll());this._fireChanged([],[],[],[],i,!1,[],[],[],[])},n.prototype.addId=function(n){this._add([n])},n.prototype.addIds=function(n){this._add(n)},n.prototype.addItem=function(n){this._add([n.id],[n])},n.prototype.addItems=function(n){var t=n.map((function(n){return n.id}));this._add(t,n)},n.prototype.removeId=function(n){this._remove([n],null)},n.prototype.removeIds=function(n){this._remove(n,null)},n.prototype.removeItem=function(n){this._remove([n.id],[n])},n.prototype.removeItems=function(n){var t=n.map((function(n){return n.id}));this._remove(t,n)},n.prototype._add=function(n,t){var e=this.includeAll.peek(),i=o(),r=o(),u=o(),f;e?(r=g(this.excludedIds,n),u=a(this.excludedItems,this.excludedIds,t,null,!1,r.removed)):i=nt(this.ids,n,this._allowMultiple,this._prepend);f=a(this.items,this.ids,t,null,e,i.removed);this._fireChanged(i.added,i.removed,f.added,f.removed,!1,!1,r.added,r.removed,u.added,u.removed)},n.prototype._remove=function(n,t){var e=this.includeAll.peek(),i=o(),r=o(),u=o(),f;e?(r=nt(this.excludedIds,n,!0,!1),u=a(this.excludedItems,this.excludedIds,t,null,!1,r.removed)):i=g(this.ids,n);f=a(this.items,this.ids,null,t,e,i.removed);this._fireChanged(i.added,i.removed,f.added,f.removed,!1,!1,r.added,r.removed,u.added,u.removed)},n.prototype.removeAll=function(){var n=!1,t=[],i=[],r=[],u=[];this.includeAll.peek()&&(n=!0,this.includeAll(!1),this.excludedIds.peek().length&&(r=this.excludedIds.removeAll()),this.excludedItems.peek().length&&(u=this.excludedItems.removeAll()));this.ids.peek().length&&(t=this.ids.removeAll());this.items.peek().length&&(i=this.items.removeAll());this._fireChanged([],t,[],i,!1,n,[],r,[],u)},n.prototype._fireChanged=function(n,t,i,r,u,f,e,o,s,h){(n.length||t.length||i.length||r.length||u||f||e.length||o.length||s.length||h.length)&&this._onChanged(n,t,i,r,u,f,e,o,s,h)},n.prototype.fireCurrentChanges=function(){this._fireChanged(this.ids(),[],this.items(),[],this.includeAll(),!1,this.excludedIds(),[],this.excludedItems(),[])},n})();v=(function(){function n(n){var t=this,r=n,i;if(!r._msPortalFxSelectableSet)throw new Error("SelectableSet is missing internal members.  Ensure the SelectableSet is constructed from FxViewModels.SelectableSet2Contract.");this._viewModel=r;this._lifetime=new tt;i=this._lifetime;this.activationMode=n.activationMode||1;this.selectionMode=n.selectionMode||1;var u=n.activatedIds||h(),f=n.selectedIds||h(),e=n.selectedAll||y(!1),o=n.unselectedIds||h();c.disallowRemoteMutations(u);c.disallowRemoteMutations(f);c.disallowRemoteMutations(e);c.disallowRemoteMutations(o);this._activationSet=new w(u,y(!1),h(),this.activationMode===d.Multiple,!0,function(n,i,r,u){t._onActivationChanged&&t._onActivationChanged(n,r,i,u)});this._selectionSet=new w(f,e,o,this.selectionMode===3,!1,function(n,i,r,u,f,e,o,s,h,c){var l=t.selectedAll.peek();t._onSelectionChanged&&t._onSelectionChanged(f,l?s:n,l?c:r,e,l?o:i,l?h:u)});this.activatedItems=this._activationSet.items.mapInto(i,(function(n,t){return p(t)}));this.selectedItems=this._selectionSet.items.mapInto(i,(function(n,t){return p(t)}));this.unselectedItems=this._selectionSet.excludedItems.mapInto(i,(function(n,t){return p(t)}));this.activatedIds=this._activationSet.ids;this.selectedIds=this._selectionSet.ids;this.selectedAll=this._selectionSet.includeAll;this.unselectedIds=this._selectionSet.excludedIds;this.itemsArePinnable=this._selectionSet.itemsArePinnable;this.commandGroupProvider=this._viewModel.commandGroupProvider;this.dynamicSelectionProvider=this._viewModel.dynamicSelectionProvider;this.pinProvider=this._viewModel.pinProvider}return n.prototype.dispose=function(){this._lifetime&&(this._lifetime.dispose(),this._lifetime=null)},n.prototype.registerItemController=function(n,t,i,r){var f=this._activationSet,e=this._selectionSet,u=function(i){return{id:n(i),data:t(i),item:i}};return i&&(this._onActivationChanged=function(n,t,r,u){i(n,t.map((function(n){return n.item})),r,u.map((function(n){return n.item})))},f.fireCurrentChanges()),r&&(this._onSelectionChanged=function(n,t,i,u,f,e){r(n,t,i.map((function(n){return n.item})),u,f,e.map((function(n){return n.item})))},e.fireCurrentChanges()),{activateItem:function(n){var t=u(n);f.addItem(t)},activateItems:function(n){var t=n.map(u);f.addItems(t)},deactivateItem:function(n){var t=u(n);f.removeItem(t)},deactivateItems:function(n){var t=n.map(u);f.removeItems(t)},selectItem:function(n){var t=u(n);e.addItem(t)},selectItems:function(n){var t=n.map(u);e.addItems(t)},unselectItem:function(n){var t=u(n);e.removeItem(t)},unselectItems:function(n){var t=n.map(u);e.removeItems(t)}}},n.prototype.activateId=function(n){this._activationSet.addId(n)},n.prototype.activateIds=function(n){this._activationSet.addIds(n)},n.prototype.activateAllSelectedItems=function(){this._activationSet.addIds(this._selectionSet.ids.peek())},n.prototype.deactivateId=function(n){this._activationSet.removeId(n)},n.prototype.deactivateIds=function(n){this._activationSet.removeIds(n)},n.prototype.deactivateAll=function(){this._activationSet.removeAll()},n.prototype.selectId=function(n){this._selectionSet.addId(n)},n.prototype.selectIds=function(n){this._selectionSet.addIds(n)},n.prototype.selectAll=function(){this._selectionSet.addAll()},n.prototype.unselectId=function(n){this._selectionSet.removeId(n)},n.prototype.unselectIds=function(n){this._selectionSet.removeIds(n)},n.prototype.unselectAll=function(){this._selectionSet.removeAll()},n})();t.SelectableSet2=v}));
define("MsPortalImpl/Base/Base.Timers",["require","exports","f","o","a","ko"],(function(n,t,i,r,u,f){"use strict";function o(n){if(!n&&e.requestAnimationFrame&&e.cancelAnimationFrame)t.requestAnimationFrame=function(n){return e.requestAnimationFrame(n)},t.cancelAnimationFrame=function(n){return e.cancelAnimationFrame(n)};else{var i=0;t.requestAnimationFrame=function(n){var t=Date.now(),r=Math.max(0,16-(t-i)),u=e.setTimeout((function(){n(t+r)}),r);return i=t+r,u};t.cancelAnimationFrame=function(n){e.clearTimeout(n)}}}function s(n){var r,i;return function(){for(var u,o,e=[],f=0;f<arguments.length;f++)e[f]=arguments[f];return r=e,i||(u=Q.defer(),o=i=u.promise,i.timeout(2e3,"requestAnimationFrameQ timout after 2 seconds: callback:"+n).catch((function(){o===i&&(i=null)})),t.requestAnimationFrame((function(){try{var t=Q(n.apply(void 0,r));t.then(u.resolve,u.reject)}catch(f){u.reject(f)}i=null}))),i}}r.defineProperty(t,"__esModule",{value:!0});var e=window;t.setupTimers=o;o(!1);t.throttleByAnimationFrame=s;t.debounce=i.debounce;t.throttle=i.throttle;f.extenders.rateLimit.tasks.debounce=t.debounce;f.extenders.rateLimit.tasks.throttle=t.throttle}));
define("MsPortalImpl/Base/ClaimsIdentity",["require","exports","f","i","o","a","MsPortalImpl/Services/Services.Storage"],(function(n,t,i,r,u,f,e){"use strict";function h(n){var t=Q.defer(),i=new FileReader,u="data:image/jpeg;base64,";return i.onload=function(n){for(var i=n.target.result,r="",e=new Uint8Array(i),f=0;f<e.byteLength;f++)r+=String.fromCharCode(e[f]);try{atob(r);i=u+r}catch(o){if(o.code===5)i=u+btoa(r);else{t.reject(o);return}}t.resolve(i)},i.onerror=function(){return t.reject(r.createError("Error reading thumbnail photo. Error:"+i.error))},i.readAsArrayBuffer(n),t.promise}function c(n,t,i,r){var u=t,f,o;return n&&(f=e.ComponentName.Avatar,o=0,u=!r&&i.getValue(f,n,o),!u)?Q(s.ajax({uri:n,type:"GET",dataType:"binary",responseType:"arraybuffer",isBackgroundTask:!0,performRetry:!0,setAuthorizationHeader:{resourceName:"graph"}})).then((function(n){return h(n)})).catch((function(n){var i=n.jqXHR&&n.jqXHR.status;return i===404||i===403?t:Q.reject(n)})).then((function(t){return i.setValue(f,n,t,o),t})):Q(u)}u.defineProperty(t,"__esModule",{value:!0});var o=i.Base,s=o.Net2;t.getAvatarImage=c}));
define("MsPortalImpl/Base/JQueryExtensions",["require","exports","f","o","$","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u,f,e){"use strict";function y(n,t,r){var e=i.find(n,(function(n){var t=u(n);return!t.hasClass(l)&&!t.hasClass("fxs-display-none")&&!i.startsWith(t.attr("tabindex"),"-")&&f.isVisible(t)&&(!r||r(t))}),t?-1:0);return u(e||[])}function h(n){return function(t){var i=this;return[a,v].reduce((function(r,f){return(r&&r.length)?r:y(u(f,i).toArray(),n,t)}),null)}}r.defineProperty(t,"__esModule",{value:!0});var s=f.findByClassName,c=window,u=jQuery,l="msportalfx-skip-initial-focus",o=u.fn,a="select, button, [tabindex=0], input, textarea",v="a";o.setEvents=function(){for(var n,i,r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];return n=this,i=function(t){var i=function(){return n[t].apply(n,arguments)};r.forEach((function(n){var u=n[0],t=n[1],r;typeof t=="function"?i(u,t):(r=n[2],r&&i(u,t,r))}))},i("on"),{dispose:function(){n&&(i("off"),n=null)}}};o.findByClassName=function(n){return s(this,n)};o.findFirstTabbable=h();o.findLastTabbable=h(!0);o.isInScrollView=function(n){var u,t=n?this.closest("."+n):u=this.scrollParent();if(!t.length||!t[0].offsetParent||!t.is(u||this.scrollParent())&&!this.isInScrollView())return!1;var i=t.offset().top,f=i+t.height(),r=this.offset().top,e=r+this.height(),o=r>=i&&r<=f,s=e<=f&&e>=i;return o&&s};o.handleTransitionEndOnce=function(n,t,i){var o=this,r,s=!1,f;this.on(e.default.transitionend,r=function(t){for(var f,h=[],u=1;u<arguments.length;u++)h[u-1]=arguments[u];(f=t&&t.originalEvent,f&&f.propertyName!==n)||s||(s=!0,o.off(e.default.transitionend,r),i.apply(o,[t].concat(h)))});return f=function(){var t=u.Event("transitionend",{originalEvent:{propertyName:n}});r(t)},u.fx.off?f():c.setTimeout(f,t),this};u.enableAnimations=function(n){var t="fxs-transition-off-style-head-marker",r=u("<style/>").addClass(t).append("* {transition: none !important;-webkit-animation-iteration-count: .5 !important;animation-iteration-count: .5 !important;-webkit-animation-duration: 0s !important;animation-duration: 0s !important;-webkit-animation-delay: 0s !important;animation-delay: 0s !important;}"),i=u("head");u.fx.off=!n;n?s(i,t).remove():s(i,t).length===0&&i.append(r)}}));
define("MsPortalImpl/Base/Languages",["require","exports","f","o","ko","MsPortalFx/Globalization","MsPortalImpl/Services/Services.Storage"],(function(n,t,i,r,u,f,e){"use strict";function o(n,t){return["en-"+n,"English ("+t+")","English ("+t+")"]}function c(n,t,i){return["de-"+n,"German ("+t+")","Deutsch ("+i+")"]}function h(n,t,i){return["es-"+n,"Spanish ("+t+")","Espaol ("+i+")"]}function s(n,t,i){return["fr-"+n,"French ("+t+")","Franais ("+i+")"]}function y(n,t,i){return["pt-"+n,"Portuguese ("+t+")","Portugus ("+i+")"]}function k(){function t(t){var r=this,i=t[0];n[i]={locale:i,name:t[1],localizedName:t[2],neutralCulture:r,specificCulture:t[3]}}var n={},i=[c("be","Belgium","Belgien"),c("de","Germany","Deutschland"),c("li","Liechtenstein","Liechtenstein"),c("lu","Luxembourg","Luxemburg"),c("ch","Switzerland","Schweiz"),c("at","Austria","sterreich"),o("as","American Samoa"),o("ai","Anguilla"),o("ag","Antigua and Barbuda"),o("au","Australia"),o("bs","Bahamas"),o("bb","Barbados"),o("be","Belgium"),o("bz","Belize"),o("bm","Bermuda"),o("bw","Botswana"),o("io","British Indian Ocean Territory"),o("vg","British Virgin Islands"),o("cm","Cameroon"),o("ca","Canada"),o("029","Caribbean"),o("ky","Cayman Islands"),o("cx","Christmas Island"),o("cc","Cocos (Keeling) Islands"),o("ck","Cook Islands"),o("dm","Dominica"),o("er","Eritrea"),o("150","Europe"),o("fk","Falkland Islands"),o("fj","Fiji"),o("gm","Gambia"),o("gh","Ghana"),o("gi","Gibraltar"),o("gd","Grenada"),o("gu","Guam"),o("gg","Guernsey"),o("gy","Guyana"),o("hk","Hong Kong SAR"),o("in","India"),o("ie","Ireland"),o("im","Isle of Man"),o("jm","Jamaica"),o("je","Jersey"),o("ke","Kenya"),o("ki","Kiribati"),o("ls","Lesotho"),o("lr","Liberia"),o("mo","Macao SAR"),o("mg","Madagascar"),o("mw","Malawi"),o("my","Malaysia"),o("mt","Malta"),o("mh","Marshall Islands"),o("mu","Mauritius"),o("fm","Micronesia"),o("ms","Montserrat"),o("na","Namibia"),o("nr","Nauru"),o("nz","New Zealand"),o("ng","Nigeria"),o("nu","Niue"),o("nf","Norfolk Island"),o("mp","Northern Mariana Islands"),o("pk","Pakistan"),o("pw","Palau"),o("pg","Papua New Guinea"),o("ph","Philippines"),o("pn","Pitcairn Islands"),o("pr","Puerto Rico"),o("rw","Rwanda"),o("kn","Saint Kitts and Nevis"),o("lc","Saint Lucia"),o("vc","Saint Vincent and the Grenadines"),o("ws","Samoa"),o("sc","Seychelles"),o("sl","Sierra Leone"),o("sg","Singapore"),o("sx","Sint Maarten"),o("sb","Solomon Islands"),o("za","South Africa"),o("ss","South Sudan"),o("sh","St Helena, Ascension, Tristan da Cunha"),o("sd","Sudan"),o("sz","Swaziland"),o("tz","Tanzania"),o("tk","Tokelau"),o("to","Tonga"),o("tt","Trinidad and Tobago"),o("tc","Turks and Caicos Islands"),o("tv","Tuvalu"),o("um","U.S. Outlying Islands"),o("vi","U.S. Virgin Islands"),o("ug","Uganda"),o("gb","United Kingdom"),o("us","United States"),o("vu","Vanuatu"),o("001","World"),o("zm","Zambia"),o("zw","Zimbabwe"),h("ar","Argentina","Argentina"),h("bo","Bolivia","Bolivia"),h("cl","Chile","Chile"),h("co","Colombia","Colombia"),h("cr","Costa Rica","Costa Rica"),h("cu","Cuba","Cuba"),h("ec","Ecuador","Ecuador"),h("sv","El Salvador","El Salvador"),h("es","Spain, International Sort","Espaa, alfabetizacin internacional"),h("us","United States","Estados Unidos"),h("ph","Philippines","Filipinas"),h("gt","Guatemala","Guatemala"),h("gq","Equatorial Guinea","Guinea Ecuatorial"),h("hn","Honduras","Honduras"),h("419","Latin America","Latinoamrica"),h("mx","Mexico","Mxico"),h("ni","Nicaragua","Nicaragua"),h("pa","Panama","Panam"),h("py","Paraguay","Paraguay"),h("pe","Peru","Per"),h("pr","Puerto Rico","Puerto Rico"),h("do","Dominican Republic","Repblica Dominicana"),h("uy","Uruguay","Uruguay"),h("ve","Venezuela","Venezuela"),s("dz","Algeria","Algrie"),s("be","Belgium","Belgique"),s("bf","Burkina Faso","Burkina Faso"),s("bi","Burundi","Burundi"),s("bj","Benin","Bnin"),s("cm","Cameroon","Cameroun"),s("ca","Canada","Canada"),s("km","Comoros","Comores"),s("cg","Congo","Congo"),s("cd","French Congo (DRC)","Congo, Rpublique dmocratique du"),s("ci","Cte dIvoire","Cte dIvoire"),s("dj","Djibouti","Djibouti"),s("fr","France","France"),s("ga","Gabon","Gabon"),s("gp","Guadeloupe","Guadeloupe"),s("gq","Equatorial Guinea","Guine quatoriale"),s("gn","Guinea","Guine"),s("gf","French Guiana","Guyane franaise"),s("ht","Haiti","Hati"),s("re","Runion","La Runion"),s("lu","Luxembourg","Luxembourg"),s("mg","Madagascar","Madagascar"),s("ml","Mali","Mali"),s("ma","Morocco","Maroc"),s("mq","Martinique","Martinique"),s("mu","Mauritius","Maurice"),s("mr","Mauritania","Mauritanie"),s("yt","Mayotte","Mayotte"),s("mc","Monaco","Monaco"),s("ne","Niger","Niger"),s("nc","New Caledonia","Nouvelle-Caldonie"),s("pf","French Polynesia","Polynsie franaise"),s("rw","Rwanda","Rwanda"),s("cf","Central African Republic","Rpublique centrafricaine"),s("bl","Saint Barthlemy","Saint-Barthlemy"),s("mf","Saint Martin","Saint-Martin"),s("pm","Saint Pierre and Miquelon","Saint-Pierre-et-Miquelon"),s("sc","Seychelles","Seychelles"),s("ch","Switzerland","Suisse"),s("sy","Syria","Syrie"),s("sn","Senegal","Sngal"),s("td","Chad","Tchad"),s("tg","Togo","Togo"),s("tn","Tunisia","Tunisie"),s("vu","Vanuatu","Vanuatu"),s("wf","Wallis and Futuna","Wallis-et-Futuna"),["it-it","Italian (Italy)","Italiano (Italia)"],["it-sm","Italian (San Marino)","Italiano (San Marino)"],["it-ch","Italian (Switzerland)","Italiano (Svizzera)"],["hu-hu","Hungarian (Hungary)","Magyar (Magyarorszg)"],["nl-aw","Dutch (Aruba)","Nederlands (Aruba)"],["nl-be","Dutch (Belgium)","Nederlands (Belgi)"],["nl-bq","Dutch (Bonaire, Sint Eustatius and Saba)","Nederlands (Bonaire, Sint Eustatius en Saba)"],["nl-cw","Dutch (Curaao)","Nederlands (Curaao)"],["nl-nl","Dutch (Netherlands)","Nederlands (Nederland)"],["nl-sx","Dutch (Sint Maarten)","Nederlands (Sint-Maarten)"],["nl-sr","Dutch (Suriname)","Nederlands (Suriname)"],["pl-pl","Polish (Poland)","Polski (Polska)"],y("br","Brazil","Brasil"),y("pt","Portugal","Portugal"),["sv-fi","Swedish (Finland)","Svenska (Finland)"],["sv-se","Swedish (Sweden)","Svenska (Sverige)"],["sv-ax","Swedish (land Islands)","Svenska (land)"],["tr-cy","Turkish (Cyprus)","Trke (Kbrs)"],["tr-tr","Turkish (Turkey)","Trke (Trkiye)"],["qps-ploc","Pseudo (Pseudo)","[ () !!! !!]"],["cs-cz","Czech (Czechia)","etina (esko)"],["ru-by","Russian (Belarus)"," ()"],["ru-kz","Russian (Kazakhstan)"," ()"],["ru-kg","Russian (Kyrgyzstan)"," ()"],["ru-md","Russian (Moldova)"," ()"],["ru-ru","Russian (Russia)"," ()"],["ru-ua","Russian (Ukraine)"," ()"],["zh-cn","Chinese (Simplified, China)","()"],["zh-tw","Chinese (Traditional, Taiwan)","()"],["zh-sg","Chinese (Simplified, Singapore)","()"],["zh-mo","Chinese (Traditional, Macao SAR)","()"],["zh-hk","Chinese (Traditional, Hong Kong SAR)","()"],["ja-jp","Japanese (Japan)"," ()"],["ko-kp","Korean (North Korea)"," ()"],["ko-kr","Korean (Korea)","()"],];return[["de","German","Deutsch","de-de"],["en","English","English","en-us"],["es","Spanish","Espaol","es-es"],["fr","French","Franais","fr-fr"],["it","Italian","Italiano","it-it"],["hu","Hungarian","Magyar","hu-hu"],["nl","Dutch","Nederlands","nl-nl"],["pl","Polish","Polski","pl-pl"],["pt","Portuguese","Portugus","pt-br"],["sv","Swedish","Svenska","sv-se"],["tr","Turkish","Trke","tr-tr"],["cs","Czech","etina","cs-cz"],["ru","Russian","","ru-ru"],["zh","Chinese","","zh-cn"],["zh-hans","Chinese (Simplified)","()","zh-cn"],["zh-chs","Chinese (Simplified) Legacy","() ","zh-cn"],["zh-hant","Chinese (Traditional)","()","zh-tw"],["zh-cht","Chinese (Traditional) Legacy","() ","zh-tw"],["ja","Japanese","","ja-jp"],["ko","Korean","","ko-kr"],].forEach(t,!0),i.forEach(t,!1),n}function d(n){var i=t.knownCulturesMap[n];return i?i.localizedName:null}function g(n){var i=a.NativeIntl||a.Intl,t=n.split(".")[1];try{if(!i||t==="en-in"&&i.DateTimeFormat(t).format(new Date(2016,0,9))==="1/9/2016")return!0;t&&i.DateTimeFormat(t,{hour:"numeric",minute:"numeric"})}catch(r){return!0}return!1}function nt(n,t){var i=[];return n.forEach((function(n){n in t&&i.push(t[n])})),i}function tt(n){var r=i.convertArrayToMap(n,(function(n){return n.locale.split("-")[0]}));return v(t.knownCulturesMap,(function(n,t,i){var u=n.split("-");u.length>1&&!t.neutralCulture&&r[u[0]]&&i.push(t)}),[])}function it(n,t,i){return n?n.split(".")[1]:i}function p(n){var i=n.displayLanguage,r=nt(n.supportedLocales,t.knownCulturesMap);return{selectableDisplayLanguages:r,selectedDisplayLanguage:i,selectedFormatCulture:it(n.rawLocaleSetting,i,n.formatCulture),selectableFormatCultures:tt(r)}}function rt(n,r,e,o,s){r.setValue(l,"LastUsedLocale",o,0);var h=!1;return u.reactor(n,(function(){var c=e(),n=JSON.parse(r.getValue(l,t.redirectQueryKey,0)||"{}"),u,f;n.l=c||"";u=c||o;s||u===o||(h=!0);f=i.getFeatureValue("intlpolyfill");f!=="false"&&(n["feature.intlpolyfill"]=g(u)?"true":"",n["feature.intlpolyfill"]&&f==="true"&&(h=!0));r.setValue(l,t.redirectQueryKey,JSON.stringify(n),0)})),t.currentLocaleContext=p({supportedLocales:b,displayLanguage:f.displayLanguage,formatCulture:f.formatCulture,rawLocaleSetting:e()}),h}var v,l;r.defineProperty(t,"__esModule",{value:!0});var a=window,w=a.fx.environment,b=w.supportedLocales;t.knownCulturesMap=k();v=i.forEachKey;t.redirectQueryKey="LocaleQuery";t.localeDelimiter=".";l=e.ComponentName.Redirect;t.getLocalizedName=d;t.createLocaleContext=p;t.initialize=rt}));
define("MsPortalImpl/Services/Services.PortalIdleState",["require","exports","o","Fx/DependencyInjection"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});var u=(function(){function n(n,t){var i=this;this._win=n;this._defaultPollMS=t;this._state=0;this._handleId=1;this._iteration=0;this._actions=[];this._win.addEventListener("blur",this._blurFunc=function(){i._blurStartTime=new Date;i._state=1;i._processCallbacks(i._defaultPollMS)});this._win.addEventListener("focus",this._focusFunc=function(){i._blurStartTime=null;i.signalBusy()})}return n.prototype.dispose=function(){var n=this._win;return n?(this._win=null,n.removeEventListener("blur",this._blurFunc),n.removeEventListener("focus",this._focusFunc),this._state=0,!0):!1},n.prototype.addCallbacks=function(n){var t=this._handleId++;return this._actions.push({key:t,value:n}),t},n.prototype.removeCallbacks=function(n){var t=this._actions,i=t.firstIndex((function(t){return n===t.key}));return i!==-1?(t.splice(i,1),!0):!1},n.prototype.signalBusy=function(){this._state===1&&(this._state=2,this._processCallbacks(5e3))},n.prototype.signalIdle=function(){this._blurStartTime||(this._blurStartTime=new Date);this._state=1;this._processCallbacks(0)},n.create=function(){return new n(window,9e5)},n.prototype._processCallbacks=function(n){var t=this,i;this._win&&(i=this._timeoutHandle,i&&this._win.clearTimeout(i),this._timeoutHandle=this._win.setTimeout((function(){t._timeoutHandle=null;try{t._processIteration()}finally{t._state!==0&&t._processCallbacks(t._defaultPollMS)}}),n))},n.prototype._processIteration=function(){var i=this,t,n;switch(this._state){case 2:this._state=0;t=function(n){n.onBusy(new Date)};break;case 1:this._state=1;t=function(n){return n.onIdle(new Date,i._blurStartTime)};break;default:case 0:return}var r=function(n){var r=i._actions[n];r&&t(r.value)},u=this._actions.length,f=this._iteration%u;for(this._iteration++,n=f;n<u;n++)r(n);for(n=0;n<f;n++)r(n)},n})();__decorate([r.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",u)],u,"create",null);t.PortalIdleStateService=u}));
define("MsPortalImpl/Svg/Startup/Error.svg",[],(function(){"use strict";return{type:6,data:"<svg viewBox='0 0 9 9' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><circle cx='4.5' cy='4.5' r='4.5' class='msportalfx-svg-c22'/><circle cx='4.5' cy='6.438' r='.697' class='msportalfx-svg-c01'/><path d='M4.604 2.186h-.729l.186 3.232h.878l.186-3.232z' class='msportalfx-svg-c01'/><\/g><\/svg>"}}));
define("MsPortalImpl/UI/Compositions/UI.Composition",["require","exports","f","o","MsPortalImpl/Extension/Extension.Definition.Locator"],(function(n,t,i,r,u){"use strict";function l(n){return function(t){return t.id===n}}function a(n,t,i){if(n)if(t){if(!i)throw new Error("Command container name is required.");}else throw new Error("Command name is required.");else throw new Error("Commands list is required.");var r=n.first((function(n){return n.commandName===t}));return r||e.error("Command container '{0}' does not have a command named '{1}'.".format(i,t)),r}function v(n){var t=n.locator&&n.locator.type;return t===u.LocatorType.PartInstance||t===u.LocatorType.PartType||t===u.LocatorType.StartboardPartInstance}function y(n,t){return r.keys(t).every((function(r){return n.hasOwnProperty(r)&&i.deepEquals(t[r],n[r])}))}function p(n,t,i){var s;try{return t()}catch(r){var h="Error deserializing composition.",f=void 0,o=void 0;try{f=JSON.stringify(n)}catch(c){f="<Invalid> {0}".format(c.toString())}try{o=u.Locator.fromJSON(n.locator)}catch(l){o=u.Locator.forExtension(h+"-"+l)}return s="{0}\nJSON: {1}\nException Message: {2}\nException StackTrace: {3}".format(h,f,r.message||"<N/A>",r.stack||r.toString()),e.error(s),i(o,s)}}function w(n){var t=n&&n.assetTypeId;if(typeof t=="string")return t}function b(n){var t=n;return t&&t.beforeActivateCommandMenuItems&&typeof t.beforeActivateCommandMenuItems=="function"}var c;r.defineProperty(t,"__esModule",{value:!0});var f=i.Base,o=f.Constants,s=o.BladeParameterNames,h=f.Diagnostics,e=h.createLog(n);t.referenceTypeMap={};t.referenceTypeMap[0]="Part";t.referenceTypeMap[1]="BladeInput";t.referenceTypeMap[2]="BladeActionBar";t.referenceTypeMap[3]="BladeProperty";t.referenceTypeMap[4]="Command";t.referenceTypeMap[5]="Constant";t.referenceTypeMap[6]="SelectedItem";t.referenceTypeMap[7]="Adapter";t.referenceTypeMap[8]="Dashboard";t.referenceTypeMap[9]="AdapterInput";t.EditScopeIdPropertyName=s.EditScopeId;t.PartContainerModelIdProperty="##SnapshotContainerId##";t.CompositionInstanceDataName="MsPortalImplCompositionInstance";t.fxreplacedpartcomposing="fxreplacedpartcomposing",(function(n){n[n.Unknown=0]="Unknown";n[n.Part=1]="Part";n[n.StartboardPart=2]="StartboardPart";n[n.Lens=3]="Lens";n[n.BladeActionBar=4]="BladeActionBar";n[n.Blade=5]="Blade";n[n.Journey=6]="Journey";n[n.Startboard=7]="Startboard"})(c=t.CompositionType||(t.CompositionType={}));t.getIdMatchFunc=l;t.findCommand=a;t.isPartComposition=v;t.deepSubset=y;t.createCompositionFromJSON=p;t.tryGetAssetType=w;t.isContextMenuContainer=b}));
define("MsPortalImpl/Interactions/Interactions.DismissHandler",["require","exports","f","i","o","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u,f){"use strict";function k(n,t){c.error("An error occurred on dismiss. Unregister might have been forgotten on cleanup of the dismissable element. DismissHandle log name: {0}".format(t&&t.logName||"unknown"),0,n)}function d(n){var i="function",t=!!n;return n.shouldDismissOnFocusOutFn&&(t=t&&typeof n.shouldDismissOnFocusOutFn===i),n.restoreFocus&&(t=t&&typeof n.restoreFocus===i),n.shouldDismissOnMouseDownFn&&(t=t&&typeof n.shouldDismissOnMouseDownFn===i),n.shouldDismissOnMouseWheelFn&&(t=t&&typeof n.shouldDismissOnMouseWheelFn===i),t}function o(n){var t=n&&typeof n.dismissFn=="function"&&d(n);return t||c.error("The dismiss handle object is null or malformed."),t}function h(n){var r,i,t,u;if(e.length)for(r=e[e.length-1],i=r.length-1;i>=0;i--){t=r[i];try{u=n(t);u!==0&&(t.dismissFn(),u===2&&t.restoreFocus&&t.restoreFocus())}catch(f){k(f,t)}}}function v(n){h((function(t){return t.shouldDismissOnFocusOutFn&&o(t)?t.shouldDismissOnFocusOutFn(n.target):0}))}function y(n){n.keyCode===27&&h((function(n){return o(n)?2:0}))}function s(n){h((function(t){return t.shouldDismissOnMouseDownFn&&o(t)?t.shouldDismissOnMouseDownFn(n.target,n):0}))}function p(n){l||(l=!0,b.setTimeout((function(){l=!1}),250),h((function(t){return t.shouldDismissOnMouseWheelFn&&o(t)?t.shouldDismissOnMouseWheelFn(n.target):0})))}function w(n){h((function(t){return t.shouldDismissOnMouseWheelFn&&t.shouldDismissOnScroll&&o(t)&&!$(n.target).hasClass("azc-resize")?t.shouldDismissOnMouseWheelFn(n.target):0}))}function g(){var n=a.body;n.addEventListener(f.default.focus,v,!0);n.addEventListener(f.default.keydown,y,!0);n.addEventListener(f.default.mousedown,s,!0);n.addEventListener(f.default.touchstart,s,!0);n.addEventListener(f.default.pointerdown,s,!0);n.addEventListener(f.default.mousewheel,p,!0);n.addEventListener(f.default.scroll,w,!0)}function nt(){var n=a.body;n.removeEventListener(f.default.focus,v,!0);n.removeEventListener(f.default.keydown,y,!0);n.removeEventListener(f.default.mousedown,s,!0);n.removeEventListener(f.default.touchstart,s,!0);n.removeEventListener(f.default.pointerdown,s,!0);n.removeEventListener(f.default.mousewheel,p,!0);n.removeEventListener(f.default.scroll,w,!0);e.length=0}function tt(n,t){if(!o(n))throw new Error("The dismiss handle object is null or malformed.");e.some((function(t){return t.indexOf(n)>=0}))||((t||!e.length)&&e.push([]),e.last().push(n))}function it(n){e.forEach((function(t){t.remove(n)}));e=e.filter((function(n){return n.length!==0}))}function rt(n,t){var u="DismissHandle for '"+n.logName+"': previouslyFocusedElement";if(t){if(typeof t.focus!="function")return c.error(r.createError(u+" focus member is not a function. _previouslyFocusedElement.focus: "+t.focus,{data:{previous:i.getObjectDescriptor(t)}})),!1}else return c.warning(u+" was not defined."),!1;return!0}u.defineProperty(t,"__esModule",{value:!0});var b=window,a=document,c=i.Base.Diagnostics.createLog(n),l=!1,e=[];t.initialize=g;t.dispose=nt;t.register=tt;t.unregister=it;t.validatePreviousFocusedElement=rt}));
define("MsPortalImpl/Interactions/Interactions.KeyboardNavigation",["require","exports","o","ko","MsPortalImpl/Base/Base.KeyboardHelper","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u,f,e){"use strict";i.defineProperty(t,"__esModule",{value:!0});var o=(function(){function n(n,t){var i=this,r;this._element=t.element;this._tabTriggers=t.tabTriggers||6;this._itemSelector=t.itemSelector||":tabbable";this._arrowsOnly=!(this._tabTriggers&2);this._internalLifetime=n.createChildLifetime();this._parentTabIndexContextObservable=t.parentTabIndexContextObservable;this._childrenHaveTabIndexContext=t.childrenHaveTabIndexContext;this._setRootTabIndex();this._internalLifetime.registerForDispose(this._element.setEvents([e.default.focus,function(){i._element.find(i._itemSelector).first().focus()},],[e.default.keydown,function(n){i._handleMenuKeyDown(n)},]));this._arrowsOnly&&(r=this._element.find(this._itemSelector),r.attr("tabindex","-1"),this._internalLifetime.registerForDispose(this._element.setEvents([e.default.focus,this._itemSelector,function(n){i._manageTabIndices($(n.target).closest(i._itemSelector,i._element[0]))}])))}return n.prototype.correctState=function(n){(n||this._lastTarget&&this._lastTarget.length&&this._element.find(this._itemSelector).toArray().indexOf(this._lastTarget[0])<0)&&this._setRootTabIndex()},n.prototype.dispose=function(){this._internalLifetime.dispose()},n.prototype._handleMenuKeyDown=function(n){var r=u.getModifierKeys(n),i=!1,f=this._tabTriggers&2,e=this._tabTriggers&4,o=this._tabTriggers&8,t=r===0;f&&n.keyCode===9&&t||e&&n.keyCode===40&&t||o&&n.keyCode===39&&t?i=this._moveFocusToItem(1,n.target):(f&&n.keyCode===9&&r===4||e&&n.keyCode===38&&t||o&&n.keyCode===37&&t)&&(i=this._moveFocusToItem(-1,n.target));i&&n.preventDefault()},n.prototype._moveFocusToItem=function(n,t){var r=!1,e=this._element.find(this._itemSelector),i=$(e.filter((function(n,t){return f.isElementVisible(t)}))),u=i.index(t);return u!==-1&&($(i[(u+n+i.length)%i.length]).focus(),r=!0),r},n.prototype._manageTabIndices=function(n){var t=this,i=this._element.find(this._itemSelector),u,f;this._lastTarget&&this._lastTarget[0]===n[0]||(this._itemFocusLifetime&&this._itemFocusLifetime.dispose(),this._itemFocusLifetime=this._internalLifetime.createChildLifetime(),this._lastTarget=n,i.index(this._lastTarget[0])>=0&&(this._parentTabIndexContextObservable?this._parentTabIndexContextObservable.subscribeAndRun(this._itemFocusLifetime,(function(n){if(i.attr("tabindex","-1"),t._lastTarget.attr("tabindex",n),t._childrenHaveTabIndexContext){var u=r.contextFor(t._lastTarget[0]).$tabIndex;u&&u(n)}})):(i.attr("tabindex","-1"),this._lastTarget.attr("tabindex","0"))),this._clearRootTabIndex(),u=function(){t._setRootTabIndex()},f=this._lastTarget[0],r.utils.domNodeDisposal.addDisposeCallback(f,u),this._itemFocusLifetime.registerForDispose((function(){r.utils.domNodeDisposal.removeDisposeCallback(f,u)})))},n.prototype._setRootTabIndex=function(){var n=this;this._parentTabIndexContextObservable?(this._rootFocusLifetime&&this._rootFocusLifetime.dispose(),this._rootFocusLifetime=this._internalLifetime.createChildLifetime(),this._parentTabIndexContextObservable.subscribeAndRun(this._rootFocusLifetime,(function(t){n._element.attr("tabindex",t)}))):this._element.attr("tabindex","0")},n.prototype._clearRootTabIndex=function(){this._rootFocusLifetime&&this._rootFocusLifetime.dispose();this._element.attr("tabindex","-1")},n})();t.KeyboardNavigation=o}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.FormDialog.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxs-formdialog{font-size:14px;border:1px solid;line-height:14px}.fxs-formdialog h2{font-size:110%}.fxs-formdialog .fxs-formdialog-description{margin-top:-10px}.fxs-formdialog .fxs-formdialog-form{margin:20px 0 0;padding:15px 25px;width:448px;max-width:calc(100% - 2 * 25px)}.fxs-formdialog .fxs-formdialog-buttons{margin-left:25px}.fxs-formdialog .fxs-formdialog-buttons>.fxc-simplebutton{margin-right:5px;margin-bottom:25px}.fxs-formdialog-header{border-bottom:1px solid;margin:0 25px;padding-bottom:10px}")}));
define("MsPortalImpl/Widgets/Dialogs/Widgets.FormDialog",["require","exports","f","ko","MsPortalImpl.Controls/Fields/Base/FormValidation","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Interactions/Interactions.KeyboardNavigation","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.Common","MsPortalImpl/Base/Base.Timers","MsPortalImpl/Base/JQueryHelper","_generated/Less/MsPortalImpl/Widgets/Widgets.FormDialog.css"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";var l;return (function(n){var l=i.ViewModels.Controls.SimpleButton.ViewModel,b=i.ViewModels.Forms.Section,t=b.ViewModel,a=i.newGuid,v="fxs-formdialog",y="fxs-portal-bg-txt-br",p="fxs-popup",k="<div class='fxs-formdialog-header fxs-portal-border'><h2 data-bind='text: data.dialogOptions.title'><\/h2><div class='fxs-formdialog-description' data-bind='text: data.dialogOptions.description'><\/div><\/div><div class='fxs-formdialog-form msportalfx-form' data-bind='pcControl: func._formSection'><\/div><div class='fxs-formdialog-buttons'><div class='fxs-formdialog-okbutton' data-bind='pcControl: func._okButton'><\/div><div class='fxs-formdialog-cancelbutton' data-bind='pcControl: func._cancelButton'><\/div><\/div>",d=(function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.okButtonText=r.observable(),t.cancelButtonText=r.observable(),t.onOkClick=i.noop,t.onCancelClick=i.noop,t}return __extends(t,n),t})(o.ViewModel),w;n.ViewModel=d;w=(function(n){function o(t,i){var r=n.call(this,t,i)||this,o,u;if(!i.dialogOptions)throw new Error("dialogOptions must be specified for rendering a form dialog.");return t.addClass(v+" "+p+" "+y).html(k),o=document.activeElement,u=r._dismissHandle={dismissFn:function(){r._cancelButton&&i.onCancelClick()},restoreFocus:function(){f.validatePreviousFocusedElement(u,o)&&o.focus()},logName:"formdialog"},new e.KeyboardNavigation(r.ltm,{element:t,tabTriggers:2}),f.register(u),r.ltm.registerForDispose((function(){f.unregister(u)})),r._initializeViewModels(u),r._bindDescendants(),r._setAria(),r.setFocus(),r}return __extends(o,n),o.prototype.setFocus=function(){var t=this,n=this.element;s.waitForBindings(n[0]).finally((function(){var i=n.find("input:first");i.length===0&&(i=n.find(".fxs-formdialog-okbutton:first .fxs-button"));h.requestAnimationFrame((function(){t.ltm&&!t.ltm.isDisposed()&&i.length&&c.isElementVisible(i[0])&&i.focus()}))}))},o.prototype.dispose=function(){this._cleanElement(v,p,y);n.prototype.dispose.call(this)},o.prototype._setAria=function(){var t="aria-labelledby",i="aria-describedby",n=this.element,r=a(),u=a();n.attr("role","alertdialog").attr(t,u).attr(i,r);n.find("h2").attr("id",u);n.findByClassName("fxs-formdialog-description").attr({id:r});this.ltm.registerForDispose((function(){n.removeAttr(["role",t,i].join(" "))}))},o.prototype._initializeViewModels=function(n){var h=this,f=this.ltm,e=this.options,o=e.dialogOptions,c=[[o.row1column1,o.row1column2],[o.row2column1,o.row2column2],],a=c.map((function(n){var u=n.filter(i.identity).map((function(n){return new t(f,{style:r.observable(0),children:r.observableArray([n])})}));if(u.length)return new t(f,{style:r.observable(3),children:r.observableArray(u)})})).filter(i.identity),v=this._formSection=new t(f,{children:r.observableArray(a)}),s;this._cancelButton=new l(f,{text:e.cancelButtonText,onClick:function(){e.onCancelClick();n.restoreFocus()}});s=this._okButton=new l(f,{text:e.okButtonText,primary:!0,onClick:function(){u.ensureFormFieldValidation(h.element,!0).then((function(t){t&&(e.onOkClick(),n.restoreFocus())}))}});r.computed(f,[this._formSection.valid],(function(){s.disabled(!v.valid())}))},o})(o.Widget);n.Widget=w})(l||(l={})),l}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.ListPopup.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxs-listpopup{display:inline-block;cursor:default;position:absolute;left:0;width:200px;max-height:300px;z-index:200;overflow-y:auto;box-sizing:border-box}.fxs-listpopup .fxs-listpopup-list{list-style-type:none;padding:0;max-height:300px}.fxs-listpopup .fxs-listpopup-item{font-size:12px;line-height:normal;display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center;-webkit-flex:0 0 auto;flex:0 0 auto;white-space:nowrap;text-overflow:ellipsis;position:relative;box-sizing:border-box;padding:0 10px;border:0;overflow:visible;text-align:left;height:35px;cursor:pointer}")}));
define("MsPortalImpl/Widgets/Dialogs/Widgets.ListPopup",["require","exports","f","o","ko","$","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Base/Base.KeyboardHelper","MsPortalImpl/Interactions/Interactions.KeyboardNavigation","MsPortalImpl/Widgets/Widgets.WidgetBase","_generated/Less/MsPortalImpl/Widgets/Widgets.ListPopup.css"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";var b;r.defineProperty(t,"__esModule",{value:!0});var k=i.Base.Diagnostics,c=".fxs-commandBar-item",l="fxs-listpopup",d=k.createLog(n),a="fxs-portal-bg-txt-br",v="fxs-popup",y="fxs-listpopup-list",p="fxs-listpopup-item",w="."+p,g="<ul class='"+y+"' data-bind='foreach: func._items' role='menu'>"+("<li role='menuitem' class='"+p+" fxs-portal-hover' tabindex='-1'")+'data-bind=\'text: text, css: { "fxs-listpopup-item-selected fxs-portal-selected fxs-portal-activated fxs-br-primary": text === $root.data.dialogOptions.selectedItem() }, event: { click: onClick, keydown: onKeyDown}, attr: { title: text, "aria-setsize": $parent.func._items().length, "aria-posinset": $index() + 1, "aria-selected": text === $root.data.dialogOptions.selectedItem() }\'><\/li><\/ul>',nt=(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t})(h.ViewModel);t.ViewModel=nt;b=(function(n){function t(t,i){var r=n.call(this,t,i)||this;i.dialogOptions||d.error("dialogOptions must be specified for rendering a list popup.");var h=document.activeElement,p=function(n){return n===h||f.contains(h,n)?0:!(t[0]===n)&&!f.contains(t[0],n)?2:0},b=r._dismissHandle={dismissFn:function(){var n=i.onLostFocus;n&&n()},shouldDismissOnFocusOutFn:p,shouldDismissOnMouseDownFn:p,shouldDismissOnMouseWheelFn:p,restoreFocus:function(){e.validatePreviousFocusedElement(b,h)&&h.focus()},logName:"listpopup"};return r._items=u.computed(r.ltm,(function(){var n=function(n){typeof i.onItemSelected=="function"&&(i.dialogOptions.selectedItem(n),i.onItemSelected(),b.restoreFocus())};return i.dialogOptions.listItems().map((function(t){return{text:t,onClick:function(i,r){r.stopPropagation();n(t)},onKeyDown:function(i,r){if((r.keyCode===13||r.keyCode===32)&&o.getModifierKeys(r)===0)r.stopPropagation(),n(t);else return!0}}}))})),t.addClass(l+" "+v+" "+a).html(g),new s.KeyboardNavigation(r.ltm,{element:t.find("."+y),tabTriggers:12,itemSelector:w}),t.closest(c).attr("aria-expanded","true"),r._bindDescendants(),Q.nextTick((function(){r.setFocus()})),e.register(b),r}return __extends(t,n),t.prototype.dispose=function(){e.unregister(this._dismissHandle);this._cleanElement(l,v,a);this.element.removeAttr("tabindex").closest(c).attr("aria-expanded","false");n.prototype.dispose.call(this)},t.prototype.setFocus=function(){this.element.find(w).first().focus()},t})(h.Widget);t.Widget=b}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.MessageBox.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxs-messagebox,.fxs-progressbox{font-size:14px;box-sizing:border-box;box-shadow:0 5px 15px 2px rgba(0,0,0,.3);border:1px solid}.fxs-messagebox h2,.fxs-progressbox h2{font-size:110%;padding:24px 27px 7px;margin:0;line-height:14px;border-bottom:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-messagebox .fxs-messagebox-text,.fxs-messagebox .fxs-modal-template,.fxs-messagebox .fxs-progressbox-text,.fxs-progressbox .fxs-messagebox-text,.fxs-progressbox .fxs-modal-template,.fxs-progressbox .fxs-progressbox-text{padding:0 27px;word-wrap:break-word}.fxs-messagebox .fxs-progressbox-progressbar,.fxs-progressbox .fxs-progressbox-progressbar{padding:7px 27px 24px}.fxs-messagebox .fxs-messagebox-buttons,.fxs-progressbox .fxs-messagebox-buttons{border-top-width:1px;border-top-style:solid}.fxs-messagebox .fxs-messagebox-buttons .fxs-button,.fxs-progressbox .fxs-messagebox-buttons .fxs-button{margin-right:5px}.fxs-messagebox .msportalfx-form,.fxs-progressbox .msportalfx-form{padding:0;margin:27px 0 0}.fxs-messagebox .msportalfx-form>div,.fxs-progressbox .msportalfx-form>div{padding:15px 27px}.azc-balloon-dialog .fxs-messagebox{box-shadow:unset;border:0}.fxs-messagebox-confirmation{padding:10px 27px 0;display:block}")}));
define("MsPortalImpl/Widgets/Dialogs/Widgets.MessageBox",["require","exports","f","o","ko","$","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Interactions/Interactions.KeyboardNavigation","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.Common","_generated/Less/MsPortalImpl/Widgets/Widgets.MessageBox.css","MsPortalImpl.Controls/Controls/SimpleButton"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";function rt(n){var i=n.closest("."+v),t;i.length>0&&(t=h.Widget.getWidget(i,y),t.cancelBtn&&t.cancelBtn.onClick.call(this))}function d(n,t){var r=n.closest("."+v),i;for(r.length>0&&c.waitForBindings(r[0]).then((function(){var n=h.Widget.getWidget(r,y);n.options.confirmationRequired?n.element.find(".azc-checkBox").focus():n.element.find(".fxs-portal-button-primary").focus()})),i=t||document.activeElement;i&&typeof i.focus!="function";)i=f(i).closest("[tabindex]")[0];w=i}var g,y;r.defineProperty(t,"__esModule",{value:!0});var nt=i.Base.Diagnostics,tt=i.ViewModels.Controls.SimpleButton.ViewModel,a=nt.createLog(n),b=i.newGuid,l=e.Dialogs.ButtonText,k="fxs-portal-bg-txt-br",v="fxs-messagebox",p="fxs-messagebox-text",it='<h2 data-bind="text: data.title" class="fxs-messagebox-title" msportalfx-tooltip-overflow"><\/h2><!-- ko if: data.modal --><!-- ko ifnot: data.template -->'+('<div data-bind="sanitizedHtml: data.text" class="'+p+'"><\/div>')+'<!-- /ko --><!-- ko if: data.template --><div class="fxs-modal-template" data-bind="untrustedHtml: { html: data.template, data: data.templateViewModel, isolated: true }"><\/div><!-- /ko --><!-- /ko --><!-- ko ifnot: data.modal --><!-- ko ifnot: data.template -->'+('<div data-bind="text: data.text" class="'+p+'"><\/div>')+'<!-- /ko --><!-- ko if: data.template --><div class=\'msportalfx-padding\' data-bind="untrustedHtml: { html: data.template, data: data.templateViewModel, isolated: true }"><\/div><!-- /ko --><!-- /ko --><!-- ko if: data.confirmationRequired --><div data-bind="pcControl: func.checkboxVm" class="fxs-messagebox-confirmation"><\/div><!-- /ko --><div class="msportalfx-form fxs-messagebox-buttons fxs-portal-border"><div data-bind="foreach: func.buttonVms"><div data-bind="pcControl: $data.vm, attr: { \'data-result\': $data.result }"><\/div><\/div><\/div>',w=document.activeElement;t.cancelMessageBox=rt;t.setFocusOnMessageBox=d;g=(function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.title=u.observable(),t.text=u.observable(),t.template=u.observable(),t.templateViewModel=u.observable(),t.modal=!1,t.buttons=1,t.confirmationRequired=!1,t}return __extends(t,n),r.defineProperty(t.prototype,"onButtonClick",{get:function(){return this._buttonClick},set:function(n){if(this._buttonClick)throw new Error("The onButtonClick callback has already been set.");this._buttonClick=n},enumerable:!0,configurable:!0}),t})(h.ViewModel);t.ViewModel=g;y=(function(n){function t(t,r){var e=n.call(this,t,r)||this,h,c;return e.buttonVms=u.observableArray([]),t.html(it).addClass(v).addClass(k),h=e.ltm,c=function(n){var t=e.element[0];return!e.options.modal&&!(t===n)&&!f.contains(t,n)?2:0},e._dismissHandle={dismissFn:function(){e.cancelBtn&&e.cancelBtn.onClick.call(e)},shouldDismissOnMouseDownFn:c,shouldDismissOnMouseWheelFn:c,restoreFocus:function(){o.validatePreviousFocusedElement(e._dismissHandle,w)&&w.focus()},logName:"messagebox"},e.checkboxVm=new i.ViewModels.Forms.CheckBox.ViewModel(h,{label:u.observable(r.confirmationMessage),inlineLabel:!0}),e._getButtonHtml(r.buttons,h),e._bindDescendants(),e._setAria(),d(t,document.activeElement),new s.KeyboardNavigation(e.ltm,{element:t,tabTriggers:2}),o.register(e._dismissHandle),h.registerForDispose((function(){o.unregister(e._dismissHandle)})),e.checkboxVm.value(!r.confirmationRequired),u.reactor(h,(function(){e.defaultBtn.disabled(!e.checkboxVm.value())})),e}return __extends(t,n),t.prototype.dispose=function(){this._cleanElement(v,k);n.prototype.dispose.call(this)},t.prototype.generateBtns=function(n,t){var u=this,r=this.buttonVms,f=function(n,t,i){return new tt(n,{text:i.text,primary:t,disabled:i.disabled,onClick:function(){if(typeof u.options.onButtonClick=="function")u.options.onButtonClick(i.result);u._dismissHandle.restoreFocus()}})};r().forEach((function(n){n.vm.dispose()}));r().length=0;r([]);this.defaultBtn=null;this.cancelBtn=null;this.extraBtn=null;t.forEach((function(t,i){i===0&&t.kind!==1&&a.error("The first button should be the default button for this dialog.");u.defaultBtn&&t.kind===1&&a.error("Only one default button should be defined.");u.cancelBtn&&t.kind===2&&a.error("Only one cancel button should be defined.");switch(t.kind){case 1:r.push({vm:f(n,!0,t),result:t.result});u.defaultBtn=r().last().vm;break;case 2:r.push({vm:f(n,!1,t),result:t.result});u.cancelBtn=r().last().vm;break;case 3:default:r.push({vm:f(n,!1,t),result:t.result});u.extraBtn=r().last().vm}}));t.length===1&&(this.cancelBtn=this.defaultBtn);i.isNullOrUndefined(this.cancelBtn)&&a.error("Cancel button should be defined.")},t.prototype._getButtonHtml=function(n,t){var i=this.options;if(i.customBtns)this.generateBtns(t,i.customBtns);else{switch(n){case 0:this.generateBtns(t,[{kind:1,text:l.retry,result:5},{kind:2,text:l.abort,result:0},{kind:3,text:l.ignore,result:2}]);break;case 1:this.generateBtns(t,[{kind:1,text:l.ok,result:4}]);break;case 2:this.generateBtns(t,[{kind:1,text:l.ok,result:4},{kind:2,text:l.cancel,result:1}]);break;case 3:this.generateBtns(t,[{kind:1,text:l.retry,result:5},{kind:2,text:l.cancel,result:1}]);break;case 4:this.generateBtns(t,[{kind:1,text:l.yes,result:6},{kind:2,text:l.no,result:3}]);break;case 5:this.generateBtns(t,[{kind:1,text:l.yes,result:6},{kind:3,text:l.no,result:3},{kind:2,text:l.cancel,result:1}]);break;default:throw new Error("Could not locate message box button of type {0}.".format(n));}this.defaultBtn&&i.defaultButtonText&&this.defaultBtn.text(i.defaultButtonText);this.cancelBtn&&i.cancelButtonText&&this.cancelBtn.text(i.cancelButtonText);this.extraBtn&&i.extraButtonText&&this.extraBtn.text(i.extraButtonText)}return},t.prototype._setAria=function(){var n=this.element,t=b(),i=b();n.attr({role:"alertdialog","aria-labelledby":i,"aria-describedby":t});n.find("h2").attr("id",i);n.findByClassName(p).attr("id",t);this.ltm.registerForDispose((function(){n.removeAttr("role aria-labelledby aria-describedby")}))},t})(h.Widget);t.Widget=y}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.ProgressBox.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxs-progressbox{color:#fff}")}));
define("MsPortalImpl/Widgets/Dialogs/Widgets.ProgressBox",["require","exports","f","ko","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Widgets/Widgets.WidgetBase","_generated/Less/MsPortalImpl/Widgets/Widgets.MessageBox.css","_generated/Less/MsPortalImpl/Widgets/Widgets.ProgressBox.css"],(function(n,t,i,r,u,f){"use strict";var e;return (function(n){var v=u.Dialogs.ProgressBar,e="fxs-progressbox",o="fxs-progressbox-text",y="<h2 data-bind='text: data.title' class='fxs-progressbox-title'><\/h2><div data-bind='text: data.text' class='"+o+"'><\/div><div data-bind='text: data.completionText' class='fxs-progressbox-progressbar'><\/div>",s="fxs-popup",h="fxs-portal-bg-txt-br",t=r.observable,c=r.isObservable,l=i.newGuid,p=(function(n){function i(i,u){var f=n.call(this)||this;return f.title=t(),f.text=t(),f.completionPercentage=t(-1),c(i)&&(f.text=i),c(u)&&(f.completionPercentage=u),f.completionText=r.pureComputed((function(){var n=f.completionPercentage();return n<0||n>100?"":v.percentComplete.format(n)})),f}return __extends(i,n),i})(f.ViewModel),a;n.ViewModel=p;a=(function(n){function t(t,i){var r=n.call(this,t,i)||this;return r.element.html(y).addClass(e).addClass(s).addClass(h),r._bindDescendants(),r._setAria(),r}return __extends(t,n),t.prototype.dispose=function(){this._cleanElement(e,s,h);n.prototype.dispose.call(this)},t.prototype._setAria=function(){var t="aria-labelledby",i="aria-describedby",n=this.element,r=l(),u=l();n.attr("role","alertdialog").attr(t,u).attr(i,r);n.find("h2").attr("id",u);n.findByClassName(o).attr("id",r);this.element.attr("tabindex",-1).focus();this.ltm.registerForDispose((function(){n.removeAttr("tabindex role "+t+" "+i)}))},t})(f.Widget);n.Widget=a})(e||(e={})),e}));
define("MsPortalImpl/UI/UI.DialogManager",["require","exports","f","o","a","Fx/DependencyInjection","Viva.Controls/Util/Viva.Util","MsPortalImpl/Widgets/Dialogs/Widgets.FormDialog","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Widgets/Dialogs/Widgets.ListPopup","MsPortalImpl/Services/Services.PortalIdleState","MsPortalImpl/Widgets/Dialogs/Widgets.ProgressBox","MsPortalImpl/Svg/Startup/Error.svg","MsPortalImpl/Svg/Startup/Warning.svg","MsPortalImpl/Base/Telemetry","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Dialogs/Widgets.MessageBox","MsPortalImpl/Base/Base.SvgHelper","MsPortalImpl/Resources/ImplScriptResources"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d){"use strict";function tt(n){return"The {0} used to render the dialog was not specified.".format(n)}function vt(n,t){var r=i.getUniqueId();return n.replaceAll(t,r).replaceAll("msportalfx-svg-c01",t).replaceAll(r,"msportalfx-svg-c01")}function yt(n,t,r,u,f){var e,s;switch(r.type){case 1:e=new b.Widget(t,ni(f,r,u));break;case 2:e=new l.Widget(t,ii(null,r));break;case 4:s=ui(f,r);s.onLostFocus=function(){n.dismissOpenDialog()};e=new h.Widget(t,s);break;case 3:e=new o.Widget(t,ri(f,r));break;case i.ViewModels.Internal.Dlg2:r.positionHint=r.positionHint||3;e=new b.Widget(t,ti(f,r,u))}return e}function ni(n,t,i){var r=new b.ViewModel;return r.title(t.title),t.templateViewModel?(r.template(t.text),r.templateViewModel(t.templateViewModel)):r.text(t.text),r.buttons=t.buttons,r.onButtonClick=function(t){n(t)},r.modal=i,r.defaultButtonText=t.defaultButtonText,r.cancelButtonText=t.cancelButtonText,r.extraButtonText=t.extraButtonText,r.confirmationRequired=t.confirmationRequired,r.confirmationMessage=t.confirmationMessage,r}function ti(n,t,r){var f=new b.ViewModel;return f.title(t.title),typeof t.content=="object"?(f.template(t.content.htmlTemplate),f.templateViewModel(t.content.viewModel)):typeof t.content=="string"&&f.text(t.content),u.isArray(t.buttons)?(f.customBtns=[],t.buttons.forEach((function(n){var t=n.displayText||g[n.button];f.customBtns.push({kind:3,text:t,result:n.button,disabled:n.disabled})})),f.customBtns.length&&(f.customBtns[0].kind=1,f.customBtns.length>1&&(i.last(f.customBtns).kind=2))):f.buttons=t.buttons,f.onButtonClick=function(t){n(t)},f.modal=r,f}function ii(n,t){var i=new l.ViewModel(t.text,t.completionPercentage);return i.title(t.title),i}function ri(n,t){var i=new o.ViewModel;return i.dialogOptions=t,i.okButtonText(d.Dialogs.okButtonText),i.cancelButtonText(d.Dialogs.cancelButtonText),i.onOkClick=function(){n(4)},i.onCancelClick=function(){n(1)},i}function ui(n,t){var i=new h.ViewModel;return i.dialogOptions=t,i.onItemSelected=function(){n(4)},i}function pt(n,t){var r=n.closest(".fxs-tile").data(p.CompositionInstanceDataName),u;return r&&p.isPartComposition(r)?u=r.locator:t!=="sideload"&&dt.error("Unable to determine the extension that opened the dialog. "+i.getCurrentCallStack(!0)),u}function wt(n){var r=n.closest(".fxs-bladecontent"),t=w.Widget.getWidgets(r),i;return t&&t.length&&(i=t[0],n=rt(i.getForm())),n}function bt(n){ht.trace({source:ct,name:n&&n.toFriendlyString(),action:lt.DialogOpened,extension:n&&n.getExtensionLocator().name})}function it(n,t){ht.trace({source:ct,name:n&&n.toFriendlyString(),action:lt.DialogClosed,extension:n&&n.getExtensionLocator().name,data:t+""})}var nt,g,ot,at,ut;r.defineProperty(t,"__esModule",{value:!0});var ft=i.Base,st=ft.Diagnostics,ht=st.Telemetry,kt=i.ViewModels.Dialogs,rt=jQuery,et=rt("body"),dt=st.createLog(n),gt="<div class='fxs-portal-shield'><div class='fxs-portal-shield-icon fxs-portal-shield-icon-on-topbar'><\/div><div class='fxs-portal-shield-modaldialog'><div/><\/div><\/div>",ct=y.Source.Shell,lt=y.Action;nt=d.Dialogs.ButtonText;g=[];g[0]=nt.abort;g[1]=nt.cancel;g[2]=nt.ignore;g[3]=nt.no;g[4]=nt.ok;g[5]=nt.retry;g[6]=nt.yes;ot=(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t})(kt.MessageBox);t.MessageBox=ot;at=(function(){function n(n){this._portalIdleSvc=n}return r.defineProperty(n.prototype,"hasOpenDialog",{get:function(){return!!this._dismissOpenDialog},enumerable:!0,configurable:!0}),n.prototype.dismissOpenDialog=function(){this._dismissOpenDialog&&(this._dismissOpenDialog(),this._dismissOpenDialog=null)},n.prototype.showModalDialog=function(n){var o=this,t=rt(gt),r,y,h,e,c,u,l,p,f;return et.append(t),r=t.findByClassName("fxs-portal-shield-icon"),y=t.findByClassName("fxs-portal-shield-modaldialog"),n.showErrorIcon?(h=k.getSvgReferenceOrFallBackToData(i.extend2(a,{data:vt(a.data,"msportalfx-svg-c22")})),e="fxs-portal-shield-icon-error"):(h=k.getSvgReferenceOrFallBackToData(i.extend2(v,{data:vt(v.data,"msportalfx-svg-c10")})),e="fxs-portal-shield-icon-warning"),r.empty().append(h),r.addClass(e),c=et.findByClassName("fxs-topbar-content").width(),u=et.findByClassName("fxs-topbar-notifications").position(),c&&u&&(l=c-(u.left+40),r.css({top:u.top,right:l}),y.css({top:u.top+40,right:l})),this._currentCancelToken&&(this._currentCancelToken.cancel(),this._currentCancelToken=null),p=t.find(".fxs-portal-shield-modaldialog > div"),f=new ot(n.title,n.description,n.buttons),f.defaultButtonText=n.defaultButtonText,f.cancelButtonText=n.cancelButtonText,f.templateViewModel=n.templateViewModel,s.unhide(t),this._portalIdleSvc.signalIdle(),this._showDialog(p,f,!0,null).then((function(i){var u=n.uiShield&&n.uiShield.hidePromise;return u?(o._currentCancelToken=new ft.Promises.CancelationToken,ft.Promises.wrapWithCancelablePromise(u,o._currentCancelToken).then((function(){s.hide(t)}))):s.hide(t),r.removeClass(e),i})).finally((function(){o._portalIdleSvc.signalBusy()}))},n.prototype.showDialog=function(n,t,i,r){return n?t?(this.dismissOpenDialog(),this._showDialog(n,t,!1,i,r)):Q.reject(tt("options")):Q.reject(tt("element"))},n.prototype.showDialogWithCallback=function(n,t,i,r){if(!n)throw new Error(tt("element"));if(!t)throw new Error(tt("options"));this.dismissOpenDialog();this._showDialogWithCallback(n,t,!1,i,r)},n.prototype.showShellDialog=function(n,t,r,u,f,o){if(!t)return Q.reject(tt("formTarget"));if(!r)return Q.reject(tt("sourceTarget"));if(!n)return Q.reject(tt("options"));f=i.isUndefined(f)?!0:f;this.dismissOpenDialog();var s=this._showDialog(rt(t.getForm()),n,f,u,o?"sideload":"").then((function(n){return t.hideForm(),n})),h=e.getBox(r);return t.showForm(h,n.positionHint),s},n.prototype._showDialog=function(n,t,i,r,u){var o=this,f=Q.defer(),s=function(n){f.resolve(n)},e;return r||i||(r=pt(n,u)),t.type!==4&&(n=wt(n)),e=yt(this,n,t,i,s),bt(r),e?(this._dismissOpenDialog=function(){e.dispose();f.reject();it(r,"Dismissed")},f.promise.then((function(n){e.dispose();o._dismissOpenDialog=null;it(r,n)}))):(it(r,"InvalidDialogType"),f.reject("Invalid type specified in dialogOptions.")),f.promise},n.prototype._showDialogWithCallback=function(n,t,i,r,u){var o=this,f,e;u||i||(u=pt(n));t.type!==4&&(n=wt(n));e=function(n){f&&f.dispose();o._dismissOpenDialog=null;it(u,n);r&&r(n)};f=yt(this,n,t,i,e);bt(u);f?this._dismissOpenDialog=function(){f.dispose();it(u,"Dismissed")}:it(u,"InvalidDialogType")},n})();ut=(function(){function n(){}return n.create=function(n){return new at(n)},n})();__decorate([f.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[c.PortalIdleStateService]),__metadata("design:returntype",ut)],ut,"create",null);t.DialogManager=ut}));
define("MsPortalImpl/CodeComponentSideLoad/CodeComponentSideLoadManager",["require","exports","f","o","a","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Services/Services.Storage","MsPortalImpl/UI/UI.DialogManager"],(function(n,t,i,r,u,f,e,o,s){"use strict";r.defineProperty(t,"__esModule",{value:!0});var p=i.Base,c=p.Diagnostics.createLog(n),h=f.Shell.Dialogs,l=0,v=1,y=0,a=h.loadOnlySafeExtensionsButtonText,w=(function(){function n(n,t,i,r,u,f,e,o,s,h,c,l){this._temporaryTestCodeComponents=[];this._trustedCodeComponents=n;this._settingsManager=t;this._storageService=i;this._dialogManager=r;this._dialogContainer=u;this._canModifyCodeComponents=f;this._acceptWithoutPrompt=e;this._storageServiceKey=o;this._hashQueryStringKey=s;this._createFunction=h;this._componentType=c;this._settingsKey=l}return n.prototype.getCodeComponentsMetadata=function(){var n=this,t;return Q().then((function(){var i=JSON.parse(JSON.stringify(n._trustedCodeComponents));return t=i.map((function(t){return n._createFunction(t)})),n._loadUntrustedCodeComponentsIfAllowed().then((function(i){if(i.length>0){var r=function(n){return n.logUsageWarning()};n._merge(t,i,r)}return t.filter((function(n){return n.isValid()}))}))}))},n.prototype.listTestCodeComponents=function(){var t=this,n=this._temporaryTestCodeComponents.slice(0);return this._settingsManager.querySetting(l,this._settingsKey).then((function(i){return i=i&&i.map((function(n){return t._createFunction(n)})),u.isArray(i)&&(n=n.concatUnique(i,(function(n,t){return n.isEqual(t)}))),n.filter((function(n){return n.isValid()}))})).then(null,(function(n){return c.error("Error listing code components",2,n),[]}))},n.prototype.registerTestCodeComponent=function(n,t){var r=this,u;return n.isValid()?t?(this._addOrUpdateCodeComponent(this._temporaryTestCodeComponents,n),Q.resolve(null)):this.listTestCodeComponents().then((function(t){return r._addOrUpdateCodeComponent(t,n),r._settingsManager.setSetting(l,r._settingsKey,t),r._settingsManager.flushSettings()})).catch((function(t){c.error("Error registering code component",4,{codeComponent:n,error:t})})):(u=new i.Errors.Error("Invalid codeComponent"),u.data=n,Q.reject(u))},n.prototype.unregisterTestCodeComponent=function(n){var t=this;return this._removeCodeComponent(this._temporaryTestCodeComponents,n),this.listTestCodeComponents().then((function(i){if(t._removeCodeComponent(i,n))return t._settingsManager.setSetting(l,t._settingsKey,i),t._settingsManager.flushSettings()})).catch((function(n){c.error("Error unregistering code component.",6,{name:name,error:n})}))},n.prototype.unregisterAll=function(){this.clearTemporaryTestCodeComponents();var n=this._settingsManager;return n.deleteSettings({store:l,keys:[this._settingsKey]}),n.flushSettings().catch((function(n){c.error("Error registering all code components",5,n)}))},n.prototype.clearTemporaryTestCodeComponents=function(){var n=this._temporaryTestCodeComponents;n.splice(0,n.length)},n.prototype._loadUntrustedCodeComponentsIfAllowed=function(){var n=this,t=this._canModifyCodeComponents;return t?this.listTestCodeComponents().then((function(i){return i.length===0?(t&&c.verbose("No untrusted code components were found. Will load the portal in normal mode.",3),[]):n.prompt().then((function(t){return t?(i.forEach((function(t){n._componentType===y&&t.markAsTestExtension()})),i):[]}))})):Q([])},n.prototype.prompt=function(){var c=this,u=o.ComponentName.ExtensionManager,f=this._storageServiceKey,e=this._storageService,n,t,i,r;if(e.getValue(u,f,v)||this._acceptWithoutPrompt)return Q(!0);switch(this._componentType){case y:n=h.untrustedExtensionsTitle;t=h.untrustedExtensionsDescriptionFmt.format(a);break;case 1:n=h.untrustedGalleryPackageTitle;t=h.untrustedGalleryPackageDescriptionFmt.format(a);break;case 2:n=h.untrustedPatchTitle;t=h.untrustedExtensionsDescriptionFmt.format(a);break;default:throw new Error("Unsupported componentType");}return i=$("<div />"),r=new s.MessageBox(n,t,5),this._dialogContainer.prepend(i),r.defaultButtonText=a,r.extraButtonText=h.loadUnsafeExtensionsButtonText,this._dialogManager.showDialog(i,r,null,"sideload").then((function(n){var t=n===3;return c._dialogManager.dismissOpenDialog(),i.remove(),t?e.setValue(u,f,"true",v):e.clearValue(u,f,v),t}))},n.prototype._registerTestCodeComponentFromUri=function(n){return n.isValid()?this.registerTestCodeComponent(n,!0):null},n.prototype._removeCodeComponent=function(n,t){var i=-1;return(i=n.firstIndex((function(n){return n.isEqual(t)})),i>=0)?(n.splice(i,1),!0):!1},n.prototype._merge=function(n,t,i){var r=this;n!==null&&t!==null&&t.forEach((function(t){i&&i(t);r._addOrUpdateCodeComponent(n,t)}))},n.prototype._addOrUpdateCodeComponent=function(n,t){var i=n.first((function(n){return n.isEqual(t)}));i?i.updateWith(t):n.push(t)},n})();t.CodeComponentSideLoadManagerImpl=w}));
define("MsPortalImpl/CodeComponentSideLoad/CodeComponentSideLoadModels",["require","exports","f","i"],(function(n,t,i,r){"use strict";var u;return (function(t){function v(n){return s.test(n)}var a=i.Base,u=a.Diagnostics.createLog(n),e=/^[a-zA-Z][\w]*$/,o=i.isFeatureEnabled,s,f,h,c,l;t.canModifyExtensions=o("canmodifyextensions");s=/^(https?:)?\/\/(localhost|127\.0\.0\.1|\[\:\:1\])(\:\d+)?(\/|$)/;f=function(n,t){return(n&&n.toLowerCase())===(t&&t.toLowerCase())};t.isLocalhostUri=v;t.canAddGalleryPackages=o("canaddgallerypackages");h=(function(){function n(){}return n.prototype.isValid=function(){if(typeof this.name!="string")return u.error("Invalid extension name",1,this),!1;if(typeof this.uri!="string"||!this.uri)return u.error("Invalid extension uri",1,this),!1;if(!e.test(this.name))return u.error("Invalid extension name '{0}'. Expected pattern '{1}'".format(this.name,e),8),!1;return!0},n.prototype.isEqual=function(n){var t=n;return r.Extension.isEqualDescriptor(this,t)},n.prototype.updateWith=function(n){var t=n;this.name=t.name;this.uri=t.uri;this.obsoleteBundlesBitmask=t.obsoleteBundlesBitmask;this.features=t.features;this.trustedHost=t.trustedHost;this.startBoardParts=t.startBoardParts;this.isTestExtension=t.isTestExtension},n.prototype.markAsTestExtension=function(){this.isTestExtension=!0},n.prototype.logUsageWarning=function(){u.warning("Extension '{0}' is running untrusted code from '{1}'".format(this.name,this.uri),7,this)},n.create=function(t){var r=i.extend(new n,t);return r.trustedHost=r.trustedHost||"*",r},n})();t.ExtensionMetadataExt=h;c=(function(){function n(){}return n.prototype.isValid=function(){return!0},n.prototype.isEqual=function(n){var t=n||{uri:""};return f(this.uri||"",t.uri)},n.prototype.updateWith=function(n){var t=n;this.uri=t.uri},n.prototype.logUsageWarning=function(){u.warning("Untrusted gallery package '{0}' is running".format(this.uri),7,this)},n.create=function(t){var i=new n;return i.uri=t.uri,i},n})();t.GalleryPackageExt=c;l=(function(){function n(){}return n.prototype.isValid=function(){return!0},n.prototype.isEqual=function(n){var t=n;return f(this.uri,t&&t.uri)},n.prototype.updateWith=function(n){var t=n;this.uri=t.uri},n.prototype.logUsageWarning=function(){u.warning("Untrusted patch '{0}' is running".format(this.uri),7,this)},n})();t.PatchExt=l})(u||(u={})),u}));
define("MsPortalImpl/Controls/ControlBindings",["require","exports","ko"],(function(n,t,i){"use strict";var r;return (function(){function n(n,i){t[n]=i}function f(n,t){var r=i.unwrap(n()),f;if(r){if(f=t[r.controlType],!f)throw new Error("Unsupported ControlType in formControl binding handler: "+r.controlType+".");return u[f]}}function e(n,t,i,r,u,e){var s=f(t,e),o;if(s)return o=$(n),o.attr("data-formelement",o.attr("data-bind")),s.init(n,t,i,r,u)}function o(n,t,i,r,u,e){if(n){var o=f(t,e);if(o)return o.update(n,t,i,r,u)}}var u=i.bindingHandlers,t={},r;n(127,"pcAccordion");n(20,"pcArtifactLinks");n(106,"pcAsyncFileUpload");n(16,"pcAttachment");n(63,"pcChart");n(7,"pcCheckBoxField");n(75,"pcConsole");n(40,"pcCopyableLabel");n(83,"pcCreatorAndSelector");n(85,"pcCreatorAndSelectorV2");n(23,"pcCustomHtmlField");n(91,"pcCustomValueSlider");n(111,"pcCustomRangeSlider");n(25,"pcDatePickerField");n(26,"pcDateTimePickerField");n(27,"pcDateTimeRangePickerField");n(92,"pcDayPickerField");n(76,"pcDeleteAssetConfirmation");n(33,"pcDiffEditor");n(32,"pcDockedBalloon");n(65,"pcDonut");n(3,"pcDropDownField");n(99,"pcDurationPickerField");n(15,"pcSection");n(37,"pcEditor");n(120,"pcEssentials");n(82,"pcFileDownloadButton");n(28,"pcFileUpload");n(81,"pcFileUploadWidget");n(12,"pcFilterComboField");n(55,"pcGallery");n(67,"pcGraph");n(103,"pcGrid2");n(125,"pcEditableGrid");n(130,"pcArrayGrid");n(131,"pcDataGrid");n(132,"pcPagedDataGrid");n(133,"pcSequentialDataGrid");n(98,"pcGroupDropDownField");n(77,"pcHeroBanner");n(19,"pcHistory");n(84,"pcHotSpot");n(108,"pcIFrame");n(113,"pcIFrame2");n(78,"pcInfoBox");n(121,"pcIntuneAppFileUpload");n(118,"pcLegend");n(88,"pcHotSpot");n(87,"pcInfoBox");n(104,"pcList2");n(58,"pcLogStream");n(68,"pcMap");n(109,"pcMediaPlayer");n(115,"pcMenu");n(69,"pcMetrics");n(122,"pcMonitorChart");n(126,"pcMonitorChartV2");n(13,"pcMultiLineTextField");n(8,"pcMultiselectDropDownField");n(79,"pcNotice");n(10,"pcNumericTextBoxField");n(29,"pcOAuthButtonField");n(4,"pcOptionsGroupField");n(70,"pcPairedTimeline");n(94,"pcPairedTimelineBadges");n(5,"pcPasswordField");n(39,"pcCheckBox");n(42,"pcDropDown");n(43,"pcFilterCombo");n(54,"pcGrid");n(56,"pcListView");n(110,"pcMarkdown");n(45,"pcMultiLineTextBox");n(46,"pcMultiselectDropDown");n(47,"pcNumericTextBox");n(48,"pcOptionPicker");n(49,"pcPassword");n(50,"pcRangeSlider");n(52,"pcSlider");n(57,"pcTreeView");n(112,"pcPartPinner");n(80,"pcPicker");n(128,"pcPill");n(129,"pcPillCollection");n(123,"pcPillList");n(89,"pcPreviewTag");n(71,"pcProgressBar");n(31,"pcQueryBuilder");n(72,"pcQuotaGauge");n(9,"pcRangeSliderField");n(93,"pcSearchBox");n(114,"pcResourceFilter");n(1,"pcFormSection");n(11,"pcSelectorField");n(60,"pcSettings");n(100,"pcSimpleButton");n(97,"pcChart");n(61,"pcSingleSetting");n(73,"pcSingleValueGauge");n(6,"pcSliderField");n(95,"pcSpecComparisonTable");n(21,"pcSplitter");n(17,"pcStringListField");n(134,"pcSummary");n(135,"pcPricingControl");n(124,"pcResourceDropDown");n(136,"pcTagsByResource");n(101,"pcTextBlock");n(2,"pcTextField");n(24,"pcTimePickerField");n(30,"pcTokenComboBox");n(62,"pcToolbar");n(105,"pcTree2");n(22,"pcTriStateCheckBox");n(116,"pcVideo");n(107,"pcWizard");n(119,"pcHeatMap");n(201,"pcFileShareDropDown");r={};[127,20,16,7,83,85,23,91,111,25,26,27,92,3,99,15,120,201,81,12,98,124,19,108,113,110,13,8,10,29,4,112,5,128,129,123,135,89,9,1,11,6,21,17,134,136,2,24,30,22,].forEach((function(n){return r[n]=t[n]}));u.pcControl={init:function(n,i,r,u,f){return e(n,i,r,u,f,t)},update:function(n,i,r,u,f){return o(n,i,r,u,f,t)}};u.formElement={init:function(n,t,i,u,f){return e(n,t,i,u,f,r)},update:function(n,t,i,u,f){return o(n,t,i,u,f,r)}}})(r||(r={})),r}));
define("MsPortalImpl/Controls/ControlBindings.Async",["require","exports","ko","MsPortalImpl/Widgets/Widgets.Common"],(function(n,t,i,r){"use strict";var u;return (function(n){function o(n,t,i,r){e.push({name:t,moduleId:n+i,initOptions:r})}function t(n,t,i){o("MsPortalImpl.Controls/",n,t,i)}function u(n,t,i){o("MsPortalImpl/Controls/",n,t,i)}function s(t){n.portalControlBindings.forEach((function(n){i.bindingHandlers[n.name]=r.getAsyncBindingHandler(n.moduleId,n.initOptions,t)}))}var e=[],f={controlsDescendantBindings:!1};t("pcAccordion","Controls/Accordion");t("pcButton","Controls/SimpleButton");t("pcChart","Controls/Visualization/Chart");t("pcCheckBoxField","Fields/CheckBoxField");t("pcConsole","Controls/Console");t("pcCopyableLabel","Controls/Forms/CopyableLabel");t("pcCreatorAndSelector","Fields/CreatorAndSelectorField");t("pcCreatorAndSelectorV2","Fields/CreatorAndSelectorFieldV2");t("pcCustomHtmlField","Fields/CustomHtmlField");t("pcCustomValueSlider","Fields/CustomValueSliderField");t("pcCustomRangeSlider","Fields/CustomRangeSlider");t("pcDatePickerField","Fields/DatePickerField");t("pcDateTimePickerField","Fields/DateTimePickerField");t("pcDateTimeRangePickerField","Fields/DateTimeRangePickerField");t("pcDayPickerField","Fields/DayPickerField");t("pcDiffEditor","Controls/Documents/DiffEditor");t("pcDockedBalloon","Controls/DockedBalloon");t("pcDonut","Controls/Visualization/Donut");t("pcDropDownField","Fields/DropDownField");t("pcDurationPickerField","Fields/DurationPickerField");t("pcEditor","Controls/Documents/Editor");t("pcFileUpload","Controls/Forms/FileUpload");t("pcFilterComboField","Fields/FilterComboField");t("pcFormSection","Fields/SectionField",f);t("pcGallery","Controls/Lists/List1/Gallery");t("pcGraph","Controls/Visualization/Graph");t("pcGrid","Controls/Lists/Grid1/Grid1");t("pcGrid2","Controls/Lists/Grid2/GridB");t("pcEditableGrid","Controls/Lists/Grid2/Grid2.EditableGrid.ctl");t("pcArrayGrid","Controls/Lists/Grid2/Grid2.ArrayGrid.ctl");t("pcDataGrid","Controls/Lists/Grid2/Grid2.DataGrid.ctl");t("pcPagedDataGrid","Controls/Lists/Grid2/Grid2.PagedDataGrid.ctl");t("pcSequentialDataGrid","Controls/Lists/Grid2/Grid2.SequentialDataGrid.ctl");t("pcHeatMap","Controls/HeatMap");t("pcIFrame","Controls/IFrame");t("pcIFrame2","Controls/IFrameV2");t("pcLegend","Controls/Visualization/Legend");t("pcListView","Controls/Lists/List1/ListView");t("pcLogStream","Controls/LogStream");t("pcMap","Controls/Visualization/Map");t("pcMediaPlayer","Controls/AzureMediaPlayer");t("pcMenu","Controls/Lists/Menu");t("pcMetrics","Controls/Visualization/Metrics");t("pcMonitorChart","Controls/Visualization/MonitorChart/MonitorChart");t("pcMonitorChartV2","Controls/Visualization/MonitorChartV2/MonitorChartV2");t("pcMultiLineTextField","Fields/MultiLineTextField");t("pcMultiselectDropDownField","Fields/MultiselectDropDownField");t("pcNumericTextBoxField","Fields/NumericTextBoxField");t("pcOAuthButtonField","Fields/OAuthButtonField");t("pcOptionsGroupField","Fields/OptionsGroupField");t("pcPairedTimeline","Controls/Visualization/PairedTimeline");t("pcPairedTimelineBadges","Controls/Visualization/PairedTimelineBadges");t("pcPartPinner","Controls/PartPinner");t("pcPasswordField","Fields/PasswordField");t("pcPricingControl","Controls/PricingControl");t("pcPreviewTag","Controls/PreviewTag");t("pcProgressBar","Controls/Visualization/ProgressBar");t("pcQueryBuilder","Controls/Data/QueryBuilder");t("pcQuotaGauge","Controls/Visualization/QuotaGauge");t("pcRangeSliderField","Fields/RangeSliderField");t("pcSearchBox","Controls/SearchBox");t("pcResourceFilter","Controls/ResourceFilter");t("pcSection","Fields/Section");t("pcSelectorField","Fields/SelectorField");t("pcSettings","Controls/Settings");t("pcSimpleButton","Controls/SimpleButton");t("pcSingleSetting","Controls/SingleSetting");t("pcSingleValueGauge","Controls/Visualization/SingleValueGauge");t("pcSliderField","Fields/SliderField");t("pcSpecComparisonTable","Controls/SpecComparisonTable");t("pcSplitter","Fields/Splitter",f);t("pcStringListField","Fields/StringListField");t("pcSummary","Controls/Summary");t("pcTextBlock","Controls/TextBlock");t("pcTextBox","Fields/TextField");t("pcTextField","Fields/TextField");t("pcTimePickerField","Fields/TimePickerField");t("pcToolbar","Controls/Toolbars/Toolbar");t("pcTreeView","Controls/Lists/Tree1/TreeView");t("pcTriStateCheckBox","Fields/TriStateCheckBox");t("pcMarkdown","Controls/Markdown");t("pcVideo","Controls/Video");u("pcAsyncFileUpload","Forms/AsyncFileUpload");u("pcDeleteAssetConfirmation","Controls.DeleteAssetConfirmation");u("pcEssentials","Controls.Essentials");u("pcFileDownloadButton","Controls.FileDownloadButton");u("pcFileUploadWidget","Forms/Controls.FileUpload");u("pcGroupDropDownField","Forms/GroupDropDown");u("pcResourceDropDown","Forms/ResourceDropDown");u("pcHeroBanner","Controls.HeroBanner");u("pcHotSpot","Controls.HotSpot",f);u("pcInfoBox","Controls.InfoBox");u("pcNotice","Controls.Notice");u("pcPicker","Controls.Picker");u("pcPickerV3","Controls.PickerV3");u("pcPill","Controls.Pill");u("pcPillCollection","Controls.PillCollection");u("pcPillList","Controls.PillList");u("pcTagsByResource","Controls.TagsByResource");u("pcTokenComboBox","Forms/Controls.TokenComboBox");u("pcWizard","Controls.Wizard");u("pcIntuneAppFileUpload","Forms/IntuneAppFileUpload");u("pcFileShareDropDown","Storage/FileShareDropDown");n.portalControlBindings=e;n.initialize=s})(u||(u={})),u}));
define("MsPortalImpl/Extension/Extension.DefinitionValidator",["require","exports","f","o","a","ko"],(function(n,t,i,r,u,f){"use strict";function s(n,t){i.forEachKey(n,(function(n,i){i!==undefined&&t(n,i)}))}function g(n){var i=new c,t=i.errors;return n?(s(n,(function(i,r){switch(i){case"name":e("Extension name",r,t);break;case"version":case"hash":case"schemaVersion":case"sdkVersion":case"buildDescription":e(i,r,t);break;case"isPreview":v(i,r,t);break;case"assetTypes":o(i,r,t);break;case"blades":nt(n,r,t);break;case"startBoardParts":ft(r,t);break;case"partsCatalog":yt(r,t);break;case"commandsCatalog":vt(r,t);break;case"commandGroups":lt(r,t);break;case"htmlTemplates":ot(r,t);break;case"styleSheets":st(r,t);break;case"galleryService":ht(r,t);break;case"dashboardProvider":ct(r,t);break;case"requireConfig":break;default:t.push("Unexpected attribute '{0}' on definition.".format(i))}})),i):(t.push("Definition is null or undefined."),i)}function e(n,t,i){typeof t!="string"&&i.push("{0} is not a valid string.".format(n))}function v(n,t,i){typeof t!="boolean"&&i.push("{0} is not a valid boolean.".format(n))}function o(n,t,i){var r=u.isArray(t);return r||i.push("The '{0}' property is not a valid array.".format(n)),r}function nt(n,t,i){t&&o("blades",t,i)&&t.forEach((function(t,r){y(n,t,r,i)}))}function y(n,t,i,r){var u=t.name;t.inputs&&o("Blade: {0}. Property: blades[{1}].inputs".format(u,i),t.inputs,r);t.optionalInputs&&o("Blade: {0}. Property: blades[{1}].optionalInputs".format(u,i),t.optionalInputs,r);o("Blade: {0}. Property: blades[{1}].lenses".format(u,i),t.lenses,r)&&t.lenses.forEach((function(n,t){var f="Blade: {0}. Lens: {1}. Property: blades[{2}].lenses[{3}].".format(u,n.name,i,t);n.partInstances&&o(f,n.partInstances,r)&&n.partInstances.forEach((function(f,e){var o="Blade: {0}. Lens: {1}. Part: {2}. Property: blades[{3}].lenses[{4}].partInstances[{5}]".format(u,n.name,f.name,i,t,e);w(o,f,r)}))}));t.permissions&&o("Blade: {0}. Property: blades[{1}].permissions".format(u,i),t.permissions,r)&&t.permissions.forEach((function(n,t){l("Blade: {0}. Property: blades[{1}].permissions[{2}]".format(u,i,t),n,r)}));tt(t.toolbar,"Blade: {0}. Property: blades[{1}].toolbar".format(u,i),r);it(t.actionBar,"Blade: {0}. Property: blades[{1}].actionBar".format(u,i),r)}function tt(n,t,i){n&&(n.source?p(n.source,t+".source",i):i.push("Source not specified for toolbar. "+t))}function it(n,t,i){n&&n.source&&p(n.source,t+".source",i)}function p(n,t,i){n.property&&e(t+".property",n.property,i);n.optional&&typeof n.optional!="boolean"&&i.push("The attribute 'optional' should be of type boolean. "+t);n.isIdentityInput&&typeof n.isIdentityInput!="boolean"&&i.push("The attribute 'isIdentityInput' should be of type boolean. "+t);o(t+".valuesFrom",n.valuesFrom,i)&&n.valuesFrom.forEach((function(n,r){rt(t+".valuesFrom[{0}]".format(r),n,i)}))}function rt(n,t,i){switch(t.referenceType){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:break;default:i.push("Unknown reference type '{0}' found for {1}.referenceType.".format(t.referenceType,n))}e(n+".property",t.property,i);t.part&&e(n+".part",t.part,i)}function ut(n,t,i){switch(t.sourceType){case 0:t.providerKey&&i.push("Asset ID source source type of FromInput with provider key (should be null) found for {0}.sourceType.".format(n));break;case 1:t.providerKey||i.push("Asset ID source source type of FromProvider with missing provider key found for {0}.sourceType.".format(n));e(n+".providerKey",t.providerKey,i);break;case 2:t.providerKey||i.push("Asset ID source source type of FromSourceProvider with missing provider key found for {0}.sourceType.".format(n));e(n+".providerKey",t.providerKey,i);break;default:i.push("Unknown asset ID source source type '{0}' found for {1}.sourceType.".format(t.sourceType,n))}e(n+".property",t.property,i)}function l(n,t,i){var r,u;switch(t.permissionType){case 0:r=t;r.extensionName&&e(n+".extensionName",r.extensionName,i);e(n+".assetType",r.assetType,i);r.assetId?ut(n+".assetId",r.assetId,i):i.push("Permission missing assetId found for {0}.assetId.".format(n));e(n+".action",r.action,i);break;case 1:u=t;switch(u.requirement){case h.All:case h.Any:break;default:i.push("Unknown permission set requirement '{0}' found for {1}.requirement.".format(u.requirement,n))}o(n+".permissions",u.permissions,i)&&u.permissions.forEach((function(t,r){l("{0}.permissions[{1}]".format(n,r),t,i)}));break;default:i.push("Unknown permission type '{0}' found for {1}.permissionType.".format(t.permissionType,n))}}function ft(n,t){o("startBoardParts",n,t)&&n.forEach((function(n,i){w("startBoardParts[{0}]".format(i),n,t)}))}function w(n,t,i){t.reference||t.inline?t.reference&&t.inline?i.push("'reference' and 'inline' properties cannot be set at the same time on PartInstanceDefinition. Property: {0}".format(n)):t.reference&&!t.reference.partTypeName?i.push("'partTypeName' property is required on part reference. Property: {0}".format(n)):t.inline&&b(n,t.inline,i):i.push("'reference' or 'inline' property required on PartInstanceDefinition. Property: {0}".format(n))}function b(n,t,i){t&&(et(n,t.partState,i),t.permissions&&o("{0}.permissions".format(n),t.permissions,i)&&t.permissions.forEach((function(t,r){l("{0}.permissions[{1}]".format(n,r),t,i)})))}function et(n,t,i){if(t){var e=t.inputIdentityProperties||[],f=t.sharedProperties||[],o=e.concat(f.map((function(n){return n.property}))),s=f.map((function(n){return n.key})),r=k(o),u=k(s);r&&r.length>0&&i.push("Part view model properties cannot be used in multiple part settings. Duplicated properties: '{0}'. Path: '{1}'.".format(JSON.stringify(r),n));u&&u.length>0&&i.push("Shared key settings cannot be used in multiple part settings. Duplicated keys: '{0}'. Path: '{1}'.".format(JSON.stringify(u),n))}}function k(n){var t={},i=[];return(n||[]).forEach((function(n){!t[n]||i.push(n);t[n]=!0})),i}function ot(n,t){s(n,(function(n,i){typeof i!="string"&&(e("htmlTemplates['{0}'].file".format(n),i.file,t),e("htmlTemplates['{0}'].content".format(n),i.content,t))}))}function st(n,t){u.isArray(n)?n.forEach((function(n,i){e("StyleSheet at position {0}".format(i),n,t)})):t.push("Invalid type for 'styleSheets' property on definition.")}function ht(n,t){var i;s(n,(function(n,r){switch(n){case"serviceViewModel":i=r;break;default:t.push("Unexpected properties on 'galleryService' property of definition.")}}));e("galleryService.serviceViewModel",i,t)}function ct(n,t){var i=n.viewModel;i&&typeof i=="string"||t.push("The view model of dashboard provider must be non-empty string.")}function lt(n,t){n&&o("commandGroups",n,t)&&n.mapMany((function(n){return n.commands})).forEach((function(n){n.reference&&at(n,t)}))}function at(n,t){if(n&&n.reference){var i=!1;s(n,(function(n){n!=="name"&&n!=="bindings"&&n!=="reference"&&(i=!0)}));i?t.push("Command reference can only define 'name' and 'bindings' properties. Definition: {0}".format(f.toJSON(n))):n.reference.commandType||t.push("Command reference must specify the 'commandType' property. Definition: {0}".format(f.toJSON(n)))}}function vt(n,t){n&&o("commandsCatalog",n,t)&&n.forEach((function(n){var i="Commands in 'commandsCatalog' ";n.name||t.push(i+"must have names.");!n.reference||t.push(i+"cannot specify a 'reference' property.")}))}function yt(n,t){n&&o("partsCatalog",n,t)&&n.forEach((function(n){d(n,t)}))}function pt(n,t){e("name",n.name,t);e("moduleId",n.moduleId,t)}function d(n,t){n.inputDefinitions&&o("PartType: {0}. Property: inputDefinitions".format(n.name),n.inputDefinitions,t);n.reference&&wt(n,t);b("PartType: {0}".format(n.name),n,t)}function wt(n,t){(n.reference.bindings||[]).forEach((function(i){(i.valuesFrom||[]).forEach((function(i){i.referenceType!==7&&i.referenceType!==9&&i.referenceType!==5&&t.push("Adapted Part: {0} can only have Adapter, AdapterInput and Constant bindings for its referenced part.".format(n.name))}))}))}var a,h,c;r.defineProperty(t,"__esModule",{value:!0});a=i.Extension;h=a.SetRequirement;c=(function(){function n(){this.errors=[]}return n.prototype.valid=function(){return!this.errors.length},n})();t.ValidationResult=c;t.validateDefinition=g;t.validateIsString=e;t.validateIsBoolean=v;t.validateIsArray=o;t.validateBlade=y;t.validateControl=pt;t.validatePartType=d}));
define("MsPortalImpl/Extension/Extension.Manifest",["require","exports","f","o","MsPortalImpl/Extension/Extension.DefinitionValidator"],(function(n,t,i,r,u){"use strict";function o(n){var i=new u.ValidationResult,t=i.errors,r,f;return n?((typeof n.name!="string"||e(n.name)||n.name.indexOf("!")>=0)&&(f="The extension manifest should specify a valid name. This name is obtained from the <Extension> tag in PDL. This name should be a string and cannot be empty or whitespace. It also cannot contain the ! character. The recommended naming convention for an extension name is to follow the pattern {Company}_{BrandOrSuite}_{ProductOrComponent} (e.g. Microsoft_Azure_Insights).",t.push(f)),n.assetTypes&&u.validateIsArray("manifest.assetTypes",n.assetTypes,t)&&n.assetTypes.forEach((function(i){s(i,n.name,t)})),i):(r="Manifest was not specified for the extension. Ensure that you passing a valid manifest to the MsPortalFx.Extension.register/FxExtension.registerAmd call that is used to register your extension with the portal.",t.push(r),i)}function f(n,t,i,r){n.push(t.format(i,r))}function s(n,t,r){var u=n.name;if(e(u)&&f(r,"The name for the asset type in manifest '{0}' was not specified.",t),n.browseType!==undefined&&typeof n.browseType!="number"&&f(r,"The browse type for the asset type '{0}' in manifest '{1}' was not a number.",u,t),n.browseServiceViewModel&&typeof n.browseServiceViewModel!="string"&&f(r,"The browse service view model for the asset type '{0}' in manifest '{1}' was not a string.",u,t),n.browseLinkUri&&typeof n.browseLinkUri!="string"&&f(r,"The browse link URI for the asset type '{0}' in manifest '{1}' was not a string.",u,t),n.privateBrowse!==undefined&&typeof n.privateBrowse!="boolean"&&f(r,"The private browse flag was present for the asset type '{0}' in manifest '{1}' was not a boolean.",u,t),n.browseRequiresRdfe!==undefined&&typeof n.browseRequiresRdfe!="boolean"&&f(r,"The requires RDFE browse flag was present for the asset type '{0}' in manifest '{1}' was not a boolean.",u,t),n.browseRequirements!==undefined&&typeof n.browseRequirements!="number"&&f(r,"The browse requirements was present for the asset type '{0}' in manifest '{1}' was not a number.",u,t),n.browseType!==undefined){switch(n.browseType){case 0:n.browseServiceViewModel||f(r,"The browse for the asset type '{0}' in manifest '{1}' is set to use a service view model but there was no service view model.",u,t);break;case 1:n.browseServiceViewModel&&f(r,"The browse for the asset type '{0}' in manifest '{1}' is set to use the asset type's resource type but there was a service view model.",u,t);break;case 2:n.browseServiceViewModel&&f(r,"The browse for the asset type '{0}' in manifest '{1}' is set to use the asset type's blade but there was a service view model.",u,t);break;case 3:n.browseLinkUri||f(r,"The browse for the asset type '{0}' in manifest '{1}' is set to be a service link but there was no link URI.",u,t)}n.privateBrowse!==undefined&&n.browseType===undefined&&f(r,"The private browse flag was present for the asset type '{0}' in manifest '{1}' but there was browse type.",u,t);n.browseType!==0&&n.browseServiceViewModel&&f(r,"The asset type '{0}' in manifest '{1}' has a browse service but doesn't have service view model browse type.",u,t);e(n.pluralDisplayName)&&e(n.text)&&f(r,"The pluralDisplayName for the asset type '{0}' in manifest '{1}' was not specified and asset type was set to browse.",u,t);i.isNullOrUndefined(n.icon)&&f(r,"The icon for the asset type '{0}' in manifest '{1}' was not specified and asset type was set to browse.",u,t)}else n.browseServiceViewModel!==undefined?n.browseType=0:n.privateBrowse!==undefined&&f(r,"The asset type '{0}' in manifest '{1}' has a private blade flag but no browse type.",u,t);n.gridColumnsServiceViewModel&&typeof n.gridColumnsServiceViewModel!="string"&&f(r,"The grid columns service view model for the asset type '{0}' in manifest '{1}' was not a string.",u,t);n.dynamicBladeServiceViewModel&&typeof n.dynamicBladeServiceViewModel!="string"&&f(r,"The dynamic blade service view model for the asset type '{0}' in manifest '{1}' was not a string.",u,t);n.propertyProviderServiceViewModel&&typeof n.propertyProviderServiceViewModel!="string"&&f(r,"The property provider service view model for the asset type '{0}' in manifest '{1}' was not a string.",u,t)}r.defineProperty(t,"__esModule",{value:!0});var e=i.isNullOrWhiteSpace;t.validate=o}));
define("MsPortalImpl/Extension/ViewModelManager",["require","exports","f"],(function(n,t,i){"use strict";var r;return (function(n){function e(n,i,r){t[n]={name:n,modulePath:i,factory:r}}function o(n,t,i){r[n]={name:n,modulePath:t,factoryWithState:i}}function s(n,t,i){u[n]={name:name,modulePath:t,factoryWithPrefix:i}}function h(n,e,o){var s=null,h=null;return(e in t?(s=t[e].modulePath,h=t[e].factory):e in r&&(s=r[e].modulePath,h=function(n){return r[e].factoryWithState(n,o)}),f(u,(function(t,i){e.startsWith(t)&&(s=i.modulePath,h=function(t){return i.factoryWithPrefix(t,o,e,n)})})),s)?i.require(s).then((function(n){return h(n)})):null}var t={},r={},u={},f=i.forEachKey;n.register=e;n.registerWithState=o;n.registerPrefix=s;n.resolve=h})(r||(r={})),r}));
define("MsPortalImpl/Interactions/Interactions.FocusHandler",["require","exports","f","i","o","ko","$","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Base/Base.Timers"],(function(n,t,i,r,u,f,e,o,s){"use strict";var h;return (function(n){function a(n){var t=document.createEvent("CustomEvent");t.initCustomEvent(o.default.fxreadyforfocus,!1,!1,null);n.dispatchEvent(t)}function c(n,t){var u=e(n),r,f,o;if(!e.contains(u[0],document.activeElement)){if(r=u.findFirstTabbable((function(n){return n.isInScrollView(t)})),!r.length&&u.hasClass("fxs-blade-content")){var s=u.closest(".fxs-blade"),c=s.hasClass("fxs-menublade"),h=c?[]:[s.find(".fxs-blade-header [tabindex]")];h.push(u.closest("[tabindex]"));f=i.find(h,(function(n){return!!n.attr("tabindex")}));f&&(r=f)}if(r.length)return r.hasClass("fxs-part")&&(o=r.findFirstTabbable(),o.length===1&&(r=o)),r.focus()}}var t,h=i.isFeatureEnabled("skipautofocus"),l;n.setFocusOnContainer=s.throttleByAnimationFrame((function(n,t){return c(n,t)}));l=(function(){function n(){var n=this;if(this._containerTargets=[],this._mapToContainer=new i.Map,this._mapTofocusableTargets=i.memoize((function(){return[]})),this._mapSkipAutoFocus=new i.Map,this._debounceFocus=s.debounce((function(n){s.requestAnimationFrame((function(){if(n&&n.parentElement){var i=f.dataFor(n),t=i&&i.func;t&&t.setFocus?t.setFocus():c(n,"fxs-blade-content")}}))}),250),this._debounceMenuBladeCleanup=s.debounce((function(){n._containerTargets.length===0&&(n._menuBladeToSetFocus=undefined)}),1e3),this.journey=f.observable(!0),t)throw new Error("FocusHandler operates as a singleton.");this._ltm=new r.TriggerableLifetimeManager;t=this;this._ltm.registerForDispose([this._debounceMenuBladeCleanup,this._debounceFocus,e("body").setEvents(["focusin",this._cancelAutofocus=function(t){h||n._mapTofocusableTargets.map().forEach((function(i,r){var u=!!t||r!==n._menuBladeToSetFocus;n._mapSkipAutoFocus.set(r,u)}))},]),])}return n.prototype.dispose=function(){this._ltm&&(this._ltm.dispose(),this._ltm=null);t=null},u.defineProperty(n,"Instance",{get:function(){return t||(t=new n)},enumerable:!0,configurable:!0}),n.prototype.waitForJourney=function(){var t=this,n;return this.journey()?Q():(this._journeyPromise||(n=this._ltm.createChildLifetime(),this._journeyPromise=this.journey.fxAwait(n).finally((function(){n.dispose();t._journeyPromise=null}))),this._journeyPromise)},n.prototype.registerContainerForFocus=function(n){if(n){if(!this._menuBladeToSetFocus){var r=e(n),t=r.closest(".fxs-blade"),u=t.length&&t.hasClass("fxs-menublade"),f=u&&r.closest(".fxs-blade-content-container-details",t[0]).length>0;u&&!f&&(this._menuBladeToSetFocus=n)}this._cancelAutofocus();i.pushUnique(this._containerTargets,[n])}},n.prototype.registerTargetForFocus=function(n){var t,r;n&&(t=e(n).closest(".fxs-blade-content")[0],t&&this._containerTargets.indexOf(t)>=0&&(this._mapToContainer.set(n,t),r=this._mapTofocusableTargets(t),i.pushUnique(r,[n])))},n.prototype.notifyTargetReadyForFocus=function(n){var r=this,o;try{var t=this._mapToContainer.get(n),u=this._mapTofocusableTargets(t),f=u.indexOf(n);f>-1&&(u.splice(f,1),this._mapToContainer.delete(n),u.length===0&&(i.remove(this._containerTargets,t),o=t,this.waitForJourney().finally((function(){var i,n;h||r._mapSkipAutoFocus.get(t)||(i=t,r._menuBladeToSetFocus&&r._menuBladeToSetFocus!==t&&(n=e(r._menuBladeToSetFocus).closest(".fxs-blade-content-container"),n[0]&&e.contains(n[0],t)&&(i=n.children(".fxs-blade-content-container-default").children(".fxs-blade-content-wrapper")[0])),r._debounceFocus(i));r._mapSkipAutoFocus.delete(t);r._mapTofocusableTargets.delete(t);a(o)})),this._menuBladeToSetFocus&&this._containerTargets.length===0&&this._debounceMenuBladeCleanup()))}catch(s){}},n})();n.FocusHandler=l})(h||(h={})),h}));
define("MsPortalImpl/Svg/Startup/DashboardPartFilter.svg",[],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 26 26' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path fill='#69829b' d='M26 0H0v26L26 0z'/><path d='M2 2v1.547l4 3.787V12h3V7.334l4-3.787V2zm1 1.253V3h9v.253L8 7v4H7V7z' class='msportalfx-svg-c01'/><\/g><\/svg>"}}));
define("MsPortalImpl/Svg/Startup/DashboardPartFilterConflict.svg",[],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 26 26' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path fill='#69829b' d='M26 0H0v26L26 0z'/><path d='M4 2v1.547l4 3.786V12h3V7.333l4-3.787V2z' fill='#8a2da5'/><path d='M7 8L3 4.035V2H2v2.421l4 3.965V12h1V8z' class='msportalfx-svg-c01'/><path d='M4 2v1.547l4 3.786V12h3V7.333l4-3.787V2zm1 1.253V3h9v.253L10 7v4H9V7z' class='msportalfx-svg-c01'/><\/g><\/svg>"}}));
define("MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding",["require","exports","f","i","o","a","ko","$"],(function(n,t,i,r,u,f,e,o){"use strict";function ut(n,t){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return rt(tt,this,[n,t].concat(r.map(e.toJS)))}function h(n,t,i){for(var f=t?t.split("."):[],u={exists:n&&f.length>0,value:undefined},r=n,o=0,s=i?e.utils.peekObservable:e.unwrap;u.exists&&o<f.length;)r=s(r),r&&r.hasOwnProperty(f[o])?r=r[f[o]]:u.exists=!1,o++;return u.exists&&(u.value=r),u}function a(n,t,r){for(var h=function(i){if(!i||typeof i!="object")throw new Error(et("A property in model hierarchy is not an object. Path: '{0}'.".format(t),n));return i},o=t.split("."),f=h(n),u,s=0;s<o.length-1;s++)u=o[s],i.isNullOrUndefined(f[u])&&(f[u]={}),f=h(e.unwrap(f[u]));u=o.last();f[u]&&e.isObservable(f[u])?f[u](r):f[u]=r}function v(n){var t;try{t=e.toJSON(n)}catch(i){return i.message}return t}function et(n,t){var i=v(t);return i?"{0}\nModel: '{1}'".format(n,i):n}function ot(n,t,i,r){var o=y(r,b),u={};return f.isArray(t)&&t.forEach((function(t){var r=t.source,s=t&&r&&r.scope===k.CurrentContainer&&r.modelType===i,f=s&&h(n,r.property);f&&f.exists&&(p(o,t.targetProperty,f.value),a(u,t.targetProperty,e.toJS(f.value)))})),u}function y(n,t){if(t){var s=n.toLowerCase(),r=function(n){return i.isPlainObject(n)&&!i.isEmptyObject(n)?u.keys(n).every((function(n){return s.indexOf(n.toLowerCase())>=0})):!1},f=r(t.debug),h=r(t.log),e=r(t.verbose),o;return(h||f||e)&&(o={debugId:n,breakOnInputsSet:f,verbose:e}),o}}function p(n,t,r){n&&n.verbose&&!i.canSendThroughPostMessage(r)&&w.verbose("Inputs should be simple data objects without functions/observables: {0} | {1} | {2}".format(n.debugId,t,e.toJSON(r)))}var k,ft,s,l,c,d;u.defineProperty(t,"__esModule",{value:!0});var g=r.TriggerableLifetimeManager,nt=i.Base,w=nt.Diagnostics.createLog(n),b=i.trace.inputsset,tt=f.prototype.splice,it=r.quickApplyArrayEdits,rt=i.applyCall;(function(n){n[n.CurrentContainer=0]="CurrentContainer";n[n.MasterContainer=1]="MasterContainer";n[n.DetailsContainer=2]="DetailsContainer"})(k=t.ReferenceScope||(t.ReferenceScope={})),(function(n){n[n.OneToOne=0]="OneToOne";n[n.OneToMany=1]="OneToMany";n[n.ManyToOne=2]="ManyToOne"})(ft=t.ReferenceCardinality||(t.ReferenceCardinality={}));s=(function(){function n(n,t){this.kind=n;this.propertyName=t}return n.forObject=function(t,i,r){var u=new n(0,t);return u.propertyValue=i,u.propertyOldValue=r,u},n.forArray=function(t,i){var r=new n(1,t);return r.propertyArrayEdits=i||[],r},n.forNewArray=function(t,i){var r=new n(1,t);return r.propertyValue=i,r},n})();t.ObservableChangeArgs=s;l=(function(){function n(n,t,i,r,u){this.cancel=!1;this.propertyChanges=[];this.sourceModelId=n;this.sourceModel=t;this.sourceProperty=i;this.targetModel=r;this.targetProperty=u}return n})();t.PropertyTransformerArgs=l;c=(function(){function n(n,t,r,u,f,e){this.transformers=[];this.compositionBindingDefinition=null;this._callbacks=o.Callbacks();this._errCallbacks=o.Callbacks();this._tgtHasValue=!1;this.sourceProperty=n;this.targetProperty=t;this.targetModel=r;this._tgtModelName=u;this.transformers=f;this._awaitBound=i.Helpers.Deferred();this._tgtPropExists=e;this._traceOptions=y(u,b)}return n.prototype.sourceModelName=function(){return this._srcModelName},u.defineProperty(n.prototype,"sourceModel",{get:function(){return this._srcModel},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"isBound",{get:function(){return!!this._srcModel},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"awaitBound",{get:function(){return this._awaitBound.promise()},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"targetHasValue",{get:function(){return this._tgtHasValue},enumerable:!0,configurable:!0}),n.prototype.addValueChangedHandler=function(n){n&&this._callbacks.add(n)},n.prototype.removeValueChangedHandler=function(n){this._callbacks.remove(n)},n.prototype.addErrorHandler=function(n){n&&this._errCallbacks.add(n)},n.prototype.bind=function(n,t,i,r,u){var o=this,l,a,h,c;if(i===void 0&&(i=!0),this.isBound){this._err("Property binding is already bound.");return}return this.addValueChangedHandler(r),this.addErrorHandler(u),this._validateBinding(n,t)?(this._srcModelName=n,this._srcModel=t,l=this._getSrcValue(),a=e.utils.peekObservable(l),i&&a!==undefined&&this._changeTgtModel(s.forObject(this.targetProperty,a)),e.isObservable(l)?(h=l,this._bindingLifetime=new g,h.subscribe(this._bindingLifetime,(function(n){var t,r,i;f.isArray(n)?(r=n,t=n.slice(0)):t=n;(h.splice||h.map)&&(i="arrayChange");c&&c.dispose();c=o._bindingLifetime.createChildLifetime();h.subscribe(c,(function(n){var u,l;c.dispose();c=undefined;i==="arrayChange"&&(u=n,n=h());f.isArray(t)&&f.isArray(n)?r===n?(u=u||e.utils.compareArrays(t,n,{sparse:!0}),l=s.forArray(o.targetProperty),l.propertyArrayEdits=e.utils.adjustArrayEdits(u),o._changeTgtModel(l)):o._changeTgtModel(s.forNewArray(o.targetProperty,n)):o._changeTgtModel(s.forObject(o.targetProperty,h(),t))}),null,i)}),null,"beforeChange")):i||this._err("Error when binding. The value is not an observable and importInitialValue is false."),this._awaitBound.resolve()):this._awaitBound.reject(),this},n.prototype.unbind=function(){this._bindingLifetime&&(this._bindingLifetime.dispose(),this._bindingLifetime=null);this._srcModel=null;this._srcModelName=null;this._callbacks.empty();this._errCallbacks.empty()},n.prototype.toString=function(){return"\n\nDetails:\nSource model id: '{0}'.\nSource property: '{1}'.\nTarget model id: '{2}'.\nTarget property: '{3}'.\nSource model: '{4}'.\nTarget model: '{5}'.".format(this._srcModelName||"<UNBOUND>",this.sourceProperty,this._tgtModelName,this.targetProperty||"<DYNAMIC>",this._srcModel?v(this._srcModel):"<UNBOUND>",v(this.targetModel))},n.prototype._changeTgtModel=function(n){var i=this,r=new l(this._srcModelName,this._srcModel,this.sourceProperty,this.targetModel,this.targetProperty),t,u;n&&r.propertyChanges.push(n);this._processTransformers(r)&&((r.propertyChanges||[]).forEach((function(n){var r,o,s;n.propertyName&&(r=i._traceOptions,n.kind===0?(i._tgtHasValue=n.propertyValue!==undefined,p(r,n.propertyName,n.propertyValue),a(i.targetModel,n.propertyName,e.toJS(n.propertyValue))):(t=h(i.targetModel,n.propertyName).value,u=e.unwrap(t),o=n.propertyArrayEdits,f.isArray(u)?o?(r&&r.verbose&&o.forEach((function(t){t.status==="added"&&p(r,n.propertyName,t.value)})),e.isObservable(t)&&t.valueWillMutate(),i._tgtHasValue=!0,it(u,o,{inplaceFixup:!1,spliceFunc:ut}),e.isObservable(t)&&t.valueHasMutated()):n.propertyValue&&(i._tgtHasValue=!0,s=n.propertyValue,t.splice?t.splice.apply(t,[0,u.length].concat(s)):t(s)):i._err("[Property Binding] Array change detected on source property, but target property is not an array.")))})),this._callbacks.fire(r.propertyChanges))},n.prototype._processTransformers=function(n){return this.transformers.some((function(t){return t(n),n.cancel})),!n.cancel},n.prototype._getSrcValue=function(){return h(this._srcModel,this.sourceProperty).value},n.prototype._validateBinding=function(n,t){var i,r=this.compositionBindingDefinition,u=!(r&&r.optional);return this._validateModel(n,t,this.sourceProperty,u,(function(n){i=n}))?this.sourceProperty?this._validateModel(this._tgtModelName,this.targetModel,this.targetProperty,this._tgtPropExists,(function(n){i=n}))||(i="[Property Binding] Invalid target model - {0}".format(i)):i="[Property Binding] Invalid source model - Source property must be defined.":i="[Property Binding] Invalid source model - {0}".format(i),i&&this._err(i),!i},n.prototype._validateModel=function(n,t,i,r,u){var f;return n?t?i&&r&&!h(t,i).exists&&(f="Model is missing property '{0}'.".format(i)):f="Model is undefined.":f="Model is missing an identifier.",f&&u&&u(f+"\nModel id: '{0}'.".format(n||"N/A")),!f},n.prototype._err=function(n){this.isBound&&(n+=""+this);var t=i.trace;(i.isDevelopmentMode||t&&t.diagnostics)&&w.error(n);this._errCallbacks.fire(n)},n})();t.PropertyBinding=c;t.getModelValue=h;t.setModelValue=a;d=(function(){function n(n,t,i){var r=this;this._properties=[];this._propertyChangedCallbacks=o.Callbacks();this._aggregatePropertyChangedHandler=function(n){r._propertyChangedCallbacks.fire(n)};this._targetModel=t;this._targetModelName=n;this._validateTargetPropertiesExist=i!==!1}return u.defineProperty(n.prototype,"properties",{get:function(){return this._properties.slice(0)},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"targetModelName",{get:function(){return this._targetModelName},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"targetModel",{get:function(){return this._targetModel},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"awaitAllBound",{get:function(){var n=this._properties.map((function(n){return n.awaitBound}));return o.when.apply(o,n)},enumerable:!0,configurable:!0}),u.defineProperty(n.prototype,"allBound",{get:function(){return this.properties.every((function(n){return n.isBound}))},enumerable:!0,configurable:!0}),n.prototype.addPropertyChangedHandler=function(n){this._propertyChangedCallbacks.add(n)},n.prototype.addProperty=function(n){for(var i,r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];return i=new c(n,n,this._targetModel,this._targetModelName,r,this._validateTargetPropertiesExist),i.addValueChangedHandler(this._aggregatePropertyChangedHandler),this._properties.push(i),i},n.prototype.mapProperty=function(n,t){for(var r,u=[],i=2;i<arguments.length;i++)u[i-2]=arguments[i];return r=new c(n,t,this._targetModel,this._targetModelName,u,this._validateTargetPropertiesExist),r.addValueChangedHandler(this._aggregatePropertyChangedHandler),this._properties.push(r),r},n.prototype.removeProperty=function(n){var t=this._properties.indexOf(n);t>=0&&(this._properties[t].unbind(),this._properties[t].removeValueChangedHandler(this._aggregatePropertyChangedHandler),this._properties.splice(t,1))},n.prototype.getProperty=function(n){return this._properties.first((function(t){return t.targetProperty===n}))},n.prototype.unbind=function(){this._properties.forEach((function(n){n.unbind()}));this._propertyChangedCallbacks.empty()},n.prototype.toString=function(){for(var t="",i=this.properties,r=this.properties.length,n=0;n<r;++n)t+="properties[{0}]: {1}".format(n,i[n].toString());return t},n})();t.PropertyBindings=d;t.mapSourceModelToTargetModel=ot;t.extractTraceOptions=y}));
define("MsPortalImpl/Resources/Resources.Images",["require","exports","f","o"],(function(n,t,i,r){"use strict";function e(n){return function(){return i.getImages(u,n)}}var u,f;r.defineProperty(t,"__esModule",{value:!0});u=[{MsPortalImpl:[{AvatarMenu:[{AvatarMenu:["defaultAvatarSmall.png"]}]},{Blade:[{Blade:["icon.gif"]}]},{ControlsWizard:[{ControlsWizard:["loadingImage.gif"]}]},{General:[{FlowLayout:["gridShadow.png"]}]},{Notice:[{Notice:["comingSoon.png","noSubscription.png","unauthorized.png"]}]},{PartError:[{PartError:["icon.png"]}]},{PartGallery:[{PartGallery:["collectionPartWithRollup.svg","collectionSummary.svg","donutChart.svg","donutChartPartial.svg","extensions.svg","gridWithMoreData.svg","map.svg","multiLineChartMultiTrendLine.svg","multiScatterChart.svg","multiStackedBarChart.svg","mutliLineChart.svg","pricingTier.svg","quotaGauge.svg","resourceMap.svg","singleAreaChart.svg","singleAreaChartSingleThreshold.svg","singleAreaChartSingleTrendline.svg","singleBarChartLarge.svg","singleBarChartSmall.svg","singleLineChart.svg","singleScatterChart.svg","singleScatterSingleThreshold.svg","singleValueGauge.svg","splitBarChart.svg","stackedAreaChart.svg"]}]},{ProvisioningPart:[{ProvisioningPart:["running.gif"]}]}]}];f=["AvatarMenu","Blade","ControlsWizard","FlowLayout","Notice","PartError","PartGallery","ProvisioningPart"];f.forEach((function(n){t["get"+n]=e(n)}))}));
define("_generated/Less/MsPortalImpl/Widgets/Widgets.PartError.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,'.fxs-portal .fxs-tile .fxs-part-error-devmode{background-color:#b00000!important;color:#fff}.fxs-part-error{background-color:#f4f5f6}.fxs-part .fxs-part-content.fxs-errorpart-clickable{cursor:pointer}.fxs-part-error-content{display:-webkit-flex;display:flex;-webkit-flex-flow:column nowrap;flex-flow:column nowrap;height:100%;box-sizing:border-box}.fxs-part-error-content .fxs-part-error-title{font-size:14px;line-height:normal;margin:0}.fxs-part-error-content .fxs-part-error-reason{font-size:12px;line-height:normal}.fxs-part .fxs-part-content.fxs-errorpart~.fxs-part-nodatamessage{display:none!important}.fxs-part-error-icon{-webkit-flex:0 0 auto;flex:0 0 auto;margin:auto;display:block;height:50px;width:50px}.fxs-part-error-subtitle{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe WP",Tahoma,Arial,sans-serif;font-weight:600;font-size:10px;line-height:normal;text-transform:uppercase}.fxs-tilesize-fullwidthfitheight .fxs-part .fxs-part-content.fxs-errorpart,.fxs-tilesize-herowidefitheight .fxs-part .fxs-part-content.fxs-errorpart{position:relative}.fxs-tilesize-fullwidthfitheight .fxs-part-error-content,.fxs-tilesize-herowidefitheight .fxs-part-error-content{position:static}.fxs-tilesize-mini .fxs-part-error-icon,.fxs-tilesize-small .fxs-part-error-icon{display:none}.fxs-tilesize-mini .fxs-part-error-text{order:1}.fxs-tilesize-mini .fxs-part-error-reason,.fxs-tilesize-mini .fxs-part-error-text{text-align:center}.fxs-tilesize-small .fxs-part-error-reason{margin-top:auto}html[lang^=ja] .fxs-part-error-subtitle,html[lang^=ko] .fxs-part-error-subtitle,html[lang^=zh] .fxs-part-error-subtitle{font-size:11px}')}));
define("_generated/Templates/PartError",["require","exports"],(function(){"use strict";return function(){return"<div class='fxs-part-error-content'> <div class='fxs-part-error-text'> <h3 class='fxs-part-error-title' data-bind='visible: data.title, text: data.title'><\/h3> <div class='fxs-part-error-subtitle fxs-portal-title' data-bind='visible: data.subtitle, text: data.subtitle'><\/div> <\/div> <img class='fxs-part-error-icon' data-bind='attr: { src: data.uri.icon, title: data.title, alt: data.title}'/> <div class='fxs-part-error-reason' data-bind=\"text: data.reason\"><\/div> <\/div> "}}));
define("MsPortalImpl/Widgets/Widgets.PartError",["require","exports","f","o","ko","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Widgets/Widgets.WidgetBase","_generated/Templates/PartError","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Resources/Resources.Images","_generated/Less/MsPortalImpl/Widgets/Widgets.PartError.css"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";var a;r.defineProperty(t,"__esModule",{value:!0});var l="fxs-errorpart",v="fxs-errorpart-clickable",c=f.PartError,y=(function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.uri=h.getPartError(),t.title=u.observable(i.isDevelopmentMode?c.titleDevMode:c.title),t.subtitle=u.observable(c.subtitle),t.reason=u.observable(""),t.clickable=!0,t}return __extends(t,n),t})(e.ViewModel);t.ViewModel=y;a=(function(n){function t(t,r){var u=n.call(this,t,r)||this,f,e;if(t.html(o()).addClass(l),r.clickable){f=function(){t.trigger(s.default.fxerrorpartclicked)};t.addClass(v).on(s.default.click,f);u.ltm.registerForDispose((function(){t.off(s.default.click,f)}))}return u._bindDescendants(),e=i.getUniqueId(),t.findByClassName("fxs-part-error-title").attr("aria-describedby",e),t.findByClassName("fxs-part-error-subtitle").attr("id",e),u}return __extends(t,n),t.prototype.dispose=function(){this._cleanElement(l);n.prototype.dispose.call(this)},t})(e.Widget);t.Widget=a}));
define("_generated/Less/MsPortalImpl/CustomForm.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,'.msportalfx-form .azc-checkBoxField-inlineLabelContainer label,.msportalfx-form .azc-form-labelcontainer label,.msportalfx-form .msportalfx-form-labelcontainer label{font-size:12px;line-height:normal}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>.msportalfx-form-formelement>.azc-formElementContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>.msportalfx-form-formelement>.azc-formElementSubLabelContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>.msportalfx-form-formelement>.msportalfx-form-elementContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>div>.msportalfx-form-formelement>.azc-formElementContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>div>.msportalfx-form-formelement>.azc-formElementSubLabelContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>div>.msportalfx-form-formelement>.msportalfx-form-elementContainer{display:inline-block;vertical-align:middle;width:68%}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>.msportalfx-form-formelement.msportalfx-form-fileUploadField,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>div>.msportalfx-form-formelement.msportalfx-form-fileUploadField{height:80px}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>.msportalfx-form-formelement>.azc-form-labelcontainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>.msportalfx-form-formelement>.msportalfx-form-labelcontainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>div>.msportalfx-form-formelement>.azc-form-labelcontainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular>div>.msportalfx-form-formelement>.msportalfx-form-labelcontainer{width:32%;display:inline-block}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-regular .msportalfx-form-extralabel{display:block;width:68%;margin-left:33%;margin-right:0}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement:nth-child(odd),.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement:nth-child(odd){margin-right:1%}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement{min-height:43px;width:48.75%!important;display:inline-block;vertical-align:top;margin-top:0}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement:first-child,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement:last-child,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement:first-child,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement:last-child{margin-top:0}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement.azc-multiLineTextField,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement.azc-optionsGroupField,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement.azc-multiLineTextField,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement.azc-optionsGroupField{height:auto;margin-right:1px}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement.msportalfx-form-fileUploadField,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement.msportalfx-form-fileUploadField{height:100px}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement .azc-form-labelcontainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement .msportalfx-form-labelcontainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement .azc-form-labelcontainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement .msportalfx-form-labelcontainer{display:block;margin-bottom:0;width:auto;min-height:20px}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement .azc-formElementSubLabelContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>.msportalfx-form-formelement .msportalfx-form-elementContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement .azc-formElementSubLabelContainer,.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-formelement .msportalfx-form-elementContainer{display:block;width:100%;margin-left:0}.fxs-blade:not(.fxs-bladestyle-create) .msportalfx-form-compact>div>.msportalfx-form-extralabel>.msportalfx-form-extralabel{display:inline-block;width:47.75%;margin:43px 1% 0 -49.75%!important}.msportalfx-form.msportalfx-form-custom .msportalfx-form-extralabel{margin-top:0}.fxs-bladestyle-create .msportalfx-form{margin-top:14px}.fxs-bladestyle-create .msportalfx-form .msportalfx-form{margin-top:0}.msportalfx-form:not(.msportalfx-form-custom) .fxc-section>.msportalfx-form-formelement,.msportalfx-form:not(.msportalfx-form-custom)>.msportalfx-form-formelement,.msportalfx-form:not(.msportalfx-form-custom)>div>.msportalfx-form-formelement{padding-bottom:15px;width:100%;min-height:23px}.msportalfx-form:not(.msportalfx-form-custom) .fxc-has-sublabel:not(.fxc-right-sublabel),.msportalfx-form:not(.msportalfx-form-custom) .fxc-section>.msportalfx-form-formelement .msportalfx-form-formelement,.msportalfx-form:not(.msportalfx-form-custom)>.msportalfx-form-formelement .msportalfx-form-formelement,.msportalfx-form:not(.msportalfx-form-custom)>div>.msportalfx-form-formelement .msportalfx-form-formelement{padding-bottom:0}.msportalfx-form:not(.msportalfx-form-custom) .fxc-has-sublabel:not(.fxc-right-sublabel) .azc-validation-messages{margin:0;display:inline-block;padding-bottom:15px}.msportalfx-form.msportalfx-vertical-compact .fxc-section>.msportalfx-form-formelement,.msportalfx-form.msportalfx-vertical-compact>.msportalfx-form-formelement,.msportalfx-form.msportalfx-vertical-compact>div>.msportalfx-form-formelement{padding-bottom:7px}.msportalfx-form .azc-checkBoxField-inlineLabelContainer,.msportalfx-form .azc-form-labelcontainer,.msportalfx-form .msportalfx-form-labelcontainer{box-sizing:border-box;min-height:20px}.msportalfx-form .azc-checkBoxField-inlineLabelContainer label,.msportalfx-form .azc-form-labelcontainer label,.msportalfx-form .msportalfx-form-labelcontainer label{max-width:calc(100% - 25px)}.msportalfx-form:not(.msportalfx-selectable) .azc-checkBoxField-inlineLabelContainer label,.msportalfx-form:not(.msportalfx-selectable) .azc-form-labelcontainer label,.msportalfx-form:not(.msportalfx-selectable) .msportalfx-form-labelcontainer label{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.msportalfx-form .azc-checkBoxField-inlineLabelContainer{width:calc(100% - 25px + 2px)}.msportalfx-form .azc-validatableControl-invalid+.azc-checkBoxField-inlineLabelContainer{width:calc(100% - 25px + 2px - 6px)}.msportalfx-form.msportalfx-form-row{padding:0 25px;width:calc(100% - 50px)}.msportalfx-form .azc-multiLineTextField .azc-multiLineTextBox{height:100%}.azc-text-sublabel{float:right;margin-bottom:-1px}.fxc-has-sublabel-html .azc-text-sublabel{float:none}.azc-formElementSubLabelContainer::after{content:"";display:table;clear:both}.msportalfx-form:not(.fxc-left-label-fixed) .fxc-left-label .azc-text-sublabel-neighbor{padding-bottom:16px}.msportalfx-form:not(.fxc-left-label-fixed) .fxc-left-label .azc-text-sublabel-neighbor.azc-form-labelcontainer{padding-bottom:calc(19px)}.msportalfx-form:not(.fxc-left-label-fixed) .fxc-left-label .azc-text-sublabel-neighbor.azc-checkBoxField-inlineLabelContainer{padding-bottom:0}.azc-required-balloon{display:inline-block}.msportalfx-form-extralabel{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;text-align:right;margin-top:-15px;padding-bottom:3px}.msportalfx-customHtml .msportalfx-form-extralabel{margin-top:0}.msportalfx-form-formelement .azc-dockedballoon.azc-dockedballoon-info{height:16px;width:16px}')}));
define("_generated/Less/MsPortalImpl/CustomPart.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,'.msportalfx-docking,.msportalfx-fill{width:100%;height:100%}.azc-graph-node-container .msportalfx-overflowY,.fxs-tilesize-fittocontainer .msportalfx-overflowY,.msportalfx-docking-body{overflow-x:hidden;overflow-y:auto}.msportalfx-layoutChildren-horizontal-inlineblock{white-space:nowrap;line-height:0;font-size:0}.msportalfx-layoutChildren-horizontal-inlineblock>.msportalfx-layoutChildren-child{display:inline-block;box-sizing:border-box;white-space:normal;font-size:12px;line-height:18px;line-height:normal}.msportalfx-clearfix::after,.msportalfx-layoutChildren-horizontal-float::after{content:"\\0000a0";clear:both;visibility:hidden;font-size:0;line-height:0}.msportalfx-layoutChildren-horizontal-float>.msportalfx-layoutChildren-child{float:left;box-sizing:border-box}.msportalfx-layoutChildren-horizontal-float::after{display:block;height:0}.msportalfx-bgcolor-themeMain{background-color:#00bcf2}.msportalfx-bgcolor-themeWarning{background-color:#ff8c00}.msportalfx-bgcolor-themeError{background-color:#e81123}.msportalfx-bgcolor-themeSuccess{background-color:#7fba00}.msportalfx-bgcolor-paletteDiffAdd{background-color:#c7f1c7}.msportalfx-bgcolor-paletteDiffDel{background-color:#fcd6f1}.msportalfx-bgcolor-white{background-color:#fff}.msportalfx-padding{padding:25px;box-sizing:border-box}.msportalfx-docking{display:-webkit-flex;display:flex;-webkit-flex-direction:column;flex-direction:column}.msportalfx-docking-header{-webkit-flex:0 0 auto;flex:0 0 auto}.msportalfx-docking-body{-webkit-flex:1 1 auto;flex:1 1 auto;height:100%;min-height:0}.msportalfx-docking-footer{-webkit-flex:0 0 auto;flex:0 0 auto;border-top:1px solid}.msportalfx-vertical-center{display:-webkit-flex;display:flex;-webkit-flex-flow:row nowrap;flex-flow:row nowrap;-webkit-align-items:center;align-items:center}.msportalfx-removeTableBorders{border-spacing:0;border-collapse:collapse}.msportalfx-boxsizing-borderbox{box-sizing:border-box}.msportalfx-removeDefaultListStyle{list-style-type:none;padding:0;margin:0}.msportalfx-removeDefaultListStyle>li{margin:0;padding:0}.msportalfx-clearfix::after{display:block;height:0}.msportalfx-unselectable{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.msportalfx-removepartpadding{height:calc(100% + 15px + 15px);width:calc(100% + 15px + 15px);margin:-15px}.msportalfx-removepartpaddingside{width:calc(100% + 15px + 15px);margin:0 -15px}.fxs-blade-locked .msportalfx-removepartpadding{height:calc(100% + 15px);width:100%;margin:0 0 15px}.fxs-blade-locked .msportalfx-removepartpaddingside{width:100%;margin:0}.fxs-blade-locked .fxs-tilesize-fittocontainer .msportalfx-removepartpadding{height:100%;width:100%;margin:0}.msportalfx-partdivider:after{content:"";display:block;width:calc(100% + 15px + 15px);margin:0 -15px;border-bottom-width:1px;border-bottom-style:solid}.msportalfx-text-ellipsis{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.msportalfx-font-regular{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_normal,"Segoe WP",Tahoma,Arial,sans-serif;font-weight:400}.msportalfx-font-bold{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_bold,"Segoe UI Bold","Segoe WP Bold","Segoe WP",Tahoma,Arial,sans-serif;font-weight:700}.msportalfx-font-semibold{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe WP",Tahoma,Arial,sans-serif;font-weight:600}.msportalfx-font-light,.msportalfx-font-semilight{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_light,"Segoe UI Light","Segoe WP Light","Segoe WP",Tahoma,Arial,sans-serif;font-weight:200}.msportalfx-font-monospace{font-family:Consolas,"Courier New",monospace;font-size:12px}.msportalfx-text-preview,.msportalfx-text-subheader{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe WP",Tahoma,Arial,sans-serif;font-weight:600;text-transform:uppercase}.msportalfx-text-header{font-size:14px;line-height:18px}a.msportalfx-text-header{cursor:pointer}.msportalfx-text-header-small,.msportalfx-text-label{font-size:12px;line-height:normal;text-transform:uppercase}.msportalfx-text-small{font-size:12px;line-height:normal}.msportalfx-text-subheader{font-size:10px;line-height:10px}html[lang^=ja] .msportalfx-text-subheader,html[lang^=ko] .msportalfx-text-subheader,html[lang^=zh] .msportalfx-text-subheader{font-size:11px;line-height:11px}.msportalfx-text-header-regular{font-size:14px;line-height:18px}.msportalfx-text-regular{font-size:12px;line-height:18px}.msportalfx-text-preview{font-size:11px;line-height:11px;color:#fff}.msportalfx-text-createsectionheader{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_light,"Segoe UI Light","Segoe WP Light","Segoe WP",Tahoma,Arial,sans-serif;font-weight:200;font-size:20px;line-height:normal}.msportalfx-number-jumbo,.msportalfx-number-large,.msportalfx-number-medium,.msportalfx-number-small{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe WP",Tahoma,Arial,sans-serif;font-weight:600}.msportalfx-number-jumbo{font-size:60px;line-height:60px;letter-spacing:-.02em}.msportalfx-number-large{font-size:43px;line-height:43px;letter-spacing:-.02em}.msportalfx-number-medium{font-size:30px;line-height:30px;letter-spacing:-.025em}.msportalfx-number-small{font-size:17px;line-height:17px;letter-spacing:-.02em}.msportalfx-number-jumbo-adorn,.msportalfx-number-large-adorn,.msportalfx-number-medium-adorn,.msportalfx-number-small-adorn{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_bold,"Segoe UI Bold","Segoe WP Bold","Segoe WP",Tahoma,Arial,sans-serif}.msportalfx-number-jumbo-adorn{font-weight:700;font-size:20px;line-height:20px;letter-spacing:-.02em}.msportalfx-number-large-adorn,.msportalfx-number-medium-adorn{font-weight:700;font-size:15px;line-height:15px;letter-spacing:-.02em}.msportalfx-number-small-adorn{font-weight:700;font-size:10px;line-height:10px;letter-spacing:-.05em}.msportalfx-code{font-family:Consolas,"Courier New",monospace;font-size:12px;background-color:#f1f1f8;color:#32383f;border:1px solid #dcdfe2;border-left:5px solid #dcdfe2;padding:10px 10px 10px 15px;margin:5px 0;overflow-x:auto}.msportalfx-lineheight-reset{line-height:normal}.msportalfx-gettingstarted-part{color:#fff}.msportalfx-refresh-icon img,.msportalfx-refresh-icon svg{height:12px;width:12px;vertical-align:baseline}.msportalfx-tile-status-icon img,.msportalfx-tile-status-icon svg{height:16px;width:16px;vertical-align:middle}.msportalfx-gridcolumn-asseticon img,.msportalfx-gridcolumn-asseticon svg{margin-top:4px;height:21px;width:21px}.msportalfx-gridcolumn-assetsvg-icon .fx-grid-formatters-svgicon{width:21px!important;height:21px!important}.msportalfx-gridcolumn-assetsvg-badge,.msportalfx-gridcolumn-assetsvg-icon img,.msportalfx-gridcolumn-assetsvg-icon svg{height:21px;width:21px;vertical-align:middle}.msportalfx-gridcolumn-assetsvg-badge{margin-left:-21px;display:inline-block}.msportalfx-gridcolumn-assetsvg-badge img,.msportalfx-gridcolumn-assetsvg-badge svg{height:10px;width:10px;margin-top:11px}.msportalfx-gridcolumn-assetsvg-text{margin-left:10px;vertical-align:middle}.msportalfx-gridcolumn-assetsvg-textbox{vertical-align:middle;display:inline-block;margin-left:20px}.msportalfx-gridcolumn-assetsvg-strongtext{vertical-align:middle;margin-left:0}.msportalfx-gridcolumn-assetsvg-linkicon{margin-left:10px;display:inline-block;vertical-align:middle}.msportalfx-gridcolumn-assetsvg-linkicon .msportalfx-gridcolumn-assetsvg-linkicon-icon{display:inline-block}.msportalfx-gridcolumn-assetsvg-linkicon .msportalfx-gridcolumn-assetsvg-linkicon-icon img,.msportalfx-gridcolumn-assetsvg-linkicon .msportalfx-gridcolumn-assetsvg-linkicon-icon svg{opacity:.4;height:10px;width:10px;vertical-align:middle}.msportalfx-iconcontainer{-webkit-flex:0 0 auto;flex:0 0 auto;box-sizing:border-box}.msportalfx-iconcontainer>img,.msportalfx-iconcontainer>svg{height:50px;width:50px}.fxs-tilesize-mini .msportalfx-iconcontainer>img,.fxs-tilesize-mini .msportalfx-iconcontainer>svg,.fxs-tilesize-small .msportalfx-iconcontainer>img,.fxs-tilesize-small .msportalfx-iconcontainer>svg{height:30px;width:30px}.msportalfx-gridcolumn-statusicon{text-align:center}.msportalfx-gridcolumn-statusicon img,.msportalfx-gridcolumn-statusicon svg{text-align:center;height:15px;width:15px}.msportalfx-gridcolumn-statusicon svg{margin-top:4px}.msportalfx-grid-borderless .azc-grid table tbody tr td,.msportalfx-grid-borderless .azc-grid table tbody tr.azc-grid-row:first-of-type td,.msportalfx-grid-borderless .azc-grid table tbody:last-child tr:last-child td{border-top-width:0;border-bottom-width:0;border-color:transparent}.msportalfx-grid-borderless .azc-br-muted{border-top-width:0;border-bottom-width:0;border-color:transparent!important}.msportalfx-customtopo-text-name-donotuse{font-size:12px;line-height:normal}.msportalfx-customtopo-text-description-donotuse{font-size:10px;line-height:normal;color:#8f9ca8}.msportalfx-inherit-color{color:inherit!important}.msportalfx-statuspart{position:relative;height:100%;width:100%}.msportalfx-statuspart>*{box-sizing:border-box}.msportalfx-statuspart .msportalfx-statuspart-statussection{height:calc(100% - 55px);padding-top:10px}.msportalfx-statuspart .msportalfx-statuspart-statussection>*{vertical-align:middle}.msportalfx-statuspart .msportalfx-statuspart-statussection>img{height:30px;width:30px}.msportalfx-statuspart .msportalfx-statuspart-statussection>span{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_bold,"Segoe UI Bold","Segoe WP Bold","Segoe WP",Tahoma,Arial,sans-serif;font-weight:700;font-size:11px;text-transform:uppercase;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.msportalfx-statuspart .msportalfx-statuspart-messagesection{position:absolute;bottom:55px;margin-bottom:25px;height:40px;line-height:0;white-space:normal}.msportalfx-statuspart .msportalfx-statuspart-messagesection>span{font-size:12px;line-height:18px}.msportalfx-statuspart .msportalfx-statuspart-metricsection,.msportalfx-statuspart .msportalfx-statuspart-propertysection{position:absolute;bottom:0;width:100%;height:55px}.msportalfx-statuspart .msportalfx-statuspart-propertysection{padding-top:5px;font-size:12px;line-height:18px}.msportalfx-statuspart .msportalfx-statuspart-propertysection>div,.msportalfx-statuspart .msportalfx-statuspart-propertysection>span{display:block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.msportalfx-statuspart .msportalfx-statuspart-metricsection>div{float:left;width:calc(100% / 3 - 3px);box-sizing:border-box;border-right:1px solid #8f9ca8;padding-left:7px}.msportalfx-statuspart .msportalfx-statuspart-metricsection>div:first-child{padding-left:0}.msportalfx-statuspart .msportalfx-statuspart-metricsection>div:last-child{border-right:none}.msportalfx-statuspart .msportalfx-statuspart-metricsection .msportalfx-statuspart-metrictitle{white-space:normal;height:30px;font-size:12px;line-height:normal;text-transform:uppercase}.msportalfx-bgcolor-a1{background-color:#fcd116;color:#000}.msportalfx-bgcolor-b1{background-color:#eb3c00;color:#fff}.msportalfx-bgcolor-c1{background-color:#ba141a;color:#fff}.msportalfx-bgcolor-d1{background-color:#b4009e;color:#fff}.msportalfx-bgcolor-e1{background-color:#442359;color:#fff}.msportalfx-bgcolor-f1{background-color:#002050;color:#fff}.msportalfx-bgcolor-g1{background-color:#0072c6;color:#fff}.msportalfx-bgcolor-h1{background-color:#008272;color:#fff}.msportalfx-bgcolor-i1{background-color:#007233;color:#fff}.msportalfx-bgcolor-j1{background-color:#7fba00;color:#fff}.msportalfx-bgcolor-k1{background-color:#a0a5a8;color:#fff}.msportalfx-bgcolor-a0{background-color:#fff100;color:#000}.msportalfx-bgcolor-b0{background-color:#ff8c00;color:#fff}.msportalfx-bgcolor-c0{background-color:#e81123;color:#fff}.msportalfx-bgcolor-d0{background-color:#ec008c;color:#fff}.msportalfx-bgcolor-e0{background-color:#68217a;color:#fff}.msportalfx-bgcolor-f0{background-color:#00188f;color:#fff}.msportalfx-bgcolor-g0{background-color:#00bcf2;color:#fff}.msportalfx-bgcolor-h0{background-color:#00b294;color:#fff}.msportalfx-bgcolor-i0{background-color:#009e49;color:#fff}.msportalfx-bgcolor-j0{background-color:#bad80a;color:#000}.msportalfx-bgcolor-k0{background-color:#bbc2ca;color:#000}.msportalfx-bgcolor-a2{background-color:#fffc9e;color:#000}.msportalfx-bgcolor-b2{background-color:#ffb900;color:#000}.msportalfx-bgcolor-c2{background-color:#dd5900;color:#fff}.msportalfx-bgcolor-d2{background-color:#f472d0;color:#fff}.msportalfx-bgcolor-e2{background-color:#9b4f96;color:#fff}.msportalfx-bgcolor-f2{background-color:#4668c5;color:#fff}.msportalfx-bgcolor-g2{background-color:#6dc2e9;color:#000}.msportalfx-bgcolor-h2{background-color:#00d8cc;color:#000}.msportalfx-bgcolor-i2{background-color:#55d455;color:#000}.msportalfx-bgcolor-j2{background-color:#e2e584;color:#000}.msportalfx-bgcolor-k2{background-color:#d6d7d8;color:#000}.msportalfx-bgcolor-a0s2{background-color:#807900;color:#fff}.msportalfx-bgcolor-b0s2{background-color:#804600;color:#fff}.msportalfx-bgcolor-c0s2{background-color:#740912;color:#fff}.msportalfx-bgcolor-d0s2{background-color:#760046;color:#fff}.msportalfx-bgcolor-e0s2{background-color:#34113d;color:#fff}.msportalfx-bgcolor-f0s2{background-color:#000c48;color:#fff}.msportalfx-bgcolor-g0s2{background-color:#005e79;color:#fff}.msportalfx-bgcolor-h0s2{background-color:#084c41;color:#fff}.msportalfx-bgcolor-i0s2{background-color:#063d20;color:#fff}.msportalfx-bgcolor-j0s2{background-color:#3d460a;color:#fff}.msportalfx-bgcolor-k0s2{background-color:#32383f;color:#fff}.msportalfx-bgcolor-a0s1{background-color:#bfb500;color:#000}.msportalfx-bgcolor-b0s1{background-color:#bf6900;color:#fff}.msportalfx-bgcolor-c0s1{background-color:#ae0d1a;color:#fff}.msportalfx-bgcolor-d0s1{background-color:#b10069;color:#fff}.msportalfx-bgcolor-e0s1{background-color:#4e195c;color:#fff}.msportalfx-bgcolor-f0s1{background-color:#00126b;color:#fff}.msportalfx-bgcolor-g0s1{background-color:#008db5;color:#fff}.msportalfx-bgcolor-h0s1{background-color:#00856f;color:#fff}.msportalfx-bgcolor-i0s1{background-color:#0f5b2f;color:#fff}.msportalfx-bgcolor-j0s1{background-color:#8ba208;color:#fff}.msportalfx-bgcolor-k0s1{background-color:#464f59;color:#fff}.msportalfx-bgcolor-a0t1{background-color:#fcf37e;color:#000}.msportalfx-bgcolor-b0t1{background-color:#ffba66;color:#000}.msportalfx-bgcolor-c0t1{background-color:#f1707b;color:#fff}.msportalfx-bgcolor-d0t1{background-color:#f466ba;color:#fff}.msportalfx-bgcolor-e0t1{background-color:#a47aaf;color:#fff}.msportalfx-bgcolor-f0t1{background-color:#6674bc;color:#fff}.msportalfx-bgcolor-g0t1{background-color:#66d7f7;color:#000}.msportalfx-bgcolor-h0t1{background-color:#66d1bf;color:#000}.msportalfx-bgcolor-i0t1{background-color:#66c592;color:#000}.msportalfx-bgcolor-j0t1{background-color:#d6e86c;color:#000}.msportalfx-bgcolor-k0t1{background-color:#8f9ca8;color:#fff}.msportalfx-bgcolor-a0t2{background-color:#fffccc;color:#000}.msportalfx-bgcolor-b0t2{background-color:#ffe8cc;color:#000}.msportalfx-bgcolor-c0t2{background-color:#facfd3;color:#000}.msportalfx-bgcolor-d0t2{background-color:#fbcce8;color:#000}.msportalfx-bgcolor-e0t2{background-color:#e1d3e4;color:#000}.msportalfx-bgcolor-f0t2{background-color:#ccd1e9;color:#000}.msportalfx-bgcolor-g0t2{background-color:#ccf2fc;color:#000}.msportalfx-bgcolor-h0t2{background-color:#ccf0ea;color:#000}.msportalfx-bgcolor-i0t2{background-color:#ccecdb;color:#000}.msportalfx-bgcolor-j0t2{background-color:#f0f7b2;color:#000}.msportalfx-bgcolor-k0t2{background-color:#63707e;color:#fff}.msportalfx-property{padding:5px 0;white-space:nowrap;line-height:0;font-size:0}.msportalfx-property>*{display:inline-block;vertical-align:middle;box-sizing:border-box;white-space:normal;font-size:medium;line-height:normal}.msportalfx-property .msportalfx-property-label-wrapper{font-size:12px;line-height:normal;width:32%;margin-top:5px}.msportalfx-property .msportalfx-property-label-wrapper .msportalfx-property-name{text-transform:uppercase;max-width:100%;width:auto;white-space:wrap;overflow:hidden;text-overflow:ellipsis;display:inline-block}.msportalfx-property .msportalfx-property-name{font-size:12px;line-height:normal;text-transform:uppercase;width:32%;white-space:wrap;overflow:hidden;text-overflow:ellipsis}.msportalfx-property .msportalfx-property-value{font-size:14px;line-height:normal;width:64%;margin-left:3%;margin-top:4px}.msportalfx-property .msportalfx-property-value.fxs-part-properties-text .msportalfx-property-text-icon,.msportalfx-property .msportalfx-property-value.fxs-part-properties-text .msportalfx-tooltip-overflow{display:inline-block;vertical-align:middle}.msportalfx-property .msportalfx-property-value.fxs-part-properties-text .msportalfx-property-text-icon+.msportalfx-tooltip-overflow{max-width:calc(100% - 27px)}.msportalfx-property .msportalfx-property-value.fxs-part-properties-copyfield{margin-top:4px}.msportalfx-property .msportalfx-property-value.fxs-part-properties-copyfield input{padding-left:9px}.msportalfx-property.msportalfx-property-compact>*{vertical-align:top}.msportalfx-property.msportalfx-property-compact .msportalfx-property-name{margin-top:4px;width:95px}.msportalfx-property.msportalfx-property-compact .msportalfx-property-value{font-size:12px;line-height:18px;max-width:calc(100% - 3% - 95px)}.msportalfx-property-callback-icon,.msportalfx-property-text-icon{width:27px}.msportalfx-property-callback-icon svg,.msportalfx-property-text-icon svg{height:25px;width:25px}.msportalfx-property-callback-icon{float:left}')}));
define("_generated/Less/MsPortalImpl/Parts/Parts.Part.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,'.fxs-part,.fxs-part-content{background-color:inherit;width:100%}.fxs-part{height:100%;position:relative;box-sizing:border-box;overflow:hidden;padding:15px}.fxs-part-blockui-shield{position:absolute;top:0;left:0;bottom:0;right:0}.fxs-part-content,.fxs-part-title{position:relative;box-sizing:border-box}.fxs-part-title{height:49px;top:-4px}.fxs-part-title .fxs-part-assetname,.fxs-part-title .fxs-part-titleText{margin:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-part-title .fxs-part-titleText{font-size:14px;line-height:17px;padding-bottom:1px}.fxs-part-title .fxs-part-assetname{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe WP",Tahoma,Arial,sans-serif;font-weight:600;font-size:10px;line-height:10px;text-transform:uppercase;margin-top:3px}.fxs-part-content{font-size:12px;line-height:18px;line-height:normal;height:100%}.fxs-part-part-title-visible .fxs-part-content{height:calc(100% - 45px);top:-4px}.fxs-part-clickable:focus{outline-offset:-2px}.fxs-part-clickable:hover{cursor:pointer}.fxs-part-unbound{z-index:1}.fxs-part.fxs-part-is-v2{padding:0}.fxs-part.fxs-part-is-v2.fxs-part-part-title-visible .fxs-part-title{padding:15px 15px 0}.fxs-part.fxs-part-is-v2.fxs-part-part-title-visible .fxs-part-content>.msportalfx-padding:first-child{padding:0 15px 15px}.fxs-part.fxs-part-is-v2 .fxs-part-content>.msportalfx-padding{padding:15px}.fxs-part.fxs-part-is-v2.fxs-part-for-template-blade .fxs-part-content>.msportalfx-padding{padding:10px 25px 25px}.fxs-part.fxs-part-nodata,.fxs-part.fxs-part-notfound{-webkit-filter:grayscale(100%);filter:grayscale(100%);min-height:85px}.fxs-part .fxs-part-noaccessmessage,.fxs-part .fxs-part-nodatamessage,.fxs-part .fxs-part-notfoundmessage{position:absolute;left:0;top:0;height:100%!important;width:100%;text-align:left;padding:15px;box-sizing:border-box;z-index:1}.fxs-part .fxs-part-noaccessmessage>.fxs-part-noaccessmessage-text,.fxs-part .fxs-part-nodatamessage>.fxs-part-nodatamessage-text,.fxs-part .fxs-part-notfoundmessage>.fxs-part-notfoundmessage-text{position:absolute;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%);margin-top:20px;padding:15px 10px;width:calc(100% - 30px);box-sizing:border-box;font-size:12px;line-height:18px;text-align:center;border-width:1px;border-style:solid}.fxs-tile.fxs-tilesize-mini .fxs-part,.fxs-tile.fxs-tilesize-mini .fxs-part .fxs-part-noaccessmessage{padding-left:3px;padding-right:3px}.fxs-part .fxs-part-noaccessmessage>.fxs-part-noaccessmessage-textsmall{display:none;position:absolute;bottom:0;margin-bottom:13px;font-size:12px;line-height:18px;text-align:left}.fxs-tilesize-mini .fxs-part .fxs-part-noaccessmessage>.fxs-part-noaccessmessage-text,.fxs-tilesize-small .fxs-part .fxs-part-noaccessmessage>.fxs-part-noaccessmessage-text{display:none}.fxs-tilesize-mini .fxs-part .fxs-part-noaccessmessage>.fxs-part-noaccessmessage-textsmall,.fxs-tilesize-small .fxs-part .fxs-part-noaccessmessage>.fxs-part-noaccessmessage-textsmall{display:block;bottom:0}.fxs-part .fxs-part-noaccessmessage:not(.fxs-part-noaccessmessage-withtitle)>.fxs-part-noaccessmessage-text{display:none}.fxs-part .fxs-part-noaccessmessage:not(.fxs-part-noaccessmessage-withtitle)>.fxs-part-noaccessmessage-textsmall{display:block}.fxs-tile.fxs-tilesize-mini .fxs-part .fxs-part-noaccessmessage:not(.fxs-part-noaccessmessage-withtitle)>.fxs-part-noaccessmessage-textsmall,.fxs-tile.fxs-tilesize-small .fxs-part .fxs-part-noaccessmessage:not(.fxs-part-noaccessmessage-withtitle)>.fxs-part-noaccessmessage-textsmall{margin-bottom:7px}.fxs-tile.fxs-tilesize-mini .fxs-part .fxs-part-noaccessmessage:not(.fxs-part-noaccessmessage-withtitle)>.fxs-part-noaccessmessage-textsmall{top:0;bottom:auto;width:calc(94%);text-align:center}.fxs-tile.fxs-tilesize-mini .fxs-part .fxs-part-title{display:none!important}.fxs-tile.fxs-tilesize-mini .fxs-part .fxs-part-content{height:100%!important;top:0!important}.fxs-blade .fxs-blade-locked .fxs-part{padding:0 0 15px}.fxs-blade .fxs-blade-locked .fxs-part .fxs-part-title{height:29px;top:0}.fxs-blade .fxs-blade-locked .fxs-part .fxs-part-title h5{display:none}.fxs-blade .fxs-blade-locked .fxs-tilesize-fittocontainer .fxs-part{padding:0}html[lang^=ja] .fxs-part .fxs-part-title,html[lang^=ko] .fxs-part .fxs-part-title,html[lang^=zh] .fxs-part .fxs-part-title{top:-5px}html[lang^=ja] .fxs-part .fxs-part-title .fxs-part-titleText,html[lang^=ko] .fxs-part .fxs-part-title .fxs-part-titleText,html[lang^=zh] .fxs-part .fxs-part-title .fxs-part-titleText{font-size:11px;line-height:11px}.fxs-part-filter-button{border:0;padding:0;width:26px;height:26px;cursor:pointer;z-index:1}.fxs-part-filter-button,.fxs-part-filter-button>svg{position:absolute;top:0;left:0}')}));
define("_generated/Templates/Part",["require","exports"],(function(){"use strict";return function(){return'<!-- ko if: context.isFilterApplied --> <button class="fxs-part-filter-button" data-bind="image: context.filterIcon, click: context.openPartSettingsBlade"><\/button> <!-- /ko --> <div class="fxs-part-title"> <h3 data-bind="text: container.partTitle" class="fxs-part-titleText msportalfx-tooltip-overflow"><\/h3> <div data-bind="visible: container.assetName() && !context.inContainerOfSameAsset(), text: container.assetName" class="fxs-part-assetname msportalfx-tooltip-overflow"><\/div> <\/div> <div class="fxs-part-content"><\/div> <!-- ko if: context.isUiBlocked --> <div class="fxs-part-blockui-shield"><\/div> <!-- ko if: !context.notFoundMessage() --> <div class="fxs-part-nodatamessage" data-bind="visible: container.noDataMessage"> <!--The extra nested div is to enable vertical centering--> <div data-bind="text: container.noDataMessage" class="fxs-part-nodatamessage-text msportalfx-tooltip-overflow fxs-bg-overlay-dark fxs-text-white"><\/div> <\/div> <div class="fxs-part fxs-part-noaccessmessage" data-bind="visible: container.unauthorizedMessage, css: { \'fxs-part-noaccessmessage-withtitle\': container.partTitle }"> <!--The extra nested div is to enable vertical centering--> <div class="fxs-part-title" data-bind="visible: container.partTitle"> <h3 data-bind="text: container.partTitle" class="fxs-part-titleText msportalfx-tooltip-overflow"><\/h3> <div data-bind="visible: container.assetName() && !context.inContainerOfSameAsset(), text: container.assetName" class="fxs-part-assetname msportalfx-tooltip-overflow"><\/div> <\/div> <div data-bind="text: container.unauthorizedMessage" class="fxs-part-noaccessmessage-text msportalfx-tooltip-overflow fxs-bg-overlay-dark fxs-text-white"><\/div> <div data-bind="text: container.unauthorizedMessage" class="fxs-part-noaccessmessage-textsmall msportalfx-tooltip-overflow"><\/div> <\/div> <!-- /ko --> <!-- ko if: context.notFoundMessage --> <div class="fxs-part-notfoundmessage"> <!--The extra nested div is to enable vertical centering--> <div data-bind="text: context.notFoundMessage" class="fxs-part-notfoundmessage-text msportalfx-tooltip-overflow fxs-bg-overlay-dark fxs-text-white"><\/div> <\/div> <!-- /ko --> <!-- /ko -->'}}));
define("MsPortalImpl/Parts/Parts",["require","exports","f","i","o","ko","$","MsPortalImpl/Base/Base.CssSanitizer","MsPortalImpl.Controls/Fields/Base/FormValidation","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Interactions/Interactions.FocusHandler","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Base/Base.Selectable2","MsPortalImpl/Base/Telemetry","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding","MsPortalImpl/Widgets/Widgets.Common","MsPortalImpl/Widgets/Widgets.PartError","_generated/Templates/Part","MsPortalImpl/Base/Base.Selectable2.ClickContext","MsPortalImpl/UI/UI.DesktopManager","FxInternal/Composition/ViewModel","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Svg/Startup/DashboardPartFilter.svg","MsPortalImpl/Svg/Startup/DashboardPartFilterConflict.svg","_generated/Less/MsPortalImpl/Parts/Parts.Part.css","_generated/Less/MsPortalImpl/CustomPart.css","_generated/Less/MsPortalImpl/CustomForm.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt){"use strict";function wt(n){n.findByClassName("fxs-bg-error").eq(0).closest("[data-validatable='true']").findByClassName("azc-input").focus()}function ai(n,t){if(lt[n])throw new Error("The part kind '"+n+"' has already been registered and cannot be registered again.");lt[n]=t}function kt(n){return lt[n]}function dt(n){var t=n&&n.initialSize;return st.InternalPartSize[t]!==undefined?t:2}function vi(n,t,i){t.addClass(et(i.extensionWindowId)).addClass((i.styleSheets||[]).map((function(n){return et(n.file)})).join(" "));gt(n,i)}function gt(n,t){var s=t.styleSheets||[],i=t.extensionWindowId,u="",h=s.filter((function(n){return n.content&&!(ot[i]||{})[n.file]})).map((function(n){var e=ot[i]||(ot[i]={}),r,t,f;return e[n.file]=!0,r="."+et(i),n.file&&(r+="."+et(n.file)),t=[],f=o.sanitizeStyleSheetText(n.content,r,t),t.length&&t.forEach((function(t){u+="\n"+n.file+" - "+t.errorMessage+"\nCSS rule: "+t.rule.cssText})),f})),f;u&&Q.fcall((function(){r.Rpc.client.log(i||"fx",{level:i?2:1,code:1,area:"Parts",message:"Sanitization error found in following extension("+i+") styleSheets:"+u})}));f=h.map((function(i){var r=n.createElement("style");return r.type="text/css",r.textContent=i,r.setAttribute("data-extensionwindowid",t.extensionWindowId),r}));e(f).appendTo(n.head)}function yi(n,t,i,r,u){return new n.Part(t,i,r,u)}function pi(n,t,i){var u=t.partKind,r,f;if(u===ht.Custom){var o=t.htmlTemplateInline,s=t.htmlTemplate,e=o||i[s];r=ti(e&&e.content,{supportedSizes:t.supportedSizes})}else r=u===ht.Frame?ni("MsPortalImpl/Parts/Parts.Frame",yi,{supportedSizes:t.supportedSizes}):kt(ht[u]);return f=r.supportedSizes,f&&f.length||(r.supportedSizes=[dt(t)]),r}function ni(n,t,r){return{createPart:function(r,u,f,e){return i.tryImmediateResolve(i.require(n),(function(n){return t(n,r,u,f,e)}))},defaultSize:r.defaultSize,supportedSizes:r.supportedSizes,viewStateProperties:r.viewStateProperties,moduleId:n}}function ti(n,t){return t===void 0&&(t={}),{createPart:function(i,r,u,f){var o=t.partClass||bt,e=new o(i,r,u,f);return e.template=n,Q(e)},defaultSize:t.defaultSize,supportedSizes:t.supportedSizes,viewStateProperties:t.viewStateProperties}}var at,ot,ut;u.defineProperty(t,"__esModule",{value:!0});var ii=r.TriggerableLifetimeManager,vt=i.Base,yt=vt.Diagnostics,ri=vt.Images,ui=yt.Telemetry,st=i.Parts,fi=i.ViewModels,ht=st.PartKind,ft=st.PartState,ct=window,ei=yt.createLog(n),oi=h.Parts.partSettingNotReceivedErrorDescription,e=jQuery,lt={},si="attr: { 'role': context._computedRole },css: context._computedClasses,click: function (data, evt) { return context._onClick(data, evt); },event: {'keydown': function (data, evt) { return context._onKeyDown(data, evt); } }",hi="fxs-part-is-v2",ci="fxs-part-for-template-blade",et=o.getScopeName,pt=(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t})(fi.ClickableLink);t.InternalClickableLink=pt;at=(function(){function n(){this._onStartboard=f.observable();this.inContainerOfSameAsset=f.observable(!0);this.partSettingFailed=f.observable(!1);this.notFoundMessage=f.observable();this.lockedUiContext=f.observable(!0)}return n.prototype.getSelectable=function(){return this._selectable},n.prototype.configure=function(n){this._onStartboard(n.onStartboard);this._selectable=n.selectable||this._selectable},n})();t.PartBase=at;t.runFocusOnFirstInvalid=wt;var li=(ut={},ut[1]="fxs-part-success",ut[2]="fxs-part-warning",ut[3]="fxs-part-error",ut[4]="fxs-part-dirty",ut[5]="fxs-part-info",ut),bt=(function(t){function u(n,u,o,c){var l=t.call(this)||this,b,nt,p,ht,ot,st,ut,ct,g,lt;l.isFilterApplied=f.observable(!1);l.filterIcon=f.observable();l.partFilterState=f.observable(0);l.openPartSettingsBlade=function(){return e.noop};l.ariaLabel=f.observable();var w=l._lifetime=new ii,y=u.container,et=r.tryGetSelectableViewModelContract(y);if(!y)throw new Error("Cannot create a part without a container viewmodel.");return l._selectable=et&&et._msPortalFxSelectable2?v.getOrCreate(et._msPortalFxSelectable2):undefined,b=l._selectable=l._selectable||y.selectable,b||(nt=u.content,nt&&typeof nt.onClick=="function"&&(b=l._selectable=d.getSelectableWithClickHandler(nt,e(n),nt.onClick))),l._viewModel=u,p=l._partContainer=e(n).attr("data-bind",si).html(k()),l._accessibility(),o.isV2Part&&p.addClass(hi),o.isVirtualPartForTemplateBlade&&p.addClass(ci),l._partContent=p.findByClassName("fxs-part-content")[0],ht=p.findByClassName("fxs-part-title"),ot=l.validateElements=f.observableArray([]),ot.extend({rateLimit:{timeout:100,method:"notifyWhenChangesStop"}}),l._options=o,l._services=c,st=function(n){return!!l.notFoundMessage()||!!n.noDataMessage()||!!n.unauthorizedMessage()},l.isUiBlocked=f.pureComputed((function(){return l._viewModel.internal.allowUiBlocking()&&(y.operations.blockingUi()||st(y))})),ut=f.pureComputed((function(){return l._viewModel.internal.allowUiBlocking()&&st(y)})),l._isPartClickable=f.computed(w,(function(){return y.operations.blockingUi()||y.partState&&y.partState()===ft.Failed||l.notFoundMessage()||y.unauthorizedMessage()!==null&&y.unauthorizedMessage()!==undefined?!1:y.clickableLink||y.isSelectable()&&!!b})),f.computed(w,(function(){y.partTitle();setTimeout((function(){p.trigger(tt.default.fxsizechanged)}),50)})),f.computed(w,(function(){l.lockedUiContext()?p.removeAttr("aria-label"):p.attr("aria-label",y.ariaLabel()||l.ariaLabel()||y.partTitle())})),ct=f.computed(w,(function(){var n=y.partTitle()&&y.partState()!==ft.Failed;return a.toggle(ht,n),n})),l._computedClasses=f.computed(w,(function(){var n=[],t;return ct()&&n.push("fxs-part-part-title-visible"),l._isPartClickable()&&n.push("fxs-part-clickable"),l.notFoundMessage()?n.push("fxs-part-notfound"):y.noDataMessage()&&n.push("fxs-part-nodata"),b&&y.isSelectable()&&(b.isSelected()&&n.push("fxs-part-selected"),b.isCommandSelected&&b.isCommandSelected()&&n.push("fxs-part-selected-command")),l._viewModel.content._msPortalFxUnboundPart&&n.push("fxs-part-unbound"),t=li[y.contentState()],t&&n.push(t),n.join(" ")})),l._computedRole=f.computed(w,(function(){var n=[],t,r;return(p.find(".fxs-part-clickdesc, .fxs-part-tabback").remove(),l.lockedUiContext())?(p.removeAttr("aria-describedby"),null):(t=i.getUniqueId(),p.append('<div class="fxs-part-tabback" style="display:none" id="'+t+'">'+i.encodeHtml(h.Parts.tabbackcmds)+"<\/div>"),n.push(t),l._isPartClickable()&&(r=i.getUniqueId(),p.append('<div class="fxs-part-clickdesc" style="display:none" id="'+r+'">'+i.encodeHtml(h.Parts.clickableAriaDesc)+"<\/div>"),n.push(r)),p.attr("aria-describedby",n.join(" ")),"group")})),f.dataFor(p[0])&&f.cleanNode(p[0]),f.applyBindings({container:y,context:l},p[0]),ut.subscribeAndRun(w,(function(n){if(n){if(!g){g=w.createChildLifetime();var t=l._partContainer;g.registerForDispose([t.setEvents([tt.default.focus,l._onFocus=function(){l._toggleDisableTabbableElements(ut())}],[tt.default.focusin,l._onFocusIn=function(){ut()&&t[0].focus()}]),function(){l._onFocus=l._onFocusIn=null},])}p.find(document.activeElement).length>0&&p[0].focus()}else g&&(g.dispose(),g=null),l._toggleDisableTabbableElements(n)})),f.reactor(w,(function(){!l.lockedUiContext()&&(l._isPartClickable()||l._onStartboard())?p.attr("tabindex",0):p.removeAttr("tabindex")})),lt=r.shellInterface(y),lt.triggerValidation((function(n,t){return s.ensureFormFieldValidation(p,!0,t).then((function(t){return n&&wt(l._partContainer),t}))})),f.computed(w,(function(){var u=ot(),i=s.gatherFormFieldsFromElements(u),n=y.form.validationState,t=i.map((function(n){var t=n.field;return t.validatableViewModel&&t.validatableViewModel.validators().length?t.validatableViewModel.validationState():2})),r;~t.indexOf(1)?n(1):~t.indexOf(0)?n(0):~t.indexOf(3)?n(3):n(2);r=i.some((function(n){return f.unwrap(n.viewmodel&&n.viewmodel.dirty)}));y.form.dirty(r)})).extend({rateLimit:{timeout:100,method:"notifyWhenChangesStop"}}),i.isFeatureEnabled("dashboardfilters")&&l.partFilterState.subscribeAndRun(w,(function(n){l.isFilterApplied(n===1||n===2);l.filterIcon(ri.CustomImageWithOptions(n===2?rt:it,{isLogo:!0}))})),l}return __extends(u,t),u.prototype.setupContent=function(n){var t=this;return f.computed(this._lifetime,(function(){if(t.partSettingFailed())ei.error(oi),f.ignoreDependencies((function(){t._bindErrorTemplate()}));else{var r=nt.isV2(t._viewModel.content)&&!t._viewModel.content._msPortalFx_contentRevealedOnce(),i=t._viewModel.container.partState();if(r&&i!==ft.Failed)return;f.ignoreDependencies((function(){t._bindContentTemplate(i,t.template,n)}))}})).extend({deferred:!0}),w.waitForBindings(this._partContent)},u.prototype.selectOnReady=function(n,t){var i=this,c=function(){i._selectable.isSelected(!0)},f,e;t=t||{};t.selectablePath=t.selectablePath||"container.selectable";t.timeoutInMilliseconds=t.timeoutInMilliseconds===undefined?5e3:t.timeoutInMilliseconds;t.execute=t.execute||c;var o=this._viewModel.container.operations.inProgress,u=Q.defer(),s=p.getModelValue(this._viewModel,t.selectablePath),l=typeof this._viewModel.content.onInputsSet=="function"&&o(),h=function(){var r=n();r&&t.execute(i._viewModel);u.resolve(r)};return s.exists&&s.value?l?this._inProgressLifetime||(f=t.timeoutInMilliseconds,e=ct.setTimeout((function(){i._inProgressLifetime.dispose();i._inProgressLifetime=null;u.reject(r.createError("Unable to select part because its onInputsSet promise did not resolve after {0} milliseconds.".format(f)))}),f),this._inProgressLifetime=this._lifetime.createChildLifetime(),o.subscribe(this._inProgressLifetime,(function(n){n||(i._inProgressLifetime.dispose(),i._inProgressLifetime=null,ct.clearTimeout(e),e=null,h())}))):h():u.reject(r.createError("Unable to select part because it is missing selectable property '{0}' from its view model.".format(t.selectablePath))),u.promise},u.prototype._setupAutofocusReadyListener=function(){var t=this,n=this._partContainer[0];l.FocusHandler.Instance.registerTargetForFocus(n);w.waitForBindings(n).then((function(){return Q(t._viewModel.onInputsSetPromise).catch(i.noop)})).then((function(){l.FocusHandler.Instance.notifyTargetReadyForFocus(n)})).catch((function(){}))},u.prototype._logClick=function(n){var t=this._services.desktop.getActiveJourney();ui.trace({extension:this._options.locator.getExtensionLocator().name,source:this._onStartboard()?y.Source.StartBoardPart:y.Source.Blade,action:y.Action.PartClick,name:this._options.locator.toFriendlyString(),data:n,journeyId:t&&t.id})},u.prototype._onClick=function(n,t){return this._activatePart(n,t)},u.prototype._onKeyDown=function(n,t){return t.target===this._partContainer[0]&&t.keyCode===13?this._activatePart(n,t):!0},u.prototype._activatePart=function(n,t){if(this._services.desktop.mode.peek()===1&&!this._viewModel.content._msPortalFxUnboundPart)return!0;var c=this._viewModel.container,o=e(t.target),l=!0,s=ct.getSelection(),h=s.rangeCount>0&&s.getRangeAt(0),r=c.clickableLink;if(this._isPartClickable()&&!(o.closest("a").length>0)&&(s.isCollapsed||!h||h.commonAncestorContainer.ownerSVGElement||h.commonAncestorContainer.nodeName==="svg"))if(r)if(r instanceof pt&&e.isFunction(r.onClick))r.onClick();else{var u=r.target(),f=String(r.uri()||""),a=i.startsWith(f,"#"),v=!1;u==="auto"&&(u=a?"_self":"_blank");u==="_self"&&(t.ctrlKey||t.shiftKey?u="_blank":a&&(this._services.router.route(f),v=!0));v||window.open(f,u);this._logClick({effectiveTarget:u,target:r.target(),scrubbedUri:f.split("?")[0]})}else t.shiftKey||t.ctrlKey||t.which===2?o.trigger(tt.default.fxopeninnewtab,{selectable:c.selectable}):(this._selectable&&(this._selectable.isSelected()?o.trigger(tt.default.fxensurebladevisible,{}):(this._selectable.onClick(),this._logClick())),l=!1);return l},u.prototype._accessibility=function(){for(var t,r,u=this._partContainer.findByClassName("fxs-part-title"),n=0;n<u.length;n++)t=i.getUniqueId(),r=e(u[n]),r.findByClassName("fxs-part-titleText").attr("aria-describedby",t),r.findByClassName("fxs-part-assetname").attr("id",t)},u.prototype._bindContent=function(n,t,i){i&&vi(document,e(this._partContent),i);e(n).html(t);f.applyBindings(this._getContentForBinding(this._lifetime,this._viewModel),n);this._nodeToCleanup=n},u.prototype.dispose=function(){var n,t;this._lifetime.dispose();n=this._nodeToCleanup;n&&f.cleanNode(n);t=this._partContainer[0];t&&(f.cleanNode(t),this._partContainer[0]=this._partContent=null);i.disposeViewModelProperties(this._viewModel)},u.prototype._getContentForBinding=function(n,t){return t.content},u.prototype._getExtensionName=function(){return this._options.locator.getExtensionLocator().name},u.prototype._bindContentTemplate=function(t,r,u){var f=this._viewModel.container;if(t===ft.Ready)try{f.contentState(0);this._resetContentTemplateContainer();this._bindContent(this._partContent,r,u)}catch(e){c.logToExtension(n,this._partContainer,2,"Part {0} failed to bind. Error: {1}".format(this._options.getDebugId(),i.getLogFriendlyMessage(e)));this._bindErrorTemplate()}else t===ft.Failed&&(this._options.traceErrorTelemetry(f.failureMessage()),this._bindErrorTemplate());this._setupAutofocusReadyListener()},u.prototype._bindErrorTemplate=function(){this.notFoundMessage(null);this._viewModel.container.contentState(3);this._resetContentTemplateContainer();var n=new b.ViewModel;new b.Widget(e(this._partContent),n);n.title(this._options.locator.name);n.subtitle(this._getExtensionName());l.FocusHandler.Instance.notifyTargetReadyForFocus(this._partContainer[0])},u.prototype._resetContentTemplateContainer=function(){f.cleanNode(this._partContent);e(this._partContent).html("")},u.prototype._toggleDisableTabbableElements=function(n){var r,t,u,i,f="tabindex",o="data-initialtabindex";if(n)for(r=this._partContainer.find(":tabbable"),i=0;i<r.length;++i)t=e(r[i]),u=t.attr(f),t.attr(f,"-1"),t.attr(o,u||"unset");else for(r=this._partContainer.find("["+o+"]"),i=0;i<r.length;++i)t=e(r[i]),u=t.attr(o),u!=="unset"?t.attr(f,u):t.removeAttr(f),t.removeAttr(o)},u})(at);t.PartImpl=bt;t.registerFactory=ai;t.getFactory=kt;t.getPartSizeOrDefault=dt;ot={};t.injectStyles=gt;t.getPartFactory=pi;t.createAmdPartFactory=ni;t.createPartFactory=ti}));
define("MsPortalImpl/UI/Compositions/UI.Composition.BladeOpenerBase",["require","exports","f","o","ko","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding","MsPortalImpl/UI/UI.DesktopManager"],(function(n,t,i,r,u,f,e,o){"use strict";function a(n,t,i){w.error("Error invoking detail blade for master '{0}'. ".format(t)+n+"Selection model: '{0}'".format(JSON.stringify(i)))}function b(n,t){var i=arguments.length===2?s(n,t).value:n,r;return i?(r=[i.selectedValue,i.value,i.isSelected,i.isActivated,i.isCommandSelected,i.hasChildEdits],r.every(u.isObservable)):!1}function k(n,t){var i=arguments.length===2?s(n,t).value:n,r;return i?(r=[i.selectableItems,i.selectedItems,i.activatedItems,i.itemsWithChildEdits],r.every(u.isObservable)):!1}function d(n){var t=n;return!!t.isLocked()}function g(n){return n.blade?n.selectablePath||"container.selectable":nt(n)}function c(n){var t=n&&n.invocationInputArguments,i=t&&t[0],r=i&&i.valuesFrom,u=r&&r[0];return u&&u.property}function nt(n){var r=c(n),t,i,u;return r&&(t=r.split("."),i=t.length,i>1)?(u=t[i-1],["value","activatedItems","selectedItems","selectedItem"].some((function(n){return n===u}))&&(t=t.slice(0,i-1)),t.join(".")):null}function tt(n){var t,i,r;return n?(t=n.filter((function(n){return n&&!n.selectablePath&&!n.invocationInputArguments})),!t.length&&(i=n.filter((function(n){return n&&n.selectablePath==="container.selectable"})),!i.length&&(r=n.filter((function(n){var t=c(n);return t==="container.selectable.value"||!n.blade&&t==="container.selectable"})),!r.length)))?!1:!0:!1}function it(n,t,i){var r,f=n.invocationInputArguments,o=f&&f.length!==1,e=f&&!o&&f[0].valuesFrom,u=n.outputArguments;return(o?r="Invocation arguments must exist and have only one element.":e&&e.length>1?r="Multiple 'valuesFrom' not supported for invocation arguments.":!n.blade&&f[0].property?r="Static invocation property is not supported when omitting the details blade name.":e&&e[0].constantValue!==undefined?r="Constants are not allowed on invocation argument.":u&&u.length>0&&(u.some((function(n){return!n.property}))?r="Output arguments must specify a target property.":u.some((function(n){return n.valuesFrom.length!==1}))?r="Output arguments support only one valueFrom property.":u.some((function(n){return n.valuesFrom[0].constantValue!==undefined}))?r="Constants are not allowed on output arguments.":u.some((function(n){return n.valuesFrom[0].referenceType!==1}))&&(r="Output arguments only support source ReferenceType.BladeInput.")),!r&&i&&(r=i(n)),r)?(t.push(r),!1):!0}function rt(n,t,i,r){var s=t,c=t,l=t,v,u,e={},o;return ot(r,t)&&(t.extension&&(o=t.extension,o=f.redirects()[o]||o,i=h.forExtension(o)),v=h.forExtensionManifest(i.name),s.detailBlade?u=i.withBlade(s.detailBlade):c.assetType&&n.finder.tryLocate(v.withAssetType(c.assetType),e)?u=y(i.name,e.value):l.resourceId&&f.tryLocateAssetDefinitionFromResourceId(n.extensionManager,l.resourceId,e)?u=y(e.extensionName,e.value):a("Unable to locate asset. Error: '{0}'. ".format(e.error),r,t)),u||(u=i.withBlade("##NOT_SPECIFIED##")),u}function ut(n,t,i){var r=t&&t.container,u=i.details;return r&&r.selectable===n?u.first((function(n){return v(n)})):n?(u||[]).first((function(i){var r=i.invocationInputArguments,u=i.selectablePath;return r?r.some((function(i){return i.valuesFrom.some((function(i){var r=[];return i.property.split(".").some((function(i){return r.push(i),s(t,r.join(".")).value===n}))}))})):u?s(t,u).value===n:!1})):null}function v(n){var r=c(n),u=n.selectablePath,i=!0;return r?i=r===t.PartContainerSelectableValue_ViewModelPath:u&&(i=u===t.PartContainerSelectable_ViewModelPath),i}function ft(n,t,r,u,f){var o,s;if(t.setLifetimeReference(8,r),s=function(){var t={},h,s;o=new e.PropertyBindings(r.id+"-"+n,t,!1);h=r.getViewModel(1);o.addPropertyChangedHandler((function(){s=i.clone(t,!0)}));u.forEach((function(n){o.mapProperty(n,n).bind(r.id,h,!0)}));s&&f(s);o.addPropertyChangedHandler((function(){var n=i.clone(t,!0);f(n)}))},u.length){r.isComposed?s():r.awaitComposed().then(s);r.onDispose((function(){o&&(o.unbind(),o=null)}))}}function et(n,t,i,r,f){function e(){return i.referenceComposition.getPartsContainer().detailContainers.map((function(n){return"\n    "+n.toString()+". Model: "+u.toJSON(n.getInputsOnlyViewModel())})).join("")||"<None>"}o.isTraceEnabled&&n.verbose("[BladeOpener] "+t+("\n Master Identifier: "+i.masterModelId+".")+("\n  Master Property: "+r.source.property)+("\n  Master Value: "+(f!==undefined?u.toJSON(f):"<undefined>")+".")+("\n  Current Detail Blades from Container: "+e()))}function ot(n,t){var i,r=t,u=t,f=t;return t?r.detailBlade||u.assetType||f.resourceId?r.detailBlade&&u.assetType?i="'detailBlade' and 'assetType' cannot be specified at the same time.":r.detailBlade&&f.resourceId?i="'detailBlade' and 'resourceId' cannot be specified at the same time.":u.assetType&&f.resourceId?i="'assetType' and 'resourceId' cannot be specified at the same time.":t.detailBladeInputs||(i="Model must define a 'detailBladeInputs' property."):i="Either 'detailBlade', 'assetType' or 'resourceId' must be specified on the model. ":i="Dynamic selection must be specified. ",i&&a(i,n,t),!i}function y(n,t){if(!t)return null;var i=t.contracts;return(i&8)==8?h.forExtension(l.ExtensionNames.Hubs).withBlade(l.BladeNames.Hubs.ResourceMenuBlade):h.forExtension(t.bladeExtensionName||n).withBlade(t.bladeName)}var s;r.defineProperty(t,"__esModule",{value:!0});var h=f.Locator,l=i.Base.Constants,p=i.Base.Diagnostics,w=p.createLog(n);t.PartContainerSelectable_ViewModelPath="container.selectable";t.PartContainerSelectableValue_ViewModelPath=t.PartContainerSelectable_ViewModelPath+".value";s=e.getModelValue;t.DefaultConfiguration={services:null,masterModelId:null,masterModel:null,referenceComposition:null,referenceExtension:null,isBladeOpenedByMaster:null,invocationThrottleDuration:25,configureBladeDescriptor:i.noop,onBladesOpening:i.noop,onBladeOpened:i.noop,addOutputBindings:i.noop,removeOutputBindings:i.noop,getCloseOwnedDetailBladesHandler:i.wrap(null),getCloseOtherDetailBladesHandler:i.wrap(null)};t.isSelectable=b;t.isSelectableSet=k;t.isSelectableLocked=d;t.getSelectablePath=g;t.needContainerSelectable=tt;t.validateDetailsDefinition=it;t.mapDynamicSelectionToBladeLocator=rt;t.getAssociatedDetailDefinition=ut;t.detailsIsPartContainer=v;t.bindOutputsToSelectable2=ft;t.traceInvocationChange=et}));
define("MsPortalImpl/Extension/Extension",["require","exports","f","i","o","ko","MsPortalImpl/Extension/DefinitionPreprocessor","MsPortalImpl/Extension/Extension.DefinitionValidator","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/Extension/Extension.Manifest","MsPortalFx/Globalization","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Parts/Parts","MsPortalImpl/UI/Compositions/UI.Composition.BladeOpenerBase","MsPortalImpl/UI/Hubs/UI.NotificationManager","MsPortalImpl/Extension/ViewModelManager","MsPortalImpl/Base/JQueryExtensions"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p){"use strict";function oi(n){return n&&n.formatCulture===ti&&n.displayLanguage===ni}function si(n){return n.replace(/\\/g,"\\\\").replace(/\'/g,"\\'")}function hi(n,t){return new it(n,t)}function ci(n,t,i){for(var r=[],u=Q(),f=function(){r.length<t&&(u=u.then((function(){if(r.length<t)return i().then((function(n){r.push(n)})).catch((function(n){k.error(n,6)}))})))},e=0;e<t;e++)f();return{getItem:function(){return Q.delay(fi).then(f),r.pop()},size:function(){return r.length}}}function li(n,t,i){n.styleSheets&&a.injectStyles(t,{extensionWindowId:i,styleSheets:n.styleSheets.map((function(n){return{file:"",content:n}}))})}var w,tt,it,d,rt,ct;u.defineProperty(t,"__esModule",{value:!0});var b=r.Extension,lt=r.TelemetryContext,ut=i.Base,at=MsPortalEarly.ExtensionLoader,g=ut.Constants,vt=g.ExtensionNames.Hubs,nt=ut.Diagnostics,yt=nt.Telemetry,pt=r.Rpc,wt=i.Hubs.Notifications.NotificationStatus,ft=window,bt=ft.fx.getTimestamp,kt=i.isNullOrUndefined,dt=$("head"),k=nt.createLog(n),gt=ft.fx.environment,ni=c.displayLanguage,ti=c.formatCulture,ii=gt.relex,et="ExtensionLoad",ot=l.Shell,ri="data-extensionname",st="ExtensionManager",ht=yt,ui=lt,fi=4e3,ei=i.forEachKey;t.canUseManifest=oi;t.escapeSingleQuote=si,(function(n){n[n.None=0]="None";n[n.InvalidExtensionName=1]="InvalidExtensionName";n[n.InvalidManifest=2]="InvalidManifest";n[n.InvalidDefinition=3]="InvalidDefinition";n[n.Unexpected=4]="Unexpected";n[n.TooManyRefreshes=5]="TooManyRefreshes"})(w||(w={})),(function(n){n[n.Default=0]="Default";n[n.Part=1]="Part"})(tt=t.ViewModelType||(t.ViewModelType={}));t.create=hi;it=(function(){function n(n,t){var u=this;this.initializedExtension=f.observable();this._manifests=new i.Map;this._initializedDeferred=Q.defer();this._manifestLoaded=Q.defer();this._bladeRedirectMap={};this._alwaysInitialize=!1;this._loaderError=function(n){var t="Error while loading extension "+u.metadata.name+": "+n.type,i={errorObject:n,telemetry:u._extensionLoader.telemetry},f;n.type!=="TooManyRefreshes"?(f=r.createError(t,{data:i}),k.error(f,7)):(u._onError(w.TooManyRefreshes,t),ht.trace({source:st,action:et,actionModifier:"cancel",data:i,name:u.name}));nt.Upload.flush()};this._rpcClient=n;this.metadata=t;this.name=t.name;this.isTestExtension=!!t.isTestExtension;this.isTestStamp=!!t.isTestStamp;this._extensionLoader=new at.ExtensionLoader(t,this._loaderError)}return n.prototype.getVersion=function(){return this._extVersion},n.prototype.unloaded=function(){return!this._rpcChannel},n.prototype.getBladeRedirect=function(n){return this._bladeRedirectMap[n&&n.toLowerCase()]},n.prototype.getManifest=function(n){return this._manifests.get(n)},n.prototype.setManifest=function(n,t){var r=this,i=t;return(i.redirects||[]).forEach((function(n){switch(n.type){case 2:case 3:var t=n.fromBlade;t&&(r._bladeRedirectMap[t.toLowerCase()]=n);break;case 4:case 5:s.addPartRedirect(r.name,n)}})),this._manifests.set(n,i),i},n.prototype.getManifestAsync=function(){return this._manifestLoaded.promise},n.prototype.whenInitialized=function(){return this._initializedDeferred.promise},n.prototype.onManifestReceived=function(n){var r=this._validateAndSetManifest(n,!1),t;return r&&!this._alwaysInitialize?(t=this._rpcClient.gcWindow(this.getWindowId()),t&&i.disposeDisposable(this._rpcChannel),this._alwaysInitialize=!0,t):!1},n.prototype.getChannel=function(){return this._rpcChannel},n.prototype.getOrLoadChannel=function(){var t=this,n,i,r;if(!this._rpcChannel){n=this._extensionLoader;n.loadExtension();i=n.shellPort;r=this._rpcChannel=new pt.RpcChannel(i);n.initializeReceived.then((function(u){t._parseInitializationMessage(u);i!==n.shellPort&&r.swapPort(n.shellPort)}),this._loaderError);r.onDispose((function(){t._initializedDeferred=Q.defer();t.initializedExtension(void 0);var i="style[{0}='{1}']".format(ri,t.name);dt.remove(i);t._rpcChannel=null;n.unloadExtension()}))}return this._rpcChannel},n.prototype.getWindowId=function(){return b.getWindowId(this)},n.prototype.loadAsync=function(n){if(!this.unloaded())return this.whenInitialized();n||(n={});var t=n.manifest;return t&&this._validateAndSetManifest(t,!0)||this.getOrLoadChannel(),this._initializedDeferred.promise},n.prototype.dispose=function(){this._rpcChannel&&(this._rpcChannel.dispose(),this._rpcChannel=null)},n.prototype._parseInitializationMessage=function(n){this.onManifestReceived(n.manifest)||this._loadDefinition(n.definition,n.bootstrapTelemetry)},n.prototype._loadDefinition=function(n,t){var c=this.getManifest("assetTypes"),h=o.validateDefinition(n),u,r,f;if(h.valid())u=e.preprocessDefinition(n,c,s.redirects()),r=new ct(this._rpcClient,this,u),r.loadTime=this._extensionLoader.loadTime,li(u,document,this.getWindowId()),this.initializedExtension(r),this._initializedDeferred.resolve(r),ht.trace({source:st,action:et,actionModifier:"complete",duration:this._extensionLoader.loadTime,name:this.name,data:{shellSide:this._extensionLoader.telemetry,extSide:t}});else return f="The extension definition has validation errors. Errors: {0}".format(JSON.stringify(h.errors)),this._onError(w.InvalidDefinition,f),Q.reject(new i.Errors.Error(f))},n.prototype._validateAndSetManifest=function(n,t){var l=this,r=!1,o=h.validate(n),s,u,c,f,e;if(o.valid())if(this.name.toLowerCase()!==n.name.toLowerCase())s="The extension name defined in the manifest '{0}' (obtained from the <Extension> tag in PDL) does not match the name '{1}' used to identify the extension with the portal. Ensure that the name you specify in the <Extension> tag in PDL matches the one used in the extensions.json file to identify the extension with the portal.",this._onError(w.InvalidExtensionName,s.format(n.name,this.name));else try{kt(n.isPreview)&&(u=this.metadata.features,n.isPreview=(u&&u.preview||"").toLowerCase()==="true");t||ei(ii.cachedManifestTypes,(function(t){l.setManifest(t,n)}));c=this.setManifest("assetTypes",n);this._manifestLoaded.resolve(c);r=!0}catch(a){f="_validateAndSetManifest throws";k.error(new i.Errors.Error({message:f,data:n,innerErrors:a}));this._onError(w.Unexpected,f)}else o.errors.forEach(k.error,k),this._onError(w.InvalidManifest,"The extension manifest has validation errors.");return(r||!t)&&(e=n.pageVersion,this._extVersion=e,this._extensionLoader.setPageVersion(e)),r},n.prototype._onError=function(n,t){var u="Failed to initialize extension '{0}'. ErrorState: {2}. Error: {3}.".format(this.name,w[n],t),i=r.createError(u,{data:{extVersion:this._extVersion,timeThisExtensionFailed:bt(),extensionTelemetry:this._extensionLoader.telemetry}});k.error(i,1);nt.Upload.flush();this._manifestLoaded.reject(i);this._initializedDeferred.reject(i);this._notifyFailedLoad();this.dispose()},n.prototype._notifyFailedLoad=function(){var n=y.getNotificationManager();n&&n.addClientNotification({title:ot.extensionError,description:ot.loadingError.format(this.name),status:wt.Error,timestamp:new Date})},n})();t.ExtensionImpl=it;d=g.BladeNames.Hubs.ResourceMenuBlade;rt={};rt[vt]=[{partName:d+"$"+d,locator:s.resourceMenu.withLens(d).withPartInstance(d),getPartDefinition:function(n){return n.getBladeDefinition(d).then((function(n){return n.lenses[0].partInstances[0].inline}))}},];ct=(function(){function n(n,t,i){var u=this,e,o;this.outstandingObjectCount=f.observable(0);this.metadataCount=f.observable(0);this._proxiedObjects=[];this._pools={};this._bladeDefMap={};this._partDefMap={};this._controlDefMap={};this._rpcClient=n;e=this._lifetime=new r.TriggerableLifetimeManager;e.registerForDispose(this.extension=t);o=this.name=t.name;this.definition=i;(rt[o]||[]).forEach((function(n){u._pools[n.locator.toString()]=ci(e,5,(function(){return n.getPartDefinition(u).then((function(t){var i=t.details;return u.getPartViewModel(n.partName,{initialState:{},createSelectable:v.needContainerSelectable(i),partSize:t.initialSize,partLocation:2,collapsed:null,containerType:0})}))}))}))}return n.prototype.canUseInputsSetParameters=function(n){var t=this._pools[n.toString()];return!t||!t.size()},n.prototype.getBladeRedirect=function(n){return this.extension.getBladeRedirect(n)},n.prototype.processMessages=function(){return b.pingEndPoint.invoke(this._rpcClient,this.extension.getWindowId(),undefined)},n.prototype.dispose=function(){this._lifetime.dispose()},n.prototype.getManifest=function(n){return this.extension.getManifest(n)},n.prototype.getChannel=function(){return this.extension.getChannel()},n.prototype.getBladeDefinition=function(n){var c=this,u=this.definition,t=n.toLowerCase(),f=u.bladeMap[t],i,h;return f?Q(f):(i=this._bladeDefMap,h=/^[A-Za-z0-9_$]*$/,!h.test(n))?Q.reject(r.createError("Blade name is invalid identifier")):i[t]||(i[t]=Q(b.getBladeDefinitionEndPoint.invoke(this._rpcClient,this.extension.getWindowId(),n)).then((function(n){return e.processBlade(u,c.getManifest("assetTypes"),n,s.redirects())})).then((function(n){var t=[];if(o.validateBlade(u,n,null,t),t.length)throw new Error("Invalid blade definition. Errors: "+t.join("\n"));return n})).finally((function(){delete i[t]})))},n.prototype.getPartDefinition=function(n){var f=this,r=this.definition,t=n.toLowerCase(),u=r.partTypeMap[t],i;return u?Q(u):(i=this._partDefMap,i[t]||(i[t]=Q(b.getPartDefinitionEndPoint.invoke(this._rpcClient,this.extension.getWindowId(),n)).then((function(n){return e.processPart(r,f.getManifest("assetTypes"),n,s.redirects())})).then((function(n){var t=[];if(o.validatePartType(n,t),t.length)throw new Error("Invalid part type definition. Errors: "+t.join("\n"));return n})).finally((function(){delete i[t]}))))},n.prototype.getControlDefinition=function(n){var i=this,t=this._controlDefMap;return t[n]||(t[n]=Q(b.getControlDefinitionEndPoint.invoke(this._rpcClient,this.extension.getWindowId(),n)).then((function(n){return e.processControl(i.definition,i.getManifest("assetTypes"),n)})).then((function(n){var t=[];if(o.validateControl(n,t),t.length)throw new Error("Invalid control definition. Errors: "+t.join("\n"));return n})).catch((function(i){return delete t[n],Q.reject(i)})))},n.prototype.getViewModel=function(n,t){return this._getViewModel(tt.Default,n,t)},n.prototype.getPartViewModel=function(n,t){var f,r,u;return t&&t.locator&&(f=this._pools[t.locator.toString()])&&!t.onInputsSetParameters&&!i.keysLength(t.initialState)&&(r=f.getItem(),r)?(u=t&&t.onViewModelAcquired,u&&u(r),Q(r)):Q(this._getViewModel(tt.Part,n,t))},n.prototype._getViewModel=function(n,t,i){var e=this,r,u;return(i=i||{},r=p.resolve(this,t,i.initialState),r)?r.then((function(n){if(i.onViewModelAcquired)i.onViewModelAcquired(n);return typeof i.partSize=="number"&&n&&n.content&&f.isObservable(n.content.size)&&n.content.size(i.partSize),i.onInputsSetParameters&&n&&n.updatePartInputValues&&(n.onInputsSetPromise=Q(n.updatePartInputValues(i.onInputsSetParameters.inputs,i.onInputsSetParameters.settings,i.onInputsSetParameters.traceOptions))),n})):(u=n===tt.Part?g.ViewModelTypes.PartViewModel:g.ViewModelTypes.ViewModel,Q(b.getViewModelsDefinition.acquireObject(this._rpcClient,this.extension.getWindowId(),{type:u,containerType:i.containerType||0,name:t,initialState:i.initialState,createSelectable:i.createSelectable,telemetryContext:ui.getState(),partSize:i.partSize,partLocation:i.partLocation,onInputsSetParameters:i.onInputsSetParameters,collapsed:i.collapsed,flags:i.flags},i.onViewModelAcquired&&function(n){return i.onViewModelAcquired(n&&n.getValue())}).then((function(n){return e._proxiedObjects.push(n),n.getValue()}))))},n.prototype.releaseViewModel=function(n){i.disposeDisposable(n);var t=i.findIndex(this._proxiedObjects,(function(t){return t.getValue()===n}));t!==-1&&this._proxiedObjects.splice(t,1)[0].dispose()},n.prototype.isPreview=function(){return this.getManifest("assetTypes").isPreview},n})()}));
define("MsPortalImpl/Extension/ExtensionManager",["require","exports","f","i","o","$","FxInternal/Di","MsPortalImpl/Extension/Extension","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/Base/Telemetry"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";function w(n){return u.keys(n||{}).filter((function(t){var i=n[t];return i&&!!i.manifest})).length}var v,g,y;u.defineProperty(t,"__esModule",{value:!0});var b=r.Extension,c=i.Base,nt=c.Constants.ExtensionNames.Hubs,k=c.Diagnostics,tt=k.Telemetry,a=r.Rpc,it=window,p=it.fx,rt=p.early,l=k.createLog(n),ut=p.environment,d=tt.trace,ft=i.startTimer;(function(n){function r(n,i){var r={};return n&&(r["x-ms-effective-locale"]=n),Q(c.Net2.ajax({uri:t.getUri(n,i),performRetry:!0,type:"GET",dataType:"json",contentType:"application/json",headers:r}))}function u(r){var u;return u=r==="assetTypes"?i=i||Q(t.promise).catch((function(n){return l.warning(n,6),null})).then((function(t){return w(t)?t:n.getManifestsAjax(undefined,r)})):n.getManifestsAjax(undefined,r),u.then((function(n){return n||{}})).catch((function(n){return l.error(n,7),{}}))}var t=rt.manifestCache,i;n.getManifestsAjax=r;n.getManifests=u})(v=t.Relex||(t.Relex={})),(function(n){var t=(function(){function n(n){var t=this;this.initializedExtensions=[];this._isRpcStarted=!1;this._callbacksMap=new i.Map;this._callbacks=f.Callbacks();this._unloadCallbacks=f.Callbacks();this._allManifestsLoaded=Q.defer();this._manifestLoadStarted=Q.defer();this._ltm=new r.TriggerableLifetimeManager;this.getHubsExtension=function(){return t.getExtensionByName(nt)};this.manifestLoadComplete=!1;this._manifestsMap={};this._initializedExtensionMap={};this._createExtension=n.createExtension;this._extensionRedirectMap=n&&n.extensionRedirectMap||p.internalEnv.extensionRedirectMap}return n.prototype.getExtension=function(n){return this._getExtensionByDescriptor({name:n})},n.prototype.getManifestByName=function(n){var r=this,t=this._manifestsMap,i=JSON.stringify([].slice.call(arguments));return t[i]||(t[i]=this._manifestLoadStarted.promise.then((function(){return r.getExtension(n).getManifestAsync()})).catch((function(n){return delete t[i],Q.reject(n)})))},n.prototype.getExtensionByName=function(n,t){var u=this,i,r;return t=t||{},i=this._initializedExtensionMap,r=JSON.stringify([].slice.call(arguments)),i[r]||(i[r]=this._manifestLoadStarted.promise.then((function(){var t=u._getExtensionByDescriptor({name:n});if(!t)throw new Error("extension {0} was not found".format(n));return t})).then((function(f){var o=f.getWindowId(),e;return t.onlyIfLoaded||a.client.acquireWindow(o,24e4),e=f.whenInitialized(),t.timeout>0&&(e=Q(e).timeout(t.timeout,"Timed out waiting for extension '{0}' to load.".format(n))),e.then((function(){var n=u._getLoadedExtensionByWindowId(o),t;return n&&(t=u._ltm.createChildLifetime(),n.extension.initializedExtension.subscribe(t,(function(n){n||(delete i[r],t.dispose())}))),n}))})).catch((function(n){return delete i[r],Q.reject(n)})))},n.prototype.initialize=function(n){var t=this,u,e,r,o;this._extensionsMap={};var l=this._createExtension,y=n.extensions.filter((function(n){return!(n.redirectTo&&t._extensionRedirectMap[n.name])})),p=function(n){if(n){t.initializedExtensions.push(n);t._callbacks.fire(n);n.getChannel().onDispose((function(){i.remove(t.initializedExtensions,n);t._unloadCallbacks.fire(n)}))}},f=y.map((function(n){var i=l(a.client,n),r=i.getWindowId().toLowerCase();if(t._getExtensionByWindowId(r))throw new Error("Extension with window ID '"+r+"' has already been registered.");return i.initializedExtension.subscribeAndRun(t._ltm,p),t._extensionsMap[r]=i}));return s.redirects(this._extensionRedirectMap),this.startRpc(),u=this._getExtensionByWindowId(b.getHubsWindowId()),u&&a.client.acquireWindow(u.getWindowId()),e=ft(),n.useCachedManifests?(r=v.getManifests("assetTypes"),this._callbacksMap.has("assetTypes")||this._callbacksMap.set("assetTypes",{initialPromise:r,callbacks:new c.Callbacks})):r=Q({}),r.then((function(n){d({source:"ExtensionManager",action:"CachedManifestCount",actionModifier:h.ActionModifier.Default,data:w(n),duration:e()});f.forEach((function(t){var i=n[t.name];t.isTestExtension||t.isTestStamp?t.loadAsync():t.loadAsync(i)}))})),o=f.map((function(n){var i=n.getManifestAsync();return i.then((function(n){t._callbacksMap.has("assetTypes")&&t._callbacksMap.get("assetTypes").callbacks.fire(n)})),i})),this._manifestLoadStarted.resolve(),Q.any([Q.allSettled(o),Q.delay(6e4)]).then((function(){t._allManifestsLoaded.resolve();t.manifestLoadComplete=!0}))},n.prototype.startRpc=function(){var n=this;this._isRpcStarted||(this._isRpcStarted=!0,a.start({originId:"fx",loadChannelFunction:function(t){var i=n._getExtensionByWindowId(t);if(!i)throw new Error("Failed to load extension '{0}'.".format(t));return i.getOrLoadChannel()},windowRedirectMap:this._extensionRedirectMap}))},n.prototype.unloadExtension=function(n){n.dispose()},n.prototype.on=function(n,t){var u=this,f,i,r;return this._callbacksMap.has(n)||(f=void 0,f=ut.relex.cachedManifestTypes[n]?v.getManifests(n).then((function(t){d({source:"ExtensionManager",action:"CachedManifestTypeCount",actionModifier:n,data:w(t)});var i=u.getExtensions().map((function(i){var e=i.isTestExtension||i.isTestStamp?null:t[i.name],r=e&&e.manifest,f;if(r)i.setManifest(n,r),u._callbacksMap.get(n).callbacks.fire(r);else return i.loadAsync(),f=i.getManifestAsync(),f.then((function(t){u._callbacksMap.get(n).callbacks.fire(t)})),f.timeout(2e3)})).filter((function(n){return!!n}));return Q.allSettled(i)})):this._allManifestsLoaded.promise,this._callbacksMap.set(n,{initialPromise:f,callbacks:new c.Callbacks})),i=this._callbacksMap.get(n),t&&(r=function(n){try{t(n)||i.callbacks.remove(r)}catch(u){l.error(u,11)}},i.callbacks.add(r),this.getExtensions().forEach((function(t){var i=t.getManifest(n);i&&r(i)}))),i.initialPromise},n.prototype.onLoad=function(n){var i=this,r=this.initializedExtensions.slice(0),t=function(r){try{n(r)||i._callbacks.remove(t)}catch(u){l.error("onLoad event callback has thrown an exception.",2,u)}};this._callbacks.add(t);r.forEach((function(t){n(t)}))},n.prototype.onUnload=function(n){var i=this,t=function(r){try{n(r)||i._unloadCallbacks.remove(t)}catch(u){l.error("onUnload event callback has thrown an exception.",3,u)}};this._unloadCallbacks.add(t)},n.prototype.refreshManifests=function(n){return v.getManifestsAjax(n)},n.prototype.dispose=function(){this._ltm.dispose()},n.prototype._getExtensionByWindowId=function(n){var t=this._extensionsMap;return t&&t[n.toLowerCase()]},n.prototype._getExtensionByDescriptor=function(n){return this._getExtensionByWindowId(b.getWindowId(n))},n.prototype._getLoadedExtensionByWindowId=function(n){return this.initializedExtensions.first((function(t){return t.extension.getWindowId()===n}))},n.prototype.getExtensions=function(){var n=this;return u.keys(this._extensionsMap||{}).map((function(t){return n._extensionsMap[t]}))},n})();n.ExtensionManagerImpl=t})(g=t.Internal||(t.Internal={}));y=(function(){function n(){}return n.create=function(){return new g.ExtensionManagerImpl({createExtension:o.create})},n})();__decorate([e.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",y)],y,"create",null);t.ExtensionManager=y}));
define("MsPortalImpl/Services/Services.Settings.Schema",["require","exports","f"],(function(){"use strict";var n;return (function(n){n.desktopSettingsKey="sprint2";n.startBoardSettingsKey="Startboard";n.fxThemeKey="fxs-theme";n.highContrastKey="highContrastKey";n.favoritesKey="favorites";n.testExtensionsKey="TestExtensions";n.testGalleryPackagesKey="TestGalleryPackages";n.testPatchesKey="TestPatches";n.npsTimeMs="npsTimeMs";n.rawLocaleKey="rawLocale";n.sideBarCollapsedKey="sideBarCollapsedKey";n.sideBarBrowseDisplayModeKey="sideBarBrowseDisplayModeKey";n.showCommandLabelsKey="showCommandLabelsKey";n.notificationToastEnabledKey="notificationToastEnabledKey";n.whatsNewEnabledKey="whatsNewEnabledKey";n.showLabelsKey="showLabelsKey";n.whatsNewVersionKey="whatsNewVersion";n.userConsentForNpsContactKey="userConsentForNpsContact";n.settingsVersionSettingKey="Version";n.defaultAssetTypeIdKey="MsPortalFx.Browse.DefaultAssetTypeId";n.idleTimeoutMinsKey="idleTimeoutMins";n.optIntoNewBrowseKey="optIntoNewBrowse";n.generalSettingsKeys=[n.defaultAssetTypeIdKey,n.fxThemeKey,n.highContrastKey,n.idleTimeoutMinsKey,n.notificationToastEnabledKey,n.npsTimeMs,n.rawLocaleKey,n.settingsVersionSettingKey,n.showCommandLabelsKey,n.showLabelsKey,n.sideBarCollapsedKey,n.sideBarBrowseDisplayModeKey,n.testExtensionsKey,n.testGalleryPackagesKey,n.userConsentForNpsContactKey,n.whatsNewVersionKey,n.optIntoNewBrowseKey,]})(n||(n={})),n}));
define("MsPortalImpl/Extension/ExtensionMetadataSource",["require","exports","f","i","o","FxInternal/Di","MsPortalImpl/CodeComponentSideLoad/CodeComponentSideLoadManager","MsPortalImpl/CodeComponentSideLoad/CodeComponentSideLoadModels","MsPortalImpl/Services/Services.Settings.Schema","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Services/Services.Storage","MsPortalImpl/UI/UI.DialogManager","MsPortalImpl/UI/UI.NavigationManager","MsPortalImpl/Base/Base.ImplUtils"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){"use strict";var w;u.defineProperty(t,"__esModule",{value:!0});var nt=i.Base,tt=nt.Diagnostics,p=o.ExtensionMetadataExt,it=window,rt=tt.createLog(n),b="testExtensions",ut="loadUntrustedExtensions",k=o.canModifyExtensions,d="Reload the portal with the query parameter ?feature.canmodifyextensions=true to load the test extension.",g=p.create,y=(function(){function n(n){this.value=n}return n.create=function(){return new n(it.fx.bootParameters.environment.extensionsMetadata)},n})();__decorate([f.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",y)],y,"create",null);t.StaticExtensionMetadata=y;w=(function(n){function t(t,i,r,u,f,e,o){return n.call(this,t,i,r,u,f,e,o,ut,b,g,0,s.testExtensionsKey)||this}return __extends(t,n),t.prototype.registerTestExtension=function(n,t){var i=g(n);return this.registerTestCodeComponent(i,t).then((function(){console.log(d)}))},t.prototype.registerTestExtensionsFromUri=function(n){var e=this,h=new v.Uri(n),s=h.getHashQueryStringValue(b),t,f;return s?(t=JSON.parse(decodeURIComponent(s)),f=u.keys(t),!k&&f.length&&console.warn(d),Q.allSettled(f.map((function(n){var u=new p,h,f,s,c;return u.name=n,h=r.Extension.getWindowId(u),f=i.find(e._trustedCodeComponents,(function(n){return r.Extension.getWindowId(n)===h})),f&&(u.obsoleteBundlesBitmask=f.obsoleteBundlesBitmask),s=u.uri=t[n],o.isLocalhostUri(s)?e._registerTestCodeComponentFromUri(u):(c="Invalid extension: '{0}', only allowed on 'localhost'.".format(s),rt.error(c,1),null)})))):Q(null)},t.prototype.unregisterTestExtension=function(n){var t=new p;return t.name=n,this.unregisterTestCodeComponent(t)},t.prototype.listTestExtensions=function(){return this.listTestCodeComponents()},t.prototype.clearTemporaryTestExtensions=function(){this.clearTemporaryTestCodeComponents()},t.create=function(n,r,u,f,e,s){var h=new t(s.value.map((function(n){return o.ExtensionMetadataExt.create(n)})),n,r,u,f.splashScreen,k,i.isDevelopmentMode);return MsPortalImpl.Extension=h,h.registerTestExtensionsFromUri(e.location.href).then((function(){return h}))},t})(e.CodeComponentSideLoadManagerImpl);__decorate([f.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[h.SettingsManager,c.StorageService,l.DialogManager,a.RootElements,a.WindowManager,y]),__metadata("design:returntype",u)],w,"create",null);t.ExtensionMetadataSource=w}));
define("MsPortalImpl/GalleryPackage/GalleryPackageLoader",["require","exports","f","o"],(function(n,t,i,r){"use strict";function h(n){return new u(n)}var u;r.defineProperty(t,"__esModule",{value:!0});var e=i.Base,o=e.Constants,f=o.ExtensionNames,s=i.Services.Rpc;t.initialize=h;u=(function(){function n(n){this._extensionManager=n}return n.prototype.loadGalleryPackages=function(n){if(n&&n.length>0)return this._extensionManager.getExtensionByName(f.Marketplace).then((function(){s.invokeCallback(f.Marketplace,"loadGalleryPackages",n)}))},n})();t.GalleryPackageLoaderImpl=u}));
define("_generated/Less/MsPortalImpl/Interactions/Interactions.KeyboardShortcutHandler.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxs-keyboardshortcuts{padding:0 25px;width:355px}.fxs-keyboardshortcuts-category{margin-top:20px}.fxs-keyboardshortcuts-shortcut{display:-webkit-flex;display:flex}.fxs-keyboardshortcuts-key{-webkit-flex:0 0 auto;flex:0 0 auto;width:98px}")}));
define("MsPortalImpl/Interactions/Interactions.KeyboardShortcutHandler",["require","exports","f","$","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.KeyboardHelper","MsPortalImpl/Base/Telemetry","_generated/Less/MsPortalImpl/Interactions/Interactions.KeyboardShortcutHandler.css"],(function(n,t,i,r,u,f,e,o){"use strict";var s;return (function(t){function it(n){var t=n.isJourneyVisible()&&n.getPanorama();return t&&t.getJourneyWidget()}function a(n){var t=it(n),r=t&&t.getFocusedBlade();return r?r:t&&i.last(t.getBlades())}function rt(n,t,i,r,u){return new v(n,t,i,r,u)}var c=i.Base.Diagnostics,y=c.Telemetry,p=window,l="#blade/HubsExtension/Resources",w=l+"/resourceType/",b="fxs-sidebar-collapse-button",k="fxs-topbar-home",s=f.KeyboardShortcuts,h=s.GoTo,d=c.createLog(n),g=y.trace,nt=[49,50,51,52,53,54,55,56,57,48,],tt=[97,98,99,100,101,102,103,104,105,96,],v;t.setup=rt;v=(function(){function n(n,t,i,r,u){this._disposables=[];this._keyShortcuts={};this._goToShortcuts={};this._errorLoggingFunc=u||function(n){d.error(n)};this._addKeyShortcuts(n);this._addGoToShortcuts(t.router,n);this._registerSpecialShortcut(s.showDiagnostics,i,65);this._registerSpecialShortcut(s.showDebugHelper,r,68);this._registerShortcut(s.moveFavoritesUp,(function(){n.getSideBarWidget().reorderFavorites(38)}),38,5);this._registerShortcut(s.moveFavoritesDown,(function(){n.getSideBarWidget().reorderFavorites(40)}),40,5);this._attachEventHandlers()}return n.prototype.dispose=function(){this._removeEventHandlers()},n.prototype._attachEventHandlers=function(){var t=this,n;this._removeEventHandlers();n=!1;this._disposables.push(r(p.document).setEvents([u.default.keydown,function(i){var u,s=e.getModifierKeys(i),h,f;if(i.keyCode===71&&s===0){n=!0;return}(h=n?t._goToShortcuts[i.keyCode]:t._keyShortcuts[i.keyCode],f=h&&h[s],f)&&((u=r(document.activeElement),u.length>0&&s===0&&(u.is("input")||u.is("textarea")||["azc-editableControl","fxc-editor","fxc-console"].some((function(n){return u.closest("."+n).length>0}))))||(f.handler(),g({source:o.Source.KeyboardShortcuts,action:o.Action.KeyboardShortcutExecuted,name:f.id}),i.preventDefault()))}],[u.default.keyup,function(t){var i=e.getModifierKeys(t);t.keyCode===71&&i===0&&(n=!1)}]))},n.prototype._removeEventHandlers=function(){i.disposeDisposable(this._disposables);this._disposables=[]},n.prototype._registerShortcut=function(n,t,i,r){r===void 0&&(r=0);var u=this._keyShortcuts[i],f=this._generateIdForKeyboardShortcut(i,r),e={description:n,handler:t,id:f};u?u[r]&&this._errorLoggingFunc("Duplicate shortcut: "+f):this._keyShortcuts[i]=[];this._keyShortcuts[i][r]=e},n.prototype._addKeyShortcuts=function(n){this._registerGotoShortcut(s.toggleFocusSideAndTopBar,(function(){var n=r(document).findByClassName(k)[0];r(document.activeElement)[0]===n?r(document).findByClassName(b)[0].focus():n.focus()}),190);this._registerGotoShortcut(s.moveFocusToCommandBar,(function(){var t=a(n),i=t&&t.getContentWidget();i&&i.setFocusOnCommandBar()}),188);this._registerShortcut(s.bladeSearch,(function(){var t=a(n);t&&t.focusSearchBox()}),191,8)},n.prototype._registerGotoShortcut=function(n,t,i){var r=0,u=this._goToShortcuts[i],f=this._generateIdForKeyboardShortcut(i,r,!0),e={description:n,handler:t,id:f};u?u[r]&&this._errorLoggingFunc("Duplicate goto shortcut: "+f):this._goToShortcuts[i]=[];this._goToShortcuts[i][r]=e},n.prototype._registerSpecialShortcut=function(n,t,i){r.isFunction(t)&&this._registerShortcut(n,t,i,9)},n.prototype._addGoToShortcuts=function(n,t){var r=this,i;this._registerGotoShortcut(s.browse,(function(){t.getSideBarWidget().toggleFlyout()}),66);this._registerGotoShortcut(s.new,(function(){t.getSideBarWidget().openCreate()}),78);this._registerGotoShortcut(s.search,(function(){t.getSearchWidget().setFocus()}),191);[[h.allResources,l,65],[h.resourceGroups,w+"Microsoft.Resources%2Fsubscriptions%2FresourceGroups",82],].forEach((function(t){r._registerGotoShortcut(t[0],(function(){n.route(t[1])}),t[2])}));this._registerGotoShortcut(h.dashboard,(function(){t.handleStartButtonClick()}),68);i=function(n,i){var u=i+1;r._registerGotoShortcut(h.sideBarItem+u,(function(){t.options.sideBarViewModel.openFavorite(i)}),n)};nt.forEach(i);tt.forEach(i)},n.prototype._generateIdForKeyboardShortcut=function(n,t,i){i===void 0&&(i=!1);var r=i?"G+":"";return t>15&&this._errorLoggingFunc("Not allowed modifier!"),t&8&&(r+="CTRL+"),t&1&&(r+="ALT+"),t&2&&(r+="WIN/CMD+"),r+e.mapKeyCodeToString((t&4)==4,n)},n.prototype.getShortcuts=function(){return{key:this._keyShortcuts,goTo:this._goToShortcuts}},n})()})(s||(s={})),s}));
define("MsPortalImpl/Interactions/Interactions.PortalReader",["require","exports","f","o","MsPortalImpl/Base/Base.Timers"],(function(n,t,i,r,u){"use strict";function s(n){if(o)throw new Error("Interactions.PortalReader cannot be initialized twice");else o=!0,$(n).append(e)}function h(){e.remove();o=!1}function c(n,t,r){var e,u,f;return r===void 0&&(r=""),n=(n||"").trim(),n?(e=a(r),u={active:!0,msg:n,msgElem:null},e.queue.push(u),e.act(),f=function(){u&&(u.active=!1,u.msgElem&&(u.msgElem.remove(),u.msgElem=null),u=null)},t===0?setTimeout(f,2e3):t===1&&setTimeout(f,5e3),f):i.noop}function a(n){var t=f[n];return t||(t={queue:[],act:u.debounce((function(){for(var u,o=t.queue,i=null,r=o.length-1;r>=0;--r)if(u=o[r],u.active){i=u;break}i&&e.append(i.msgElem=$("<div/>").text(i.msg));t.queue=null;t.act=null;f[n]=null}),l)},f[n]=t),t}var f;r.defineProperty(t,"__esModule",{value:!0});t.initialize=s;t.shutdown=h;t.read=c;var e=$("<div class='fxs-hide-accessible-label' aria-live='polite' aria-relevant='additions' />"),l=500,o=!1;f={}}));
define("_generated/Less/MsPortalImpl/Parts/Parts.ButtonPart.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxs-part-buttonpart-assetname,.fxs-tilesize-mini .fxs-part-buttonpart-title.fxs-should-use-single-line,.fxs-tilesize-small .fxs-part-buttonpart-title.fxs-should-use-single-line,.fxs-tilesize-wide .fxs-part-buttonpart-title{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.fxs-part-buttonpart{height:100%;width:100%;box-sizing:border-box}.fxs-part-buttonpart-inner{display:-webkit-flex;display:flex;height:100%;box-sizing:border-box;text-align:center;-webkit-align-items:center;align-items:center;-webkit-flex-direction:column;flex-direction:column}.fxs-part-buttonpart-inner-pad{padding-top:28px}.fxs-part-buttonpart-iconcontainer{-webkit-flex:0 0 auto;flex:0 0 auto;box-sizing:border-box}.fxs-part-buttonpart-iconcontainer>img,.fxs-part-buttonpart-iconcontainer>svg{height:50px;width:50px}.fxs-part-buttonpart-textcontainer{width:100%;font-size:12px;line-height:18px}.fxs-part-buttonpart-assetname{margin:0;font-family:az_ea_font,\"Segoe UI\",wf_segoe-ui_semibold,\"Segoe UI Semibold\",\"Segoe WP Semibold\",\"Segoe WP\",Tahoma,Arial,sans-serif;font-weight:600;font-size:10px;line-height:10px;text-transform:uppercase}.fxs-part-buttonpart-titlecontainer{margin:10px 0 5px;display:-webkit-flex;display:flex;-webkit-flex-flow:row nowrap;flex-flow:row nowrap;-webkit-align-items:flex-start;align-items:flex-start;-webkit-justify-content:center;justify-content:center}.fxs-tilesize-mini .fxs-part-buttonpart-titlecontainer,.fxs-tilesize-small .fxs-part-buttonpart-titlecontainer,.fxs-tilesize-wide .fxs-part-buttonpart-titlecontainer{margin:0}.fxs-part-buttonpart-title{position:relative;margin:0;overflow:hidden;text-overflow:ellipsis;max-height:36px}.fxs-part-buttonpart-title::after,.fxs-part-buttonpart-title::before,.fxs-tilesize-mini .fxs-part-buttonpart-title.fxs-can-use-multiline::after,.fxs-tilesize-mini .fxs-part-buttonpart-title.fxs-can-use-multiline::before,.fxs-tilesize-small .fxs-part-buttonpart-title.fxs-can-use-multiline::after,.fxs-tilesize-small .fxs-part-buttonpart-title.fxs-can-use-multiline::before{position:absolute;background-color:inherit}.fxs-part-buttonpart-title::before{content:'\\02026';top:18px;right:0}.fxs-part-buttonpart-title::after{content:'';height:100%;width:100%}.fxs-tilesize-mini .fxs-part-buttonpart-iconcontainer>img,.fxs-tilesize-mini .fxs-part-buttonpart-iconcontainer>svg,.fxs-tilesize-small .fxs-part-buttonpart-iconcontainer>img,.fxs-tilesize-small .fxs-part-buttonpart-iconcontainer>svg{height:30px;width:30px}.fxs-tilesize-small .fxs-part-buttonpart-inner,.fxs-tilesize-wide .fxs-part-buttonpart-inner{padding-top:0;text-align:left;-webkit-flex-direction:row;flex-direction:row}.fxs-tilesize-small .fxs-part-buttonpart-iconcontainer,.fxs-tilesize-wide .fxs-part-buttonpart-iconcontainer{display:-webkit-flex;display:flex;-webkit-align-items:center;align-items:center}.fxs-tilesize-small .fxs-part-buttonpart-iconcontainer>img,.fxs-tilesize-small .fxs-part-buttonpart-iconcontainer>svg,.fxs-tilesize-wide .fxs-part-buttonpart-iconcontainer>img,.fxs-tilesize-wide .fxs-part-buttonpart-iconcontainer>svg{-webkit-flex:0 0 auto;flex:0 0 auto}.fxs-tilesize-small .fxs-part-buttonpart-titlecontainer,.fxs-tilesize-wide .fxs-part-buttonpart-titlecontainer{-webkit-justify-content:flex-start;justify-content:flex-start}.fxs-tilesize-small .fxs-part-buttonpart-textcontainer,.fxs-tilesize-wide .fxs-part-buttonpart-textcontainer{-webkit-flex:0 1 auto;flex:0 1 auto;display:-webkit-flex;display:flex;-webkit-flex-direction:column;flex-direction:column;-webkit-justify-content:center;justify-content:center}.fxs-tilesize-mini{font-size:12px;line-height:normal}.fxs-tilesize-mini .fxs-part-buttonpart-inner{padding-top:5px}.fxs-tilesize-mini .fxs-part-buttonpart-title.fxs-can-use-multiline{overflow:hidden;text-overflow:ellipsis;max-height:32px;line-height:15px}.fxs-tilesize-mini .fxs-part-buttonpart-title.fxs-can-use-multiline::before{content:'\\02026';top:16px;right:0}.fxs-tilesize-mini .fxs-part-buttonpart-title.fxs-can-use-multiline::after{content:'';height:100%;width:100%}.fxs-tilesize-small .fxs-part-buttonpart-iconcontainer{width:51px;padding-left:6px}.fxs-tilesize-small .fxs-part-buttonpart-textcontainer{width:calc(100% - 51px)}.fxs-tilesize-small .fxs-part-buttonpart-title.fxs-can-use-multiline{overflow:hidden;text-overflow:ellipsis;max-height:36px}.fxs-tilesize-small .fxs-part-buttonpart-title.fxs-can-use-multiline::before{content:'\\02026';top:18px;right:0}.fxs-tilesize-small .fxs-part-buttonpart-title.fxs-can-use-multiline::after{content:'';height:100%;width:100%}.fxs-tilesize-wide .fxs-part-buttonpart-iconcontainer{width:85px;padding-left:15px}.fxs-tilesize-wide .fxs-part-buttonpart-textcontainer{width:calc(100% - 85px)}.fxs-tilesize-wide .fxs-part-buttonpart-assetname{padding-top:2px}.fxs-tilesize-wide .fxs-part-buttonpart-desc{display:block;margin-top:10px;position:relative;overflow:hidden;text-overflow:ellipsis;max-height:90px}.fxs-tilesize-wide .fxs-part-buttonpart-desc::after,.fxs-tilesize-wide .fxs-part-buttonpart-desc::before{position:absolute;background-color:inherit}.fxs-tilesize-wide .fxs-part-buttonpart-desc::before{content:'\\02026';top:72px;right:0}.fxs-tilesize-wide .fxs-part-buttonpart-desc::after{content:'';height:100%;width:100%}.fxs-part-buttonpart-externallink{height:12px;width:12px;margin-left:3px;margin-top:2px}.fxs-part-buttonpart-externallink>img,.fxs-part-buttonpart-externallink>svg{height:12px;width:12px}.fxs-part-buttonpart,.fxs-part-buttonpart .fxs-part-buttonpart-desc,.fxs-part-buttonpart .fxs-part-buttonpart-inner,.fxs-part-buttonpart .fxs-part-buttonpart-textcontainer,.fxs-part-buttonpart .fxs-part-buttonpart-title,.fxs-part-buttonpart .fxs-part-buttonpart-titlecontainer{background-color:inherit}html[lang^=ja] .fxs-tilesize-mini .fxs-part-buttonpart .fxs-part-buttonpart-title,html[lang^=ko] .fxs-tilesize-mini .fxs-part-buttonpart .fxs-part-buttonpart-title,html[lang^=zh] .fxs-tilesize-mini .fxs-part-buttonpart .fxs-part-buttonpart-title{font-size:11px;line-height:11px}")}));
define("MsPortalImpl/Parts/Parts.ButtonPart",["require","exports","f","ko","MsPortalImpl/Parts/Parts","FxInternal/Composition/ViewModel","_generated/Less/MsPortalImpl/Parts/Parts.ButtonPart.css"],(function(n,t,i,r,u,f){"use strict";var e;return (function(n){var t=i.getUniqueId(),e;n.template="<div class='fxs-part-buttonpart'><div class='fxs-part-buttonpart-inner'><div class='fxs-part-buttonpart-iconcontainer' data-bind='image: icon, css: { \"fxs-part-buttonpart-inner-pad\": _showTopPadding() }'><\/div><div class='fxs-part-buttonpart-textcontainer'><div class='fxs-part-buttonpart-titlecontainer'><h3 class='fxs-part-buttonpart-title msportalfx-tooltip-overflow' "+('data-bind=\'text: _displayTitle, css: { "fxs-should-use-single-line": _assetNameVisible(), "fxs-can-use-multiline": !_assetNameVisible() }\' aria-describedby='+t+"><\/h3>")+"<!-- ko if: _isExternalLink --><div class='fxs-part-buttonpart-externallink azc-fill-heavy' data-bind='image: _hyperlinkSvg, attr: { \"aria-label\": _clickableLinkUri }'><\/div><!-- /ko --><\/div>"+("<div data-bind='text: _assetName, visible: _assetName() && (_assetNameVisible())' class='fxs-part-buttonpart-assetname msportalfx-tooltip-overflow' id="+t+"><\/div>")+"<div data-bind='text: description, visible: ((_size() === MsPortalFx.Parts.PartSize.Wide) && description())' class='fxs-part-buttonpart-desc msportalfx-tooltip-overflow'><\/div><\/div><\/div><\/div>";e=(function(t){function u(){var i=t!==null&&t.apply(this,arguments)||this;return i.template=n.template,i}return __extends(u,t),u.prototype._getContentForBinding=function(n,u){var l=this,o=u.content,s=u.container,e=s.clickableLink,a=function(n){return n.target()==="_self"||n.uri&&i.startsWith(n.uri(),"#")&&n.target()==="auto"},v=r.observable(!!e&&!a(e)),y,h,c;return r.computed(n,(function(){l.ariaLabel(o.title())})),y=e&&e.target,y&&y.subscribe(n,(function(){v(!a(e))})),h=e&&e.uri,h&&h.subscribe(n,(function(){v(!a(e))})),c=f.isV2(o)?function(){return l._options.size()}:function(){return o.size&&o.size()},i.extend2(t.prototype._getContentForBinding.call(this,n,u),{_displayTitle:r.computed(n,(function(){var n=c(),t=o.title();return n===0||n===1?o.shortTitle()||t:t})),_assetName:s.assetName,_isExternalLink:v,_clickableLinkUri:h,_hyperlinkSvg:i.Base.Images.Hyperlink({isLogo:!0}),_assetNameVisible:r.computed(n,(function(){return!l.inContainerOfSameAsset()&&s.assetName()})),_showTopPadding:r.computed(n,(function(){return c()===2&&!s.partTitle()})),_size:r.computed(n,c)})},u})(u.PartImpl);n.ButtonPart=e})(e||(e={})),e}));
define("_generated/Less/MsPortalImpl/Parts/Parts.Collection.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,'.fxs-part-collectionpart .azc-grid table td.azc-grid-cell:first-of-type,.fxs-part-collectionpart .azc-grid table thead tr th:first-child a{padding-left:15px}.fxs-part-collectionpart-more-data,.fxs-part-collectionpart-rollup-count{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe WP",Tahoma,Arial,sans-serif;font-weight:600}.fxs-part-collectionpart .azc-grid table thead tr th{height:28px;line-height:28px;border-top-width:1px;border-top-style:solid}.fxs-part-collectionpart .azc-grid table thead tr th>a{line-height:normal}.fxs-part-collectionpart .azc-grid table tbody tr td{height:27px}.fxs-part-collectionpart .azc-grid table td:last-child,.fxs-part-collectionpart .azc-grid table td:last-of-type{padding-right:15px}.fxs-part-collectionpart .azc-grid table .azc-grid-resizableColumn-handle{height:28px}.fxs-part-collectionpart .fxs-part-collectionpart-rollup-container{display:none}.fxs-part-collectionpart.fxs-part-collectionpart-rollup-forceshow .fxs-part-collectionpart-rollup-container{display:block}.fxs-part-collectionpart-more-data{font-size:12px;line-height:24px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;position:absolute;right:0}.fxs-part-collectionpart-more-data:hover{text-decoration:underline}.fxs-part-collectionpart-rollup-container{margin:-6px 0 6px}.fxs-part-collectionpart-rollup-count{font-size:30px;line-height:30px;letter-spacing:-.025em}.fxs-part-collectionpart-rollup-label{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_bold,"Segoe UI Bold","Segoe WP Bold","Segoe WP",Tahoma,Arial,sans-serif;font-weight:700;font-size:15px;line-height:15px;letter-spacing:-.02em;margin-left:4px}.fxs-part-collectionpart-part-title{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe WP",Tahoma,Arial,sans-serif;font-weight:600;font-size:10px;line-height:10px;text-transform:uppercase;margin:5px 0 0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:none}.fxs-part-collectionpart-rollup-icon{width:21px;height:21px;margin-left:4px;display:inline-block}.fxs-tilesize-mini .fxs-part-collectionpart .fxs-part-collectionpart-rollup-container,.fxs-tilesize-small .fxs-part-collectionpart .fxs-part-collectionpart-rollup-container{display:block;margin:0}.fxs-tilesize-mini .fxs-part-collectionpart .fxs-part-collectionpart-rollup-label,.fxs-tilesize-small .fxs-part-collectionpart .fxs-part-collectionpart-rollup-label{display:none}.fxs-tilesize-mini .fxs-part-collectionpart .fxs-part-collectionpart-rollup-count,.fxs-tilesize-small .fxs-part-collectionpart .fxs-part-collectionpart-rollup-count{line-height:25px}.fxs-tilesize-mini .fxs-part-collectionpart .fxs-part-collectionpart-no-rollup-count,.fxs-tilesize-small .fxs-part-collectionpart .fxs-part-collectionpart-no-rollup-count{width:30px;height:30px;margin-left:0}.fxs-tilesize-mini .fxs-part-collectionpart{text-align:center;padding:5px 6px 0}.fxs-tilesize-mini .fxs-part-collectionpart .fxs-part-collectionpart-part-title{display:block}.fxs-tilesize-small .fxs-part-collectionpart{float:right;margin-top:-15px}html[lang^=ja] .fxs-part-collectionpart .fxs-part-collectionpart-part-title,html[lang^=ko] .fxs-part-collectionpart .fxs-part-collectionpart-part-title,html[lang^=zh] .fxs-part-collectionpart .fxs-part-collectionpart-part-title{font-size:11px;line-height:11px}')}));
define("MsPortalImpl/Parts/Parts.Collection",["require","exports","f","ko","$","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Parts/Parts","MsPortalImpl/Resources/ImplScriptResources","_generated/Less/MsPortalImpl/Parts/Parts.Collection.css"],(function(n,t,i,r,u,f,e,o){"use strict";var s;return (function(n){var t=o.Parts,s='<div class="fxs-part-collectionpart" data-bind="css: {\'fxs-part-collectionpart-rollup-forceshow\': alwaysShowRollupCount()}"><div class="fxs-part-collectionpart-rollup-container"><span class="fxs-part-collectionpart-rollup-count" data-bind="text: rollupCount, visible: !noRollupCount()"><\/span><span class="fxs-part-collectionpart-rollup-label" data-bind="text: rollupCountLabel"><\/span><img class="fxs-part-collectionpart-rollup-icon" data-bind="attr: { src: rollupCountIconUri }, visible: rollupCountIconUri, css: {\'fxs-part-collectionpart-no-rollup-count\': noRollupCount }" alt=""/><div class="fxs-part-collectionpart-rollup-icon" data-bind="image: rollupCountIcon, visible: rollupCountIcon, css: {\'fxs-part-collectionpart-no-rollup-count\': noRollupCount }"><\/div><h4 class="fxs-part-collectionpart-part-title fxs-display-none" data-bind="text: _partTitle"><\/h4><\/div><!-- ko if: emptyGrid() && noRowsHtml() --><div class="fxs-part-collectionpart-norowshtml fxs-display-none" data-bind="pcControl: noRowsHtml"><\/div><!-- /ko --><!-- ko if: !emptyGrid() || !noRowsHtml() --><!-- ko if: !!gridMode() --><div data-bind="pcGrid: grid" class="msportalfx-removepartpaddingside"><\/div>'+('<a href="#" class="fxs-part-collectionpart-more-data fxs-portal-text-primary" tabindex="0" data-bind="visible: hasMoreData">'+i.encodeHtml(t.more)+"<\/a>")+"<!-- /ko --><!-- /ko --><\/div>",h=(function(n){function t(t,i,r,f){var e=n.call(this,t,i,r,f)||this,o;e.template=s;o=e._container=u(t);o.on("click keydown","a.fxs-part-collectionpart-more-data",(function(n){n.preventDefault();n.stopPropagation();var t=u.Event(n.type);t.keyCode=n.keyCode;u(n.delegateTarget).trigger(t)}));return e}return __extends(t,n),t.prototype._getContentForBinding=function(n,t){var u=this._container.findByClassName("fxs-part-collectionpart-part-title"),e=this._container.findByClassName("fxs-part-collectionpart-norowshtml");return r.computed(n,(function(){var n=t.content.size();f.toggle(u,n!==0||!!t.container.partTitle());f.toggle(e,n!==0&&n!==1)})),i.extend2(t.content,{_partTitle:t.container.partTitle})},t})(e.PartImpl);n.CollectionPart=h})(s||(s={})),s}));
define("_generated/Less/MsPortalImpl/Parts/Parts.ItemSummary.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxpart-itemsummary{height:100%;background:#00f;display:block;color:#fff}.fxpart-itemsummary-name{font-size:19px;padding:20px;text-transform:uppercase}.fxpart-itemsummary-sourceControl{font-size:16px;padding:0 20px}")}));
define("_generated/Less/MsPortalImpl/Parts/Parts.PricingTier.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".msportalfx-pricingTier .msportalfx-tooltip-overflow{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.msportalfx-pricingTier .msportalfx-pricingTier-normal-iconContainer,.msportalfx-pricingTier .msportalfx-pricingTier-wide-iconContainer{height:55px;border-bottom:1px solid #dcdfe2}.msportalfx-pricingTier .msportalfx-pricingTier-textContainer{margin-top:10px}.msportalfx-pricingTier .msportalfx-pricingTier-textContainer .msportalfx-pricingTier-specCode{float:left;margin-right:8px;max-width:100px}.msportalfx-pricingTier .msportalfx-pricingTier-textContainer .msportalfx-pricingTier-promotedFeatures{line-height:12px;padding-top:4px}.msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-float .msportalfx-pricingTier-icon{width:30px;height:30px;margin-top:1.7em}.msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-float .msportalfx-pricingTier-icon.msportalfx-pricingTier-icon-small{margin-top:-.15em}.fxs-tilesize-wide .msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-inlineblock{padding-top:10px}.fxs-tilesize-wide .msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-inlineblock .msportalfx-pricingTier-icon{width:30px;height:30px;margin-right:15px}.fxs-tilesize-normal .msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-inlineblock{padding-top:18px}.fxs-tilesize-normal .msportalfx-pricingTier .msportalfx-layoutChildren-horizontal-inlineblock .msportalfx-pricingTier-icon{width:20px;height:20px;margin-right:5px}.fxs-tilesize-small .msportalfx-pricingTier .msportalfx-pricingTier-textContainer{margin-top:-12px}.fxs-tilesize-mini .msportalfx-pricingTier .msportalfx-pricingTier-specCode,.fxs-tilesize-mini .msportalfx-pricingTier .msportalfx-pricingTier-specTitle{text-align:center;float:initial}")}));
define("_generated/Less/MsPortalImpl/Parts/Parts.SpecPicker.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,'.msportalfx-specpicker-footer-value,.msportalfx-specpicker-header .msportalfx-specpicker-header-specCode,.msportalfx-specpicker-table .msportalfx-specpicker-feature-name,.msportalfx-specpicker-table .msportalfx-specpicker-feature-value{font-family:az_ea_font,"Segoe UI",wf_segoe-ui_semibold,"Segoe UI Semibold","Segoe WP Semibold","Segoe WP",Tahoma,Arial,sans-serif;font-weight:600}.msportalfx-specpicker{width:175px;height:320px;position:relative;border-color:inherit}.msportalfx-specpicker:after,.msportalfx-specpicker:before{content:"";position:absolute;z-index:-1;top:10px;bottom:10px;left:0;right:0;border-radius:10px}.msportalfx-specpicker:after{right:10px;left:auto;transform:skew(8deg) rotate(3deg)}.msportalfx-specpicker .msportalfx-specpicker-table{table-layout:auto}.msportalfx-specpicker ul{list-style-type:none;padding:0}.msportalfx-specpicker .msportalfx-tooltip-overflow{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.fxs-mode-dark .msportalfx-specpicker{box-shadow:0 1px 4px rgba(255,255,255,.3),0 0 40px rgba(255,255,255,.1) inset}.fxs-mode-dark .msportalfx-specpicker:after,.fxs-mode-dark .msportalfx-specpicker:before{box-shadow:0 0 20px rgba(255,255,255,.8)}.fxs-mode-light .msportalfx-specpicker{box-shadow:0 1px 4px rgba(0,0,0,.3),0 0 40px rgba(0,0,0,.1) inset}.fxs-mode-light .msportalfx-specpicker:after,.fxs-mode-light .msportalfx-specpicker:before{box-shadow:0 0 20px rgba(0,0,0,.8)}.msportalfx-specpicker-star{width:14px;height:14px;fill:#ffb900;stroke:#000;stroke-width:1px;float:right;margin-right:4px;margin-top:1px}.msportalfx-specpicker-header{color:#fff;font-size:14px;height:26px;line-height:26px}.msportalfx-specpicker-header .msportalfx-specpicker-header-specCode{text-transform:uppercase;padding-left:11px}.msportalfx-specpicker-header .msportalfx-specpicker-header-title{padding-left:6px}.msportalfx-specpicker-header-text{fill:#ffb900;stroke:#000;stroke-width:1px;width:161px;position:absolute}.msportalfx-specpicker>.msportalfx-mediumBlue .msportalfx-specpicker-shade1{background-color:#4668c5}.msportalfx-specpicker>.msportalfx-mediumBlue .msportalfx-specpicker-shade2{background-color:rgba(70,104,197,.2)}.msportalfx-specpicker>.msportalfx-mediumBlue .msportalfx-specpicker-shade3{background-color:rgba(70,104,197,.1)}.msportalfx-specpicker>.msportalfx-darkOrchid .msportalfx-specpicker-shade1{background-color:#8a2da5}.msportalfx-specpicker>.msportalfx-darkOrchid .msportalfx-specpicker-shade2{background-color:rgba(138,45,165,.2)}.msportalfx-specpicker>.msportalfx-darkOrchid .msportalfx-specpicker-shade3{background-color:rgba(138,45,165,.1)}.msportalfx-specpicker>.msportalfx-yellowGreen .msportalfx-specpicker-shade1{background-color:#578000}.msportalfx-specpicker>.msportalfx-yellowGreen .msportalfx-specpicker-shade2{background-color:rgba(87,128,0,.2)}.msportalfx-specpicker>.msportalfx-yellowGreen .msportalfx-specpicker-shade3{background-color:rgba(87,128,0,.1)}.msportalfx-specpicker>.msportalfx-orange .msportalfx-specpicker-shade1{background-color:#c40}.msportalfx-specpicker>.msportalfx-orange .msportalfx-specpicker-shade2{background-color:rgba(204,68,0,.2)}.msportalfx-specpicker>.msportalfx-orange .msportalfx-specpicker-shade3{background-color:rgba(204,68,0,.1)}.msportalfx-specpicker-table{table-layout:auto;width:100%;border-collapse:collapse}.msportalfx-specpicker-table .msportalfx-specpicker-feature-name{font-size:12px;margin-left:6px}.msportalfx-specpicker-table .msportalfx-specpicker-feature-value{font-size:17px}.msportalfx-specpicker-row td{white-space:nowrap;padding:0}.msportalfx-specpicker-row td .msportalfx-specpicker-cell{height:30px;line-height:30px}.msportalfx-specpicker-row td.msportalfx-specpicker-right{overflow:hidden;text-overflow:ellipsis;max-width:1px;width:100%}.msportalfx-specpicker-row.msportalfx-specpicker-promotedFeatures td{padding-bottom:1px}.msportalfx-specpicker-row.msportalfx-specpicker-borderBottom td{border-bottom:1px solid #e9e9f3}.msportalfx-specpicker-row .msportalfx-specpicker-left{text-align:center;min-width:39px}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-feature-value{font-size:12px;padding-top:6px;margin-left:6px;line-height:normal}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-feature-name{font-size:10px;line-height:normal;margin-top:-3px}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-mutipleline .msportalfx-specpicker-feature-value{padding-top:1px}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-left .msportalfx-specpicker-cell{min-width:29px;text-align:center}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-left .msportalfx-specpicker-cell img{width:22px;height:22px;margin-top:8px}.msportalfx-specpicker-extendedFeatures .msportalfx-specpicker-left .msportalfx-specpicker-cell div{width:20px;height:20px;padding-top:5px;padding-left:0;display:inline-block}.msportalfx-specpicker-footer-container{position:absolute;bottom:0;left:0;right:0;height:46px;text-align:right}.msportalfx-specpicker-footer{margin-right:10px;margin-bottom:8px;background-color:inherit}.msportalfx-specpicker-footer-value{margin-top:6px;text-transform:uppercase;font-size:22px;line-height:22px;letter-spacing:-.025em}.msportalfx-specpicker-footer-details{font-size:10px;line-height:14px;text-transform:uppercase}.msportalfx-specpicker-footer-channelMessage,.msportalfx-specpicker-footer-statusMessage{margin-left:5px;margin-right:5px;font-size:11px;text-align:left}.msportalfx-specpicker-footer-statusMessage{margin-top:25px}.msportalfx-specpicker-footer-channelMessage{margin-top:10px;position:absolute;background-color:inherit;white-space:normal;overflow:hidden;text-overflow:ellipsis;max-height:32px}.msportalfx-specpicker-footer-channelMessage::after,.msportalfx-specpicker-footer-channelMessage::before{position:absolute;background-color:inherit}.msportalfx-specpicker-footer-channelMessage::before{content:\'\\02026\';top:16px;right:0}.msportalfx-specpicker-footer-channelMessage::after{content:\'\';height:100%;width:100%}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker{background-color:rgba(189,189,189,.05)}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-header{background-color:#bdbdbd}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-promotedFeatures .msportalfx-specpicker-left .msportalfx-specpicker-cell{background-color:rgba(189,189,189,.2)}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-promotedFeatures .msportalfx-specpicker-right .msportalfx-specpicker-cell{background-color:rgba(189,189,189,.1)}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-footer-container{background-color:#dedede}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-feature-name,.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-feature-value,.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-footer-value{color:#bdbdbd}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-disable-blockui-shield{position:absolute;top:0;left:0;bottom:0;right:0}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-disable-message-anchor{position:absolute;text-align:center;left:15px;right:15px;top:40%}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-disable-message-anchor .msportalfx-specpicker-disable-message-container{display:inline-block;background-color:rgba(50,56,63,.8);margin-top:20px;padding:15px 10px;width:100%;box-sizing:border-box}.azc-listView-item[aria-disabled=true] .msportalfx-specpicker-disable-message-anchor .msportalfx-specpicker-disable-message-container .msportalfx-specpicker-disable-message{display:inline}.ext-hubs-specPickerGrid-container{height:100%;overflow:hidden;display:flex;flex-direction:column}.ext-hubs-specPicker-container{width:100%;min-height:100%}.ext-hubs-specPicker-container .ext-hubs-specPicker-filtersContainer.ext-hubs-specPicker-filtersContainer{margin-top:0;padding-top:5px}.ext-hubs-specPicker-container .msportalfx-specpicker-viewOptionsContainer{height:25px;padding-top:5px;padding-right:15px}.ext-hubs-specPicker-container .msportalfx-specpicker-viewOptions{font-size:14px;float:right}.ext-hubs-specPicker-container .msportalfx-specpicker-viewOptions .msportalfx-specpicker-recommendationsIcon{width:14px;height:14px;display:inline-block}.ext-hubs-specPicker-container .msportalfx-specpicker-viewOptions .fxc-hotspot.fxc-hotspot-selected{cursor:default;background-color:inherit}.ext-hubs-specPicker-container .msportalfx-specpicker-viewOptions .fxc-hotspot.fxc-hotspot-clickable{color:#0058ad;fill:#0058ad}.ext-hubs-specPicker-container .ext-hubs-specPicker-content{height:100%}.ext-hubs-specPicker-container .ext-hubs-specPicker-message{margin-top:0;border-left:6px solid #ffb900;padding:15px;white-space:pre-wrap}.ext-hubs-specPicker-container .ext-hubs-specPicker-listView{margin-left:19px}.ext-hubs-specPicker-container .fxc-hotspot{outline:0;padding:5px}.ext-hubs-specPicker-container .fxc-hotspot:focus{outline-style:dotted;outline-width:1px}')}));
define("MsPortalImpl/Parts/Parts.Intrinsics",["require","exports","f","o","MsPortalImpl/Parts/Parts","_generated/Less/MsPortalImpl/Parts/Parts.ItemSummary.css","_generated/Less/MsPortalImpl/Parts/Parts.SpecPicker.css","_generated/Less/MsPortalImpl/Parts/Parts.PricingTier.css"],(function(n,t,i,r,u){"use strict";r.defineProperty(t,"__esModule",{value:!0});var f=i.Parts.PartKind,c=0,s=1,o=2,e=3,l=10,a=4,v=5,y=6,b=7,p=8,k=9,h="<div data-bind='{0}: $root'><\/div>",w={defaultSize:p,supportedSizes:[p],viewStateProperties:["content.selection.selectedItems","content.selection.activatedItems"]};t.parts=[{kind:f.Asset,factory:u.createAmdPartFactory("MsPortalImpl/Parts/Parts.Asset",(function(n,t,i,r,u){return new n.AssetPart(t,i,r,u)}),{defaultSize:s,supportedSizes:[c,s,o]})},{kind:f.Button,factory:u.createAmdPartFactory("MsPortalImpl/Parts/Parts.ButtonPart",(function(n,t,i,r,u){return new n.ButtonPart(t,i,r,u)}),{supportedSizes:[c,s,o,e,]})},{kind:f.Chart,factory:u.createAmdPartFactory("MsPortalImpl/Parts/Parts.Chart",(function(n,t,i,r,u){return new n.Chart(t,i,r,u)}),{supportedSizes:[s,o,a,e,l,v,y,b,p,k,]})},{kind:f.Collection,factory:u.createAmdPartFactory("MsPortalImpl/Parts/Parts.Collection",(function(n,t,i,r,u){return new n.CollectionPart(t,i,r,u)}),{supportedSizes:[c,s,o,e,a,l,v,y,b,k,p,]})},{kind:f.CollectionSummary,factory:u.createAmdPartFactory("MsPortalImpl/Parts/Parts.CollectionSummary",(function(n,t,i,r,u){return new n.Part(t,i,r,u)}),{supportedSizes:[c,s,o,e]})},{kind:f.DiffEditor,factory:u.createPartFactory(h.format("pcDiffEditor"))},{kind:f.Donut,factory:u.createAmdPartFactory("MsPortalImpl/Parts/Parts.Donut",(function(n,t,i,r,u){return new n.Donut(t,i,r,u)}),{supportedSizes:[o,v,e,l,a,y,]})},{kind:f.Editor,factory:u.createPartFactory(h.format("pcEditor"))},{kind:f.Grid,factory:u.createPartFactory(h.format("pcGrid"),{viewStateProperties:["content.selectableData.selectedItems","content.selectableData.activatedItems","content.selectableData.itemsWithChildEdits"]})},{kind:f.InfoList,factory:u.createAmdPartFactory("MsPortalImpl/Parts/Parts.InfoList",(function(n,t,i,r,u){return new n.InfoListPart(t,i,r,u)}),w)},{kind:f.ItemSummary,factory:u.createPartFactory("<div class='fxpart-itemsummary'><div class='fxpart-itemsummary-name' data-bind='text: name'><\/div><\/div>")},{kind:f.LogStream,factory:u.createPartFactory(h.format("pcLogStream"))},{kind:f.Properties,factory:u.createAmdPartFactory("MsPortalImpl/Parts/Parts.Properties",(function(n,t,i,r,u){return new n.PropertiesPart(t,i,r,u)}),w)},{kind:f.Provisioning,factory:u.createAmdPartFactory("MsPortalImpl/Parts/Parts.Provisioning",(function(n,t,i,r,u){return new n.ProvisioningPart(t,i,r,u)}),{supportedSizes:[o,e,]})},{kind:f.QuickStart,factory:u.createAmdPartFactory("MsPortalImpl/Parts/Parts.QuickStart",(function(n,t,i,r,u){return new n.QuickStartPart(t,i,r,u)}),{defaultSize:s,supportedSizes:[c,s,o,e,]})},{kind:f.QuotaGauge,factory:u.createAmdPartFactory("MsPortalImpl/Parts/Parts.QuotaGauge",(function(n,t,i,r,u){return new n.QuotaGauge(t,i,r,u)}),{supportedSizes:[o,l,e,a,y,v,]})},{kind:f.ResourceSummary,factory:u.createAmdPartFactory("MsPortalImpl/Parts/Parts.ResourceSummary",(function(n,t,i,r,u){return new n.ResourceSummaryPart(t,i,r,u)}),w)},{kind:f.Settings,factory:u.createPartFactory(h.format("pcSettings"),{defaultSize:e,supportedSizes:[e]})},{kind:f.SingleSetting,factory:u.createPartFactory(h.format("pcSingleSetting"))},{kind:f.SingleValueGauge,factory:u.createAmdPartFactory("MsPortalImpl/Parts/Parts.SingleValueGauge",(function(n,t,i,r,u){return new n.SingleValueGauge(t,i,r,u)}),{supportedSizes:[o,l,e,a]})},{kind:f.Unavailable,factory:u.createPartFactory("<div><\/div>")},];t.parts.forEach((function(n){u.registerFactory(f[n.kind],n.factory)}))}));
define("MsPortalImpl/Services/Services.AssetTypes",["require","exports","f","i","o","a","ko","FxInternal/Di","FxHubs/RpcEndPoints","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.ItemCache","MsPortalImpl/Base/Base.Router","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/Extension/ExtensionManager","MsPortalImpl/Services/Services.PortalIdentity"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){"use strict";function er(n){bt.push(n)}function tt(n){return pt(n)||wt(n)}function ot(n){return tt(n)||ii(n)}function ou(n,t){return pt(n)&&pt(t)&&gr(n,t)}function su(n,t){return wt(n)&&wt(t)&&nu(n,t)}function hu(n,t){return ii(n)&&ii(t)&&tu(n,t)}function fi(n,t){return ou(n,t)||su(n,t)||hu(n,t)}function cu(n,t){return n===et.ExtensionNames.Billing&&t===yt.SubscriptionDetail}function ei(n){return rr(n).toLowerCase()}function or(n,t){return ir(n)&&ir(t)?k.compareResourceManagerId(n,t):i.deepEquals(n,t)}function oi(n,t){var i=t;return(n&1)!=1||i.startsWith("/subscriptions/")||(i="/subscriptions/"+t),i}function sr(n,t){var i=si(n);return!!(i&&(typeof t.assetId=="string"||i.mappingViewModel))}function hr(n){return pt(n)?st.Subscriptions:wt(n)?st.ResourceGroups:rr(n)}function lu(n,t,i){return i&&i.toLowerCase()}function lr(n){return n.replace(cr,lu)}function au(n,t,i){return lr(n+" "+t+i||(i?" "+i:""))}function vu(n,t,r){var u;return ni.isInstanceOfErrorType(n,ni.Error)?u=nt(n,r):kr.isXMLHttpRequestLike(n)?(u=nt(n.message||t,n.stack,r),i.shallowCopyFromObject(u,n,["readyState","status","statusText","responseText"])):u=nt(new ni.Error({message:t,data:r,innerErrors:n})),u}function yu(n){var t=n.text||n.name,i=n.pluralDisplayName||t;return{plural:i,singular:n.singularDisplayName||t,lowerPlural:n.lowerPluralDisplayName||t,lowerSingular:n.lowerSingularDisplayName||t,service:n.serviceDisplayName||i}}function vr(n,t,i){var r;return bt.some((function(u){return r=u.provideAssetTypeKeywords(n,t,i),!!r})),r}function pu(n){var t;return bt.some((function(i){return t=i.provideCategoryName(n),!!t})),t||n}function si(n){return n.assetTypeManifest.resourceType}function hi(n){var t=n.resourceType;return t&&t.resourceTypeName&&t.resourceTypeName.toLowerCase()}function kt(n,t,i,u,f){var e;return i===void 0&&(i=null),u===void 0&&(u=null),f===void 0&&(f=null),e=n.assetTypeManifest,u=u||e.bladeExtensionName||n.extension,i=i||e.bladeName,!i&&e.resourceType&&(i=rt,u=d),{icon:f||n.icon,selection:r.ViewModels.getBladeSelection(u,i,{id:t}),isPreview:n.isPreview}}function ci(n,t){var r;if(t){var u=n.assetTypeManifest,f=hi(u),i=function(n){return(t&n)===n};if(i(1)&&((r=u.browseType,r===undefined)||i(5)&&(r!==1||!f)||i(9)&&(r!==3||!u.browseLinkUri||i(25)&&r!==3))||i(2)&&!f)return!1}return!0}function ct(n,t,i){return n.extensionName===t&&n.assetType===i}function lt(n,t,i,r){return ct(n,t,i)&&or(n.assetId,r)}function wu(n,t){return"Extension <"+n+"> : AssetType <"+t+"> : ID <REDACTED>"}function li(n,t,i){return nt("Asset type does not specify a resource type. Extension <"+t+"> : AssetType <"+i+"> : "+n)}function at(n){return nt("Resource ID <"+k.sanitizeId(n)+"> is not a subscription ID, resource group ID or resource ID.")}function dt(n,t,i){return new Error("The "+n+" view model was already disposed. Extension <"+t+"> : ViewModel <"+i+">")}function bu(n,t){var u=function(n,t){return i.unique((n||"").split(",").filter((function(n){return!!n})).concat(t)).join(",")},f=t.name,r=vr(n,f,""),e;r&&r.length&&(t.keywords=u(t.keywords,r));e=t.resourceType||{};(e.kinds||[]).forEach((function(t){var r=(t.name||"").toLowerCase(),i=vr(n,f,r);i&&i.length&&(t.keywords=u(t.keywords,i))}))}function ku(n,t,r){var f=r.resourceType&&r.resourceType.kinds||[],e=f.first((function(n){return n.isDefault}));return{lowerCaseAssetType:r.name.toLowerCase(),lowerCaseExtension:t.name.toLowerCase(),lowerCaseResourceType:hi(r)||"",kindMap:i.extendArrayIntoMap(u.create(null),f,(function(n){return n.name.toLowerCase()}),i.identity),defaultKind:e&&e.name.toLowerCase(),assetTypeManifest:r,id:n,extension:t.name,compositeDisplayName:yu(r),icon:r&&r.icon||iu,isPreview:t.isPreview||!!r.isPreview}}function du(n,t){it.getAssetTypeInformationEndPoint.register(n,null,(function(n){return t.getAssetTypeInformation(n.extensionName,n.assetType)}));it.getResourceTypeAssetTypeInformationEndPoint.register(n,null,(function(n){return t.getResourceTypeAssetTypeInformation(n)}));it.mapAssetIdToDynamicSelectionAndIconEndPoint.register(n,null,(function(n,i){var r={reason:"mapAssetIdToDynamicSelectionAndIcon",extension:i.srcWindowId};return t.mapAssetIdToDynamicSelectionAndIcon(n.assetId,r)}))}function gu(n,t){var u=it.getHubsWindowId(),i=new r.TriggerableLifetimeManager,f={assetTypesInformation:e.computed(i,(function(){return t.assetTypes().map((function(n){return t.mapAssetTypeToResourceTypeAssetTypeInformation(n)}))})),isPartialSet:e.computed(i,(function(){return t.allManifestsLoaded()}))};s.AssetTypes.getAssetTypesInformationObservableEndPoint.registerObjectFactory(n,{allowedOrigin:[u],allowRemoteChanges:!1,handler:function(){return Q(e.observable(f))}})}function ai(n,t){i.disposeViewModelProperties(t);n.releaseViewModel(t)}function nf(n){return Q({icon:n.icon,kind:null,isPreview:n.isPreview})}function g(n,t,i){var r=t&&(f.isArray(t)?t:[t]),u;r&&(u=n.length+r.length-i,u>0&&n.splice(0,u),n.push.apply(n,r))}function b(n,t){return i.find(n,t,-1)}function tf(n){var t=n.rpcClient,i=n.assetTypeService;du(t,i);gu(t,i)}function vi(n,t){n&&n.split(",").forEach(t)}function yi(n){return ei(n.resourceId)}function yr(n){var t=3;return n.privateBrowse&&(t-=2),n.isPreview&&(t-=1),t}var bt,cr,ar,pr,gt;u.defineProperty(t,"__esModule",{value:!0});var it=r.Extension,vt=i.Base,et=vt.Constants,yt=et.AssetNames,pi=yt.NonAssetResource,d=et.ExtensionNames.Hubs,st=et.ResourceTypes,rt=et.BladeNames.Hubs.ResourceMenuBlade,wr=et.BladeNames.Hubs.BrowseServiceBlade,br=i.Extension,k=i.ViewModels.Services.ResourceTypes,wi=i.Assets,bi=r.Assets,ki=br.ResourceRoutingType,ni=i.Errors,kr=i.Helpers,w=i.tryImmediateResolve,dr=window,di=dr.fx.environment,ht=vt.Diagnostics.createLog(n),gi=function(n){return ht.warning(n)};t.allAssetTypesRetrievalTimeoutInMilliseconds=5e3;var ut="Timeout trying to load extension manifest",p=i.remove,ti=i.getFeatureValue,nr="ResourceMap$ResourceProviderViewModel",tr="MsPortalImpl/Services/Services.AssetTypesDelayed",ft=wi.supportsContract,nt=vt.Diagnostics.createIgnoreUnhandledRejectionError,pt=k.isSubscriptionId,gr=k.compareSubscriptionId,wt=k.isResourceGroupId,nu=k.compareResourceGroupId,ii=k.isResourceId,tu=k.compareResourceId,ir=k.isResourceManagerId,rr=k.buildResourceTypeFromResourceId,ur=bi.getAssetTypeOrResourceTypeId,ri=it.isEqualDescriptor,ui=it.getWindowId,fr=it.getDescriptor(d),iu=vt.Images.Polychromatic.ResourceDefault(),ru=ti("assettypeapiversion"),uu=ti("showassettypes"),fu=ti("hideassettypes"),eu=i.isFeatureEnabled("servicemenu");t.failedToFindAssetTypePrefix="Could not find the asset type";bt=[];t.registerStringProvider=er;t.compareAssetId=or;cr=/(^|[^A-Za-z0-9]*)([A-Za-z0-9]+)/g;ar=/^https?:\/\//i;er({provideCategoryName:function(n){return h.BrowseCategories[lr(n)]||n},provideAssetTypeKeywords:function(n,t,i){var r=h.AssetTypeKeywords[au(n,t,i)];return r?r.split(","):[]}});t.provideCategoryName=pu;t.createViewModelDisposedError=dt;t.setupAssetTypeServiceRpc=tf;t.Internal={};pr=(function(){function n(n,t){var u=this,s,f,o;this._resourceTypeMap={};this._assetIdToResourceIdPromises=[];this._resourceIdToAssetIdPromises=[];this._assetTypePromises=[];this._assetTypeByIdPromises=[];this._assetTypeByIdBrowseLink={};this._assetTypeByResourceTypePromises=[];this._resourceTypeMappingPromises=[];this._selectionFromAssetIdPromises=[];this._selectionFromResourceIdPromises=[];this._iconAndKindFromResourceIdPromises=[];this._resourceGroupPromises=[];this._resourcePromises=[];this._apiVersionOverrides={};this._assetTypeOverrides={};this._callbacks=[];this._preprocess=Q(!0);this._memoizedManifestsLoadedError=i.memoize((function(n){return nt(n)}));this._getResourceProvider=i.memoizeQ((function(){return w(u._extensionManager.getHubsExtension(),(function(n){return n.getViewModel(nr).then((function(t){u._resourceProviderLifetime||(u._resourceProviderLifetime=u._lifetimeManager.createChildLifetime());return(u._resourceProviderLifetime.registerForDispose((function(){ai(n,t)})),!0)?t.content:Q.reject(dt("resource map provider",d,nr))}))}))}));this._getResourceTypeCachePromise=i.memoizeQ((function(){return w(u._getResourceProvider(),(function(n){return Q(n.getResourceTypeCache())}))}));this.getAssetTypeByIdPromise=this._getAssetTypeById;this.getAssetTypeByResourceTypePromise=this._getAssetTypeByResourceType;this.getResourceTypeAssetTypeInformation=this._getResourceTypeAssetTypeInformation;s=this._lifetimeManager=new r.TriggerableLifetimeManager;f=this._assetTypes=e.observableArray();f.extend({deferred:!0});this._extensionManager=n;this._cachedUser=t;this._initialLoad=this._listenForExtensions();this._initialLoad.then((function(){p(u._callbacks,(function(n){return!n()}))}));vi(ru,(function(n){var t=n.split(":");t.length===2&&(u._apiVersionOverrides[t[0].toLowerCase()]=t[1])}));o=function(n){return function(t){u._assetTypeOverrides[t.toLowerCase()]=n}};vi(uu,o(!0));vi(fu,o(!1));this._getAssetTypeInfoComputed=f.map(s,(function(n,t){return u._mapAssetTypeToInternalResourceTypeAssetTypeInformation(t)}))}return n.prototype._onManifestLoaded=function(n){return this._callbacks.push(n),n},n.prototype._offManifestLoaded=function(n){p(this._callbacks,n)},n.prototype._getDynamicBladePromiseForAssetType=function(n,t){var u=n.assetTypeManifest,i=n.extension,r=u.dynamicBladeServiceViewModel;if(!r)throw nt("Missing dynamic blade service view model. Extension <"+i+"> : AssetType <"+u.name+">");return this._extensionManager.getExtensionByName(i).then((function(n){return n.getViewModel(r).then((function(u){var f=!1;if(t.registerForDispose((function(){f=!0;ai(n,u)})),!f)return u.content;throw dt("dynamic blade service",i,r);}))}))},n.prototype._mapAssetTypeToInternalResourceTypeAssetTypeInformation=function(n){return this.mapAssetTypeToResourceTypeAssetTypeInformation(n)},n.prototype._getAssetTypePromise=function(n,i){var f=this,r=i(),o;if(r)return Q(r);if(o=t.failedToFindAssetTypePrefix+" "+n+" after all extension manifests loaded.",this.allManifestsLoaded())return Q.reject(this._memoizedManifestsLoadedError(o));var e=Q.defer(),u=e.promise,s=this._onManifestLoaded((function(){return Q.isPending(u)&&(r=i(),r&&e.resolve(r),Q.isPending(u)&&f.allManifestsLoaded()&&e.reject(f._memoizedManifestsLoadedError(o))),Q.isPending(u)}));return Q.delay(2e4).then((function(){f._offManifestLoaded(s);Q.isPending(u)&&e.reject(f._memoizedManifestsLoadedError(ut))})),u},n.prototype._getAssetTypeByResourceType=function(n,t){var u=this,f=n.toLowerCase(),e=b(this._assetTypeByResourceTypePromises,(function(n){return n.resourceType===f&&n.requirements===t})),i,r;return e?e.promise:(i=this._getAssetTypePromise("resourceType: <"+n+">",(function(){return u.getAssetTypeByResourceType(n,t)})),Q.isRejected(i)||(r={resourceType:f,promise:i,requirements:t},g(this._assetTypeByResourceTypePromises,r,200),Q.isPending(i)&&i.catch((function(n){n.message===ut&&ht.warning(ut);p(u._assetTypeByResourceTypePromises,r)}))),i)},n.prototype._getResourceTypeMappingPromiseForAssetType=function(n,t){var u=si(n),i=u&&u.mappingViewModel,r;if(!i)throw nt("Resource type missing resource type mapping view model. AssetType <"+n+">");return r=n.extension,this._extensionManager.getExtensionByName(r).then((function(n){return n.getViewModel(i).then((function(u){var f=!1;if(t.registerForDispose((function(){f=!0;ai(n,u)})),!f)return u.content;throw dt("resource type mapping",r,i);}))}))},n.prototype._getMappingViewModel=function(n){var e=this,i=this._resourceTypeMappingPromises,r,t;if(this._resourceMappingCache=this._resourceMappingCache||new c.LifetimeItemCache(3e4),this._resourceMappingCache.hasEntry(n.id))return Q(this._resourceMappingCache.getEntry(n.id));if(r=n.lowerCaseResourceType,t=b(i,(function(n){return n.resourceType===r})),t)return t.promise;var u=this._lifetimeManager.createChildLifetime(),f=this._getResourceTypeMappingPromiseForAssetType(n,u).then((function(f){return e._resourceMappingCache.addEntry(n.id,f,u),t=b(i,(function(n){return n.resourceType===r})),t&&p(i,t),f})),o={resourceType:r,promise:f};return g(i,o,200),f},n.prototype._getDynamicBladeReference=function(n,t){var i=this._lifetimeManager.createChildLifetime();return this._getDynamicBladePromiseForAssetType(n,i).then((function(n){if(typeof n.onInputsSet!="function")return null;var i=n.onInputsSet({assetId:t.assetId});return Q(i||!0).then((function(){return n}))})).then((function(n){return n&&n.bladeName()?{blade:n.bladeName(),extension:n.extensionName()}:null})).finally((function(){i.dispose();i=null}))},n.prototype._getDynamicSelectionAndIconFromAssetId=function(n,t){var r=kt(n,t.assetId),u=this._selectionFromAssetIdPromises,f=b(u,(function(n){return lt(n.assetId,t.extensionName,t.assetType,t.assetId)})),i;return f?f.promise:(i=function(n){return g(u,{assetId:t,promise:n},200),n},n.assetTypeManifest.dynamicBladeServiceViewModel)?i(this._getDynamicBladeReference(n,t).then((function(i){return i?kt(n,t.assetId,i.blade,i.extension):r}))):i(Q(r))},n.prototype._getResourceReference=function(n,t,i){var r=this,u,f;return(this._resourceCache=this._resourceCache||new c.ItemCache(5e3),this._resourceCache.hasEntry(n))?Q(this._resourceCache.getEntry(n)):(u=b(this._resourcePromises,(function(t){return t.resourceId===n})),u)?u.promise:(f=this._getResourceProvider().then((function(u){var f;return f=ft(t.assetTypeManifest.contracts,64)?Q(u.getExtensionResource(n,r.mapAssetTypeToResourceTypeAssetTypeInformation(t),i)):Q(u.getResource(n,i)),f.then((function(t){return r._resourceCache.addEntry(n,t),p(r._resourcePromises,(function(t){return t.resourceId===n})),t}))})),g(this._resourcePromises,{resourceId:n,promise:f},200),f)},n.prototype._getDynamicSelectionAndIconFromResourceId=function(n,t,r,u){var a=this,e=kt(n,r.assetId),f=e.selection,o=n.assetTypeManifest,s,c,h,l;return tt(t)?(f.extension=d,f.detailBlade=rt,Q(e)):(s=o.resourceType,s&&s.routingType===ki.Extension&&!ft(n.assetTypeManifest.contracts,64))?Q(e):ft(o.contracts,128)?(f.extension=d,f.detailBlade=rt,Q(e)):(c=b(this._selectionFromResourceIdPromises,(function(n){return n.resourceId===t})),c)?c.promise:(h=this._getResourceReference(t,n,u).then((function(t){var u,h;if(t.error)throw t.error;return o.name===pi?(f.extension=d,f.detailBlade=rt,e):(u=!1,o.viewModel&&ft(o.contracts,8)&&(f.extension=d,f.detailBlade=rt,u=!0),h=function(){return o.dynamicBladeServiceViewModel?a._getDynamicBladeReference(n,r).then((function(t){return t?kt(n,r.assetId,t.blade,t.extension,e.icon):e})):Q(e)},i.require(tr).then((function(i){if(s&&s.kinds){var c=!1,l=!1,r=!1;if(i.getIconAndBladeFromAssetTypeInformation(t,n.kindMap,n.defaultKind,null,(function(n){n?o.viewModel&&ft(o.contracts,16)&&(f.extension=d,f.detailBlade=rt,u=!0):u=!1}),(function(n){l||(l=!0,e.isPreview=n)}),(function(n){c||(c=!0,e.icon=n)}),(function(t,i){r||u||(r=!0,f.extension=t||n.extension,f.detailBlade=i)})),r||u)return e}return h()})))})).catch((function(i){var f=vu(i,"_getDynamicSelectionAndIconFromResourceId have unexpected error.",{assetType:n,resourceId:t,assetId:r,telemetry:u});return Q.reject(f)})),l={resourceId:t,promise:h},g(this._selectionFromResourceIdPromises,l,200),h.catch((function(){a._selectionFromResourceIdPromises.remove(l)})),h)},n.prototype._getIconAndKindFromResourceId=function(n,t,r,u){var l=this,f={icon:n.icon,kind:null,isPreview:n.isPreview},c=n.assetTypeManifest,e,s,o,h;return tt(t)?Q(f):ft(c.contracts,128)?Q(f):(e=c.resourceType,e&&e.routingType===ki.Extension&&!ft(n.assetTypeManifest.contracts,64))?Q(f):(s=b(this._iconAndKindFromResourceIdPromises,(function(n){return n.resourceId===t})),s)?s.promise:(o=w(this._getResourceReference(t,n,u),(function(t){return t.error?Q.reject(t.error):w(i.require(tr),(function(i){if(e&&e.kinds){var r=!1,u=!1,o=!1;i.getIconAndBladeFromAssetTypeInformation(t,n.kindMap,n.defaultKind,(function(n){r||(r=!0,f.kind=n)}),null,(function(n){o||(o=!0,f.isPreview=n)}),(function(n){u||(u=!0,f.icon=n)}))}return Q(f)}))})),h={resourceId:t,promise:o},g(this._iconAndKindFromResourceIdPromises,h,200),o.catch((function(){l._iconAndKindFromResourceIdPromises.remove(h)})),o)},n.prototype._getResourceTypeAssetTypeInformation=function(n){var f=this,e=t.Internal.getResourceTypeAssetTypeInformationOverride,h;if(e)return Q(e(n));var o=function(n,t){return{resourceType:n,topLevelTenantAlias:null,topLevelResourceTypeAlias:null,extensionName:null,assetType:null,browseType:-1,compositeDisplayName:null,icon:null,viewModel:null,contracts:0,lowerCaseExtension:null,lowerCaseAssetType:null,lowerCaseResourceType:n.toLowerCase(),reason:i.getLogFriendlyMessage(t)}},r=[],u=[],s=i.unique(n.map((function(n){return n.toLowerCase()}))).filter((function(n){var t=n.split("/").length>=2;return t||u.push(n),t}));return u.length&&(h=new Error("Invalid resource type"),r.push.apply(r,u.map((function(n){return o(n,h)})))),s.sort(),s.forEach((function(n){var t=w(f.getAssetTypeByResourceTypePromise(n),(function(n){return f.mapAssetTypeToResourceTypeAssetTypeInformation(n)}),(function(t){return o(n,t)}));r.push(t)})),Q.all(r)},n.prototype._flushCachesForAssetType=function(n){var t=n.assetTypeManifest.name,i=n.extension,f,r,u;this._resourceMappingCache&&this._resourceMappingCache.removeEntry(n.id);this._resourceAssetIdCache&&this._resourceAssetIdCache.removeEach((function(n){return ct(n.assetId,i,t)}));p(this._assetIdToResourceIdPromises,(function(n){return ct(n.assetId,i,t)}));this._assetIdSelectionCache&&this._assetIdSelectionCache.removeEach((function(n){return ct(n.assetId,i,t)}));p(this._assetTypePromises,(function(n){return n.extension===i&&n.assetType===t}));f=ur(i,t);p(this._assetTypeByIdPromises,(function(n){return n.assetTypeId===f}));this._assetTypeByIdBrowseLink[f]&&delete this._assetTypeByIdBrowseLink[f];p(this._selectionFromAssetIdPromises,(function(n){return ct(n.assetId,i,t)}));i===d&&t===yt.ResourceGroups&&(this._resourceGroupCache&&this._resourceGroupCache.flush(),this._resourceGroupPromises=undefined);r=n.lowerCaseResourceType;r&&(u=r,delete this._resourceTypeMap[u],p(this._resourceIdToAssetIdPromises,(function(n){return!tt(n.resourceId)&&yi(n)===u})),this._resourceIdSelectionCache&&this._resourceIdSelectionCache.removeEach((function(n){return!tt(n.resourceId)&&ei(n.resourceId)===r})),this._resourceCache&&this._resourceCache.removeEach((function(n){return!tt(n)&&ei(n)===r})),p(this._assetTypeByResourceTypePromises,(function(n){return n.resourceType===r})),p(this._resourceTypeMappingPromises,(function(n){return n.resourceType===r})),p(this._selectionFromResourceIdPromises,(function(n){return!tt(n.resourceId)&&yi(n)===u})),p(this._resourcePromises,(function(n){return!tt(n.resourceId)&&yi(n)===u})))},n.prototype._preventDuplicateResourceTypes=function(n,t,i){if(this._resourceTypeMap[n]){var r=b(this._assetTypes(),(function(t){return t.lowerCaseResourceType&&t.lowerCaseResourceType===n})),u=yr(r.assetTypeManifest),f=yr(i);if(u<f)delete this._resourceTypeMap[n],this._assetTypes.remove(r);else return u>f?!1:(gi("Extension <"+t+"> has duplicate resource type <"+n+"> also found in <"+r.extension+"> extension"),!1)}return!0},n.prototype._listenForExtensions=function(){var n=this,r=this._extensionManager,t=this._mappedBrowseBlades={};return r.on("assetTypes",(function(r){var f;return w(n._preprocess,(function(){var o=n._assetTypes(),e,s,h;n._assetTypes.valueWillMutate();e=i.convertArrayToMap(o.filter((function(n){return ri(r,{name:n.extension})})),(function(n){return n.assetTypeManifest.name}),i.identity);i.forEachKey(e,(function(t,i){n._flushCachesForAssetType(i)}));s=ui(r).toLowerCase();t[s]=t[s]||{};h=r.assetTypes;h&&h.forEach((function(s){var d=e[s.name],h,v,g,y,c,l,p,w,b,k;if((d&&(delete e[s.name],o.remove(d),f=!0),s.browseType!==4)&&(s.browseType!==3||(s.browseLinkUri||"").match(ar))){if(h=s.resourceType,v=h&&h.resourceTypeName,v){if(g=v.split("/"),g.length<2){gi("Skipping asset type <"+s.name+"> with invalid resource type <"+v+"> in extension <"+r.name+">");return}if(y=hi(s),!n._preventDuplicateResourceTypes(y,r.name,s))return;n._resourceTypeMap[y]=!0}var nt=function(n,i,u){if(n&&u){var f=ui({name:i||r.name}).toLowerCase(),e=t[f]||(t[f]={});e[n.toLowerCase()]=!0}},a=h&&h.kinds,tt=wi.supportsContract(s.contracts,8);a&&a.length?(a.forEach((function(n){nt(n.bladeName||s.bladeName,n.bladeExtensionName||s.bladeExtensionName,n.useResourceMenu!==undefined?n.useResourceMenu:tt);n.filterMap=i.extendArrayIntoMap(u.create(null),n.kinds||[n.name],(function(n){return n.toLowerCase()}),(function(){return!0}));n.isDefault&&(n.filterMap[""]=!0)})),r.name==="SqlAzureExtension"&&s.name==="Database"&&(c=a.first((function(n){return n.name.toLowerCase()==="v12.0,user,datawarehouse"})),l=a.first((function(n){return n.name.toLowerCase()==="v12.0,user,datawarehouse,gen2"})),c&&l&&(c.filterMap[c.name.toLowerCase()]=!0,c.filterMap[l.name.toLowerCase()]=!0,l.filterMap[c.name.toLowerCase()]=!0,l.filterMap[l.name.toLowerCase()]=!0))):nt(s.bladeName,s.bladeExtensionName,tt);bu(r.name,s);p=ur(r.name,s.name);w=p.toLowerCase();h&&(b=n._apiVersionOverrides[w],b&&(s.resourceType.apiVersion=b));k=n._assetTypeOverrides[w];k!==undefined&&(s.privateBrowse=!k);o.push(ku(p,r,s));f=!0}}));f=f||p(o,(function(n){return!!e[n.assetTypeManifest.name]})).length>0;f&&n._assetTypes.valueHasMutated();p(n._callbacks,(function(n){return!n()}))})),!0}))},n.prototype._getAssetTypeById=function(n,t){var u=this,f=b(this._assetTypeByIdPromises,(function(i){return i.assetTypeId===n&&i.requirements===t})),i,r;return f?f.promise:(i=this._getAssetTypePromise("assetTypeId <"+n+">",(function(){return b(u._assetTypes(),(function(i){return i.id===n&&ci(i,t)}))})),r={assetTypeId:n,promise:i,requirements:t},g(this._assetTypeByIdPromises,r,200),i.catch((function(n){n.message===ut&&ht.warning(ut);p(u._assetTypeByIdPromises,r)})),i)},n.prototype._getAssetType=function(n,t,i,r){var o=this,l={name:n},s=b(this._assetTypePromises,(function(n){var i={name:n.extension};return ri(i,l)&&n.assetType===t&&n.requirements===r})),h,u,f,c;return s?(i&&i(s.options()),s.promise):(h=function(){return o._getAssetTypePromise("assetType <"+n+", "+t+">",(function(){return o.getAssetType(n,t,r)}))},f=e.observable(0),u=cu(n,t)?this._getAssetTypeByResourceType(st.Subscriptions,r).then((function(n){return f(1),i&&i(f()),n})).catch((function(){return h()})):h(),c={extension:n,assetType:t,promise:u,requirements:r,options:f},g(this._assetTypePromises,c,200),u.catch((function(n){n.message===ut&&ht.warning(ut);p(o._assetTypePromises,c)})),u)},n.prototype.dispose=function(){i.disposeDisposable(this._memoizedManifestsLoadedError,this._getResourceProvider,this._getResourceTypeCachePromise,this._lifetimeManager,this._resourceCache,this._resourceGroupCache,this._assetIdIconAndKindCache,this._resourceIdSelectionCache,this._assetIdSelectionCache,this._resourceAssetIdCache,this._resourceMappingCache);this._resourceProviderLifetime=null},u.defineProperty(n.prototype,"assetTypes",{get:function(){return this._assetTypes},enumerable:!0,configurable:!0}),n.prototype.getMappedBladeLocator=function(n){if(n.type===a.LocatorType.Blade){var t=this._mappedBrowseBlades[ui(n.getExtensionLocator()).toLowerCase()];if(t&&t[n.name.toLowerCase()])return a.Locator.forExtension(fr.name).withBlade(rt)}return n},n.prototype.getAssetType=function(n,t,i){var r={name:n};return b(this._assetTypes(),(function(n){return ri({name:n.extension},r)&&n.assetTypeManifest.name===t&&ci(n,i)}))},n.prototype.hasAssetType=function(n,t,i){return!!this.getAssetType(n,t,i)},n.prototype.getAssetTypePromise=function(n,t,i){return this._getAssetType(n,t,null,i)},n.prototype.getAssetTypeByResourceType=function(n,t){if(n){var i=n.toLowerCase();return b(this._assetTypes(),(function(n){return n.lowerCaseResourceType===i&&ci(n,t)}))}},n.prototype.getAssetTypeByResourceTypePromiseWithFallback=function(n,t){var r=this;return w(this._getAssetTypeByResourceType(n,t),i.identity,(function(){return w(r._getAssetType(d,pi,null,t),(function(t){return t=i.clone(t),t.assetTypeManifest.resourceType={resourceTypeName:n},t}))}))},n.prototype.allManifestsLoaded=function(){return Q.isFulfilled(this._initialLoad)},n.prototype.getAssetTypeDeepLink=function(n,t){var r=n.assetTypeManifest,f=r.name,h=r.bladeName,c=n.extension,e=r.bladeExtensionName||c,a=r.resourceType,o=a&&a.resourceTypeName,u=function(n,t){return l.getBladeDeepLink(fr,n,"",t,!1)},i="",v=eu&&r.serviceMenuBlade,y,s,p;if(v)i=l.getBladeDeepLink({name:r.serviceMenuBladeExtension||n.extension},v,"",{id:r.serviceMenuItemId},!1);else switch(r.browseType){case 0:i=u(wr,{assetTypeId:bi.getAssetTypeOrResourceTypeIdByWindowId(c,f)});break;case 1:i=t?u("Resources",{resourceType:o,kind:t}):u("Resources",{resourceType:o});break;case 2:e===d&&(y={BrowseAllResourcesBlade:st.AllResources,BrowseRecentResourcesBlade:st.RecentResources},s=y[h],s&&(i=u("Resources",{resourceType:s})));i||(p=f==="Dashboard"&&e===d,i=p?"#":l.getBladeDeepLink({name:e},h,"",{},!1),f===yt.Gallery&&(i+="/selectedMenuItemId/undefined"));break;case 3:i=this.getBrowseLinkUri(n)}return i||ht.error("<"+o+"> asset type does not have a deep link. Side bar & search results will not be able to open any blades."),i},n.prototype.getBrowseLinkUri=function(n){var t=this._cachedUser,r=this._assetTypeByIdBrowseLink[n.id],i,u;return r?r:(i=n.assetTypeManifest.browseLinkUri,i&&(u=di.links.classicPortal.format({domain:t&&t.tenantDomain}),i=i.format({accountPortal:di.links.accountPortal,classicPortal:u,domain:t&&t.tenantDomain,tenantId:t&&t.tenantId})),this._assetTypeByIdBrowseLink[n.id]=i,i)},n.prototype.getAssetTypeInformation=function(n,i){var u=this,r=t.Internal.getAssetTypeInformationOverride;return r?Q(r(n,i)):w(this.getAssetTypePromise(n,i),(function(n){return u.mapAssetTypeToAssetTypeInformation(n)}))},n.prototype.mapAssetIdToResourceId=function(n){var s=this,u=this._assetIdToResourceIdPromises,i=n.extensionName,r=n.assetType,t=n.assetId,f,e;if(this._resourceAssetIdCache=this._resourceAssetIdCache||new c.ItemArrayCache(216e5),f=this._resourceAssetIdCache.first((function(n){return lt(n.assetId,i,r,t)})),f)return Q(f.resourceId);if(e=b(u,(function(n){return lt(n.assetId,i,r,t)})),e)return e.promise;var l=function(n){t=oi(n,t)},o=w(this._getAssetType(i,r,l),(function(u){var e=si(u),f;return e?(f=function(t){return s._resourceAssetIdCache.pushEntry({assetId:n,resourceId:t}),t},ot(t))?f(t):e.mappingViewModel?s._getMappingViewModel(u).then((function(n){return Q(n.mapAssetIdToResourceId(t)).then((function(n){if(!ot(n))throw at(n);return f(n)}))})):Q.reject(nt("Asset ID not a resource ID but asset type does not provided mapping view model. "+wu(i,r,t))):Q.reject(li("ID <"+k.sanitizeId(t),i,r))})),h={assetId:n,promise:o};return g(u,h,200),o.catch((function(){p(u,h)})),o},n.prototype.mapResourceIdToAssetId=function(n){var e=this,i=this._resourceIdToAssetIdPromises,r,u,t,f;return ot(n)?(this._resourceAssetIdCache=this._resourceAssetIdCache||new c.ItemArrayCache(216e5),r=this._resourceAssetIdCache.first((function(t){return fi(t.resourceId,n)})),r)?Q(r.assetId):(u=b(i,(function(t){return fi(t.resourceId,n)})),u)?u.promise:(t=this._getAssetTypeByResourceType(hr(n)).then((function(t){var r=t.assetTypeManifest,u=r.name,f=r.resourceType,o=t.extension,i;if(!f)throw li("ResourceId <"+k.sanitizeId(n)+">",o,u);return(i=function(t){var i={extensionName:o,assetType:u,assetId:t};return e._resourceAssetIdCache.pushEntry({assetId:i,resourceId:n}),i},!f.mappingViewModel)?i(n):e._getMappingViewModel(t).then((function(t){return Q(t.mapResourceIdToAssetId(n)).then((function(n){return i(n)}))}))})),f={resourceId:n,promise:t},g(i,f,200),t.catch((function(){p(i,f)})),t):Q.reject(at(n))},n.prototype.mapAssetIdToDynamicSelectionAndIcon=function(n,t){var u=this,h;this._assetIdSelectionCache=this._assetIdSelectionCache||new c.ItemArrayCache(216e5);var f=n.extensionName,o=n.assetType,r=n.assetId,s=this._assetIdSelectionCache.first((function(n){return lt(n.assetId,f,o,r)}));return s?Q(s.value):(h=function(n){r=oi(n,r)},w(w(this._getAssetType(f,o,h),(function(f){var o=i.clone(n);return(o.assetId=r&&e.unwrap(r),sr(f,o))?w(u.mapAssetIdToResourceId(o),(function(n){if(!ot(n))throw at(n);return u._getDynamicSelectionAndIconFromResourceId(f,n,o,t)})):u._getDynamicSelectionAndIconFromAssetId(f,o)})),(function(t){return u._assetIdSelectionCache.pushEntry({assetId:n,value:t}),t})))},n.prototype.mapAssetIdToIconAndKind=function(n,t){var u=this,h;this._assetIdIconAndKindCache=this._assetIdIconAndKindCache||new c.ItemArrayCache(216e5);var f=n.extensionName,o=n.assetType,r=n.assetId,s=this._assetIdIconAndKindCache.first((function(n){return lt(n.assetId,f,o,r)}));return s?Q(s.value):(h=function(n){r=oi(n,r)},w(w(this._getAssetType(f,o,h),(function(f){var o=i.clone(n);return(o.assetId=r&&e.unwrap(r),sr(f,o))?w(u.mapAssetIdToResourceId(o),(function(n){return ot(n)?u._getIconAndKindFromResourceId(f,n,o,t):Q.reject(at(n))})):nf(f,o)})),(function(t){return u._assetIdIconAndKindCache.pushEntry({assetId:n,value:t}),t})))},n.prototype.mapResourceIdToDynamicSelectionAndIcon=function(n,t){var i=this,r;return(this._resourceIdSelectionCache=this._resourceIdSelectionCache||new c.ItemArrayCache(216e5),!ot(n))?Q.reject(at(n)):(r=this._resourceIdSelectionCache.first((function(t){return fi(t.resourceId,n)})),r)?Q(r.value):w(w(this._getAssetTypeByResourceType(hr(n)),(function(r){var u=r.assetTypeManifest,f=u.name;if(!u.resourceType)throw li("ResourceId <"+k.sanitizeId(n)+">",r.extension,f);return w(i.mapResourceIdToAssetId(n),(function(u){return i._getDynamicSelectionAndIconFromResourceId(r,n,u,t)}))})),(function(t){return i._resourceIdSelectionCache.pushEntry({resourceId:n,value:t}),t}))},n.prototype.mapAssetTypeToAssetTypeInformation=function(n){var t=n.assetTypeManifest,i=t.keywords;return{extensionName:n.extension,assetType:t.name,browseType:t.browseType!==undefined?t.browseType:-1,browseLinkUri:this.getBrowseLinkUri(n),compositeDisplayName:n.compositeDisplayName,icon:n.icon,viewModel:t.viewModel,dynamicBladeServiceViewModel:t.dynamicBladeServiceViewModel,contracts:t.contracts,isPreview:n.isPreview,privateBrowse:t.privateBrowse,keywords:!i?undefined:i.split(",")}},n.prototype.mapAssetTypeToResourceTypeAssetTypeInformation=function(n){var t=n.assetTypeManifest,i=t.resourceType||{},u=t.browseType,f=t.keywords,r=i.proxyRoutingFilters;return r||n.lowerCaseExtension!=="microsoft_azure_marketplace"||n.lowerCaseAssetType!=="galleryrpitem"||(r=[1,3]),{resourceType:i.resourceTypeName,topLevelTenantAlias:i.topLevelTenantAlias,topLevelResourceTypeAlias:i.topLevelResourceTypeAlias,apiVersion:i.apiVersion,routingType:i.routingType,bladeName:t.bladeName,bladeExtensionName:t.bladeExtensionName,partName:t.partName,kinds:i.kinds,kindMap:n.kindMap,defaultKind:n.defaultKind,proxyRoutingFilters:r,extensionName:n.extension,assetType:t.name,browseType:u!==undefined?u:-1,browseLinkUri:this.getBrowseLinkUri(n),compositeDisplayName:n.compositeDisplayName,icon:n.icon,viewModel:t.viewModel,dynamicBladeServiceViewModel:t.dynamicBladeServiceViewModel,contracts:t.contracts,isPreview:n.isPreview,marketplaceItemId:t.marketplaceItemId,marketplaceMenuItemId:t.marketplaceMenuItemId,staticOverview:t.staticOverview,privateBrowse:t.privateBrowse,keywords:f&&f.split(","),lowerCaseAssetType:n.lowerCaseAssetType,lowerCaseExtension:n.lowerCaseExtension,lowerCaseResourceType:n.lowerCaseResourceType,description:t.description,links:t.links}},n})();gt=(function(){function n(){}return n.create=function(n,t){return new pr(n,t.value)},n})();__decorate([o.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[v.ExtensionManager,y.SignedInUser]),__metadata("design:returntype",gt)],gt,"create",null);t.AssetTypeService=gt}));
define("MsPortalImpl/Services/Services.AssetManagement",["require","exports","f","i","o","$","FxInternal/Di","MsPortalImpl/Services/Services.AssetTypes"],(function(n,t,i,r,u,f,e,o){"use strict";var s;u.defineProperty(t,"__esModule",{value:!0});var c=i.Base,l=r.Rpc,a=i.ViewModels.Services.ResourceTypes,v=c.Diagnostics.createLog(n),h=(function(){function n(n,t){var e=this,u;this._assetDeletedCallbacks=f.Callbacks();u=function(t,i,u){var f,s,h;u.reason=u.reason||"Received asset deletion notification from the extension '"+t+"'";f=u.assetId;s=u.assetType;s===r.AssetManager.resourceAssetType?(h=a.buildResourceTypeFromResourceManagerId(f),h&&n.mapResourceIdToAssetId(f).then((function(n){e.handleAssetDeleted({name:n.extensionName},n.assetType,n.assetId,u.reason)})).catch((function(n){(n&&n.message||"").indexOf(o.failedToFindAssetTypePrefix)!==0&&v.warning(n)}))):e.handleAssetDeleted(i,s,f,u.reason)};t&&(r.AssetManager.notifyAssetDeletedDefinition.register(t,null,(function(n,t){var f=t.srcWindowId,e=r.Extension.getDescriptor(f);i.makeArray(n).forEach((function(n){u(f,e,n)}))})),r.AssetManager.hubsNotifyAssetDeletedDefinition.register(t,[r.Extension.getHubsWindowId()],(function(n,t){var r=t.srcWindowId;i.makeArray(n).forEach((function(n){u(r,{name:n.extensionName},n)}))})))}return n.prototype.onAssetDeleted=function(n){this._assetDeletedCallbacks.add(n)},n.prototype.markAssetDeleted=function(n,t,i,r){this.handleAssetDeleted(n,t,i,r)},n.prototype.handleAssetDeleted=function(n,t,i,r){this._assetDeletedCallbacks.fire(n,t,i,r)},n})();t.AssetManagerImpl=h;s=(function(){function n(){}return n.create=function(n){return new h(n,l.client)},n})();__decorate([e.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[o.AssetTypeService]),__metadata("design:returntype",s)],s,"create",null);t.AssetManager=s}));
define("MsPortalImpl/Services/Services.AzureStorage",["require","exports","f","i"],(function(n,t,i,r){"use strict";var u;return (function(n){function e(){u.register(r.Rpc.client,[r.Extension.getWindowId({name:"Microsoft_Azure_Scheduler"})],o)}function o(n){var i={isBackgroundTask:!1,uri:f};return Q(t.Net2.postJSON(i,n).then((function(n){return n.data})))}var t=i.Base,u=r.InternalAzure.getSasUriForQueueEndPoint,f=t.Resources.getAppRelativeUri("api/Storage/getsasuriforqueue");n.registerSasEndPoint=e})(u||(u={})),u}));
define("MsPortalImpl/Services/Services.BrowseCuration",["require","exports","f","i","o","a","MsPortalImpl/Resources/ImplScriptResources","FxHubs/RpcEndPoints"],(function(n,t,i,r,u,f,e,o){"use strict";function w(n){if(n&&!g.test(n)){v.warning("Invalid curation file name: <"+n+">, skipping this curation file.");return}return n}function nt(n,t,i){var r=f.isArray(t[0])?t:[t];return{base:h(n),associated:b.apply(void 0,r),infoTextOverride:i}}function h(n){var t,i;if(n&&!(n.length<2)&&n[0].length&&n[1].length)return t={extensionName:n[0],assetType:n[1]},n.length>2&&(i=n[2],i&&typeof i=="string"?t.kind=i:n[2]===!1&&(t.isHidden=!0)),t}function b(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return t.map((function(n){return h(n)})).filter((function(n){return!!n}))}function tt(){o.Curation.getSharedCurationEndpoint.register(k.client,[r.Extension.getHubsWindowId()],(function(){return t.getSharedCuration()}))}var s;u.defineProperty(t,"__esModule",{value:!0});var c=i.Base,k=r.Rpc,l=i.Hubs.Notifications,d=window,a=d.fx.environment,v=c.Diagnostics.createLog(n),g=/^[a-z\_]+[a-z\d\-\_]*$/i,y=e.BrowseCuration,p=i.lowerCaseAllStrings;s=w(i.getFeatureValue("browsecuration"))||w(a.browseCuration)||"default";t.getMergedAssetType=nt;t.getAssetType=h;t.getAssetTypes=b;t.getBrowseCuration=i.memoizeQ((function(){return i.require("MsPortalImpl/Services/BrowseCuration/"+s).then((function(n){return n.getCuration()})).catch((function(n){var i="Failed to get the browse curation file <"+s+">",t=i;return n&&n.statusText?t+=": "+(n.status||"")+" ("+n.statusText+")":n&&n.message&&(t+=": "+n.message),v.warning(t),l.ClientNotification.publish({title:y.noCurationTitle,description:y.noCuration,status:l.NotificationStatus.Warning}),{}}))}));t.getSharedCuration=i.memoizeQ((function(){var n=e.SearchTypeDisplayText,r=e.SearchTypeKeywords,u=e.SearchTypeSubText;return t.getBrowseCuration().then((function(t){var f=(t&&t.search||[]).map((function(t){var i=(t.id||"").toLowerCase(),f=i&&n[i];if(f)return{id:t.id,displayName:f,subText:u[i],keywords:(r[i]||"").split(","),icon:typeof t.icon=="string"?c.Images.ImageUri(t.icon):t.icon,link:(t.link||"").format({accountPortal:a.links.accountPortal})}})).filter(i.identity);return{searchCuration:f,resourceTypesExcludedFromBrowse:p(t&&t.resourceTypesExcludedFromBrowse),mergedAssetTypes:p(t&&t.mergedAssetTypes)}}))}));t.testReset=i.noop;t.initializeRpc=tt}));
define("MsPortalImpl/Services/Services.FavoritesSettings",["require","exports","f","i","o","ko","MsPortalImpl/Services/Services.SettingsProcessor"],(function(n,t,i,r,u,f,e){"use strict";function h(n){var r="InitializeFavoritesSettingsInternal";if(s&&!i.isTestMode)throw new Error(r+" has already been called.");s=!0;t.sidebarFavoritesProcessor.init(n,t.sidebarFavoritesSettings,10,r,!0);t.userDirectorySettingsProcessor.init(n,t.userDirectorySettings,7,r,!0)}var o,s;u.defineProperty(t,"__esModule",{value:!0});o=new r.TriggerableLifetimeManager;t.sidebarFavoritesProcessor=new e.SettingsProcessor(o);t.userDirectorySettingsProcessor=new e.SettingsProcessor(o);s=!1;t.sidebarFavoritesSettings={favorites:f.observable(""),version:f.observable(0)};t.userDirectorySettings={favoriteDirectoriesList:f.observableArray(),userDefaultDirectory:f.observable(),signInToLastVisitedDirectory:f.observable(!0)};t.initFavoritesSettings=h}));
define("MsPortalImpl/Services/Services.FileUploadEndpointRegistration",["require","exports","f","i","o"],(function(n,t,i,r,u){"use strict";function c(){s||(s=!0,e.uploadActionEndPoint.register(f.client,null,(function(n){return o().then((function(t){return t.invokeUploadAction(n.uploadKey,n.action,n.context)}))})),e.getUploadInfosEndPoint.registerObjectFactory(f.client,{allowedOrigin:null,allowRemoteChanges:!0,handler:function(n){return o().then((function(t){return t.getUploadInfos(n.uploadKeys,n.category,n.resumable)}))}}))}u.defineProperty(t,"__esModule",{value:!0});var f=r.Rpc,e=r.FileUpload,h="MsPortalImpl/Services/Services.FileUploadManager",o=i.memoizeQ((function(){return i.require(h).then((function(n){return n.fileUploadManagerInstance()}))})),s=!1;t.registerFileUploadEndpoints=c}));
define("MsPortalImpl/Services/Services.FileUploadInitialization",["require","exports","f","o"],(function(n,t,i,r){"use strict";function e(n){u||(u=!0,t.uploadSettingsManager=n,Q(n.querySettings({store:12})).then((function(t){i.isEmpty(t)||f().then((function(t){return t.init(n)}))})))}r.defineProperty(t,"__esModule",{value:!0});var f=i.memoizeQ((function(){return i.require("MsPortalImpl/Services/Services.FileUploadSettings").then((function(n){return n.fileUploadResumableTrackerInstance()}))})),u=!1;t.init=e}));
define("_generated/Less/MsPortalImpl/UI/UI.Portal.Actions.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxt-copy{display:-webkit-flex;display:flex;margin-top:5px}.fxt-copy-control{padding-left:10px}")}));
define("MsPortalImpl/UI/UI.StatusHandler",["require","exports","f","i","o","FxInternal/Di","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Telemetry","MsPortalImpl/UI/UI.DialogManager","MsPortalImpl/UI/UI.NavigationManager","_generated/Less/MsPortalImpl/UI/UI.Portal.Actions.css"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";function tt(n,t){return(n&t)===t}function a(n,t,i,r,u){ht.ClientNotification.publish({title:n,description:t,status:r||ut.Information,descriptionAsHtml:u,correlationIds:[i]})}var v,y;u.defineProperty(t,"__esModule",{value:!0});var p=i.Base,it=p.Diagnostics,rt=it.Telemetry,ht=i.Hubs.Notifications,ut=i.Hubs.Notifications.NotificationStatus,w=o.Action,ft=o.Source,l=window,b=l.fx.environment.bootstrapAuthorizationKey,k=it.createLog(n),ct=r.ensureAbsoluteUri(l.fx.internalEnv.errorPageUri),d=p.Constants.Shell,et=e.Shell,g=et.Notifications,c=et.Dialogs,nt=g.SessionEnding,ot=g.TokenFailure,st=g.VersionChanged,lt={sessionId:i.sessionId},at=[12e5,6e5,],vt='<div class="fxt-copy"><a href="#" data-bind="text: copyText, click: copyClick"><\/a><\/div>';v=(function(){function n(n,t){var i=this;this.bootstrapState=n;this.clear=function(n){n||(i.bootstrapState=null);MsPortalImpl.localStorage.removeItem(b)};this.persistentRefreshToken=function(n){i.bootstrapState&&MsPortalImpl.localStorage.setItem(b,JSON.stringify({refreshToken:i.bootstrapState.refreshToken,aadSessionId:i.bootstrapState.aadSessionId,user:i.bootstrapState.user,tenantId:n}))};this.persist=function(){i.bootstrapState&&MsPortalImpl.sessionStorage.setItem(b,JSON.stringify(i.bootstrapState))};t&&t.unloadCallbacks.push(this.persist)}return n.create=function(t){return Q(l.fx.early.authBootstrapStatePromise).then((function(i){return new n(i,t)}))},n})();__decorate([f.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[h.WindowManager]),__metadata("design:returntype",u)],v,"create",null);t.AuthStateManager=v;y=(function(){function n(n,t,i,r){this._authStateManager=n;this._dialogManager=t;this._rootElements=i;this._windowManager=r;this.isShellInitialized=Q.defer();this._pageBlockingPrompt=!1;this._isDialogVisible=!1;this._unknownNetworkErrorCount=0;this._unknownNetworkErrorCanceled=!1}return n.prototype.onLastTokenRefresh=function(n,t){var i=Date.now();if(t<=i)this.onStatus({code:2},n);at.forEach((function(n){var r=t-n;l.setTimeout((function(){var t=Math.floor(n/6e4),i=t>10?nt.messageFmt.format(t):nt.message;a(nt.title,i,"lastTokenRefresh")}),r-i)}))},n.prototype.onStatus=function(n,t){var s=this,r=Q.resolve(null),u,e,o;if(!n||this._pageBlockingPrompt)return r;var f=t===d||t===p.Constants.ExtensionNames.Hubs,i=n.data||{},h=i.uri||"";switch(n.code){case 0:break;case 1:f?r=this._showDialog(t,w.ShellVersionChanged,c.newVersionMessageTitle,c.newVersionMessageDescription,c.newVersionDefaultButtonText,null,3e4,2,5,i):(rt.trace({source:ft.Shell,action:w.ExtensionVersionChanged,data:t}),k.warning("Extension reporting incompatible server version. {0}:{1}".format(t,i.version)),a(st.title,st.messageFmt.format(t),"VersionChanged-{0}".format(t)));break;case 2:f&&i.isPrimaryToken?(this._authStateManager.clear(),this._windowManager.redirect({uri:ct+"/UE_SessionExpired"+window.location.hash})):a(ot.title,ot.messageFmt.format(t),"AuthTokenError-{0}".format(t));break;case 7:r=this._showDialog(d,"SessionExpired",c.sessionExpired,c.sessionExpiredMessage,c.refresh,null,0,1,2,i);break;case 4:if(k.verbose("Received a status code zero from extension {0} for URL '{1}'.".format(t,h)),!f)break;if(this._unknownNetworkErrorCount>3||this._isDialogVisible||this._unknownNetworkErrorCanceled)break;this._unknownNetworkErrorCount++;r=this._showDialog(d,w.UnknownNetworkError,c.connectionErrorMessageTitle,c.connectionErrorMessageDescription,null,c.connectionErrorCancelButtonText,0,2,0,i).then((function(n){s._unknownNetworkErrorCanceled=n===1}));break;case 6:u=c.tooManyRequestsDescription;e=i.retryAfter;e&&(u=u+" "+c.tooManyRequestsRetry.format(e));a(c.tooManyRequestsTitle,u,"TooManyRequests-{0}".format(t),ut.Warning,!0);break;default:o="Received unknown extension event '{0}' for extension '{1}'.".format(n.code,t);r=Q.reject(o);k.error(o)}return r},n.prototype._showDialog=function(n,t,r,u,f,e,o,s,h,a){var v=this,w,b=tt(h,2),y,k,p,d;return this._pageBlockingPrompt=tt(h,1),t&&rt.trace({source:ft.Shell,action:t,data:n}),b&&this._authStateManager.clear(),y=function(n){v._windowManager.redirect({skipFlushBuffers:b,delayPromise:n&&o?Q.delay(o):null})},k=tt(h,4)&&Q.isPending(this.isShellInitialized.promise),k?(w=Q.defer().promise,y(!1)):(p=Q.defer(),this._isDialogVisible=!0,d=u+" "+vt,w=this._dialogManager.showModalDialog({title:r,description:d,templateViewModel:{copyText:c.copyText,copyClick:function(){var u=JSON.stringify(i.extend2(lt,a||{}),null,2),n=document.createElement("pre"),t,r;n.textContent=u;$("body").append(n);t=l.getSelection();t.removeAllRanges();r=document.createRange();r.selectNodeContents(n);t.addRange(r);l.document.execCommand("copy");n.remove()}},defaultButtonText:f,cancelButtonText:e,buttons:s,uiShield:{hidePromise:p.promise}}).then((function(n){return v._pageBlockingPrompt?(v._rootElements.showSplash(!0),p.resolve(),y(!0)):n===4?y(!1):p.resolve(),n})).finally((function(){v._isDialogVisible=!1}))),w},n})();y=__decorate([f.Class(),__metadata("design:paramtypes",[v,s.DialogManager,h.RootElements,h.WindowManager])],y);t.StatusHandler=y}));
define("MsPortalImpl/Services/Services.SecurityTokens",["require","exports","f","i","o","FxInternal/Di","MsPortalImpl/UI/UI.StatusHandler"],(function(n,t,i,r,u,f,e){"use strict";var c,p,v;u.defineProperty(t,"__esModule",{value:!0});var w=r,l=w.Extension,o=i.Base,b=o.Net2,et=o.Constants,k=o.Constants.ExtensionNames.Hubs,d=o.Diagnostics,g=d.Telemetry,ot=o.Resources,st=o.Security,ht=w.Security,nt=d.createLog(n),ct=ot.getAppRelativeUri("/api/DelegationToken?feature.tokencaching="+i.isFeatureEnabled("tokencaching")),s=ht.tokenErrors,h="",a=et.Shell.toLowerCase(),lt=s.accessDenied,tt=s.unknown,it=s.sessionEnded,rt=s.credentialsExpired,at=s.networkError,vt=s.nullToken,y=Date.now,ut=l.getWindowId,yt=(function(){function n(){}return n.prototype.getToken=function(n,t,r,u){var e={extensionName:n,resourceName:r,tenant:t,portalAuthorization:u},o=g.start({source:"Services.SecurityTokens",action:"Get",name:n}),f;return Q(b.postJSON({uri:ct,dataType:"json",setAuthorizationHeader:!1,performRetry:!0},e)).catchError(i.Errors.AjaxError,(function(t){return f="Failed to get tokens for extension '{0}' resource '{1}'. {2} {3} {4}".format(n,r,t.jqXHR.status,t.textStatus,t.errorThrown),Q.reject(t)})).finally((function(){g.endTrace(o,!f,f||r)}))},n})(),ft=(function(){function n(n,t){var r=this._refreshToken=t.refreshToken,i;this._pendingAuthorization=Q.resolve(r);this._client=n;i=this._user=t.user;this._tenant=i&&i.tenantId}return n.prototype.getToken=function(n,t){var i=this;return this._pendingAuthorization.then((function(r){var u=i._client.getToken(n,i._tenant,t||h,r).catch((function(n){var i=n.data||{},t=i.status,u;return u=t===401?rt:t?tt:at,{portalAuthorization:r,value:{authHeader:null,expiresInMs:0,refreshToken:null,error:u,errorMessage:"code: {0}, statusText: {1}, message: {2}, stack: {3}".format(t,i.statusText,n.message,n.stack||"")}}}));return i._pendingAuthorization=u.then((function(n){return i._refreshToken=n.portalAuthorization||r})),u}))},n.prototype.getRefreshToken=function(){return this._refreshToken},n.prototype.getDiagnosticsData=function(){return{user:this._user}},n})();t.OAuthTokenProviderImpl=ft;c=(function(){function n(){}return n.create=function(n){var t;return n.bootstrapState.refreshToken&&(t=new ft(new yt,n.bootstrapState)),t},n})();__decorate([f.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[e.AuthStateManager]),__metadata("design:returntype",c)],c,"create",null);t.OAuthTokenProvider=c;p=(function(){function n(n,t,i,r,u){this._hubsWindowId=l.getHubsWindowId();this._extensionTokenSettings={};this._sessionEnded=!1;this._authStateManager=n;this._hubsWindowId=l.getHubsWindowId();this._tokenProvider=i;this._rpcClient=t;this._sessionEndedHandler=r;this._tokenFailedHandler=u}return n.prototype.initializeSecurityForShell=function(n){var t=n||{},i=t.oAuthToken,f=t.refreshToken,r=t.createdOn||y(),u=f?this._createShellTokenFunc(i,r):createTestInProdTokenFunc(i,r,this._sessionEndedHandler);return this._enableShellTokenAccess(),b.initialize(u),u},n.prototype.registerGetAuthorizationTokenEndpoint=function(n){var t=this;this._extensionTokenSettings=i.convertArrayToMap(n,(function(n){return ut({name:n.name.toLowerCase()}).toLowerCase()}),(function(n){return n.tokenSettings}));this._enableShellTokenAccess();l.getAuthorizationTokenEndPoint.register(this._rpcClient,null,(function(n,i){var r;return r=i.srcWindowId===t._hubsWindowId?ut({name:k}):i.srcWindowId,t._getSecurityToken(r,n.resourceName||h,n.isBackground)}))},n.prototype.getDiagnosticsData=function(){return this._tokenProvider.getDiagnosticsData()},n.prototype._getSecurityToken=function(n,t,i){var u=this,e=n.toLowerCase(),f=this._extensionTokenSettings[e],r=this._shellTokenCache;return t&&f&2?Q({error:lt}):this._sessionEnded?Q({error:it}):r&&!t&&f&1?r.getToken({resourceName:""}).then((function(n){return{token:n}})):this._tokenProvider.getToken(n,t,i).then((function(f){var c=y(),e=f&&f.value||{},o=e?e.error:vt,p=e.errorMessage,l,s,w,b,v;return!o&&e.authHeader?{token:{header:e.authHeader,expiresAt:c+e.expiresInMs}}:(l=o===rt,(o===it||l)&&(u._sessionEnded=!0,s=void 0,l||!r?s=c:(w=n===a?t:h,s=r.getTokenExpiresAt(w)),u._sessionEndedHandler(n,s||c)),i||(b=!t&&(n===a||n===k),u._tokenFailedHandler(n,b),v="Failed to get token for {0} & {1}. Error:{2}. Message:{3}".format(n,t,o,p),o===tt?nt.error(v):nt.verbose(v)),{error:o,errorMessage:p})}))},n.prototype._createShellTokenFunc=function(n,t){var i=this,u={},r,f;return n&&(r=n.expiresInMs||1,u[h]={header:n.authHeader,expiresAt:r>0?t+r:-1}),f=this._shellTokenCache=st.createAuthTokenCache((function(n){return i._getSecurityToken(a,n?n.resourceName:h,n.isBackground).then((function(t){var u=(t||{}).token;if(!!u&&n.resourceName===h){var f=y(),r=i._authStateManager.bootstrapState||{},e={authHeader:u.header,expiresInMs:u.expiresAt-f,refreshToken:i._tokenProvider.getRefreshToken()||r.refreshToken},o={aadSessionId:r.aadSessionId,refreshToken:r.refreshToken,user:r.user,createdOn:f,oAuthToken:e};i._authStateManager.bootstrapState=o}return t}))}),u),function(n){return f.getToken(n).then((function(n){return n&&n.header}))}},n.prototype._enableShellTokenAccess=function(){this._extensionTokenSettings[a]=0},n})();t.SecurityTokensManagerImpl=p;v=(function(){function n(){}return n.create=function(n,t,i,r){var u=function(n,t){return r.onLastTokenRefresh(n,t)},f=function(n,t){r.onStatus({code:2,data:{isPrimaryToken:t}},n)};return new p(n,t,i,u,f)},n})();__decorate([f.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[e.AuthStateManager,r.Rpc.Client,c,e.StatusHandler]),__metadata("design:returntype",v)],v,"create",null);t.SecurityTokensManager=v}));
define("MsPortalImpl/Services/Services.SelectedSubscriptions",["require","exports","f","i","o","a","ko","FxHubs/HubsSettingsSchema","FxHubs/RpcEndPoints","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Services/Services.Settings"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";function rt(){l=undefined;a=undefined;y=undefined}function d(n){var i=(n||[]).map((function(n){return n.subscriptionId})).join(";");t.userSettingsManager.setSetting(p,b,i)}function ct(n,t){var r=(n.state||"").toLowerCase(),u=(t.state||"").toLowerCase(),i;if(r!==u){if(r===it)return 1;if(u===it)return-1}return i=n.displayName.localeCompareIgnoreCase(t.displayName),i===0&&(i=n.subscriptionId.localeCompareIgnoreCase(t.subscriptionId)),i}function w(n,t){var u=n||[],r=[],f;return t&&t.length&&(f=i.convertArrayToMap(t,(function(n){return n})),r=u.filter((function(n){return!!f[n.subscriptionId]}))),(r.length?r:u).stableSort(ct)}function lt(n){rt();t.userSettingsManager=n;var i=ht.getHubsWindowId();st.getOrSetUserSettingsSelectedSubscriptionsEndPoint.register(c.client,[i],(function(n){return n&&d(n),t.userSettingsManager.querySetting(p,b).then((function(n){return n&&n.split(";")||[]}))}));nt.Azure.getSelectedSubscriptionsEndPoint.register(c.client,null,(function(){return g()}));t.selectedSubsUpdateTriggered.subscribe(new nt.TriggerableLifetimeManager,(function(n){ot.pingSelectedSubscriptionsListEndPoint.invoke(c.client,et.ExtensionNames.Hubs,n)}))}function g(){if(l)return Q(l);if(!y){var n=void 0;i.isFeatureEnabled("mgsubs")?(n=Q(v.getSelectedSubscriptions(c.client)),Q.spread([n,v.getAllSubscriptionsCount(c.client),],(function(n,i){return n=n||[],t.allSubscriptionsSelected(i.type===1&&n.length===i.value),l=n,n}))):n=Q(i.Azure.getAllSubscriptions()).then((function(n){return t.userSettingsManager.querySetting(p,b).then((function(i){var f=(i||"").split(";"),r=w(n,f),u;return t.allSubscriptionsSelected(n.length===r.length),r.length>t.selectedSubscriptionsCap&&(r=r.slice(0,t.selectedSubscriptionsCap),d(r),u=n.length,tt.ClientNotification.publish({status:tt.NotificationStatus.Information,title:k.cappedTitleFmt.format(t.selectedSubscriptionsCap,u),description:k.cappedFmt.format(t.selectedSubscriptionsCap,u),uri:"#menu/settings"})),l=r,r}))}));y=n.catch((function(n){return y=null,Q.reject(n)}))}return y}function at(){return!a||!a.length?g():Q(a)}function vt(n){return i.isFeatureEnabled("mgsubs")?v.processSelectedSubscriptionChanges(c.client,n).then((function(n){a=n.selectedSubscriptions})):t.getAllSubscriptions().then((function(t){a=w(t,n)}))}function yt(n){var r=i.isFeatureEnabled("mgsubs"),u=function(n,i){var u=n.length,f=u===i;l=n.slice(0);t.selectedSubsUpdateTriggered(l);r&&u>100&&(n.length=100);d(f?[]:n);t.allSubscriptionsSelected(f)};return r?Q.spread([v.processSelectedSubscriptionChanges(c.client,n),v.getAllSubscriptionsCount(c.client),],(function(n,t){u(n.selectedSubscriptions,t.value)})):t.getAllSubscriptions().then((function(t){var i=w(t,n);u(i,t.length)}))}var k,p,y,l,a;u.defineProperty(t,"__esModule",{value:!0});var ut=o.Keys,nt=r,ft=i.Base,et=ft.Constants,c=r.Rpc,ot=s.SelectedSubscriptions,st=s.Subscriptions,ht=r.Extension,tt=i.Hubs.Notifications,v=s.Impl,b=ut.subscriptionsSelected,it="disabled";t.selectedSubscriptionsCap=60;k=h.SubscriptionsNotification;p=6;t.allSubscriptionsSelected=e.observable(!0);t.selectedSubsUpdateTriggered=e.observable();t.resetState=rt;t.getValidSelectedSubscriptions=w;t.init=lt;t.getSelectedSubscriptions=g;t.getAllSubscriptions=i.memoizeQ((function(){return Q(i.Azure.getAllSubscriptions())}));t.getSelectedSubscriptionsInSession=at;t.setSelectedSubscriptionsInSession=vt;t.setSelectedSubscriptions=yt}));
define("MsPortalImpl/Services/Services.SharedSettings",["require","exports","i","o"],(function(n,t,i,r){"use strict";function h(){e.getSharedSettingsEndPoint.register(o.client,null,(function(){return f()}))}function f(){return Q.fcall((function(){return{links:{accountPortal:u.accountPortal,classicPortal:u.classicPortal,createSupportRequest:u.createSupportRequest,helpAndSupport:u.helpAndSupport,manageSupportRequests:u.manageSupportRequests,giveFeedback:u.giveFeedback,privacyAndTerms:u.privacyAndTerms,learnRelatedResources:u.learnRelatedResources,resourceGroupOverview:u.resourceGroupOverview,roadmap:u.roadmap}}}))}r.defineProperty(t,"__esModule",{value:!0});var e=i.Extension,o=i.Rpc,s=window,u=s.fx.environment.links;t.initializeRpc=h;t.getSharedSettings=f}));
define("MsPortalImpl/Services/Services.ShellProvisioner",["require","exports","f","i"],(function(n,t,i,r){"use strict";var u;return (function(t){function c(n){return o||(o=new f(n.desktop,n.rpcClient))}var u=r.ViewModels.ParameterCollectionV3,s=i.Base,h=s.Diagnostics,e,o,f;t.promiseCleanupDelay=3e4;e=h.createLog(n);t.create=c;f=(function(){function n(n,t){this.provisioningPromisesLookup={};this._desktopManager=n;this._registerRpcCallbacks(t)}return n.prototype.processProvisioningRequest=function(n){var f=this,r=!0,t="Provisioning request is ",u,i;if(!n)throw new Error(t+" undefined.");if(u=n.provisioningRefKey,!u)throw new Error(t+"missing the provisioningReferenceKey.");if(!n.provisioningPromise)throw new Error(t+"missing the provisioningPromise.");return n.provisioningPromise.catch((function(n){var t=(n||{}).error||n;f._logWarning("Provisioning promise rejected. "+(t.message||JSON.stringify(t)))})),n.provisioningConfig&&!!n.provisioningConfig.dontDiscardJourney&&(r=!1),r&&(i=this._desktopManager.getActiveJourney(),i&&this._desktopManager.forceDiscardJourney(i.id)),n.provisioningPromise},n.prototype._registerRpcCallbacks=function(n){var t=this;u.initiateProvisioningRequestEndPoint.registerObjectFactory(n,{allowedOrigin:null,allowRemoteChanges:!0,handler:function(i,r){var e=r.srcWindowId,f="Can't initiate the provisioning request. ";return i.provisionerId?i.provisioningRefKey?(u.getProvisioningRequestEndPoint.acquireObject(n,e,i).then((function(n){var i=n.getValue();t.processProvisioningRequest(i).finally((function(){n.dispose()}))}),(function(n){throw new Error(n);})),Q(i)):Q.reject(f+"provisioningRefKey unspecified."):Q.reject(f+"provisionerId unspecified.")}});u.getProvisioningOperationEndPoint.registerObjectFactory(n,{allowedOrigin:null,allowRemoteChanges:!0,handler:function(n){if(!n)return Q.reject("Can't return provisioning operation. provisioningRefKey unspecified.");var i=t.provisioningPromisesLookup[n],r=i&&i.promise;return r&&(t.provisioningPromisesLookup[n].wasAcquired=!0),Q({provisioningPromise:r,data:i&&i.data})}})},n.prototype._logWarning=function(n){e.warning(n)},n})();t.ShellProvisionerImpl=f})(u||(u={})),u}));
define("MsPortalImpl/Services/Services.TelemetrySharing",["require","exports","f","i","o"],(function(n,t,i,r,u){"use strict";function c(n){return o.registerExtensionUnloadCallback(n),o}u.defineProperty(t,"__esModule",{value:!0});var s=i.Base,e=s.Constants,f=r.Rpc,h=(function(){function n(){var n=this;this._extensions={};f.client.registerRpcEndPoint(e.TelemetrySharing.RegisterExtension,{allowedOrigin:null,handler:function(){n._extensions[f.messageContext.srcWindowId]=!0}})}return n.prototype.registerExtensionUnloadCallback=function(n){var t=this;n.onUnload((function(n){var i=r.Extension.getWindowId(n);return t._extensions[i]&&delete t._extensions[i],!0}))},n.prototype.trace=function(n){var t=n.extension,i=n.data&&n.data.srcExtension,r=e.TelemetrySharing.TraceTelemetry;this._extensions[t]&&f.client.invokeRpc(r,t,n);t!==i&&this._extensions[i]&&f.client.invokeRpc(r,i,n)},n.prototype.flush=function(){return i.Helpers.Deferred().resolve().promise()},n})(),o=new h;t.getProcessor=c}));
define("MsPortalImpl/Services/Services.Util",["require","exports","f","i","o"],(function(n,t,i,r,u){"use strict";function c(n,t){var i="./Services.UtilHandlers";f(e.pinParts,i,"pinPartsRpcHandler",n,{desktop:t});f(e.getClientIp,i,"getClientIpHandler",n);f(e.getHmacSha256,i,"hmacShaRpcHandler",n);f(s,i,"x509CertificateRpcHandler",n);f(h,i,"getPublishingProfileRpcHandler",n,null,[""+o.ClassicResources,"fx"])}function f(t,r,u,f,e,o){return f.registerRpcEndPoint(t,{allowedOrigin:o,handler:function(t,f,o){return i.require(n.normalize(r)).then((function(n){var i=n[u];return i(t,f,o,e)}))}})}u.defineProperty(t,"__esModule",{value:!0});var e=r.Constants.RpcMethods,o=i.Base.Constants.ExtensionNames,s="MsPortalFx.Internal.Constants.RpcMethods.X509Certificate.getX509Certificates",h="MsPortalFx.Internal.Constants.RpcMethods.PublishingProfile.getPublishingProfile";t.registerEndpoints=c}));
define("MsPortalImpl/UI/Compositions/UI.Composition.PropertyTransformers",["require","exports","f","a","ko","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding"],(function(n,t,i,r,u,f){"use strict";var e;return (function(t){var o=i.Base.Diagnostics,e=o.createLog(n),s;(function(n){function h(){var n=function(n){var t=n.propertyChanges||[],i=t.length===1&&t[0].propertyValue,r=(i||{}).hasOwnProperty("detailBladeInputs");return i&&!r&&e.error(o.invalidNewValue.format(n.sourceModelId,JSON.stringify(n))),r};return function(t){if(n(t)){var i=t.propertyChanges[0],r=i.propertyValue;i.propertyValue=r.detailBladeInputs}}}function c(){return function(n){var t,r,u=n.propertyChanges||[];if(u.length===1&&i.isPlainObject(u[0].propertyValue)){t=n.propertyChanges[0].propertyValue;n.propertyChanges=[];for(r in t)t.hasOwnProperty(r)&&n.propertyChanges.push(f.ObservableChangeArgs.forObject(r,t[r]))}}}function l(){var n=function(n,t){var i=!0;return r.isArray(t)?t.length!==1&&(i=!1):(e.error(s.invalidNewValue.format(n.sourceModelId,JSON.stringify(t))),i=!1),i};return function(t){var r=u.unwrap(f.getModelValue(t.sourceModel,t.sourceProperty).value)||[],i;n(t,r)?(i=t.propertyChanges[0],i.kind=0,i.propertyValue=r[0],i.propertyArrayEdits=null):t.cancel=!0}}function a(){var n=null,o=function(n,i){var u=!0;return!i||!i.propertyChanges||i.propertyChanges.length<1?(e.error(t.invalidPropertyChange.format(i.sourceModelId,JSON.stringify(i))),u=!1):r.isArray(i.propertyChanges[0].propertyValue)||i.propertyChanges[0].propertyArrayEdits&&i.propertyChanges[0].propertyArrayEdits.length>0?(e.error(t.invalidNewValue.format(i.sourceModelId,JSON.stringify(i))),u=!1):r.isArray(n)||(e.error(t.invalidCurrentValue.format(i.sourceModelId,n)),u=!1),u};return function(t){var s=u.unwrap(f.getModelValue(t.targetModel,t.targetProperty).value),r,h,e,c=function(n,t){return n.firstIndex((function(n){return i.deepEquals(n,t)}))};o(s,t)&&(h=n===undefined?-1:c(s,n),r=t.propertyChanges[0],e=u.unwrap(r.propertyValue),r.propertyArrayEdits=[],r.kind=1,h>=0&&n!==e&&r.propertyArrayEdits.push({status:"deleted",index:h,moved:null,value:n}),e!==undefined&&c(s,e)===-1&&r.propertyArrayEdits.push({status:"added",index:0,moved:null,value:e}),n=e);t.cancel=!r||!r.propertyArrayEdits||!r.propertyArrayEdits.length}}var o={invalidNewValue:"[DynamicSelectionTransformer] [{0}] Source value does not implement MsPortalFx.ViewModels.DynamicSelection. Transformer Args: '{1}'"},s={invalidNewValue:"[ManyToOneTransformer] [{0}]: Source value '{1}' must be an array."},t={invalidPropertyChange:"[OneToManyMergeTransformer] [{0}]: No property change detected on source. Transformer Args: '{1}'.",invalidNewValue:"[OneToManyMergeTransformer] [{0}]: Source cannot be an array. Transformer args: '{1}'",invalidCurrentValue:"[OneToManyMergeTransformer] [{0}]: Target value '{1}' must be an array."};n.getDynamicSelectionMapper=h;n.getModelToPropertyMapper=c;n.getManyToOne=l;n.getOneToManyMerge=a})(s=t.PropertyTransformers||(t.PropertyTransformers={}))})(e||(e={})),e}));
define("MsPortalImpl/UI/Compositions/UI.Composition.CompositionBinder",["require","exports","f","o","a","ko","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/UI/Compositions/UI.Composition.PropertyTransformers"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";function tt(n){var t=Q();return{getStateAsyncSequenced:function(){return t=t.then(n,n)}}}var it;r.defineProperty(t,"__esModule",{value:!0});var w=FxImpl,b=w.TelemetryContext,k=i.Base,d=k.Diagnostics,c=e.ReferenceScope;t.onInputsSetTimeout=5e3;var v=window,y=i.trace,g=y.inputsset,nt=y.shellinputsset,l=d.createLog(n),p=e.extractTraceOptions,a=e.ReferenceCardinality;(function(n){function ut(n,t,i,r){var u=function(i,r){var u=t.mapProperty(i.source.property,i.targetProperty);u.transformers=ei(i);u.compositionBindingDefinition=i;r?u.bind(r.sourceModelName,r.sourceModel):at(n,u)};i&&i.forEach((function(n){var i=r&&r(n),o=n.source.constantValue,c,s,h;i&&i.overridesConstantBindings?u(n,i):o!==undefined?(c="[Constant: {0}]".format(f.toJSON(o)),s={},e.setModelValue(s,n.source.property,o),h=t.mapProperty(n.source.property,n.targetProperty),h.compositionBindingDefinition=n,h.bind(c,s)):u(n,i)}))}function yt(n,t,i){var r=(t||[]).every((function(n){return i&&e.getModelValue(i,n).exists}));return r||l.error("Model '{0}' is missing properties. Expected properties:'{1}', model:'{2}'".format(n,JSON.stringify(t)||"<null>",JSON.stringify(f.toJS(i))||"<null>")),r}function pt(n,t,i){var r=(t||[]).every((function(n){var t=i&&e.getModelValue(i,n);return t&&t.exists&&f.unwrap(t.value)!==undefined}));return r||l.error("Model '{0}' is missing required properties or has them set to undefined. Required properties:'{1}', model:'{2}'".format(n,JSON.stringify(t)||"<null>",JSON.stringify(f.toJS(i))||"<null>")),r}function wt(n){var r={},t,i;for(t in n)n.hasOwnProperty(t)&&(i=f.toJS(n[t]),r[t]=u.isArray(i)?f.observableArray(i):f.observable(i));return r}function ft(n,t,r){return i.mapMany(n||[],(function(n){return(n.valuesFrom||[]).map((function(i){var u={property:i.property,modelType:i.referenceType,constantValue:i.constantValue,scope:c.CurrentContainer,cardinality:n.valuesFrom.length>1?a.OneToMany:a.OneToOne},e={targetProperty:n.property,source:u,optional:!!n.optional,isIdentityInput:!!n.isIdentityInput},f=i.part,s=t.locator.name;return(i.referenceType===0||i.partCommand)&&(u.partLocator=t.locator.getExtensionLocator().withPartInstance(f||s),o.isPartComposition(t)&&(!f||f===s)&&(u.id=t.id)),i.referenceType===4&&(u.modelId=i.bladeCommand||i.partCommand),r&&r(e,i),e}))}))}function bt(n){return(n||[]).forEach((function(n){var t=n.source,i=t&&t.partLocator;i&&(t.partLocator=s.Locator.fromJSON(i))})),n}function kt(n){return(n||[]).map((function(n){var t={targetProperty:n.targetProperty};return n.source&&(t.sourceProperty=n.source.property,t.sourcePartLocator=n.source.partLocator&&n.source.partLocator.toString(),t.sourceType=o.referenceTypeMap[n.source.modelType]||n.source.modelType,t.sourceScope=c[n.source.scope],t.sourceCardinality=a[n.source.cardinality]),t}))}function et(n,t){var i=!1;return o.isPartComposition(n)&&!n.isDisposed()&&(i=t.id?n.id===t.id:n.eligibleForBinding&&n.locator.getExtensionLocator().withPartInstance(n.locator.name).equals(t.partLocator)),i}function dt(n){var t=ot(n);return t.inputsWatcherConfig&&k(t.inputsWatcherConfig),t}function ot(n){var i=[],t={allInputsSet:f.observable(!1),calledOnInputsSet:f.observable(!1),failedOnInputsSet:f.observable(!1),definitionBindings:[],propertyBindings:new e.PropertyBindings(n.bindableTarget.viewModelName,{},!1)};return st(n.referenceComposition,n.inputs,i,n.customInputBindingValidator)?(t.definitionBindings=ft(n.inputs,n.referenceComposition),ut(n.referenceComposition,t.propertyBindings,t.definitionBindings,n.customBindHandler),t.inputsWatcherConfig=w({bindableTarget:n.bindableTarget,allInputsSet:t.allInputsSet,calledOnInputsSet:t.calledOnInputsSet,failedOnInputsSet:t.failedOnInputsSet,propertyBindings:t.propertyBindings,referenceComposition:n.referenceComposition,referenceCompositionIsContainer:n.referenceCompositionIsContainer,notifyWhenInputsChangeWithSameValues:!1,beforeViewModelPropertyUpdate:n.beforeViewModelPropertyUpdate,inputsSetCalled:n.inputsSetCalled})):l.error("{0} Reference: {1}.".format(JSON.stringify(i),n.bindableTarget.viewModelName)),t}function gt(n){k(w(n))}function w(n){return i.extend2(n,{propertyBindingsState:undefined,inputsSetTrace:g,shellInputsSetTrace:nt,stateReader:!!n.getStateAsync&&tt(n.getStateAsync)})}function k(n){var t,i;if(y(n,null,n.calledOnInputsSet()),!n.allInputsSet()){t=fi(n.propertyBindings);n.referenceComposition.onDispose((function(){it(t)}))}i=n;i.onInputsSetDiagnosticsHandle=t;n.propertyBindings.addPropertyChangedHandler((function(){i.onInputsSetCallsSuppressed||y(n,t)}))}function st(n,t,i,r){var u,f=o.isPartComposition(n);return(t&&t.some((function(n){return n.property?n.valuesFrom&&n.valuesFrom.length===1?f||n.valuesFrom[0].referenceType!==0||n.valuesFrom[0].part?n.valuesFrom[0].referenceType===5&&n.valuesFrom[0].constantValue===undefined?u="'constantValue' must be defined if using 'Constant' reference type.":n.valuesFrom[0].constantValue!==undefined&&n.valuesFrom[0].referenceType!==5?u="'constantValue' can only be be defined when using 'Constant' reference type.":r&&(u=r(n)):u="Input binding that reference a Part must specify the source part name.":u="Input binding must define one and only one source valueFrom property.":u="Input binding must define a target property.",u||n.valuesFrom[0].referenceType!==4||(n.valuesFrom[0].bladeCommand||n.valuesFrom[0].partCommand?n.valuesFrom[0].bladeCommand&&n.valuesFrom[0].partCommand?u="Only one, 'bladeCommand' or 'partCommand' is allowed when using 'Command' reference type.":n.valuesFrom[0].part&&(u="'part' is not allowed when using 'Command' reference type."):u="'bladeCommand' or 'partCommand' is required if using 'Command' reference type."),!!u})),u)?(i.push(u),!1):!0}function r(n,t){var r=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return"| "+t.map((function(n){return(n.toString()+"                    ").slice(0,15)})).join("")},i=["-----------",r("Optional","isBound","hasValue","Input: Value"),],u=t.properties.map((function(n){return"{0}{1}: {2}".format(r(d(n),n.isBound,n.targetHasValue),n.targetProperty,f.toJSON(n.targetHasValue?e.getModelValue(t.targetModel,n.targetProperty).value:undefined))}));i=i.concat(u);i.push("-----------");l.verbose("{0} Target Model: {1}\n{2}".format(n,t.targetModelName,i.join("\n")))}function y(n,t,i,r,u,f){function o(t){var i;return t&&(t.dontCallViewModelOnInputsSet=u,b.usingState((function(){i=ii(n,t)}),n.referenceComposition.getCreationState())),f?i:undefined}var e=ht(n,t,i,!0,r);return e.then(o)}function ni(n){var t=n;t.onInputsSetCallsSuppressed=!0}function ti(n,t,i){var r;t===void 0&&(t=1);i===void 0&&(i=!1);r=n;r.onInputsSetCallsSuppressed=!1;var u=r.onInputsSetDiagnosticsHandle,f=!!(t&1),e=!!(t&2),o=!!(t&4);return y(n,u,f,e,o,i)}function ht(n,t,u,e,o){var a=!n.propertyBindings.properties.some(ui),h=p(n.bindableTarget.viewModelName,n.inputsSetTrace),c=h&&h.verbose,s,l;return a?(s=f.toJS(n.propertyBindings.targetModel),!e&&!i.canSendThroughPostMessage(s))?(n.propertyBindingsState=undefined,Q(null)):(it(t),!u&&n.notifyWhenInputsChangeWithSameValues||o||!i.deepEquals(s,n.propertyBindingsState)?(n.allInputsSet(!0),n.propertyBindingsState=s,l=void 0,l=n.beforeViewModelPropertyUpdate?n.beforeViewModelPropertyUpdate(s).then((function(t){if(t)return ct(n,h);c&&r("onInputsSet not called, RBAC check failed.",n.propertyBindings)})):ct(n,h),Q.all([l,n.getInputsMetadata&&n.getInputsMetadata()]).spread((function(t,i){var r={inputs:s,settings:t,traceOptions:h,viewModelName:n.bindableTarget.viewModelName,inputsMetadata:i,dontCallViewModelOnInputsSet:undefined,dashboardFilters:n.getDashboardFilters&&n.getDashboardFilters(),partFilters:n.getPartFilters&&n.getPartFilters()};return ri(n,r)?r:null}))):(c&&r("onInputsSet not called, new values are the same as current values.",n.propertyBindings),Q(null))):(c&&r("onInputsSet not called, missing required properties.",n.propertyBindings),n.propertyBindingsState=undefined,Q(null))}function ct(n,t){var f=n.referenceComposition,i,u;return(!f||!f.isDisposed())&&(i=n.bindableTarget,!i.viewModel||i.viewModel.updatePartInputValues)?(u=n.stateReader,u?u.getStateAsyncSequenced().then((function(n){return n||{}}),(function(){t&&t.verbose&&r("onInputsSet not called, failed to retrieve part settings.",n.propertyBindings);n.failedOnInputsSet(!0)})):Q({})):Q(null)}function ii(n,t){var u=n.bindableTarget.viewModel,f=t.inputs,e=t.settings,o=t.traceOptions,s=t.viewModelName,h=t.inputsMetadata,c=t.dontCallViewModelOnInputsSet,l=t.dashboardFilters,a=t.partFilters,v=i.extend2(l||{},a),r=u.updatePartInputValues(f,e,o,s,h,c,v);return lt(n,t,r),r}function ri(n,t){var s=t.inputs,e=t.settings,o=t.traceOptions,i,u;return e&&(!n.referenceComposition||!n.referenceComposition.isDisposed())?(i=n.bindableTarget.viewModelName,u=p(i,n.shellInputsSetTrace),o&&o.verbose&&r("onInputsSet will be called, all required properties are set.",n.propertyBindings),u&&(l.verbose("Invoking onInputsSet of view model '{0}'.\nInputs: {1}.\nSettings: {2}".format(i,f.toJSON(s),f.toJSON(e))),!!u.breakOnInputsSet),!0):!1}function lt(n,t,i){n.calledOnInputsSet(!0);n.inputsSetCalled&&n.inputsSetCalled(t.inputs,i||Q({}))}function ui(n){return n.targetHasValue?!1:!d(n)}function d(n){var t=n.compositionBindingDefinition,r=t&&t.optional,i=t&&t.source,u=i&&i.scope===c.DetailsContainer,f=r||u;return!!f}function fi(n){var i={handle:v.setTimeout((function(){var t,r,u;it(i);t=[];r=[];n.properties.forEach((function(n){var i=d(n),u="Target Input Name: {0} \nSource Model Name: {1} \nSource Property Name: {2} \nOptional: {3}".format(n.targetProperty,n.isBound?n.sourceModelName():"<UNBOUND>",n.isBound?n.sourceProperty:"<UNBOUND>",i);n.targetHasValue||i?r.push(u):t.push(u)}));u="onInputsSet is taking more time than expected for target model: {0}\n=== Missing Required Properties === \n{1}\n\n=== All Other Properties === \n{2}";l.warning(u.format(n.targetModelName,t.join("\n\n"),r.join("\n\n")))}),t.onInputsSetTimeout)};return i}function it(n){n&&n.handle&&(v.clearTimeout(n.handle),n.handle=null)}function ei(n){var t=[];return n.source.cardinality===a.OneToMany?t.push(h.PropertyTransformers.getOneToManyMerge()):n.source.cardinality===a.ManyToOne&&t.push(h.PropertyTransformers.getManyToOne()),n.opensDynamicBlades&&t.push(h.PropertyTransformers.getDynamicSelectionMapper()),n.targetProperty||t.push(h.PropertyTransformers.getModelToPropertyMapper()),t}function at(n,t){if(!n.isDisposed()){var i=oi(n,t.compositionBindingDefinition.source),r=vt(n,i,t,t.compositionBindingDefinition.source);r(n,i,t,t.compositionBindingDefinition.source)}}function oi(n,t){var u=n.getPartsContainer(),i,r;switch(t.scope){case c.MasterContainer:i=u.masterContainer;break;case c.DetailsContainer:r=u.detailContainers.filter((function(n){return n&&!(n.flags&2)}));r.length>1?l.error("Unable to bind composition to detail blade, multiple detail blades found. Reference Composition: '{0}', Detail Blades: '{1}'.".format(n.toString(),r.map((function(n){return n.toString()})).join(","))):i=r.first();break;default:i=u}return i}function vt(n,t,i,r){return t?r.partLocator?r.modelType===4&&i.compositionBindingDefinition.source.scope!==c.MasterContainer?ci:hi:li:si}function si(n,t,i){n.getPartsContainer().awaitContainer(n,(function(t){return ai(n.getPartsContainer(),t,i.compositionBindingDefinition.source)})).done((function(t){var r=vt(n,t,i,i.compositionBindingDefinition.source);r(n,t,i,i.compositionBindingDefinition.source)}))}function hi(n,t,i,r){t.awaitComposedPart(n,(function(n){return et(n,r)})).done((function(t){rt(n,t,i)}))}function ci(n,t,i){rt(n,n,i)}function li(n,t,i){rt(n,t.getBindableContainer(),i)}function ai(n,t,i){var r=t.masterContainer;return t.isDisposed()?!1:t.locator.type!==s.LocatorType.Blade?!1:i.scope===c.MasterContainer?n.masterContainer&&n.masterContainer.id===t.id:i.scope===c.DetailsContainer?r&&r.id===n.id&&n.detailContainers.length===1:r&&r.id===n.id}function rt(n,t,i){var s=i.compositionBindingDefinition.source,r=s.modelType,u=s.modelId,h="[Composition: {0}, ModelType:{1}, ModelId:{2}]".format(t.toString(),r,u||"<null>"),c,f,e;r===1||r===8?(c=t.getViewModel(r,u),i.bind(h,c)):t.getViewModelAsync(r,u).done((function(n){t.isDisposed()||i.bind(h,n)})).fail((function(){n.isDisposed()||l.error("Failed to retrieve view model type '{0}' with id '{1}' from composition '{2}' to bind source property '{3}'.".format(o.referenceTypeMap[r]||r,u||"<none>",t.toString(),i.sourceProperty))}));f=function(){i.unbind();t.offDispose(e)};e=function(){i.unbind();i.compositionBindingDefinition.autoRebindWhenSourceDisposes&&at(n,i);n.offDispose(f)};t.onDispose(e);n.onDispose(f)}n.setupPropertyBindings=ut;n.modelHasProperties=yt;n.modelHasPropertiesWithValue=pt;n.createObservableModel=wt;n.mapInputBindingDefinitions=ft;n.bindingsFromJSON=bt;n.mapBindingsToFriendlyObjects=kt;n.isSourcePart=et;n.bindViewModelInputs=dt;n.createBindViewModelResult=ot;n.setupAllInputsSetWatcher=gt;n.createAllInputsSetWatcherConfigExtended=w;n.setupAllInputsSetWatcherFromExtendedConfig=k;n.validateInputBindings=st;n.callOnInputsSetIfNeeded=y;n.turnOnInputsSetSuppressionOn=ni;n.turnOnInputsSetSuppressionOff=ti;n.loadOnInputsSetParameters=ht;n.notifyOnInputsSetCalled=lt})(it=t.CompositionBinder||(t.CompositionBinder={}))}));
define("MsPortalImpl/Parts/Parts.Error",["require","exports","f","MsPortalImpl/Parts/Parts","MsPortalImpl/Widgets/Widgets.PartError"],(function(n,t,i,r,u){"use strict";var f;return (function(){var n=i.Parts,t=n.PartKind,e=i.ViewModels,f=(function(n){function t(t,i,r,u){var f=n.call(this,t,i,r,u)||this;return i.container.contentState(3),i.internal.allowUiBlocking(!1),f}return __extends(t,n),t.prototype._bindContent=function(n){var t=new u.ViewModel,i=this._viewModel.content,r;t.title=i.title||t.title;t.subtitle=i.subtitle||t.subtitle;t.reason=i.reason||t.reason;r=i.clickable;t.clickable=typeof r!="undefined"?r:t.clickable;this._lifetime.registerForDispose(this._control=new u.Widget($(n),t))},t})(r.PartImpl);r.registerFactory(t[n.PartKind.Error],r.createPartFactory("",{partClass:f}))})(f||(f={})),f}));
define("MsPortalImpl/Services/Services.EditScopeManagement",["require","exports","i","o","ko","FxInternal/Di","MsPortalImpl/Extension/ExtensionManager"],(function(n,t,i,r,u,f,e){"use strict";function v(n,t){return"{0}-{1}-{2}".format("editScopes",n,t)}function h(n){var t=n.split("-"),i=t.slice(1,t.length-1).join("-"),r=t[t.length-1];return{editScopeId:i,extension:r}}var o;r.defineProperty(t,"__esModule",{value:!0});var c=i,s=c.Data,l=c.Extension,y=i.Rpc,a=(function(){function n(n,t){var i=this;this._editScopes={};this._extensionManager=n;this._rpcClient=t;n.onUnload((function(n){var t=l.getWindowId(n);return i._onExtensionUnloaded(t),!0}))}return n.prototype.onEditScopeCreated=function(n){this._ensureEditScope(n,!0)},n.prototype.onEditScopeDisposed=function(n){var t=this,i=this._getDirtyExtensionSettings(n);i.forEach((function(i){var u=h(i.key).extension,f=l.getDescriptor(u),r=t._extensionManager.getExtension(f.name);r&&r.whenInitialized().then((function(){s.onEditScopeDiscardedEndPoint.invoke(t._rpcClient,r.getWindowId(),n)}))}));this._deleteEditScope(n)},n.prototype.getStateObservable=function(n){var r=this,t=this._ensureEditScope(n),i;return t.stateObservable||(i=u.observable(),t.stateObservable=u.pureComputed((function(){i();var u=r._getDirtyExtensionSettings(n).length>0;return u?t.savingRefCount()>0?2:1:0})),this._loadEditScope(n).then((function(){i(!0)}))),t.stateObservable},n.prototype.logEditsToConsole=function(n){var t=this._editScopes[n]&&this._editScopes[n].settings;t&&t.extensionSettings().forEach((function(n){var t=h(n.key);console.debug('Edits for editScopeId: {0}, extension: "{1}"'.format(t.editScopeId,t.extension));s.logEditsToConsole(n.settings)}))},n.prototype.loadEditScopeForExtension=function(n,t){var i=this;return this._loadEditScope(n).then((function(){var f=i._editScopes[n],r,e,u;return f?(r=f.settings,r?(e=v(n,t),u=r.extensionSettings().first((function(n){return n.key===e})),u?u.settings:null):null):null}))},n.prototype.saveEditScopeForExtension=function(n,t,i){var r=this._editScopes[n],u,f,e;this._canEditScopeBeUpdated(r)&&(u=v(n,t),f=r.settings.extensionSettings().firstIndex((function(n){return n.key===u})),f<0?r.settings.extensionSettings.push({key:u,settings:i}):(e=r.settings.extensionSettings()[f],e.settings=i,r.settings.extensionSettings.splice(f,1,e)),r.settings.keys.indexOf(u)<0&&r.settings.keys.push(u))},n.prototype.updateEditScopeIsSavingStateForExtension=function(n,t,i){var r=this._editScopes[n],u;r&&(u=r.savingRefCount()||0,i?r.savingRefCount(u+1):u>0&&r.savingRefCount(u-1))},n.prototype.trackingEditScope=function(n){return!!this._editScopes[n]},n.prototype._canEditScopeBeUpdated=function(n){return n?!!n.loadPromise:!1},n.prototype._deleteEditScope=function(n){delete this._editScopes[n]},n.prototype._loadEditScope=function(n){var t=this._ensureEditScope(n);return t.justCreated&&(t.settings={keys:[],extensionSettings:u.observableArray()},t.loadPromise=Q(),t.justCreated=!1),t.loadPromise||(t.loadPromise=this._getAndProcessSettings(n)),t.loadPromise},n.prototype._getAndProcessSettings=function(n){return this._editScopes[n].settings={keys:[],extensionSettings:u.observableArray()},Q()},n.prototype._getDirtyExtensionSettings=function(n){var t=this._editScopes[n]&&this._editScopes[n].settings,i=t&&t.extensionSettings().filter((function(n){var t=n.settings;return t&&t.edits.length>0}));return i||[]},n.prototype._onExtensionUnloaded=function(n){var i,t,r,u;for(i in this._editScopes)t=this._editScopes[i],r=t.savingRefCount()>0,r&&(u=t.settings&&t.settings.extensionSettings().some((function(t){return n===h(t.key).extension&&t.settings.edits.length>0})),u&&(this._clearEditScopeEdits(i),t.savingRefCount(0)))},n.prototype._clearEditScopeEdits=function(n){var i=this._editScopes[n],t;this._canEditScopeBeUpdated(i)&&(t=i.settings&&i.settings.extensionSettings,t().forEach((function(n){n.settings=null})),t(t()))},n.prototype._ensureEditScope=function(n,t){t===void 0&&(t=!1);var i=this._editScopes[n];return i||(i=this._editScopes[n]={savingRefCount:u.observable(0),justCreated:t}),i},n})();t.EditScopeManagerImpl=a;o=(function(){function n(){}return n.create=function(n,t){return new a(n,t)},n})();__decorate([f.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[e.ExtensionManager,y.Client]),__metadata("design:returntype",o)],o,"create",null);t.EditScopeManager=o;t.loadSerializedEditScope=f.defineHandler(s.loadSerializedEditScopeEndPoint,(function(n){return n.diContainer.get(o).loadEditScopeForExtension(n.messageArg,n.messageContext.srcWindowId)}));t.saveSerializedEditScope=f.defineHandler(s.saveSerializedEditScopeEndPoint,(function(n){n.diContainer.get(o).saveEditScopeForExtension(n.messageArg.editScopeId,n.messageContext.srcWindowId,n.messageArg.edits)}));t.updateEditScopeIsSavingState=f.defineHandler(s.updateEditScopeIsSavingStateEndPoint,(function(n){n.diContainer.get(o).updateEditScopeIsSavingStateForExtension(n.messageArg.editScopeId,n.messageContext.srcWindowId,n.messageArg.isSaving)}))}));
define("MsPortalImpl/Interactions/Interactions.Command",["require","exports","f","o","ko","$"],(function(n,t,i,r,u,f){"use strict";var e;return (function(n){var o=(function(){function n(n,t){this.target=n;this.getFormTarget=t}return n})(),t,e;n.CommandContext=o;t=(function(){function n(n,t){this.accept=n;this.maxFiles=t;this.files=u.observable(null)}return n})();n.FileInputOptions=t;e=(function(){function n(n,t,r){var o=this,e;this._ariaLabel=u.observable();this._inheritIcon=u.observable();this.fxEnabled=u.observable(!0);this.hasPopup=u.observable(!1);this.ariaLabel=this._ariaLabel;this.enabled=u.observable(!0);this.visible=u.observable(!0);this.unauthorized=u.observable(!1);this.pressed=u.observable();this.fileInputOptions=u.observable(null);this.tooltip=u.observable();this.isShellCommand=!1;e=this._ltm=n.createChildLifetime();this.text=u.isObservable(t)?t:u.observable(t?t:"");this.enabled(r!==undefined?r:!0);this.icon=u.computed(e,{read:this._inheritIcon,write:function(n){return o._inheritIcon(n&&i.extend2(n,{options:f.extend({palette:99},n.options)}))}})}return r.defineProperty(n.prototype,"canRebind",{get:function(){return!0},enumerable:!0,configurable:!0}),n.prototype.activate=function(){},n.prototype.execute=function(){},n.prototype.bind=function(n){var t=n&&n.getFormTarget;n.getFormTarget=function(){return t().then((function(t){if(t&&typeof t.showForm!="function")throw new Error("invalid context"+JSON.stringify(n,(function(n,t){return""+n+typeof t})));return t}))};this._currentContext=n},n.prototype.dispose=function(){this._ltm&&(this._ltm.dispose(),this._ltm=null)},n})();n.CommandImpl=e})(e||(e={})),e}));
define("MsPortalImpl/Interactions/Interactions.ContextMenuTouch",["require","exports","o","$","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u){"use strict";function a(n){var i=n.originalEvent,t=i&&i.touches,r=t&&t.length===1,u=t&&t[0];return r?u:null}function p(){var n={width:0,height:0,top:f.targetY,left:f.targetX};e.css(n);r("body").append(e);e.animate({width:o,height:o,top:"-="+(o/2+5),left:"-="+o/2},75)}function w(n){if(n){var t={opacity:.2},i={opacity:1};e.animate(t,25).animate(i,25).animate(t,25).animate(i,25)}e.animate({width:0,height:0,top:"+="+o/2,left:"+="+o/2},75,(function(){e.detach()}))}function h(n,t){t.off(s);c.clearTimeout(l);w(n);f={startTime:0,target:null,targetX:0,targetY:0}}function b(n){h(!0,r(n.currentTarget))}function k(n){var i=a(n)||{clientX:0,clientY:0},u=Math.abs(f.targetX-i.clientX),e=Math.abs(f.targetY-i.clientY);(u>t.MoveTolerancePixels||e>t.MoveTolerancePixels)&&h(!0,r(n.currentTarget))}function d(n){var e=r(n.currentTarget),o,i;f.startTime&&(o=Math.abs(Date.now()-f.startTime),o>=t.ReactionDelayMillis&&(e.off(u.default.contextmenu+s),i=r.Event(u.default.contextmenu),i.clientX=f.targetX,i.clientY=f.targetY,r(f.target).trigger(i)));h(!1,e)}function v(n){var i=a(n),e=r(n.currentTarget);if(!i){h(!0,e);return}if(!f||f.startTime===0){f={startTime:Date.now(),target:n.target,targetX:i.clientX,targetY:i.clientY};l=c.setTimeout((function(){p()}),t.ReactionDelayMillis);e.on(u.default.contextmenu+s,(function(){return!1})).on(u.default.touchmove+s,k).on(u.default.touchcancel+s,b).on(u.default.touchend+s,d)}}function g(n){n.on(u.default.touchstart,v)}function nt(n){n.off(u.default.touchstart,v);h(!0,n)}var c;i.defineProperty(t,"__esModule",{value:!0});c=window;t.ReactionDelayMillis=550;t.MoveTolerancePixels=10;t.HintClassIdentifier="fxs-contextMenuTouchHint";var y="<div class='"+t.HintClassIdentifier+"' style='position: fixed;z-index: 500border: 2px solid grey;box-sizing: border-box;background-color: rgba(255, 255, 255, 0.2);pointer-events: none;'><\/div>",e=r(y),o=110,s=".cmtevt",l,f={startTime:0,target:null,targetX:0,targetY:0};t.register=g;t.unregister=nt}));
define("MsPortalImpl/Interactions/Interactions.OverflowAutoTooltip",["require","exports","o","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r){"use strict";var u;return (function(n){function u(n){var t=n.currentTarget,r;t.offsetWidth<t.scrollWidth&&t.getBoundingClientRect().width===t.offsetWidth&&!t.title&&(r=$(t),r.attr("title",r.text()).addClass(i))}function f(n){var t=$(n.currentTarget);t.hasClass(i)&&t.removeAttr("title").removeClass(i)}function e(n){n.on(r.default.mouseover,t,u).on(r.default.mouseleave,t,f)}function o(n){n.off(r.default.mouseover,t,u).off(r.default.mouseleave,t,f)}var t=".msportalfx-tooltip-overflow,.msportalfx-text-ellipsis",i="fxs-autotooltip";n.register=e;n.unregister=o})(u||(u={})),u}));
define("MsPortalImpl/Svg/Startup/Close.svg",[],(function(){"use strict";return{type:55,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M14 3.3L12.7 2 8 6.7 3.3 2 2 3.3 6.7 8 2 12.7 3.3 14 8 9.3l4.7 4.7 1.3-1.3L9.3 8z'/><\/g><\/svg>"}}));
define("MsPortalImpl/Svg/Startup/Hamburger.svg",[],(function(){"use strict";return{type:313,data:"<svg viewBox='0 0 18 18' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M0 3h18v1H0zm0 5h18v1H0zm0 5h18v1H0z'/><\/g><\/svg>"}}));
define("MsPortalImpl/Widgets/Widgets.UIElementBase",["require","exports","ko","MsPortalImpl/Widgets/Widgets.WidgetBase"],(function(n,t,i,r){"use strict";var u;return (function(n){var t="Not implemented in base class.",f=(function(n){function r(t){var r=n.call(this)||this;return r.locked=i.observable(!0),r.id=t,r}return __extends(r,n),r.prototype.getViewSettings=function(){throw new Error(t);},r.prototype.applyViewSettings=function(){throw new Error(t);},r})(r.ViewModel),u;n.ViewModel=f;u=(function(n){function i(t,r){var u=n.call(this,t,r)||this;if(!r.id||typeof r.id!="string")throw new Error("An unique identifier is required and it must be a string.");return i.attachId(t,r.id),u}return __extends(i,n),i.prototype.dispose=function(){i.detachId(this.element);n.prototype.dispose.call(this)},i.attachId=function(n,t){n.data(i._fxsIdKey,t)},i.detachId=function(n){n.removeData(i._fxsIdKey)},i.getId=function(n){return n.data(i._fxsIdKey)},i.prototype.addChild=function(){throw new Error(t);},i.prototype.insertChild=function(){throw new Error(t);},i.prototype.removeChild=function(){throw new Error(t);},i.prototype.moveChild=function(){throw new Error(t);},i.prototype.saveViewSettings=function(){throw new Error(t);},i.prototype.setSize=function(){throw new Error(t);},i.prototype.discardStateOfUnusedChildren=function(){return{stateDiscarded:!1}},i})(r.Widget);u.viewSettingsChanged="viewSettingsChanged";u.errorEvent="widgetError";u._fxsIdKey="fxsId";n.Widget=u})(u||(u={})),u}));
define("MsPortalImpl/Widgets/Widgets.ContextPane",["require","exports","f","o","ko","MsPortalImpl/Base/Base.SvgHelper","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Svg/Startup/Close.svg","MsPortalImpl/Svg/Startup/Hamburger.svg","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Widgets/Widgets.Common","MsPortalImpl/Widgets/Widgets.UIElementBase","MsPortalImpl/Base/Base.EventTypes","_generated/Less/MsPortalImpl/Widgets/Widgets.ContextPane.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a){"use strict";var tt;r.defineProperty(t,"__esModule",{value:!0});var p=e.findByClassName,et=i.Base,w=h.ContextPane,b="fxs-contextpane",it="fxs-contextpane-title",v="fxs-contextpane-close",y="fxs-contextpane-expand",k="fxs-contextpane-loadindicator",rt="fxs-progress-dots",ut="fxs-contextpane-button-inner",d="fxs-contextpane-content",g="fxs-portal-bg-txt-br",nt="fxsContextPaneTitle",ft=(function(n){function t(){var t=n.call(this,"fxs-contextpane-identifier")||this;return t.opened=u.observable(!1),t.loading=u.observable(!1),t}return __extends(t,n),t})(l.ViewModel);t.ViewModel=ft;tt=(function(n){function t(t,r){var u=n.call(this,t,r)||this,e='<button type="button" class="'+y+' fxs-display-none"><div class="'+ut+' fxs-portal-svg">'+f.getSvgReferenceOrFallBackToData(s,{palette:99}).outerHTML+"<\/div><\/button>"+('<button type="button" class="'+v+' fxs-display-none fxs-portal-svg" title="'+i.encodeAttribute(w.close)+'">'+f.getSvgReferenceOrFallBackToData(o,{palette:99}).outerHTML+"<\/button>")+('<div class="'+k+'">')+('<div class="'+rt+'">')+"<div><\/div><div><\/div><div><\/div><\/div><\/div>";return t.addClass(b).addClass(g).attr("role","complementary").attr("aria-labelledby",nt).append(e),u._$closeButton=p(t,v),u._$expandButton=p(t,y),u._$progress=p(t,k),u._init(),u._attachEventHandlers(r),u}return __extends(t,n),t.prototype.dispose=function(){this._cleanElement(b,g);this.element.removeAttr("role");n.prototype.dispose.call(this)},t.prototype.hasContent=function(){return!!this._$content},t.prototype.addChild=function(n){var t,i;if(!n)throw new Error("Can't add null child.");this.hasContent()&&this.removeChild(null);t=this._$content=n.element?n.element:n;t.addClass(d).insertBefore(this._$progress);c.waitForBindings(t[0]).then((function(){var n=t.find("."+it+", .fxs-blade-title-titleText");n.attr("id",nt)}));i=!t.hasClass("fxs-blade")&&!t.hasClass("fxs-partgallery-container");e.toggle(this._$closeButton,i);e.toggle(this._$expandButton,t.hasClass("fxs-partgallery-container"))},t.prototype.insertChild=function(n){this.addChild(n)},t.prototype.removeChild=function(n,t){var i=this._$content;return i?(t?i.detach():i.remove(),i.removeClass(d),this._$content=null,!0):!0},t.prototype.clear=function(){return this.removeChild(null)},t.prototype.setFocus=function(){var t=this,n;i.isFeatureEnabled("skipautofocus")||(n=this._$content,n&&c.waitForBindings(this.element[0]).then((function(){var i=n.findFirstTabbable();i.length===0&&(i=t.element.find("."+v));i.focus()})))},t.prototype._init=function(){var n=this.ltm,t=this.element,i=this.options;u.reactor(n,(function(){t.toggleClass("fxs-contextpane-visible",i.opened())}));u.reactor(n,(function(){t.toggleClass("fxs-contextpane-loading",i.loading())}))},t.prototype._attachEventHandlers=function(n){var t=this,i,r;this.element.findByClassName(v).on(a.default.click,i=function(){t.element.trigger(a.default.fxcontextpaneclosing)});this.element.findByClassName(y).on(a.default.click,r=function(){n.collapsed(!n.collapsed())});n.collapsed&&n.collapsed.subscribeAndRun(this.ltm,(function(n){t.element.findByClassName(y).attr({title:n?w.expand:w.collapse,"aria-expanded":!n})}));this.ltm.registerForDispose((function(){t.element.findByClassName(v).off(a.default.click,i);t.element.findByClassName(y).off(a.default.click,r)}))},t})(l.Widget);t.Widget=tt}));
define("MsPortalImpl/Interactions/Interactions.RightClick",["require","exports","$","MsPortalImpl/Base/Base.KeyboardHelper","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u){"use strict";var f;return (function(n){function f(n,f,e){function l(){n.removeClass(t);var i=f();i&&i.forEach((function(n){n.dispose()}));o&&(n.off(u.default.fxcontextmenurequest,o),o=null);s&&(n.off(u.default.keydown,s),s=null);h&&(n.off(u.default.remove,h),h=null)}function a(n){var t=f();t&&t.length>0&&(n.preventDefault(),n.stopPropagation(),v(n.clientX,n.clientY))}function v(t,r){var e=i.Event(u.default.fxcontextmenu);e.clientX=t;e.clientY=r;c||(c=n.hasClass("fxs-bladecontent")?n:null);n.trigger(e,{commands:f(),formTarget:c,srcElement:n[0]})}var c=e&&e.formTarget,o,s,h;n.addClass(t);n.on(u.default.fxcontextmenurequest,o=function(n){a(n)});n.on(u.default.keydown,s=function(n){if(n.which===121&&r.getModifierKeys(n)===4){var t=n.target.getClientRects()[0];n.clientX=t&&t.left;n.clientY=t&&t.top;a(n)}});n.on(u.default.remove,h=l);return{dispose:l}}var t="fx-rightClick";n.setup=f})(f||(f={})),f}));
define("MsPortalImpl/Svg/Startup/Add.svg",[],(function(){"use strict";return{type:325,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M14.969 7.969H7.938V15H7V7.969H-.031v-.938H7V0h.938v7.031h7.031v.938z'/><\/g><\/svg>"}}));
define("MsPortalImpl/Svg/Startup/CaretDown.svg",[],(function(){"use strict";return{type:286,data:"<svg viewBox='0 0 12 12' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M11 3.9l-.7-.8L6 7.4 1.7 3.1l-.7.8 5 5z'/><\/g><\/svg>"}}));
define("MsPortalImpl/Svg/Startup/Clone.svg",[],(function(){"use strict";return{type:76,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M1 5v11h9V5H1zm7 9H3V7h5v7z'/><path d='M6 0v4h2V2h5v7h-2v2h4V0z'/><\/g><\/svg>"}}));
define("MsPortalImpl/Svg/Startup/Customize.svg",[],(function(){"use strict";return{type:314,data:"<svg viewBox='0 0 22 22' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path opacity='.9' d='M21.5 3.94c0 .45-.08.89-.26 1.31s-.42.8-.75 1.13l-13.5 13.5L.5 21.5l1.62-6.49 13.5-13.5c.33-.33.7-.58 1.13-.75.42-.17.86-.26 1.31-.26.47 0 .92.09 1.33.27.42.18.78.43 1.09.74s.56.68.74 1.09c.19.42.28.86.28 1.34zm-2.62 2.19c.17-.17.33-.33.49-.48s.3-.31.42-.48.22-.35.29-.54.11-.42.11-.68c0-.29-.06-.57-.17-.82s-.27-.48-.46-.68-.42-.35-.68-.46-.53-.17-.83-.17c-.26 0-.49.04-.68.11-.19.07-.38.17-.54.29s-.33.26-.48.42c-.15.16-.31.32-.48.49l3.01 3zM3.84 15.14c.72.24 1.35.62 1.87 1.14s.9 1.15 1.14 1.87L17.93 7.06l-3-3L3.84 15.14zm-1.53 4.55l3.37-.84c-.07-.31-.18-.61-.33-.89-.15-.28-.34-.53-.56-.75-.22-.22-.47-.41-.75-.56s-.58-.26-.89-.33l-.84 3.37z'/><\/g><\/svg>"}}));
define("MsPortalImpl/Svg/Startup/Download.svg",[],(function(){"use strict";return{type:174,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M9.6 7.2L14 3v3.4L8 12 2 6.5V3l4.4 4.2V0h3.2zM2 13h11.9v3H2z'/><\/g><\/svg>"}}));
define("MsPortalImpl/Svg/Startup/Filter.svg",[],(function(){"use strict";return{type:326,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M0 1h16v1.711l-6 6V15H6V8.711l-6-6V1zm15 1.289V2H1v.289l6 6V14h2V8.289l6-6z'/><\/g><\/svg>"}}));
define("MsPortalImpl/Svg/Startup/Fullscreen.svg",[],(function(){"use strict";return{type:323,data:"<svg viewBox='0 0 12 12' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M12 0v4h-1V1.61L1.61 11H4v1H0V8h1v2.38L10.38 1H7.99V0h4z'/><\/g><\/svg>"}}));
define("MsPortalImpl/Svg/Startup/Share.svg",[],(function(){"use strict";return{type:324,data:"<svg viewBox='0 0 50 50' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M.9 38.9c0 4.1 3.3 7.4 7.4 7.4 1.2 0 2.3-.3 3.3-.8C15.5 48.4 20.2 50 25 50s9.5-1.6 13.4-4.5c1 .5 2.1.8 3.3.8 4.1 0 7.4-3.3 7.4-7.4 0-2.2-1-4.2-2.6-5.6.5-1.8.7-3.7.7-5.5 0-9.4-6.1-17.8-14.9-20.9C32.1 3 28.9 0 25 0s-7.1 3-7.3 6.8C8.8 9.9 2.8 18.3 2.8 27.8c0 1.9.2 3.7.7 5.5C1.9 34.7.9 36.7.9 38.9zm3.7 0c0-2 1.7-3.7 3.7-3.7s3.7 1.7 3.7 3.7-1.7 3.7-3.7 3.7-3.7-1.7-3.7-3.7zm37.1 3.7c-2 0-3.7-1.7-3.7-3.7s1.7-3.7 3.7-3.7 3.7 1.7 3.7 3.7-1.7 3.7-3.7 3.7zM25 3.7c2 0 3.7 1.7 3.7 3.7S27 11.1 25 11.1s-3.7-1.7-3.7-3.7S23 3.7 25 3.7zM6.5 27.8c0-7.7 4.8-14.5 11.8-17.2 1.2 2.5 3.7 4.3 6.7 4.3s5.5-1.8 6.7-4.3c7 2.7 11.8 9.6 11.8 17.2 0 1.3-.1 2.6-.4 3.8-.5-.1-.9-.1-1.4-.1-4.1 0-7.4 3.3-7.4 7.4 0 1.5.5 2.9 1.3 4.1-3.1 2.1-6.7 3.3-10.5 3.3s-7.4-1.2-10.5-3.3c.8-1.2 1.3-2.6 1.3-4.1 0-4.1-3.3-7.4-7.4-7.4-.5 0-1 .1-1.4.1-.5-1.2-.6-2.5-.6-3.8z'/><\/g><\/svg>"}}));
define("MsPortalImpl/Svg/Startup/TrashOutline.svg",[],(function(){"use strict";return{type:327,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M14 3h-1v11.5a1.51 1.51 0 0 1-.437 1.063A1.493 1.493 0 0 1 11.5 16h-8a1.51 1.51 0 0 1-1.063-.437A1.482 1.482 0 0 1 2 14.5V3H1V2h4V1a.972.972 0 0 1 .293-.707A.972.972 0 0 1 6 0h3a.972.972 0 0 1 .707.293A.972.972 0 0 1 10 1v1h4v1zm-2 0H3v11.5c0 .136.05.253.148.352A.48.48 0 0 0 3.5 15h8a.48.48 0 0 0 .352-.148A.484.484 0 0 0 12 14.5V3zM6 13H5V5h1v8zM6 2h3V1H6v1zm2 11H7V5h1v8zm2 0H9V5h1v8z'/><\/g><\/svg>"}}));
define("MsPortalImpl/Svg/Startup/Upload.svg",[],(function(){"use strict";return{type:121,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M6.4 8.8L2 13V9.6L8 4l6 5.5V13L9.6 8.8V16H6.4zM2.1 0H14v3H2.1z'/><\/g><\/svg>"}}));
define("_generated/Templates/WidgetsDropMenu",["require","exports"],(function(){"use strict";return function(){return'<div class="fxs-dropmenu" role="presentation"> <button class="fxs-dropmenu-button" aria-haspopup="true" aria-expanded="false"><\/button> <div class="fxs-dropmenu-content fxs-text-link" role="menu"><\/div> <\/div>'}}));
define("MsPortalImpl/Widgets/Widgets.DropMenu",["require","exports","f","o","ko","$","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Widgets/Widgets.WidgetBase","_generated/Templates/WidgetsDropMenu","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Interactions/Interactions.KeyboardNavigation","_generated/Less/MsPortalImpl/Widgets/Widgets.DropMenu.css"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";var w;r.defineProperty(t,"__esModule",{value:!0});var l="fxs-dropmenu-button",a="fxs-dropmenu-hidden",v="fxs-dropmenu-is-open",y="fxs-dropmenu-invisible",b="fxs-popup-button",k="fxs-popup",d="fxs-portal-bg-txt-br",p="aria-label",g=(function(n){function t(t,i,r,f){var e=n.call(this)||this;return e.isMenuOpen=u.observable(!1),e.buttonLabel=u.observable(),e.buttonTooltip=u.observable(),e.menuLabel=u.observable(),e.buttonTemplate=t,e.menuTemplate=i,e.togglesVisibility=!!f,e.itemSelector=r,e}return __extends(t,n),t.prototype.open=function(){this.isMenuOpen(!0)},t.prototype.close=function(){this.isMenuOpen(!1)},t.prototype.toggle=function(){this.isMenuOpen(!this.isMenuOpen.peek())},t})(o.ViewModel);t.ViewModel=g;w=(function(n){function t(t,r){var e=n.call(this,t,r)||this,v=e.ltm,nt=i.getUniqueId(),a=e._dropMenu=f(s()),ut=e._dropMenuButton=a.findByClassName(l).addClass(r.buttonClass).addClass(b).html(r.buttonTemplate).attr("aria-controls",nt),o=e._dropMenuContent=a.findByClassName("fxs-dropmenu-content").html(r.menuTemplate).attr("id",nt).addClass(k).addClass(d),y=r.menuWidth||220,w=y===220?"fxs-dropmenu-defaultWidth":y===355?"fxs-dropmenu-extendWidth":"",tt,it,c,g,rt;w&&o.addClass(w);o.addClass(r.alignMenu===0?"fxs-dropmenu-right":"fxs-dropmenu-left");t.append(e._dropMenu);w||o.width(y);u.reactor(v,r.isMenuOpen,(function(n){n?e._show():e._hide()}));u.reactor(v,(function(){ut.attr("title",r.buttonTooltip()).attr(p,r.buttonLabel());o.attr(p,r.menuLabel())}));c=h.default.click;g=h.default.contextmenu;a.on(c,"."+l,tt=function(n){n.preventDefault();r.toggle()});o.on(c,"a",it=function(){r.close()});t.on(g,rt=function(){if(r.isMenuOpen())return!1});return v.registerForDispose((function(){a.off(c,"."+l,tt);o.off(c,"a",it);t.off(g,rt)})),e}return __extends(t,n),t.prototype._show=function(){var n=this,t,i,u,r;this._dropMenuButton.attr("aria-expanded",!0);this._dropMenuContent.removeClass(y+" "+a).addClass(v).attr("aria-hidden",!1);this._dismissHandle||(t=function(t){return f.contains(n._dropMenu[0],t)?0:2},this._dismissHandle={dismissFn:function(){n.options.close()},shouldDismissOnFocusOutFn:function(){return f.contains(n._dropMenu[0],document.activeElement)?0:1},shouldDismissOnMouseDownFn:t,shouldDismissOnMouseWheelFn:t,restoreFocus:function(){n._dropMenuButton[0].focus()},logName:"dropMenu"});i=this.element.find(".fxs-dropmenu-content");this._dismissLifetime||(u=this._dismissLifetime=this.ltm.createChildLifetime(),r=this._dismissHandle,e.register(r),new c.KeyboardNavigation(this._dismissLifetime,{element:i,tabTriggers:12,itemSelector:this.options.itemSelector}),u.registerForDispose([function(){e.unregister(r)},]));this.options.setItemFocusWhenOpen&&i.focus()},t.prototype._hide=function(){this._dropMenuButton.attr("aria-expanded",!1);this._dropMenuContent.addClass(this.options.togglesVisibility?y:a).removeClass(v).attr("aria-hidden",!0);this._dismissLifetime&&(this._dismissLifetime.dispose(),this._dismissLifetime=null)},t.prototype.setFocus=function(){this._dropMenuButton.focus()},t})(o.Widget);t.Widget=w}));
define("MsPortalImpl/UI/Compositions/UI.Composition.PartSize",["require","exports","f","o","$"],(function(n,t,i,r,u){"use strict";function h(n,t,i){return n<0?-1:n===0?0:Math.max(0,n*t+(n-1)*i)}function c(n,t){return{width:h(n,f.CellWidth,f.CellSpacingWidth),height:h(t,f.CellHeight,f.CellSpacingHeight)}}function l(n,t,i){return Math.ceil(n/(t+i))}function p(n,t){return{colSpan:l(n,f.CellWidth,f.CellSpacingWidth),rowSpan:l(t,f.CellHeight,f.CellSpacingHeight)}}function w(n,t){var i=function(n){return Math.ceil(Math.min(Math.max(n,1),25))};return c(i(n),i(t))}function b(n,r){var f=i.find(t.AllSizes,(function(t){var i=t&&t.size;return t&&i.width===n&&i.height===r}));return f||(f=e(99),f.size={width:n,height:r},f.span=p(n,r)),u.extend(!0,{},f)}function k(){return e(2)}function e(n){return u.extend(!0,{},i.find(t.AllSizes,(function(t){return t&&t.name===n})))}function o(n){return function(t){return t===n}}function d(n){var t=o(n);return a.some(t)}function g(n){var t=o(n);return v.some(t)}function nt(n){var t=o(n);return y.some(t)}var s,f,a,v,y;r.defineProperty(t,"__esModule",{value:!0});s=i.Parts;f=i.Widgets.AzureGrid;t.AllSizes=(function(){var t=[],n=function(n,i,r){t[n]={name:n,css:"fxs-tilesize-"+s.InternalPartSize[n].toLowerCase(),size:c(i,r),span:{colSpan:i,rowSpan:r}}};return n(0,1,1),n(1,2,1),n(2,2,2),n(3,4,2),n(4,2,4),n(5,6,4),n(6,4,6),n(7,6,0),n(8,-1,0),n(9,-1,-1),n(10,4,4),n(11,6,6),n(99,0,0),t})();t.AllCssClasses=t.AllSizes.map((function(n){return n.css}));t.getGridPixelSize=w;t.getCorrespondingStandardSize=b;t.getDefaultSize=k;t.getSize=e;a=[0,1,2,3,4,10,5,6,11,99,];t.isFixedSize=d;v=[7,8,9,];t.isVariableSize=g;y=[8,9,];t.isAdaptiveWidth=nt}));
define("MsPortalImpl/Widgets/Widgets.LayoutBase",["require","exports","o","ko","MsPortalImpl/Widgets/Widgets.UIElementBase"],(function(n,t,i,r,u){"use strict";var o,e,f;i.defineProperty(t,"__esModule",{value:!0}),(function(n){n[n.Horizontal=0]="Horizontal";n[n.Vertical=1]="Vertical"})(o=t.Orientation||(t.Orientation={}));e=(function(n){function t(t){var i=n.call(this,t)||this;return i.positionUpdatedSignal=r.observable(0),i.positions=[],i}return __extends(t,n),i.defineProperty(t.prototype,"positions",{get:function(){return this._positions},set:function(n){this._positions=n?n:[]},enumerable:!0,configurable:!0}),t})(u.ViewModel);t.ViewModel=e;f=(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t})(u.Widget);f.layoutUpdatedEventName="layoutUpdated";t.Widget=f}));
define("_generated/Templates/WidgetsContextMenu",["require","exports"],(function(){"use strict";return function(){return'<ul role="menu" class="fxs-contextMenu-itemList" data-bind="foreach: { data: commands, afterRender: afterRender }, attr: { \'aria-label\': ariaLabel }"> <li role="menuitem" class="fxs-contextMenu-item fxs-portal-hover" data-bind="css: { \'fxs-contextMenu-itemDisabled\': !enabled(), \'fxs-contextMenu-extensioncommand\': !!$data._extension }, attr: { title: $data.tooltip(), \'aria-disabled\': !enabled(), \'aria-label\': ariaLabel, \'aria-posinset\': $index() + 1, \'aria-setsize\': $parent.commands().length }" tabindex="0"> <div class="fxs-contextMenu-text fxs-portal-text msportalfx-text-ellipsis" data-bind="text: text"><\/div> <div class="fxs-contextMenu-icon fxs-portal-svg" data-bind="image: icon"><\/div> <\/li> <\/ul>'}}));
define("MsPortalImpl/Widgets/Widgets.ContextMenu",["require","exports","f","o","ko","$","MsPortalImpl/Base/Base.Events","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Interactions/Interactions.KeyboardNavigation","MsPortalImpl/Interactions/Interactions.OverflowAutoTooltip","MsPortalImpl/Widgets/Widgets.WidgetBase","_generated/Templates/WidgetsContextMenu","MsPortalImpl/Base/Base.EventTypes","_generated/Less/MsPortalImpl/Widgets/Widgets.ContextMenu.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){"use strict";var y;return (function(t){function y(n,t){return t||ft.error("ContextMenuViewModel."+n+" is not accessible. Please call registerForCleanup first."),t}function tt(n){return n.isShellCommand}var rt=i.Base,ut=rt.Diagnostics,w=window,ft=ut.createLog(n),b="fxs-contextMenu",k="fxs-contextMenu-active",d="fxs-contextMenu-item",et="fxs-contextMenu-itemDisabled",g="fxs-popup",nt="fxs-portal-bg-txt-br",p=(function(n){function t(){var t=n.call(this)||this;return t.visible=u.observable(!1),t.menuItems=u.observableArray(),t.topOffsetCorrection=0,t}return __extends(t,n),t.prototype.getOrderedMenuItemsCommandsComputed=function(){return y("orderedMenuItemsCommands",this._orderedMenuItemsCommands)},t.prototype.getOrderedMenuItemsComputed=function(){return y("orderedMenuItems",this._orderedMenuItems)},r.defineProperty(t.prototype,"hasVisibleCommands",{get:function(){return y("hasVisibleCommands",this._hasVisibleCommands)},enumerable:!0,configurable:!0}),t.prototype.registerForCleanup=function(n){var t=this,r=this.menuItems,i=this._ltm=n.createChildLifetime(),f=this._orderedMenuItemsCommands=r.filter(i,(function(n){return n.visible()&&!tt(n)&&!n.hasPopup()})),e=this._orderedMenuItems=r.filter(i,(function(n){return n.visible()&&tt(n)&&n.enabled()}));this._hasVisibleCommands=u.computed(i,(function(){return f().length+e().length>0}));i.registerForDispose((function(){t._ltm=t._orderedMenuItemsCommands=t._orderedMenuItems=t._hasVisibleCommands=null}))},t})(l.ViewModel),it;t.ViewModel=p;it=(function(n){function t(t,i){var r=n.call(this,t,i&&i instanceof p?i:new p)||this;r._lastShowArgs=u.observable(null);i=r.options;var h=r.ltm,c=function(n){var t=r.element[0];return!(t===n)&&!f.contains(t,n)?2:0},e=r._dismissHandle={dismissFn:function(){r.hide()},shouldDismissOnMouseDownFn:c,shouldDismissOnMouseWheelFn:c,logName:"contextmenu"};return i.registerForCleanup(h),t.html(a()).addClass(b+" "+g+" "+nt),r._bindDescendants({ariaLabel:o.ContextMenu.ariaLabel,commands:u.explicitComputed(h,[i.getOrderedMenuItemsComputed(),i.getOrderedMenuItemsCommandsComputed()],(function(n,t){return n.concat(t)})),afterRender:function(){r.updateRenderedPositionFromLastShow()}}),r._initializeHandlers(),i.visible.subscribeAndRun(h,(function(n){var t=r.element,i;n?(i=document.activeElement,e.restoreFocus=function(){s.validatePreviousFocusedElement(e,i)&&i.focus()},t.css(r._ensureInViewPort(r._lastShowArgs())).addClass(k),r.setFocus(),s.register(e,!0)):(r._lastShowArgs(null),t[0].contains(document.activeElement)&&e.restoreFocus&&e.restoreFocus(),t.removeClass(k),s.unregister(e))})),r}return __extends(t,n),t.prototype.dispose=function(){this.hide();this._dismissHandle=null;this._cleanElement(b,g,nt);n.prototype.dispose.call(this)},t.prototype.hide=function(){this.options.visible(!1)},t.prototype.show=function(n,t,i){if(n===void 0&&(n=0),t===void 0&&(t=0),i===void 0&&(i=!1),e.isFullscreen()){this.hide();return}this._lastShowArgs({xCoord:n,yCoord:t,forceLeft:i});this.options.visible(!0)},t.prototype.updateRenderedPositionFromLastShow=function(){var n=this._lastShowArgs();n&&this.element.css(this._ensureInViewPort(n))},t.prototype.setFocus=function(){var n=this;Q.fcall((function(){n.element.find("[tabindex=0]:first-of-type").focus()}))},t.prototype._initializeHandlers=function(){var t=this,n=this.element,i=this.ltm,r=function(n){if(n.stopPropagation(),n.preventDefault(),!f(n.currentTarget).hasClass(et)){t.hide();var i=u.dataFor(n.target);i&&i.enabled()&&i.execute(!0)}};new h.KeyboardNavigation(this.ltm,{element:n});c.register(n);u.computed(i,(function(){t._lastShowArgs()&&(t.options.menuItems().forEach((function(n){n.enabled()})),t.updateRenderedPositionFromLastShow())}));i.registerForDispose([function(){c.unregister(n)},n.setEvents([v.default.contextmenu,function(){return!1},]),n.find("ul").setEvents([v.default.click,"."+d,r,],[v.default.keydown,"."+d,function(n){n.which===13&&r(n)},]),])},t.prototype._ensureInViewPort=function(n){var o=n.xCoord,c=n.yCoord,s=n.forceLeft,t=c,r="auto",h=this.element,u=h.outerHeight(),f=h.outerWidth(),e;return this._isRtl()?(r=o-f,(s||r-f<0)&&(r+=f,t+=this.options.topOffsetCorrection)):(r=o,(s||r+f>w.innerWidth)&&(r-=f,t+=this.options.topOffsetCorrection)),e=w.innerHeight,t+u>e&&(t-u>=0?t-=u:t=u<e?i.truncate((e-u)/2):0,t+=this.options.topOffsetCorrection),{top:t,left:r}},t})(l.Widget);t.Widget=it})(y||(y={})),y}));
define("_generated/Templates/WidgetsTileActionBar",["require","exports"],(function(){"use strict";return function(){return'<div class="fxs-tile-actionbar-actionlist fxs-portal-background" role="menubar" data-bind="foreach: func._actionsForUi"> <!-- ko if: command.enabled() --> <button type="button" class="fxs-tile-actionbar-action fxs-portal-svg" role="menuitem" data-bind="css: className, image: command.icon, attr: { title: command.text, \'aria-label\': command.text }"><\/button> <!-- /ko --> <\/div>'}}));
define("MsPortalImpl/Widgets/Widgets.TileActionBar",["require","exports","f","ko","$","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Base/Telemetry","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.ContextMenu","_generated/Templates/WidgetsTileActionBar","MsPortalImpl/Base/Base.EventTypes","_generated/Less/MsPortalImpl/Widgets/Widgets.TileActionBar.css"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";var l;return (function(n){var b=i.Base,k=b.Diagnostics.Telemetry,d=k.trace,y="fxs-tile-actionbar-actionlist",t="fxs-tile-actionbar",g=i.isFeatureEnabled("skipautofocus"),l=[],a,p,v,w;n.widgetClassName=t;n.actionClassName="fxs-tile-actionbar-action";a=(function(){function n(){}return n})();n.TileActionViewModel=a;p=(function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.actions=r.observableArray(),t.visible=r.observable(!1),t}return __extends(t,n),t.prototype.update=function(){var t=this.visible(),n;t&&(n=this.actions(),n.forEach((function(n){n.command.activate();n.bindCommand()})))},t})(o.ViewModel);n.ViewModel=p;v=(function(n){function i(i,o,v,p){var w=n.call(this,i,v)||this,rt=w.options,b=w.ltm,g,nt,k,tt,it;l.push(w);nt=r.observable(g);w._actionsForUi=r.computed(b,nt,(function(n){return r.unwrap(n)||[]}));i.addClass(t).html(h());k=new s.ViewModel;k.topOffsetCorrection=25;tt=w.contextMenuWidget=new s.Widget(o,k);b.registerForDispose(i.setEvents(["click","."+y,function(n){var t=n.target;u(t).hasClass(y)&&(p(t),n.preventDefault(),n.stopPropagation())}]));rt.visible.subscribeAndRun(b,(function(n){if(!n){var t=document.activeElement;w.has(t)&&p(t)}n?(w.options.update(),nt(g||(g=rt.actions.filter(b,(function(n){return n.command.enabled()}))))):tt.hide();f.toggle(i,n);n&&l.forEach((function(t){t!==w&&t.options.visible(!n)}))}));it=function(n){n.stopPropagation();var t=r.dataFor(n.target);t&&t instanceof a&&t.command&&(d({source:e.Source.TileAction,action:e.Action.TileActionClicked,name:t.command.commandName}),t.command.execute(!1))};i.on(c.default.click,it);return b.registerForDispose((function(){i.off(c.default.click,it);tt.dispose();k.menuItems.removeAll();w.contextMenuWidget=null;l.remove(w)})),w._bindDescendants(),w}return __extends(i,n),i.prototype.dispose=function(){this._cleanElement(t);n.prototype.dispose.call(this)},i.prototype.showTileManagementContextMenu=function(){this.options.actions().forEach((function(n){var t=n.command;typeof t._getActionClassIdentifier=="function"&&t._getActionClassIdentifier()==="opencontextmenu"&&t.execute(!1)}))},i.prototype.setFocus=function(){!g&&this.options.visible()&&this.element.findFirstTabbable().focus()},i.prototype.has=function(n){return!!(this.element.has(n).length||this.contextMenuWidget.element.has(n).length)},i})(o.Widget);n.Widget=v;w=(function(){function n(n){this._getActions=n}return n.prototype.create=function(n){var t;return u.isFunction(this._getActions)&&(t=this._getActions(),r.utils.arrayPushAll(n.options.actions,t)),new v(n.element,n.contextElement,n.options,n.focusBackCallback)},n})();n.FactoryImpl=w})(l||(l={})),l}));
define("_generated/Templates/WidgetsTile",["require","exports"],(function(){"use strict";return function(){return'<div class="fxs-tile-actionbarcontainer" data-bind="stopBindings: true"> <div class="fxs-tile-actions"><\/div> <div class="fxs-tile-actions-contextmenu"><\/div> <\/div> <div class="fxs-tile-overlay"><\/div> <div class="fxs-tile-progress-transparent fxs-loading5dots-container" data-bind="visible: func._showTransparentSpinner"> <div class="fxs-portal-background"><\/div><div class="fxs-portal-background"><\/div><div class="fxs-portal-background"><\/div><div class="fxs-portal-background"><\/div><div class="fxs-portal-background"><\/div> <\/div> <fxs-progress class="fxs-tile-progress fxs-portal-background-secondary" data-bind="visible: func._showOpaqueSpinner"><\/fxs-progress> '}}));
define("MsPortalImpl/Widgets/Widgets.Tile",["require","exports","f","o","ko","MsPortalImpl/Interactions/Interactions.RightClick","MsPortalImpl/UI/Compositions/UI.Composition.PartSize","MsPortalImpl/Widgets/Widgets.TileActionBar","_generated/Templates/WidgetsTile","MsPortalImpl/Widgets/Widgets.UIElementBase","MsPortalImpl/Base/Base.EventTypes","_generated/Less/MsPortalImpl/Widgets/Widgets.Tile.css"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";function d(n,t,i){return new a(n,t,new o.FactoryImpl(i))}var p,a;r.defineProperty(t,"__esModule",{value:!0});var w=i.Base,b=w.Diagnostics,k=b.createLog(n),l="fxs-tile",v="fxs-tile-overlay",y="fxs-portal-bg-txt-br";t.widgetClassName=l;t.overlayClassName=v;t.actionBarContainerClassName="fxs-tile-actionbarcontainer";p=(function(n){function t(t,i){var r=n.call(this,t)||this;return r.isInBlockingLoadingState=u.observable(!1),r.hasOngoingOperation=u.observable(!1),r.size=u.observable(),r.gridHeight=u.observable(),r.gridWidth=u.observable(),r.supportedSizes=u.observableArray(),r.commands=[],r.actionBarViewModel=new o.ViewModel,r.selected=u.observable(!1),r.selectedFromHover=u.observable(!1),r.userResizable=u.observable(!1),r.inLockedContext=!1,r.applyViewSettings(i),r}return __extends(t,n),t.prototype.getViewSettings=function(){return{NormalState:{size:this.size()}}},t.prototype.applyViewSettings=function(n){n&&n.NormalState&&n.NormalState.size!==undefined&&(this.size=u.observable(n.NormalState.size))},t})(h.ViewModel);t.ViewModel=p;t.createTileWidget=d;a=(function(n){function t(t,i,r){var o=n.call(this,t,i)||this,h,c,b,a,v,p,w,d;return o._showTransparentSpinner=u.observable(!1),o._showOpaqueSpinner=u.observable(!1),c=o.ltm,i.size&&i.size()!==undefined||(k.warning("No initial size was set on the Tile view model."),i.size=u.observable(e.getDefaultSize().name)),o._actionBarWidgetFactory=r,h=e.getSize(i.size()),u.computed(c,(function(){var n=0;i.isInBlockingLoadingState()?n=2:i.hasOngoingOperation()&&(n=1);o._showTransparentSpinner(n===1);o._showOpaqueSpinner(n===2)})),b=s(),t.addClass(l).addClass(y).addClass(h&&h.css).html(b),99===h.name?(a=e.getGridPixelSize(i.gridWidth(),i.gridHeight()),t.css({width:a.width,height:a.height})):e.isFixedSize(i.size())&&(i.gridWidth(h.span.colSpan),i.gridHeight(h.span.rowSpan)),v={func:o,data:i},p=t.findByClassName("fxs-tile-progress")[0],u.applyBindingsToNode(p,null,v),w=t.findByClassName("fxs-tile-progress-transparent")[0],u.applyBindingsToNode(w,null,v),o._attachEventHandlers(),d=f.setup(t,u.observableArray(i.commands)),c.registerForDispose((function(){o._cleanNode(p);o._cleanNode(w);d.dispose()})),o}return __extends(t,n),t.prototype.dispose=function(){this._actionBarWidget&&(this._actionBarWidget.dispose(),this._actionBarWidget=null);this._cleanElement(e.AllCssClasses.join(" "),l,y);n.prototype.dispose.call(this)},t.prototype._cleanNode=function(n){n&&u.cleanNode(n)},t.prototype.addChild=function(n){if(!n)throw new Error("Can't add null child.");var t=n.element||n;t.insertBefore($(this.element).findByClassName(v))},t.prototype.removeChild=function(){return!1},t.prototype.saveViewSettings=function(){return this.options.getViewSettings()},t.prototype.setSize=function(n,t){var i=e.getCorrespondingStandardSize(n,t),s;i||(i=e.getDefaultSize());var u=i.size,f=this.options,o=f.size(),r=this.element;if(o&&o===i.name){if(o!==99)return;if(parseInt(r.css("height"))===u.height&&parseInt(r.css("width"))===u.width)return}f.size(i.name);f.gridHeight(i.span.rowSpan);f.gridWidth(i.span.colSpan);r.css({height:"",width:""}).removeClass(e.AllCssClasses.join(" ")).addClass(i.css);i.name===99&&r.css({height:u.height,width:u.width});s=300;r.handleTransitionEndOnce("height",s,(function(){r.trigger(c.default.fxsizechanged,[i.name])}))},r.defineProperty(t.prototype,"actionBarWidget",{get:function(){return this._actionBarWidget},enumerable:!0,configurable:!0}),t.prototype.setFocus=function(n){var t=this._actionBarWidget,i;!n&&t&&t.options.visible()?t.setFocus():(i=this.element.find(".fxs-part"),i&&i.focus())},t.prototype.showTileManagementContextMenu=function(){var n=this.options,t=this.actionBarWidget;!n.locked()&&n.selected()&&t&&t.showTileManagementContextMenu()},t.prototype._createActionBarWidget=function(){var i=this,n,t;!this._actionBarWidget&&this._actionBarWidgetFactory&&(n=this.element,t=this.options,this._actionBarWidget=this._actionBarWidgetFactory.create({element:n.findByClassName("fxs-tile-actions"),contextElement:n.findByClassName("fxs-tile-actions-contextmenu"),options:t.actionBarViewModel,focusBackCallback:function(t){n[0].contains(t)&&i.setFocus(!0)}}))},t.prototype._attachEventHandlers=function(){var r=this,t=this.element,n=this.options,f=this.ltm;if(n.size.subscribe(f,(function(){t.trigger(h.Widget.viewSettingsChanged,r.saveViewSettings())})),n.userResizable.subscribeAndRun(f,(function(n){n&&i.tryImmediateResolve(i.require("MsPortalImpl/Interactions/Interactions.FlowLayoutUserResize"),(function(n){n.addUserResizeBehavior(r)}))})),u.computed(f,n.locked,(function(){t.trigger(c.default.fxsizechanged)})).extend({deferred:!0}),u.computed(f,(function(){var i=n.selected(),e=n.selectedFromHover(),f=i||e;u.ignoreDependencies((function(){f&&r._createActionBarWidget()}));n.actionBarViewModel.visible(f);t.toggleClass("fxs-tile-selected",i)})),!n.inLockedContext){var o=function(){n.selectedFromHover()||n.selectedFromHover(!0)},s=function(){!n.selectedFromHover()||r.actionBarWidget&&r.actionBarWidget.has(document.activeElement)||n.selectedFromHover(!1)},l=function(n){var i=t[0];return i.contains(n.target)&&i.contains(n.relatedTarget)},a=function(n){l(n)||o(n)},v=function(n){l(n)||s(n)},e=t[0],y=function(n){n.keyCode===27&&n.target&&e.contains(n.target)&&r.setFocus(!0)};t.on(c.default.mouseenter,o).on(c.default.mouseleave,s).on(c.default.keydown,".fxs-tile-actionbar-action",y);e.addEventListener(c.default.focus,a,!0);e.addEventListener(c.default.blur,v,!0);f.registerForDispose((function(){t.off(c.default.mouseenter,o).off(c.default.mouseleave,s).off(c.default.keydown,y);e.removeEventListener(c.default.focus,a,!0);e.removeEventListener(c.default.blur,v,!0)}))}},t})(h.Widget);t.Widget=a}));
define("MsPortalImpl/Widgets/Widgets.FlowLayout",["require","exports","f","o","ko","$","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.LayoutBase","MsPortalImpl/Widgets/Widgets.Tile","MsPortalImpl/Widgets/Widgets.UIElementBase","MsPortalImpl/UI/Compositions/UI.Composition.PartSize","MsPortalImpl/Base/Base.EventTypes","_generated/Less/MsPortalImpl/Widgets/Widgets.FlowLayout.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a){"use strict";function lt(n){for(var r,u,f,e=new ut,i,c=!0,o=0;o<n.length;o++){var t=n[o],l=t.position,s=l.row,h=l.col,a=t.rowSpan,v=t.colSpan;if(e.isRectangleFree(h,s,a,v))e.markOccupancy(t);else{for(c=!1,i={misplacedPart:t.id,overlappedParts:[]},r=h;r<h+v;r++)for(u=s;u<s+a;u++)f=e.getItemAt(r,u),f&&i.overlappedParts.indexOf(f.id)===-1&&i.overlappedParts.push(f.id);break}}return{success:c,result:i}}var b,st,ht,v,it;r.defineProperty(t,"__esModule",{value:!0});var ct=i.Base.Diagnostics,rt=i.Widgets.AzureGrid,nt=s.Orientation,ft=ct.createLog(n),y=c.Widget.getId,tt=o.Widget.getWidget,et="fxs-flowlayout",ot="fxs-flowlayout-childcontainer",d="fxs-flowlayout-element",w=function(n,t,i){return Math.min(25,Math.ceil((n+i)/(t+i)))},p=function(n,t,i){return n*t+(n-1)*i};t.validateGrid=lt;b={};b[38]=1;b[39]=2;b[40]=3;b[37]=4;st=(function(n){function t(t,i){var r=n.call(this,t)||this;return r.minColumns=u.observable(1),r.minRows=u.observable(1),r.maxColumns=u.observable(999),r.maxRows=u.observable(999),r.columnSize=rt.CellWidth,r.rowSize=rt.CellHeight,r.gutterSize=rt.CellSpacingWidth,r.orientation=nt.Horizontal,r.allowReorder=!1,r.allowOverflow=!1,r.allowGaps=!1,r.resolutionGuides=!1,r.resolutionGuidesOffset={x:0,y:0},r.applyViewSettings(i),r}return __extends(t,n),t.prototype.getViewSettings=function(){return{positions:this.positions}},t.prototype.applyViewSettings=function(n){n&&n.positions&&(this.positions=n.positions,this.positionUpdatedSignal(this.positionUpdatedSignal()+1))},t})(s.ViewModel);t.ViewModel=st;ht=(function(n){function t(t,i){var r=n.call(this,t,i)||this;return r._dropPlaceholder=null,r._childContainer=null,r._engine=new k(i),r._engine.positions=i.positions,t.addClass(et).html("<div class='"+ot+"'><\/div>"),i.resolutionGuides&&r._addResolutionGuides(),r._childContainer=r.element.findByClassName(ot),r._initializeComputed(),r._setContainerSize(),r._relayoutPositions(),r._attachEventHandlers(),r}return __extends(t,n),t.prototype.dispose=function(){this._childElements.forEach((function(n){n.removeClass(d);u.cleanNode(n[0]);n.remove()}));u.cleanNode(this._childContainer[0]);this._childContainer.remove();this.element.removeClass(et);n.prototype.dispose.call(this)},r.defineProperty(t.prototype,"_childElements",{get:function(){var t=this._childContainer.children("."+d),n=[];return f.each(t,(function(t,i){n.push(f(i))})),n},enumerable:!0,configurable:!0}),r.defineProperty(t.prototype,"dropPlaceholder",{get:function(){return this._dropPlaceholder},enumerable:!0,configurable:!0}),t.prototype.addChild=function(n){var r=this.options,t,i;if(!n)throw new Error("Cannot add a null child.");t=n.element?n.element:n;t.css("visibility","hidden");this._childContainer.append(t);t.addClass(d);i=this._getChildDimensions(t);try{r.positions=this._engine.append(y(t),i.rowSpan,i.colSpan)}catch(u){ft.warning("New element could not be appended to the grid. {0}".format(u.toString()));t.removeClass(d);t.remove();return}r.positions=this._engine.positions;this._refreshElementSize(t);this._setContainerSize();this._relayoutPositions();this.element.trigger(s.Widget.layoutUpdatedEventName);t.css("visibility","")},t.prototype.removeChild=function(n,t){var u=this._childElements.firstIndex((function(t){return y(t)===n})),i=this._childElements[u],r;return i?(r=this.options,r.positions=this._engine.remove(n),this.element.trigger(s.Widget.layoutUpdatedEventName),e.hide(i).removeClass(d),t?i.detach():i.remove(),this._setContainerSize(),this._relayoutPositions(),!0):!1},t.prototype.resizeChild=function(n,t,i,r){var u=this.options,o=u.rowSize,h=u.columnSize,f=u.gutterSize,l=this._childElements.first((function(t){return y(t)===n})),a,b;if(l){a=this._engine.positions.first((function(t){return t.id===n}));t=Math.max(t,h);i=Math.max(i,o);var k=w(i,o,f),d=w(t,h,f),v=this._engine.resize(n,d,k,r);u.positions=v;var e=v.first((function(t){return t.id===n})),g=p(e.rowSpan,o,f),nt=p(e.colSpan,h,f);this._setContainerSize(!0);this._relayoutPositions();r&&((a.rowSpan!==e.rowSpan||a.colSpan!==e.colSpan)&&this.element.trigger(s.Widget.layoutUpdatedEventName),b=tt(l,c.Widget),this._setElementSize(b,l,nt,g))}},t.prototype.moveChild=function(n,t,i,r){var f=y(n),u=this._getChildDimensions(n),e=this._engine.move(f,{col:t,row:i},u.colSpan,u.rowSpan,r);this.options.positions=e;this._setContainerSize(!0);this._relayoutPositions();r&&this.element.trigger(s.Widget.layoutUpdatedEventName)},t.prototype.refreshLayout=function(){this.options.positions=this._engine.positions;this._setContainerSize();this._relayoutPositions();this._refreshSizes()},t.prototype.saveViewSettings=function(){var n=this.options;return n.positions=this._engine.positions,n.getViewSettings()},t.prototype.createDropPlaceholder=function(n,t){this._dropPlaceholder&&this.disposeDropPlaceholder();this._dropPlaceholder=f('<div class="fxs-flowlayout-drop-placeholder"><\/div>').css({width:n,height:t});this._childContainer.append(this._dropPlaceholder)},t.prototype.disposeDropPlaceholder=function(){this._dropPlaceholder&&this._dropPlaceholder.remove();this._dropPlaceholder=null},t.prototype.moveDropPlaceholder=function(n){this._setElementPositioningCss(this.dropPlaceholder,n)},t.prototype.resizeDropPlaceholder=function(n,t){var r=this.options,u=r.rowSize,f=r.columnSize,i=r.gutterSize,e=w(t,u,i),o=w(n,f,i),s=p(e,u,i),h=p(o,f,i);this._dropPlaceholder.css({width:h,height:s})},t.prototype.getDomOrderedChildren=function(){return this._engine.getNaturalDomElementOrder()},t.prototype.discardStateOfUnusedChildren=function(){var n=[],t={stateDiscarded:!1};return this._engine&&(n=n.concat(this._engine.discardUnusedPositions())),n.length&&(t.stateDiscarded=!0,t.message="Removed Positions: "+JSON.stringify(n)),t},t.prototype._initializeComputed=function(){var t=this,n=this.options,i=this.ltm;u.computed(i,(function(){n.minRows();n.maxRows();n.minColumns();n.maxColumns();t._setContainerSize()}));n.positionUpdatedSignal.subscribe(i,(function(){t._engine.positions=n.positions}))},t.prototype._getChildDimensions=function(n){var t=this.options,f=tt(n,h.Widget),i=f&&f.options,u=i&&i.size(),e,r,o,s;return l.isFixedSize(u)?(e=l.getSize(u),r=u===99?l.getGridPixelSize(i.gridWidth(),i.gridHeight()):e.size):r=this._getChildAccurateDimensions(n),o=w(r.height,t.rowSize,t.gutterSize),s=w(r.width,t.columnSize,t.gutterSize),{rowSpan:o,colSpan:s}},t.prototype._getChildAccurateDimensions=function(n){if(!n[0])return ft.warning("Attempted to measure a non-existant item in _getChildAccurateDimensions. Assuming 0 as size."),{height:0,width:0};var t=n[0].getBoundingClientRect(),i=Math.round(t.height),r=Math.round(t.width);return{height:i,width:r}},t.prototype._setContainerSize=function(n){var t=this.options,i=this._engine.getMaxOccupiedPositions(n?t.positions:null),r=Math.max(t.minRows(),i.row),u=Math.max(t.minColumns(),i.col),f=p(r,t.rowSize,t.gutterSize),e=p(u,t.columnSize,t.gutterSize);this._childContainer.css({height:f,width:e})},t.prototype._relayoutPositions=function(){for(var r,n,t,u,i=0;i<this._childElements.length;i++)n=this._childElements[i],r=y(n),t=this.options.positions.first((function(n){return n.id===r})),u=t?t.position:{row:0,col:0},this._setElementPositioningCss(n,u)},t.prototype._setElementPositioningCss=function(n,t){var i=this.options,r=t.col*(i.columnSize+i.gutterSize),u=t.row*(i.rowSize+i.gutterSize),f;f=this._isRtl()?{right:r,top:u}:{left:r,top:u};n.css(f)},t.prototype._refreshSizes=function(){this._childElements.forEach(this._refreshElementSize,this)},t.prototype._refreshElementSize=function(n){var t=this.options,i=tt(n,c.Widget);if(i){var u=y(n),r=t.positions.first((function(n){return n.id===u})),f=p(r.rowSpan,t.rowSize,t.gutterSize),e=p(r.colSpan,t.columnSize,t.gutterSize);this._setElementSize(i,n,e,f)}},t.prototype._setElementSize=function(n,t,i,r){n?n.setSize(i,r):t.css({width:i,height:r})},t.prototype._moveFocusInDirection=function(n){var e=f(document.activeElement).closest("."+h.widgetClassName),r=y(e),u,t,i;r&&(u=this._engine.getAdjacentElement(r,n),t=this._childElements.first((function(n){return u===y(n)})),t)&&(i=tt(t,h.Widget),i&&i.setFocus())},t.prototype._attachEventHandlers=function(){var t=this,n=this.element,i=function(n,i,r,u,f){t.resizeChild(i,r,u,f===undefined?!0:f);n.stopPropagation()},r=function(n){var r=f(n.target),u,i;r.is("input[type=text], textarea, select")||r.closest(".fxs-contextMenu").length||(u=n.which,i=b[u]||0,i!==0&&(n.preventDefault(),n.stopPropagation(),t._moveFocusInDirection(i)))};n.on(a.default.fxsizechange,i);n.on(a.default.keydown,r);this.ltm.registerForDispose((function(){n.off(a.default.fxsizechange,i);n.off(a.default.keydown,r)}))},t.prototype._addResolutionGuides=function(){var t=this,i='<div class="fxs-flowlayout-resolutionguide fxs-flowlayout-resolutionguide-{0}x{1} fxs-hide-in-normal"><\/div>',n=this.options.resolutionGuidesOffset;[{x:1024,y:768},{x:1366,y:768},{x:1440,y:900},{x:1920,y:1080},{x:3840,y:2160},].forEach((function(r){var u=f(i.format(r.x,r.y));(n.x||n.y)&&u.css({top:n.y+"px",left:n.x+"px"});t.element.prepend(u)}))},t})(s.Widget);t.Widget=ht,(function(n){function t(n){return n.position.row}function i(n){return n.position.row+n.rowSpan}function r(n){return n.position.col}function u(n){return n.position.col+n.colSpan}n.top=t;n.bottom=i;n.left=r;n.right=u})(v||(v={}));var ut=(function(){function n(){this._occupancyGrid=[]}return n.prototype.reset=function(n){var t=this;this._occupancyGrid.length=0;n&&n.forEach((function(n){t.markOccupancy(n)}))},n.prototype.isRectangleFree=function(n,t,i,r){for(var u,e=n+r,o=t+i,f=n;f<e;f++)for(u=t;u<o;u++)if(this.isPositionOccupied(f,u))return!1;return!0},n.prototype.isPositionOccupied=function(n,t){return!!this._occupancyGrid[n]&&!!this._occupancyGrid[n][t]},n.prototype.getItemAt=function(n,t){var i=this._occupancyGrid[n];return i?i[t]:null},n.prototype.markOccupancy=function(n,t){for(var r,f=v.top(n),e=v.bottom(n),o=v.left(n),s=v.right(n),u=this._occupancyGrid,i=o;i<s;i++)for(r=f;r<e;r++)u[i]||(u[i]=[]),u[i][r]||(u[i][r]=null),u[i][r]=t?null:n},n})(),g={},k=(function(){function n(n){this._occupancyGrid=new ut;this._items=[];this._filledPositions={};this._gridOptions=n}return n.prototype.append=function(n,t,i){var r=this._getExistingItem(n),u,f,e;if(this._filledPositions[n]=!0,!!r)return this._items;if(u=this._maxRows(),f=this._maxCols(),!this._gridOptions.allowOverflow&&(t>u||i>f))throw new Error("The element cannot fit in this grid. ElementRowSpan: {0}, ElementColSpan: {1}, GridMaxRowSpan: {2}, GridMaxColSpan: {3}".format(t,i,u,f));if(e=this._findNextAvailablePositionForRectangle(t,i),!e)throw new Error("The element cannot fit in the remaining space available in the grid.");return r={id:n,position:e,rowSpan:t,colSpan:i},this._items.push(r),this._occupancyGrid.markOccupancy(r),this._items},n.prototype.move=function(n,t,i,r,u){var o={id:n,position:t,colSpan:i,rowSpan:r},e,f,s;return this._applyGridConstraints(o),f=new it(this._items,o,this._gridOptions),e=f.resolved?f.getItems():this._items,u&&(f.resolved&&(this._items.length=0,(s=this._items).push.apply(s,e)),this._occupancyGrid.reset(this._items),this.collapseGaps()),e},n.prototype.resize=function(n,t,i,r){var e=this._getExistingItem(n),o=e.position,y={id:e.id,position:{col:o.col,row:o.row},colSpan:t,rowSpan:i},f=y.position,u,l,s,h,p,c,w;if(this._applyGridConstraints(y),f.row<0||f.col<0)return this._items;var b=Math.max(0,t-e.colSpan),k=Math.max(0,i-e.rowSpan),a=f.col,v=f.row;for(this._gridOptions.allowGaps||(a=Math.min(a,Math.max(0,o.col-b)),v=Math.min(v,Math.max(0,o.row-k))),s=a;s<=f.col;s++){for(h=v;h<=f.row;h++)if((p={id:n,position:{col:s,row:h},colSpan:t,rowSpan:i},c=new it(this._items,p,this._gridOptions),c.resolved)&&((!u||c.shiftCost<u.shiftCost)&&(u=c),u&&u.shiftCost===0))break;if(u&&u.shiftCost===0)break}return l=u?u.getItems():this._items,r&&(u&&(this._items.length=0,(w=this._items).push.apply(w,l)),this._occupancyGrid.reset(this._items),this.collapseGaps()),l},n.prototype.remove=function(n){var i=this._getExistingItem(n),t;return(this._filledPositions[n]=!1,t=this._items.indexOf(i),t===-1)?this._items:(this._items.splice(t,1),this._occupancyGrid.markOccupancy(i,!0),this.collapseGaps(),this._items)},n.prototype.collapseGaps=function(){if(!this._gridOptions.allowGaps){var n={grid:this,isPositionOccupied:function(n,t){return this.grid._occupancyGrid.isPositionOccupied(n,t)},getMaxPositions:function(){return this.grid.getMaxOccupiedPositions()},getMinSize:function(){return{col:this.grid._minCols(),row:this.grid._minRows()}},getItemAt:function(n,t){return this.grid._occupancyGrid.getItemAt(n,t)},shiftItem:function(n,t){n.position.col-=t}},t={grid:this,isPositionOccupied:function(n,t){return this.grid._occupancyGrid.isPositionOccupied(t,n)},getMaxPositions:function(){var n=this.grid.getMaxOccupiedPositions();return{col:n.row,row:n.col}},getMinSize:function(){return{col:this.grid._minRows(),row:this.grid._minCols()}},getItemAt:function(n,t){return this.grid._occupancyGrid.getItemAt(t,n)},shiftItem:function(n,t){n.position.row-=t}};this._orientation()===nt.Horizontal?(this._collapseGapsWithGridVisitor(n),this._collapseGapsWithGridVisitor(t)):(this._collapseGapsWithGridVisitor(t),this._collapseGapsWithGridVisitor(n))}},n.prototype.getNaturalDomElementOrder=function(){for(var n,t,u,i=[],f=this.getMaxOccupiedPositions(),r=0;r<f.row;r++)for(n=0;n<f.col;n++)t=this._occupancyGrid.getItemAt(n,r),t&&(u=t.id,i.indexOf(u)===-1&&i.push(u),n+=t.colSpan-1);return i},n.prototype.getAdjacentElement=function(n,t){var i=this._getExistingItem(n),r,u;return i?(r=g[t],u=r?r(this,i):i,u.id):n},r.defineProperty(n.prototype,"positions",{get:function(){return this._items},set:function(n){this._items.length=0;this._items=n?n:[];this._occupancyGrid.reset(this._items)},enumerable:!0,configurable:!0}),n.prototype.discardUnusedPositions=function(){var n=this,t=[];return this._items.slice(0).forEach((function(i){n._filledPositions[i.id]||(t.push(i),n.remove(i.id))})),t},n.prototype._orientation=function(){return this._gridOptions.orientation},n.prototype._minRows=function(){return this._gridOptions.minRows()},n.prototype._maxRows=function(){return this._gridOptions.maxRows()},n.prototype._minCols=function(){return this._gridOptions.minColumns()},n.prototype._maxCols=function(){return this._gridOptions.maxColumns()},n.prototype.getMaxOccupiedPositions=function(n){for(var e=n||this._items,r=0,u=0,i,f,t=0;t<e.length;t++)i=e[t],f=i.position,r=Math.max(r,f.col+i.colSpan),u=Math.max(u,f.row+i.rowSpan);return{col:r,row:u}},n.prototype._getExistingItem=function(n){return this._items.first((function(t){return t.id===n}))},n.prototype._applyGridConstraints=function(n){var t,i;this._gridOptions.allowOverflow||(i=n.position,t=v.bottom(n)-this._maxRows(),t>0&&(i.row-=t),t=v.right(n)-this._maxCols(),t>0&&(i.col-=t))},n.prototype._findNextAvailablePositionForRectangle=function(n,t){var f=this._maxCols()-t+1,e=this._maxRows()-n+1,i,r,u;if(this._orientation()===nt.Horizontal){for(r=0;r<f;r++)for(i=0;i<e;i++)if(this._isRectangleFree(r,i,n,t))return{col:r,row:i};if(this._gridOptions.allowOverflow)return u=this.getMaxOccupiedPositions(),{col:0,row:u.row}}else{for(i=0;i<e;i++)for(r=0;r<f;r++)if(this._isRectangleFree(r,i,n,t))return{col:r,row:i};if(this._gridOptions.allowOverflow)return u=this.getMaxOccupiedPositions(),{col:u.col,row:0}}},n.prototype._isRectangleFree=function(n,t,i,r){var u=n+r,f=t+i;return!this._gridOptions.allowOverflow&&(f>this._maxRows()||u>this._maxCols())?!1:this._occupancyGrid.isRectangleFree(n,t,i,r)},n.prototype._collapseGapsWithGridVisitor=function(n){var i=n.getMaxPositions(),r=i.col,a=i.row,u=[],y=!1,p,e,s,t,h,o,c,l;if(!(r<=n.getMinSize().col))for(s=0;s<r;s++){for(e=null,t=0;t<a;t++){if(y=!1,u[t]=this._findGap(t,s,r,n),h=u[t].colSpan,h===0)return;if((!e||h<e)&&(e=h),t>0&&!this._gapsAreContiguous(u[t-1],u[t]))break;y=!0}if(y){for(p={},o=0;o<a;o++)for(c=v.right(u[o]);c<r;c++)l=n.getItemAt(c,o),l&&(p[l.id]=l);f.each(p,(function(t,i){n.shiftItem(i,e)}));this._occupancyGrid.reset(this._items);i=n.getMaxPositions();r=i.col;a=i.row}}},n.prototype._gapsAreContiguous=function(n,t){var i=v.left(t),r=v.right(t),u=v.left(n),f=v.right(n);return f>=i&&u<=r},n.prototype._findGap=function(n,t,i,r){for(var u=t,f={id:"",position:{row:n,col:0},rowSpan:1,colSpan:0};u<i;){if(!r.isPositionOccupied(u,n))break;u++}for(f.position.col=u;u<i;){if(r.isPositionOccupied(u,n))break;f.colSpan++;u++}return f},n._scanAdjacentUp=function(n,t){for(var i,f,r=t.position,e=r.col,o=r.row-1,s=r.col+t.colSpan,u=o;u>=0;u--)for(i=e;i<s;i++)if(f=n._occupancyGrid.getItemAt(i,u),f)return f;return t},n._scanAdjacentRight=function(n,t){for(var i,f,r=t.position,e=r.col+t.colSpan,o=r.row,s=n.getMaxOccupiedPositions().col,h=r.row+t.rowSpan,u=e;u<s;u++)for(i=o;i<h;i++)if(f=n._occupancyGrid.getItemAt(u,i),f)return f;return t},n._scanAdjacentDown=function(n,t){for(var i,f,r=t.position,e=r.col,o=r.row+t.rowSpan,s=r.col+t.colSpan,h=n.getMaxOccupiedPositions().row,u=o;u<h;u++)for(i=e;i<s;i++)if(f=n._occupancyGrid.getItemAt(i,u),f)return f;return t},n._scanAdjacentLeft=function(n,t){for(var i,f,r=t.position,e=r.col-1,o=r.row,s=r.row+t.rowSpan,u=e;u>=0;u--)for(i=o;i<s;i++)if(f=n._occupancyGrid.getItemAt(u,i),f)return f;return t},n})();t.FlowLayoutPositioningEngine=k;g[1]=k._scanAdjacentUp;g[2]=k._scanAdjacentRight;g[3]=k._scanAdjacentDown;g[4]=k._scanAdjacentLeft;it=(function(){function n(n,t,i){var u=this,r;this.shiftCost=0;this.resolved=!1;this._resolvedItems=[];this._occupancyGrid=new ut;this._gridOptions=i;n.forEach((function(n){var i;t.id!==n.id&&(i=f.extend(!0,{},n),u._resolvedItems.push(i),u._occupancyGrid.markOccupancy(i))}));this.resolved=this._resolveConflict(t);r=f.extend(!0,{},t);this._resolvedItems.push(r);this._occupancyGrid.markOccupancy(r)}return n.prototype.getItems=function(){return this._resolvedItems},n.prototype._orientation=function(){return this._gridOptions.orientation},n.prototype._maxRows=function(){return this._gridOptions.maxRows()||999},n.prototype._maxCols=function(){return this._gridOptions.maxColumns()||999},n.prototype._resolveConflict=function(n){var t=!1;return this._orientation()===nt.Horizontal?(t=this._tryMoveConflictsLeft(n,{})||t,t=this._tryMoveConflictsUp(n,{})||t,t=this._tryMoveConflictsDown(n,{})||t,t=this._tryMoveConflictsRight(n,{})||t):(t=this._tryMoveConflictsUp(n,{})||t,t=this._tryMoveConflictsLeft(n,{})||t,t=this._tryMoveConflictsRight(n,{})||t,t=this._tryMoveConflictsDown(n,{})||t),t},n.prototype._tryMoveConflictsUp=function(n,t){var u,r,i,e,f;for(t[n.id]=!0,u=v.left(n);u<v.right(n);u++)for(r=v.top(n);r<v.bottom(n);r++)if(i=this._occupancyGrid.getItemAt(u,r),i&&!t[i.id]){if((t[i.id]=!0,r=v.bottom(i),e=v.top(n)-v.bottom(i),f=this._getConflictArea(i,0,e),v.bottom(f)>this._maxRows()||v.top(f)<0)||!this._tryMoveConflictsUp(f,t))return!1;this._moveItem(i,0,e);t[i.id]=!1}return!0},n.prototype._tryMoveConflictsDown=function(n,t){var u,r,i,e,f;for(t[n.id]=!0,u=v.left(n);u<v.right(n);u++)for(r=v.bottom(n)-1;r>=v.top(n);r--)if(i=this._occupancyGrid.getItemAt(u,r),i&&!t[i.id]){if((t[i.id]=!0,r=v.top(i),e=v.bottom(n)-v.top(i),f=this._getConflictArea(i,0,e),v.bottom(f)>this._maxRows()||v.top(f)<0)||!this._tryMoveConflictsDown(f,t))return!1;this._moveItem(i,0,e);t[i.id]=!1}return!0},n.prototype._tryMoveConflictsLeft=function(n,t){var u,r,i,e,f;for(t[n.id]=!0,u=v.top(n);u<v.bottom(n);u++)for(r=v.left(n);r<v.right(n);r++)if(i=this._occupancyGrid.getItemAt(r,u),i&&!t[i.id]){if((t[i.id]=!0,r=v.right(i),e=v.left(n)-v.right(i),f=this._getConflictArea(i,e,0),v.right(f)>this._maxCols()||v.left(f)<0)||!this._tryMoveConflictsLeft(f,t))return!1;this._moveItem(i,e,0);t[i.id]=!1}return!0},n.prototype._tryMoveConflictsRight=function(n,t){var u,r,i,e,f;for(t[n.id]=!0,u=v.top(n);u<v.bottom(n);u++)for(r=v.right(n)-1;r>=v.left(n);r--)if(i=this._occupancyGrid.getItemAt(r,u),i&&!t[i.id]){if((t[i.id]=!0,r=v.left(i),e=v.right(n)-v.left(i),f=this._getConflictArea(i,e,0),v.right(f)>this._maxCols()||v.left(f)<0)||!this._tryMoveConflictsRight(f,t))return!1;this._moveItem(i,e,0);t[i.id]=!1}return!0},n.prototype._getConflictArea=function(n,t,i){var u=i<0,f=t<0,r=n.position;return{id:n.id,position:{row:u?r.row+i:r.row,col:f?r.col+t:r.col},rowSpan:n.rowSpan+Math.abs(i),colSpan:n.colSpan+Math.abs(t)}},n.prototype._moveItem=function(n,t,i){this._occupancyGrid.markOccupancy(n,!0);var r=n.position;r.col+=t;r.row+=i;this._occupancyGrid.markOccupancy(n);this.shiftCost+=n.colSpan*n.rowSpan},n})();t.FlowLayoutPositionConflictResolver=it}));
define("_generated/Templates/WidgetsStartboard",["require","exports"],(function(){"use strict";return function(){return'<div class="fxs-startboard-loadanimation"> <div class="fxs-splashscreen-loader-container fxs-loading5dots-container"> <div><\/div><div><\/div><div><\/div><div><\/div><div><\/div> <\/div> <\/div> <div class="fxs-startboard-header"> <div class="fxs-startboard-header-item fxs-startboard-title fxs-startboard-title-next fxs-portal-border" id="startboard-title"><\/div> <div class="fxs-startboard-header-item fxs-startboard-dropdown"><\/div> <input type="text" class="fxs-startboard-header-item fxs-startboard-title-edit fxs-hide-in-normal" maxlength="200"> <div class="fxs-startboard-header-item fxs-startboard-migration" role="menubar"> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-migrate"><\/button> <\/div> <div class="fxs-startboard-header-item fxs-startboard-actions" role="menubar"> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-new"><\/button> <div class="fxs-startboard-button fxs-startboard-button-upload" tabindex="-1"><\/div> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-download" tabindex="-1"><\/button> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-edit" tabindex="-1"><\/button> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-share" tabindex="-1"><\/button> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-fullscreen" tabindex="-1"><\/button> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-clone" tabindex="-1"><\/button> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-delete" tabindex="-1"><\/button> <button type="button" role="menuitem" class="fxs-startboard-button fxs-startboard-button-filter" tabindex="-1"><\/button> <\/div> <\/div> <div class="fxs-startboard-filter" data-bind="stopBindings: true"><\/div> <div class="fxs-startboard-layout"><\/div> <div class="fxs-startboard-message-container"><\/div>'}}));
define("MsPortalImpl/Widgets/Widgets.StartBoard",["require","exports","f","o","ko","$","MsPortalImpl/Base/Base.Events","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Interactions/Interactions.RightClick","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Base/Base.KeyboardHelper","MsPortalImpl/Svg/Startup/Add.svg","MsPortalImpl/Svg/Startup/CaretDown.svg","MsPortalImpl/Svg/Startup/Clone.svg","MsPortalImpl/Svg/Startup/Customize.svg","MsPortalImpl/Svg/Startup/Download.svg","MsPortalImpl/Svg/Startup/Filter.svg","MsPortalImpl/Svg/Startup/Fullscreen.svg","MsPortalImpl/Svg/Startup/Share.svg","MsPortalImpl/Svg/Startup/TrashOutline.svg","MsPortalImpl/Svg/Startup/Upload.svg","MsPortalImpl/Base/Telemetry","MsPortalImpl/Widgets/Widgets.DropMenu","MsPortalImpl/Widgets/Widgets.FlowLayout","MsPortalImpl/Widgets/Widgets.LayoutBase","_generated/Templates/WidgetsStartboard","MsPortalImpl/Widgets/Widgets.UIElementBase","MsPortalImpl/Base/Base.SvgHelper","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Interactions/Interactions.KeyboardNavigation","MsPortalImpl/Base/Base.Timers","_generated/Less/MsPortalImpl/Widgets/Widgets.StartBoard.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht){"use strict";var oi,si;r.defineProperty(t,"__esModule",{value:!0});var hi=i.Base,bt=hi.Diagnostics,kt=bt.Telemetry,dt=nt.Source,gt=nt.Action,ci=window,li=bt.createLog(n),ct=o.Dashboard;t.widgetClass="fxs-startboard";t.headerButtonClass="fxs-startboard-button";var ni="fxs-theme-context-start",ti="fxs-startboard-title-edit",lt="fxs-startboard-button-text",at="fxs-startboard-button-icon",ii="fxs-startboard-button-filter",yt="fxs-startboard-button-browse",pt="fxs-startboard-header-normal",wt="fxs-startboard-header-migration",vt="fxs-startboard-dropdown-item",ri="fxs-startboard-dropdown-dashboard",ui="."+ri+", ."+yt,fi=ci.fx.environment,ei="aria-label";t.fxstartboardtitlechanged="fxstartboardtitlechanged";t.fxmigratestartboard="fxmigratestartboard";oi=(function(n){function t(t,i,r,f){var e=n.call(this,t)||this,s;return e.commands=[],e.filterButtonText=u.observable(""),e.title=u.observable(o.NavBar.home),e.dashboardList=u.observableArray(),e.loading=u.observable(!1),e.notFound=u.observable(!1),e.isShared=u.observable(!1),e.notFoundMessage=u.observable(""),e.subscriptionsInfo=u.observable(""),e.locked(!1),s=e.flowLayoutOptions=new it.ViewModel("fxs-flowlayout-instanceid"),s.allowReorder=!0,s.allowOverflow=!0,s.allowGaps=!0,s.resolutionGuides=!0,s.resolutionGuidesOffset.y=-88,s.orientation=rt.Orientation.Horizontal,s.minColumns(4),s.minRows(4),s.maxRows(4),s.locked(!1),e.headerMode=u.observable(0),e.filtersWidgetViewModel=f,e.applyViewSettings(i),e}return __extends(t,n),t.prototype.getViewSettings=function(){return{NormalState:{layoutSettings:this.flowLayoutOptions.getViewSettings()}}},t.prototype.applyViewSettings=function(n){n&&n.NormalState&&n.NormalState.layoutSettings&&this.flowLayoutOptions.applyViewSettings(n.NormalState.layoutSettings)},t})(ft.ViewModel);t.ViewModel=oi;si=(function(r){function nt(e,c){var l=r.call(this,e,c)||this,a,v;return l._layout=null,l._setFocusOnAnimationFrame=ht.throttleByAnimationFrame((function(){var i,n,t;l._$lastFocused&&f.contains(l.element[0],l._$lastFocused[0])&&h.isVisible(l._$lastFocused)&&(l._$lastFocused.focus(),i=!0);i||(n=l._layout.element.findFirstTabbable(),n.length===1?n.focus():(t=l._selectorMenu,t&&t.setFocus()))})),a=l.ltm,l._isSharedToArm=c.isShared,e.addClass(ni).addClass(t.widgetClass).html(ut()),u.reactor(a,(function(){var n=c.title();e.findByClassName("fxs-startboard-title").text(n);e.findByClassName(ti).val(n)})),u.reactor(a,(function(){var t=c.headerMode(),n=e.findByClassName("fxs-startboard-header");switch(t){case 1:n.addClass(pt).removeClass(wt);break;case 2:n.removeClass(pt).addClass(wt);break;case 0:default:n.removeClass(pt).removeClass(wt)}})),u.reactor(a,(function(){e.toggleClass("fxs-startboard-notfound",c.notFound())})),u.reactor(a,(function(){e.toggleClass("fxs-startboard-loading",c.loading())})),u.reactor(a,(function(){document.title=o.Portal.windowTitleFormat.format(c.title(),fi.branding.title)})),l._layout=new it.Widget(e.findByClassName("fxs-startboard-layout"),c.flowLayoutOptions),l._initializeCommands(a,e),v=e.findByClassName("fxs-startboard-message-container"),v.html('<div class="fxs-startboard-message-title">'+i.encodeHtml(ct.NotFound.title)+'<\/div><div class="fxs-startboard-message-body" data-bind="text: data.notFoundMessage"><\/div>'),u.applyBindings({data:c},v[0]),l._attachEventHandlers(e),new st.KeyboardNavigation(a,{element:e.find(".fxs-startboard-actions"),tabTriggers:12,itemSelector:"> .fxs-startboard-button:not(.fxs-startboard-button-upload), .fxs-startboard-button-upload input[type=file]"}),a.registerForDispose([s.setup(e,u.observableArray(c.commands)),]),i.isFeatureEnabled("dashboardfilters")&&c.filtersWidgetViewModel&&i.require("./Widgets.DashboardFilters",n).then((function(n){l._dashboardFiltersWidget=new n.Widget(l.element,c.filtersWidgetViewModel)})),l}return __extends(nt,r),nt.prototype.dispose=function(){this._layout.dispose();this._cleanElement(t.widgetClass,ni);r.prototype.dispose.call(this)},nt.prototype.addChild=function(n){if(!n)throw new Error("Can't add null child.");this._layout.addChild(n)},nt.prototype.removeChild=function(n){return this._layout.removeChild(n)},nt.prototype.moveChild=function(n,t,i,r){this._layout.moveChild(n,t,i,r)},nt.prototype.setFocus=function(){i.isFeatureEnabled("skipautofocus")||this._setFocusOnAnimationFrame()},nt.prototype.saveViewSettings=function(){return this.options.getViewSettings()},nt.prototype.discardStateOfUnusedChildren=function(){return li.assert(!!this._layout,"FlowLayout not defined."),this._layout?this._layout.discardStateOfUnusedChildren():{stateDiscarded:!1}},nt.prototype.getDomOrderedChildren=function(){return this._layout.getDomOrderedChildren()},nt.prototype._attachEventHandlers=function(n){var i=this;this.ltm.registerForDispose(n.setEvents([rt.Widget.layoutUpdatedEventName,function(t){n.trigger(ft.Widget.viewSettingsChanged,i.saveViewSettings());t.stopPropagation()},],[ot.default.focusout,function(n){i._$lastFocused=f(n.target)},],[ot.default.change,".fxs-startboard-fileUpload-overlay",function(n){var t,r;n.stopPropagation();t=n.target.files;t.length>0&&(r=f.extend(!0,{},t),i._handleUploadItemClick(r),n.currentTarget.value=null)},],[ot.default.focus,".fxs-startboard-fileUpload-overlay",function(n){n.stopPropagation();f(n.target).closest("."+t.headerButtonClass).addClass("fxs-startboard-item-focused")},],[ot.default.blur,".fxs-startboard-fileUpload-overlay",function(n){n.stopPropagation();f(n.target).closest("."+t.headerButtonClass).removeClass("fxs-startboard-item-focused")},]))},nt.prototype._initializeCommands=function(n,r){var bt=this,ft="aria-disabled",pi=ct.create,wi=ct.delete,bi=o.ShellCommands.downloadDashboard,st=o.ShellCommands.uploadDashboard,ki=ct.edit,di=ct.filter,gi=this._isSharedToArm?ct.unshare:ct.share,ni=ct.fullscreen,nr=ct.clone,s=this.options,pt=function(n,t){n.attr("title",t).findByClassName(lt).html(t)},tr="<div class='"+at+"' aria-hidden='true'><\/div>"+("<div class='"+lt+"'><\/div>"),ir="<div class='"+at+'\' aria-hidden="true"><\/div>'+("<div class='"+lt+'\' id="uploadlabel" aria-hidden="true"><\/div>')+('<input type="file" class="fxs-startboard-fileUpload-overlay" accept=".json" tabindex=\'-1\' role="menuitem" aria-labelledby="uploadlabel" title="'+st+'"/>'),nt=function(n,t,i,u,e,o){e===void 0&&(e=!1);var s=r.findByClassName(n).html(t===st?ir:tr);pt(s,t);s.findByClassName(at).empty().append(et.getSvgReferenceOrFallBackToData(i,{palette:99}));o=o||function(){u.execute(!1)};s.on(ot.default.click,(function(n){n.stopPropagation();f(n.currentTarget).attr(ft)!=="true"&&o(n);bt.trigger(ot.default.fxdashboardactivity)}));return s.data("commandVM",u),e&&h.hide(s),s},oi=nt("fxs-startboard-button-edit",ki,y,s.addPartsCommand,!1,(function(){kt.trace({source:dt.Dashboard,action:gt.CustomizeModeEntered});kt.trace({source:dt.Dashboard,action:gt.DashboardEditCommandClicked});s.addPartsCommand.execute(!1)})),ut,rt,it,si,hi,ci,li,wt;u.computed(n,(function(){var n=s.addPartsCommand,t=n&&n.enabled();t?oi.removeAttr(ft):oi.attr(ft,"true")}));i.isFeatureEnabled("filterdashboard")||r.findByClassName(ii).remove();ut=r.findByClassName(ti);ut.attr(ei,ct.titleLabel);ut.on(ot.default.change,(function(){s.title(ut.val());r.trigger(t.fxstartboardtitlechanged)}));rt=new tt.ViewModel('<div class="fxs-startboard-title" data-bind="text: data.title, attr: { title: data.title }"><\/div>'+('<div class="'+at+'">'+et.getSvgReferenceOrFallBackToData(a,{palette:99}).outerHTML+"<\/div>"),"<div class='fx-dropmenu-dropdown'>"+('<ul class="fxs-dropmenu-list-system" role="menu" aria-label="'+i.encodeAttribute(ct.recentMenuLabel)+'">')+"<!-- ko ifnot: data.dashboardList -->"+("<li class='"+vt+'\' role="menuitem" tabindex="0">')+'<div class="fxs-tile-progress-transparent"><div><\/div><div><\/div><div><\/div><div><\/div><div><\/div><\/div><\/li><!-- /ko --><!-- ko if: data.dashboardList --><!-- ko ifnot: data.dashboardList().length -->'+("<li class='"+vt+'\' role="menuitem" tabindex="0">')+("<div class='fxs-dropmenu-list-content'>"+i.encodeHtml(ct.emptynext)+"<\/div>")+"<\/li><!-- /ko --><!-- ko foreach: data.dashboardList -->"+("<li class='"+vt+" "+ri+' fxs-portal-hover msportalfx-tooltip-overflow\' role="menuitem" data-bind="attr: { \'aria-label\': $parent.func.altText(title, id) }, event: { click: $parent.func.clickHandler, keydown: $parent.func.clickHandler }">')+'<div class=\'fxs-dropmenu-list-content fxs-startboard-item-container\'><div class="fxs-startboard-item-icon"><!-- ko if: id.indexOf("private") === -1 -->'+et.getSvgReferenceOrFallBackToData(k).outerHTML+"<!-- /ko --><\/div><div class=\"fxs-startboard-item-title\" data-bind='text: title'><\/div><\/div><\/li><!-- /ko --><!-- /ko -->"+('<li class="'+vt+' fxs-startboard-dropdown-browseall fxs-portal-hover" role="menuitem">')+'<div class="fxs-startboard-dropdown-subscriptions" data-bind="text: data.subscriptionsInfo"><\/div>'+('<a tabindex=\'-1\' href="#" class="'+yt+' fxs-portal-text-primary">'+i.encodeHtml(ct.browseAll)+"<\/a>")+"<\/li><\/ul><\/div>",ui);it=r.findByClassName("fxs-startboard-dropdown");rt.alignMenu=0;si=this._selectorMenu=new tt.Widget(it,rt);rt.isMenuOpen.subscribe(n,(function(n){n&&s.refreshDashboardList&&(s.dashboardList(undefined),s.refreshDashboardList((function(n){s.dashboardList(n);it.find(".fxs-dropmenu-button")[0]===document.activeElement&&Q.fcall((function(){ht.requestAnimationFrame((function(){it.find(ui).filter("[tabindex='0']").focus()}))}))})))}));u.reactor(this.ltm,s.title,(function(n){it.find(".fxs-dropmenu-button").attr(ei,ct.switcherLabel.format(n))}));hi=function(n,t){if(t.type===ot.default.keydown&&!((t.keyCode===13||t.keyCode===32)&&c.getModifierKeys(t)===0))return!0;t.preventDefault();t.stopPropagation();r.findByClassName("fxs-startboard-title-next").text(n.title);s.switchDashboard&&s.switchDashboard(n).then((function(){var n=Math.min(Math.max(it.outerWidth()+50,400),560);it.find(".fxs-dropmenu-content").css({minWidth:n})}));rt.close()};u.applyBindings({data:s,func:{clickHandler:hi,altText:function(n,t){return n+" "+(t.indexOf("private")===-1?ct.sharedStatusLabel:"")}}},si.element[0]);nt("fxs-startboard-button-new",pi,l,s.newCommand);s.filterButtonText(di);ci=nt(ii,s.filterButtonText(),w,s.filterCommand);s.filterButtonText.subscribe(n,(function(n){ci.findByClassName(lt).html(n)}));nt("fxs-startboard-button-clone",nr,v,s.cloneCommand);li=nt("fxs-startboard-button-share",gi,k,s.shareCommand,fi.chrome.hideDashboardShare);u.reactor(n,this._isSharedToArm,(function(n){var t=n?ct.unshare:ct.share;pt(li,t)}));nt("fxs-startboard-button-delete",wi,d,s.deleteCommand);var rr=nt("fxs-startboard-button-fullscreen",ni,b,s.fullscreenCommand),ai=function(){var n=e.isFullscreen(),t=n?ct.exitFullscreen:ni;f(document.body).toggleClass("fxs-portal-fullscreen",n);pt(rr,t)},vi=f(document),yi=e.fullscreen;vi.on(yi,ai);n.registerForDispose([function(){vi.off(yi,ai)},it.setEvents([ot.default.click,function(){return bt.trigger(ot.default.fxdashboardactivity)},])]);nt("fxs-startboard-button-migrate",ct.migrate,v,null,!1,(function(){r.trigger(t.fxmigratestartboard)}));wt=i.isFeatureEnabled("dashboardupanddown");nt("fxs-startboard-button-upload",st,g,s.uploadCommand,!wt,i.noop);nt("fxs-startboard-button-download",bi,p,s.downloadCommand,!wt);r.findByClassName(yt).click((function(n){n.preventDefault();s.browseCommand.execute(!1)}))},nt.prototype._handleUploadItemClick=function(n){var t=this.options.uploadCommand.fileInputOptions;t&&t()&&t().files(n);this.trigger("itemSelected",null,{item:this.options.uploadCommand.execute(!1)})},nt})(ft.Widget);t.Widget=si}));
define("_generated/Templates/WidgetsPanorama",["require","exports"],(function(){"use strict";return function(){return'<div class="fxs-startboard-target" aria-labelledby="startboard-title"><\/div> <div class="fxs-journey-target"><\/div>'}}));
define("MsPortalImpl/Widgets/Widgets.Panorama",["require","exports","f","o","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Widgets/Widgets.WidgetBase","_generated/Templates/WidgetsPanorama","MsPortalImpl/Widgets/Widgets.StartBoard","MsPortalImpl/Widgets/Widgets.UIElementBase","MsPortalImpl/Base/Base.EventTypes","_generated/Less/MsPortalImpl/Widgets/Widgets.Panorama.css"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";var v;r.defineProperty(t,"__esModule",{value:!0});var y=window,c="fxs-panorama",l=i.encodeHtml(u.Portal.preview),a="Can't add null child.",p=(function(n){function t(t,i){var r=n.call(this,t)||this;return r.rotateThemeEvent=null,r.applyViewSettings(i),r}return __extends(t,n),t.prototype.getViewSettings=function(){return{}},t.prototype.applyViewSettings=function(){return},t})(s.ViewModel);t.ViewModel=p;v=(function(n){function t(t,i){var r=n.call(this,t,i)||this;return t.addClass(c).html(e()),t.findByClassName("fxs-panorama-previewbadge").attr("title",l).findByClassName("fxs-panorama-previewbadge-text").text(l),r.ltm.registerForDispose(t.setEvents([h.default.doubleclick,function(n){var t=$(n.target),i=t.hasClass(c),u=t.hasClass("fxs-startboard-layout"),f=t.hasClass("fxs-flowlayout-childcontainer"),e=t.hasClass("fxs-journey-layout"),o=t.hasClass("fxs-journey-placeholder");(i||u||f||e||o)&&(n.preventDefault(),n.stopPropagation(),y.getSelection().removeAllRanges(),r.trigger(h.default.fxrotatetheme))},])),r}return __extends(t,n),t.prototype.dispose=function(){this._cleanElement(c);n.prototype.dispose.call(this)},t.prototype.addChild=function(n){if(!n)throw new Error(a);this.getJourneyWidget().addChild(n)},t.prototype.insertChild=function(n,t){if(!n)throw new Error(a);this.getJourneyWidget().insertChild(n,t)},t.prototype.removeChild=function(n){var t=this.getJourneyWidget();return t&&t.removeChild(n)},t.prototype.getStartBoardArea=function(){return this.element.findByClassName("fxs-startboard-target")},t.prototype.getJourneyArea=function(){return this.element.findByClassName("fxs-journey-target")},t.prototype.getStartBoardWidget=function(){return f.Widget.getWidget(this.getStartBoardArea(),o.Widget)},t.prototype.getJourneyWidget=function(){var n=f.Widget.getWidgets(this.getJourneyArea());if(n.length>1)throw new Error("The journey target has been initialized with more than one widget.");return n[0]},t.prototype.saveViewSettings=function(){return this.options.getViewSettings()},t})(s.Widget);t.Widget=v}));
define("MsPortalImpl/Svg/Startup/Search.svg",[],(function(){"use strict";return{type:248,data:"<svg viewBox='0 0 50 50' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M21.8.6c1.5.4 2.8 1 4.1 1.7 1.2.8 2.4 1.7 3.4 2.7 1 1.1 1.9 2.2 2.7 3.5.7 1.3 1.3 2.6 1.7 4.1.4 1.5.6 3 .6 4.6 0 2-.3 4-1 5.8s-1.7 3.6-3 5.1l19.1 19.2c.3.3.5.7.5 1.1 0 .4-.2.8-.5 1.1-.3.3-.7.5-1.1.5-.4 0-.8-.2-1.1-.5l-19-19.1c-1.6 1.3-3.3 2.3-5.1 3-1.9.7-3.8 1-5.8 1-1.6 0-3.1-.2-4.6-.6-1.5-.4-2.8-1-4.1-1.7-1.3-.7-2.4-1.6-3.5-2.7-1-1.1-1.9-2.2-2.7-3.5-.7-1.3-1.3-2.6-1.7-4.1-.4-1.5-.6-3-.6-4.6 0-1.6.2-3.1.6-4.6.4-1.5 1-2.8 1.7-4.1C3.1 7.3 4 6.1 5 5c1-1 2.2-1.9 3.5-2.7C9.8 1.6 11.1 1 12.6.6c1.5-.4 3-.6 4.6-.6s3.1.2 4.6.6zm.9 29.5c1.7-.7 3.2-1.7 4.5-3s2.3-2.8 3-4.5c.7-1.7 1.1-3.5 1.1-5.5 0-1.9-.4-3.8-1.1-5.5-.7-1.7-1.7-3.2-3-4.5s-2.8-2.3-4.5-3C21 3.4 19.2 3 17.2 3s-3.8.4-5.5 1.1C10 5 8.5 6 7.3 7.3S5 10 4.2 11.7c-.7 1.7-1.1 3.5-1.1 5.5 0 1.9.4 3.8 1.1 5.5.7 1.7 1.7 3.2 3 4.5s2.8 2.3 4.5 3c1.7.7 3.5 1.1 5.5 1.1s3.7-.4 5.5-1.2z'/><\/g><\/svg>"}}));
define("_generated/Less/Viva.Controls/Controls/Base/Viva.Base.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,"body>div[data-popup=true].azc-control{z-index:250}.azc-before-color-index-76::before,.azc-color-index-76,div.azc-before-color-k0t2::before,div.azc-color-k0t2,div.msportalfx-bgcolor-k0t2{background-color:#63707e!important}.azc-before-color-index-75::before,.azc-color-index-75,div.azc-before-color-j0t2::before,div.azc-color-j0t2,div.msportalfx-bgcolor-j0t2{background-color:#f0f7b2!important}.azc-before-color-index-74::before,.azc-color-index-74,div.azc-before-color-i0t2::before,div.azc-color-i0t2,div.msportalfx-bgcolor-i0t2{background-color:#ccecdb!important}.azc-before-color-index-73::before,.azc-color-index-73,div.azc-before-color-h0t2::before,div.azc-color-h0t2,div.msportalfx-bgcolor-h0t2{background-color:#ccf0ea!important}.azc-before-color-index-72::before,.azc-color-index-72,div.azc-before-color-g0t2::before,div.azc-color-g0t2,div.msportalfx-bgcolor-g0t2{background-color:#ccf2fc!important}.azc-before-color-index-71::before,.azc-color-index-71,div.azc-before-color-f0t2::before,div.azc-color-f0t2,div.msportalfx-bgcolor-f0t2{background-color:#ccd1e9!important}.azc-before-color-index-70::before,.azc-color-index-70,div.azc-before-color-e0t2::before,div.azc-color-e0t2,div.msportalfx-bgcolor-e0t2{background-color:#e1d3e4!important}.azc-before-color-index-69::before,.azc-color-index-69,div.azc-before-color-d0t2::before,div.azc-color-d0t2,div.msportalfx-bgcolor-d0t2{background-color:#fbcce8!important}.azc-before-color-index-68::before,.azc-color-index-68,div.azc-before-color-c0t2::before,div.azc-color-c0t2,div.msportalfx-bgcolor-c0t2{background-color:#facfd3!important}.azc-before-color-index-67::before,.azc-color-index-67,div.azc-before-color-b0t2::before,div.azc-color-b0t2,div.msportalfx-bgcolor-b0t2{background-color:#ffe8cc!important}.azc-before-color-index-66::before,.azc-color-index-66,div.azc-before-color-a0t2::before,div.azc-color-a0t2,div.msportalfx-bgcolor-a0t2{background-color:#fffccc!important}.azc-before-color-index-65::before,.azc-color-index-65,div.azc-before-color-k0t1::before,div.azc-color-k0t1,div.msportalfx-bgcolor-k0t1{background-color:#8f9ca8!important}.azc-before-color-index-64::before,.azc-color-index-64,div.azc-before-color-j0t1::before,div.azc-color-j0t1,div.msportalfx-bgcolor-j0t1{background-color:#d6e86c!important}.azc-before-color-index-63::before,.azc-color-index-63,div.azc-before-color-i0t1::before,div.azc-color-i0t1,div.msportalfx-bgcolor-i0t1{background-color:#66c592!important}.azc-before-color-index-62::before,.azc-color-index-62,div.azc-before-color-h0t1::before,div.azc-color-h0t1,div.msportalfx-bgcolor-h0t1{background-color:#66d1bf!important}.azc-before-color-index-61::before,.azc-color-index-61,div.azc-before-color-g0t1::before,div.azc-color-g0t1,div.msportalfx-bgcolor-g0t1{background-color:#66d7f7!important}.azc-before-color-index-60::before,.azc-color-index-60,div.azc-before-color-f0t1::before,div.azc-color-f0t1,div.msportalfx-bgcolor-f0t1{background-color:#6674bc!important}.azc-before-color-index-59::before,.azc-color-index-59,div.azc-before-color-e0t1::before,div.azc-color-e0t1,div.msportalfx-bgcolor-e0t1{background-color:#a47aaf!important}.azc-before-color-index-58::before,.azc-color-index-58,div.azc-before-color-d0t1::before,div.azc-color-d0t1,div.msportalfx-bgcolor-d0t1{background-color:#f466ba!important}.azc-before-color-index-57::before,.azc-color-index-57,div.azc-before-color-c0t1::before,div.azc-color-c0t1,div.msportalfx-bgcolor-c0t1{background-color:#f1707b!important}.azc-before-color-index-56::before,.azc-color-index-56,div.azc-before-color-b0t1::before,div.azc-color-b0t1,div.msportalfx-bgcolor-b0t1{background-color:#ffba66!important}.azc-before-color-index-55::before,.azc-color-index-55,div.azc-before-color-a0t1::before,div.azc-color-a0t1,div.msportalfx-bgcolor-a0t1{background-color:#fcf37e!important}.azc-before-color-index-54::before,.azc-color-index-54,div.azc-before-color-k0s1::before,div.azc-color-k0s1,div.msportalfx-bgcolor-k0s1{background-color:#464f59!important}.azc-before-color-index-53::before,.azc-color-index-53,div.azc-before-color-j0s1::before,div.azc-color-j0s1,div.msportalfx-bgcolor-j0s1{background-color:#8ba208!important}.azc-before-color-index-52::before,.azc-color-index-52,div.azc-before-color-i0s1::before,div.azc-color-i0s1,div.msportalfx-bgcolor-i0s1{background-color:#0f5b2f!important}.azc-before-color-index-51::before,.azc-color-index-51,div.azc-before-color-h0s1::before,div.azc-color-h0s1,div.msportalfx-bgcolor-h0s1{background-color:#00856f!important}.azc-before-color-index-50::before,.azc-color-index-50,div.azc-before-color-g0s1::before,div.azc-color-g0s1,div.msportalfx-bgcolor-g0s1{background-color:#008db5!important}.azc-before-color-index-49::before,.azc-color-index-49,div.azc-before-color-f0s1::before,div.azc-color-f0s1,div.msportalfx-bgcolor-f0s1{background-color:#00126b!important}.azc-before-color-index-48::before,.azc-color-index-48,div.azc-before-color-e0s1::before,div.azc-color-e0s1,div.msportalfx-bgcolor-e0s1{background-color:#4e195c!important}.azc-before-color-index-47::before,.azc-color-index-47,div.azc-before-color-d0s1::before,div.azc-color-d0s1,div.msportalfx-bgcolor-d0s1{background-color:#b10069!important}.azc-before-color-index-46::before,.azc-color-index-46,div.azc-before-color-c0s1::before,div.azc-color-c0s1,div.msportalfx-bgcolor-c0s1{background-color:#ae0d1a!important}.azc-before-color-index-45::before,.azc-color-index-45,div.azc-before-color-b0s1::before,div.azc-color-b0s1,div.msportalfx-bgcolor-b0s1{background-color:#bf6900!important}.azc-before-color-index-44::before,.azc-color-index-44,div.azc-before-color-a0s1::before,div.azc-color-a0s1,div.msportalfx-bgcolor-a0s1{background-color:#bfb500!important}.azc-before-color-index-43::before,.azc-color-index-43,div.azc-before-color-k0s2::before,div.azc-color-k0s2,div.msportalfx-bgcolor-k0s2{background-color:#32383f!important}.azc-before-color-index-42::before,.azc-color-index-42,div.azc-before-color-j0s2::before,div.azc-color-j0s2,div.msportalfx-bgcolor-j0s2{background-color:#3d460a!important}.azc-before-color-index-41::before,.azc-color-index-41,div.azc-before-color-i0s2::before,div.azc-color-i0s2,div.msportalfx-bgcolor-i0s2{background-color:#063d20!important}.azc-before-color-index-40::before,.azc-color-index-40,div.azc-before-color-h0s2::before,div.azc-color-h0s2,div.msportalfx-bgcolor-h0s2{background-color:#084c41!important}.azc-before-color-index-39::before,.azc-color-index-39,div.azc-before-color-g0s2::before,div.azc-color-g0s2,div.msportalfx-bgcolor-g0s2{background-color:#005e79!important}.azc-before-color-index-38::before,.azc-color-index-38,div.azc-before-color-f0s2::before,div.azc-color-f0s2,div.msportalfx-bgcolor-f0s2{background-color:#000c48!important}.azc-before-color-index-37::before,.azc-color-index-37,div.azc-before-color-e0s2::before,div.azc-color-e0s2,div.msportalfx-bgcolor-e0s2{background-color:#34113d!important}.azc-before-color-index-36::before,.azc-color-index-36,div.azc-before-color-d0s2::before,div.azc-color-d0s2,div.msportalfx-bgcolor-d0s2{background-color:#760046!important}.azc-before-color-index-35::before,.azc-color-index-35,div.azc-before-color-c0s2::before,div.azc-color-c0s2,div.msportalfx-bgcolor-c0s2{background-color:#740912!important}.azc-before-color-index-34::before,.azc-color-index-34,div.azc-before-color-b0s2::before,div.azc-color-b0s2,div.msportalfx-bgcolor-b0s2{background-color:#804600!important}.azc-before-color-index-33::before,.azc-color-index-33,div.azc-before-color-a0s2::before,div.azc-color-a0s2,div.msportalfx-bgcolor-a0s2{background-color:#807900!important}.azc-before-color-index-32::before,.azc-color-index-32,div.azc-before-color-k2::before,div.azc-color-k2,div.msportalfx-bgcolor-k2{background-color:#d6d7d8!important}.azc-before-color-index-31::before,.azc-color-index-31,div.azc-before-color-j2::before,div.azc-color-j2,div.msportalfx-bgcolor-j2{background-color:#e2e584!important}.azc-before-color-index-30::before,.azc-color-index-30,div.azc-before-color-i2::before,div.azc-color-i2,div.msportalfx-bgcolor-i2{background-color:#55d455!important}.azc-before-color-index-29::before,.azc-color-index-29,div.azc-before-color-h2::before,div.azc-color-h2,div.msportalfx-bgcolor-h2{background-color:#00d8cc!important}.azc-before-color-index-28::before,.azc-color-index-28,div.azc-before-color-g2::before,div.azc-color-g2,div.msportalfx-bgcolor-g2{background-color:#6dc2e9!important}.azc-before-color-index-27::before,.azc-color-index-27,div.azc-before-color-f2::before,div.azc-color-f2,div.msportalfx-bgcolor-f2{background-color:#4668c5!important}.azc-before-color-index-26::before,.azc-color-index-26,div.azc-before-color-e2::before,div.azc-color-e2,div.msportalfx-bgcolor-e2{background-color:#9b4f96!important}.azc-before-color-index-25::before,.azc-color-index-25,div.azc-before-color-d2::before,div.azc-color-d2,div.msportalfx-bgcolor-d2{background-color:#f472d0!important}.azc-before-color-index-24::before,.azc-color-index-24,div.azc-before-color-c2::before,div.azc-color-c2,div.msportalfx-bgcolor-c2{background-color:#dd5900!important}.azc-before-color-index-23::before,.azc-color-index-23,div.azc-before-color-b2::before,div.azc-color-b2,div.msportalfx-bgcolor-b2{background-color:#ffb900!important}.azc-before-color-index-22::before,.azc-color-index-22,div.azc-before-color-a2::before,div.azc-color-a2,div.msportalfx-bgcolor-a2{background-color:#fffc9e!important}.azc-before-color-index-21::before,.azc-color-index-21,div.azc-before-color-k0::before,div.azc-color-k0,div.msportalfx-bgcolor-k0{background-color:#bbc2ca!important}.azc-before-color-index-20::before,.azc-color-index-20,div.azc-before-color-j0::before,div.azc-color-j0,div.msportalfx-bgcolor-j0{background-color:#bad80a!important}.azc-before-color-index-19::before,.azc-color-index-19,div.azc-before-color-i0::before,div.azc-color-i0,div.msportalfx-bgcolor-i0{background-color:#009e49!important}.azc-before-color-index-18::before,.azc-color-index-18,div.azc-before-color-h0::before,div.azc-color-h0,div.msportalfx-bgcolor-h0{background-color:#00b294!important}.azc-before-color-index-17::before,.azc-color-index-17,div.azc-before-color-g0::before,div.azc-color-g0,div.msportalfx-bgcolor-g0{background-color:#00bcf2!important}.azc-before-color-index-16::before,.azc-color-index-16,div.azc-before-color-f0::before,div.azc-color-f0,div.msportalfx-bgcolor-f0{background-color:#00188f!important}.azc-before-color-index-15::before,.azc-color-index-15,div.azc-before-color-e0::before,div.azc-color-e0,div.msportalfx-bgcolor-e0{background-color:#68217a!important}.azc-before-color-index-14::before,.azc-color-index-14,div.azc-before-color-d0::before,div.azc-color-d0,div.msportalfx-bgcolor-d0{background-color:#ec008c!important}.azc-before-color-index-13::before,.azc-color-index-13,div.azc-before-color-c0::before,div.azc-color-c0,div.msportalfx-bgcolor-c0{background-color:#e81123!important}.azc-before-color-index-12::before,.azc-color-index-12,div.azc-before-color-b0::before,div.azc-color-b0,div.msportalfx-bgcolor-b0{background-color:#ff8c00!important}.azc-before-color-index-11::before,.azc-color-index-11,div.azc-before-color-a0::before,div.azc-color-a0,div.msportalfx-bgcolor-a0{background-color:#fff100!important}.azc-before-color-index-10::before,.azc-color-index-10,div.azc-before-color-k1::before,div.azc-color-k1,div.msportalfx-bgcolor-k1{background-color:#a0a5a8!important}.azc-before-color-index-9::before,.azc-color-index-9,div.azc-before-color-j1::before,div.azc-color-j1,div.msportalfx-bgcolor-j1{background-color:#7fba00!important}.azc-before-color-index-8::before,.azc-color-index-8,div.azc-before-color-i1::before,div.azc-color-i1,div.msportalfx-bgcolor-i1{background-color:#007233!important}.azc-before-color-index-7::before,.azc-color-index-7,div.azc-before-color-h1::before,div.azc-color-h1,div.msportalfx-bgcolor-h1{background-color:#008272!important}.azc-before-color-index-6::before,.azc-color-index-6,div.azc-before-color-g1::before,div.azc-color-g1,div.msportalfx-bgcolor-g1{background-color:#0072c6!important}.azc-before-color-index-5::before,.azc-color-index-5,div.azc-before-color-f1::before,div.azc-color-f1,div.msportalfx-bgcolor-f1{background-color:#002050!important}.azc-before-color-index-4::before,.azc-color-index-4,div.azc-before-color-e1::before,div.azc-color-e1,div.msportalfx-bgcolor-e1{background-color:#442359!important}.azc-before-color-index-3::before,.azc-color-index-3,div.azc-before-color-d1::before,div.azc-color-d1,div.msportalfx-bgcolor-d1{background-color:#b4009e!important}.azc-before-color-index-2::before,.azc-color-index-2,div.azc-before-color-c1::before,div.azc-color-c1,div.msportalfx-bgcolor-c1{background-color:#ba141a!important}.azc-before-color-index-1::before,.azc-color-index-1,div.azc-before-color-b1::before,div.azc-color-b1,div.msportalfx-bgcolor-b1{background-color:#eb3c00!important}.azc-before-color-index-0::before,.azc-color-index-0,div.azc-before-color-a1::before,div.azc-color-a1,div.msportalfx-bgcolor-a1{background-color:#fcd116!important}")}));
define("Viva.Controls/Controls/Base/Viva.Base",["require","exports","f","i","o","a","ko","$","MsPortalImpl/Base/JQueryHelper","Viva.Controls/Util/Viva.Util","MsPortalImpl.Controls/Controls/Base/OptionsBase","_generated/Less/Viva.Controls/Controls/Base/Viva.Base.css"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";var l;return (function(n){function w(n){return n=n||{},n.viewModelType=n.viewModelType||p,n}function b(n,t,i){i=w(i);var r=t;return r&&r instanceof i.viewModelType||(r=new i.viewModelType({ltm:n()}),r.populateFromObject(t)),r}var l=i.initObservable,a=i.isNullOrUndefined,v="azc-control",y="azc-control-disabled",p=(function(n){function t(t){var i=n.call(this,t.ltm)||this;return i.disabled=l(t.disabled,!1),i.loading=l(t.loading,!1),i}return __extends(t,n),t.prototype.dispose=function(){n.prototype.dispose.call(this)},t.prototype.populateFromObject=function(n){t.copyObject(n,this)},t.copyObject=function(n,i){t._copyObject(n,i,[],[])},t._copyObject=function(n,i,r,u){var h=n,s=i,c,o,e;r.push(n);u.push(i);for(e in h)!h.hasOwnProperty(e)||e.startsWith("#")||e.startsWith("_")&&!e.startsWith("_msPortalFx")||(o=h[e],o!==undefined&&(f.isArray(o)?s[e]=o:o instanceof Date?s[e]=o:typeof o=="object"&&o!==null?(c=r.indexOf(o),c>=0?s[e]=u[c]:(s[e]||(s[e]={}),t._copyObject(o,s[e],r,u))):s[e]=o))},t})(i.ViewModels.Controls.Base.ViewModel),t;n.ViewModel=p;t=(function(n){function t(i,u,f){var s=this,k,d=function(){return k=new r.TriggerableLifetimeManager},c,l,p;if(s=n.call(this,i,b(d,u,f),w(f))||this,s._dataFocusableCallback=e.observable(),s._markFocusFirstElements=e.observable(),s._supportsFocus=e.observable(!1),c=h.Constants,!i||i.length===0)throw new Error("You must specify an element to associate a widget to it. Your element is either null or an empty collection.");return l=s.ltm,k&&l.registerForDispose(k),s._disposablesLifetimeManager=l.createChildLifetime(),t.setupCleanData(),p=s.element,p.addClass(v).attr(c.dataControlAttribute,"true"),e.computed(l,(function(){s.widget().toggleClass(y,s.$disabled())})),e.computed(l,(function(){var n=s._dataFocusableCallback();a(n)?(p.removeAttr(c.dataCanFocusAttribute),delete p[0][c.dataCanFocusAttribute]):(p.attr(c.dataCanFocusAttribute,"true"),p[0][c.dataCanFocusAttribute]=function(){return n.apply(s,[p,s])})})),e.computed(l,(function(){var t=s._supportsFocus(),n=s._dataFocusableCallback.peek();t?n!==s._setFocus&&s._dataFocusableCallback(s._setFocus):a(n)||s._dataFocusableCallback(null)})),e.computed(l,(function(){var t=s._markFocusFirstElements(),n=t?t():null;s._prevElement&&o(s._prevElement).removeAttr(c.dataFocusFirstAttribute);n&&o(n).attr(c.dataFocusFirstAttribute,"true");s._prevElement=n})),s._initializeSubscriptions(s.options),s}return __extends(t,n),t.prototype.dispose=function(){this._checkExistsOrRegisterDestroyId(n.prototype.dispose)||(this._supportsFocus(!1),this._disposeSubscriptions(),this.element.removeClass(v).removeClass(y).removeAttr(h.Constants.dataControlAttribute).removeAttr("role"),n.prototype.dispose.call(this))},u.defineProperty(t.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),u.defineProperty(t.prototype,"subLifetime",{get:function(){return this._subLifetimeManager},enumerable:!0,configurable:!0}),u.defineProperty(t.prototype,"_disposables",{get:function(){return this._disposablesLifetimeManager},enumerable:!0,configurable:!0}),t.prototype._canSetFocus=function(){var n=this.element;return n.attr(h.Constants.dataCanFocusAttribute)&&!this.$disabled.peek()&&s.isVisible(n)&&!n.is(":disabled")},t.prototype._getElementToFocus=function(){return this.widget()[0]},t.prototype._setFocus=function(){if(this._canSetFocus()){var n=this._getElementToFocus();if(n)return n.focus(),!0}return!1},t.prototype._disposeSubscriptions=function(){this._subLifetimeManager&&(this._subLifetimeManager.dispose(),this._subLifetimeManager=null)},t.prototype._initializeSubscriptions=function(){this._disposeSubscriptions();this._subLifetimeManager=this.ltm.createChildLifetime()},t.prototype._afterCreate=function(){},t.setupCleanData=function(){t._cleanData||(t._cleanData=o.cleanData,o.cleanData=function(n){for(var r,u=0,i=void 0;(i=n[u])!==null&&i!==undefined;u++)o.hasData(i)&&(o(i).triggerHandler(t._widgetRemoveEvent),r=!0);r&&t._cleanData.call(o,n)})},t})(c.Widget);t._widgetEventNamespace=".azcWidget";t._widgetRemoveEvent="remove"+t._widgetEventNamespace;n.Widget=t})(l||(l={})),l}));
define("Viva.Controls/Controls/Base/Viva.EditableControl",["require","exports","o","ko","Viva.Controls/Util/Viva.Util","Viva.Controls/Controls/Base/Viva.Base"],(function(n,t,i,r,u,f){"use strict";var e;return (function(n){var t="azc-editableControl",e="azc-is-edited",h="",o=(function(n){function t(t){var i=n.call(this,t)||this;return i.name=null,i.value=r.observable(),i.dirty=r.observable(!1),i.focused=r.observable(!1),i}return __extends(t,n),t})(f.ViewModel),s;n.ViewModel=o;s=(function(n){function f(i,f,e){var s=this,c,l,a;return e=e||{},e.viewModelType=e.viewModelType||o,s=n.call(this,i,f,e)||this,s._ready=!0,s.element.addClass(t).attr(u.Constants.dataEditableAttribute,"true").html(h),c=s.options,l=c.dirty,l||(a=c.value()||"",c.dirty=r.observable(!1),r.reactor(s.ltm,(function(){var n=c.value()||"";c.dirty(!s._isSameValue(n,a))}))),s._initializeSubscriptions(c),s._supportsFocus(!0),s}return __extends(f,n),f.prototype.dispose=function(){this._checkExistsOrRegisterDestroyId(n.prototype.dispose)||(this.element.removeClass(t).removeClass(e).removeAttr(u.Constants.dataEditableAttribute),n.prototype.dispose.call(this))},i.defineProperty(f.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),f.prototype._isSameValue=function(n,t){return n==t},f.prototype._initializeSubscriptions=function(t){var i=this,r,u;n.prototype._initializeSubscriptions.call(this,t);this._ready&&(r=function(n){i.element.toggleClass(e,n)},r(t.dirty()),u=this.subLifetime,t.dirty.subscribe(u,r),this.options.focused.subscribe(u,(function(n){n||i.element.trigger("editableControl-blur",{widget:i,model:i.options})})))},f})(f.Widget);n.Widget=s})(e||(e={})),e}));
define("Viva.Controls/Util/Viva.DateUtil",["require","exports","f"],(function(n,t,i){"use strict";var r;return (function(n){function p(n,t,i){return i=i?i:"0",t+1>=n.length&&(n=Array(t+1-n.length).join(i)+n),n}function f(n,t,i){return p(n+"",t,i)}function h(n,t){return n.substr(Math.max(n.length-t,0))}function r(n,t){return h(n+"",t)}function u(n,t){return h(f(n,t,"0"),t)}function c(n){return n=n%12,n===0?12:n}function o(n){return n&&n.split("").reverse().join("")}function e(n){return n&&"\\"+n.split("").join("\\")}function w(i){var o=i.length,h,l,a,v,s=n.getLocaleValues();switch(i[0]){case"y":switch(o){case 3:return f(t.getFullYear(),o);case 1:return parseInt(r(t.getFullYear(),2),10)+"";default:return u(t.getFullYear(),o)}case"M":switch(o){case 4:return e(s.months[t.getMonth()]);case 3:return e(s.monthsAbbr[t.getMonth()]);case 2:return u(t.getMonth()+1,2);default:return r(t.getMonth()+1,2)}case"d":switch(o){case 4:return e(s.days[t.getDay()]);case 3:return e(s.daysAbbr[t.getDay()]);case 2:return u(t.getDate(),2);default:return r(t.getDate(),2)}case"h":return o===2?u(c(t.getHours()),2):r(c(t.getHours()),2);case"H":return o===2?u(t.getHours(),2):r(t.getHours(),2);case"m":return o===2?u(t.getMinutes(),2):r(t.getMinutes(),2);case"s":switch(o){case 4:return u(t.getMilliseconds(),3);case 3:return r(t.getMilliseconds(),3);case 2:return u(t.getSeconds(),2)}return r(t.getSeconds(),2);case"t":return o===2?s.ampm[t.getHours()<12?0:1]:s.ampmAbbr[t.getHours()<12?0:1];case"z":return(h=-t.getTimezoneOffset()/60,l=h<0,l&&(h=-h),a=parseInt(h+"",10),v=(h-a)*60,o===3)?(l?"-":"+")+f(a,2)+":"+f(v,2):(l?"-":"+")+f(a,o);case"/":return s.dateSeparator;case":":return s.timeSeparator}return""}function b(n){return o(w(n))}function k(i){for(var r,s,f=[],u=1;u<arguments.length;u++)f[u-1]=arguments[u];return f.length?(r=f[0],s=n.getLocaleValues(),r=s.standard[r]||r,r=r.replace(/'([^']*)'/g,(function(n,t){return e(t)})),t=i,o(o(r).replace(/(y{1,5}|M{1,4}|d{1,4}|h{1,2}|H{1,2}|m{1,2}|s{1,4}|t{1,2}|z{1,3}|\/|:)(?!\\)/g,b).replace(/\\(?!\\)/g,""))):v.apply(i,arguments)}function d(n,t){return n&&t?n.getFullYear()===t.getFullYear()?n.getMonth()===t.getMonth()?n.getDate()===t.getDate()?0:n.getDate()<t.getDate()?-1:1:n.getMonth()<t.getMonth()?-1:1:n.getFullYear()<t.getFullYear()?-1:1:-1}function g(n,t){return n&&t?n.getHours()===t.getHours()?n.getMinutes()===t.getMinutes()?n.getSeconds()===t.getSeconds()?0:n.getSeconds()<t.getSeconds()?-1:1:n.getMinutes()<t.getMinutes()?-1:1:n.getHours()<t.getHours()?-1:1:-1}function nt(n,t){return n instanceof Date&&t instanceof Date&&s(n)===s(t)}var l=i,a=(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t})(i.DateUtil.DateTimeRange),t;n.DateTimeRange=a;var v=Date.prototype.toString,y=i.uncurryThis,s=l.toSeconds;n.getLocaleValues=i.getLocaleValues;n.setLocaleValues=i.setLocaleValues;n.toRelativeString=y(i.dateToRelativeString);n.toString=k;n.parse=i.dateParse;n.compareDatePartOnly=d;n.compareTimePartOnly=g;n.areDatesEqualBySeconds=nt})(r||(r={})),r}));
define("Viva.Controls/Controls/Base/Viva.Validators",["require","exports","f","i","o","ko","$","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Resources/ImplScriptResources","Viva.Controls/Util/Viva.DateUtil"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";function rt(n){return(n||"").toLowerCase()}function ut(n){return(n||"").toLocaleLowerCase()}function si(n){return n().map((function(n){var i=n.validationState(),t=i!==1,r=t?n.passMessage&&n.passMessage():n.message();return t&&n.type===21&&(r=n.message()),{valid:t,message:r,state:i,type:n.type}})).filter((function(n){return n}))}var v,y,d,ft,et,tt,ot,st,ht,ct,lt,at,p,vt,yt,pt,g,it,wt,bt,kt,nt,dt,gt,ni,ti,ii,ri,ui;u.defineProperty(t,"__esModule",{value:!0});var w=i,fi=w.Base,ei=w.ViewModels,a=w.isNullOrUndefined,l=o.Viva.Validators,b=l.DateTimeRange,oi=fi.Diagnostics.createLog(n),k=i.regexEscape;t.DateFormatForMoment="YYYY-MM-DD";t.DateFormatForJS="yyyy-MM-dd";t.TimeFormatForJS="hh:mm:ss tt";v=(function(){function n(n,t,i,r){var u=this,s=this._ltm=n.createChildLifetime(),e,o;this.fxViewModel=t;e=i;t&&t.message&&(e=t.message);o=r;o=t&&t.successMessage?t.successMessage:r&&r.length?r:null;this.message=f.observable(e);this.passMessage=f.observable(o);this.validationState=f.observable(0);this.validate=f.observable();this.isEmptyValid=f.observable(!1);this.type=t&&t.type;this.valid=f.computed(s,(function(){return u.validationState()===2}));this.validate.subscribe(s,(function(n){u.validationState(u._validate(n))}))}return n.prototype.dispose=function(){var n=this._ltm;n&&(n.dispose(),this._ltm=null)},n.prototype._validate=function(){return 0},n})();t.Validator=v;y=(function(n){function t(t,i,r,u,f,e){var o=this;return i&&i.type===2&&(r=i.pattern,u=undefined),o=n.call(this,t,i,f||l.match.format(i.pattern),e||"Match found.")||this,o._expression=new RegExp(r,u),o}return __extends(t,n),t.prototype._validate=function(n){return(a(n)||e.trim(n)==="")&&this.isEmptyValid()?2:this._expression.test(n||"")?2:1},t})(v);t.Match=y;d=(function(n){function t(t,i,r,u,f,e){var o=this;return i&&i.type===3&&(r=i.pattern,u=undefined),o=n.call(this,t,i,f||l.notMatch.format(i.pattern),e||l.Success.notMatch)||this,o._expression=new RegExp(r,u),o}return __extends(t,n),t.prototype._validate=function(n){return(a(n)||e.trim(n)==="")&&this.isEmptyValid()?2:this._expression.test(n||"")?1:2},t})(v);t.NotMatch=d;ft=(function(n){function t(t,i){return n.call(this,t,i,k(i.searchString),"i",l.contains.format(i.message),l.Success.contains.format(i.searchString))||this}return __extends(t,n),t})(y);t.Contains=ft;et=(function(n){function t(t,i){return n.call(this,t,i,k(i.searchString),"i",l.notContains.format(i.searchString),l.Success.notMatch.format(i.searchString))||this}return __extends(t,n),t})(d);t.NotContains=et;tt=(function(n){function t(t,i,r,u,f){var e=this;return i&&i.type===6&&(r=i.characters),n.call(this,t,i,"["+k(r)+"]","",u||l.containsCharacters.format(r),f||l.Success.containsCharacters.format(r))||this}return __extends(t,n),t})(y);t.ContainsCharacters=tt;ot=(function(n){function t(t,i){return n.call(this,t,i,"["+k(i.characters)+"]","",l.notContainsCharacters.format(i.characters),l.Success.notContainsCharacters.format(i.characters))||this}return __extends(t,n),t})(d);t.NotContainsCharacters=ot;st=(function(n){function t(t,i){return n.call(this,t,i,"[0-9]",undefined,l.hasDigit,l.Success.hasDigit)||this}return __extends(t,n),t})(y);t.HasDigit=st;ht=(function(n){function t(t,i){return n.call(this,t,i,"[A-Za-z]",undefined,l.hasLetter,l.Success.hasLetter)||this}return __extends(t,n),t})(y);t.HasLetter=ht;ct=(function(n){function t(t,i){return n.call(this,t,i,"[A-Z]",undefined,l.hasUpperCaseLetter,l.Success.hasUpperCaseLetter)||this}return __extends(t,n),t})(y);t.HasUpperCaseLetter=ct;lt=(function(n){function t(t,i){return n.call(this,t,i,"[a-z]",undefined,l.hasLowerCaseLetter,l.Success.hasLowerCaseLetter)||this}return __extends(t,n),t})(y);t.HasLowerCaseLetter=lt;at=(function(n){function t(t,i){return n.call(this,t,i,"!@#$%^&*()_+-={}|[]\\:\";'<>,.?/~`",l.hasPunctuation,l.Success.hasPunctuation)||this}return __extends(t,n),t})(tt);t.HasPunctuation=at;p=(function(n){function t(t,i,r){var u=n.call(this,t,i,r,l.Success.equals.format(f.unwrap(i.compareTo)))||this;return u._compareTo=f.isObservable(i.compareTo)?i.compareTo:function(){return i.compareTo},u}return __extends(t,n),t.prototype._validate=function(n){return this._compare(n,this._compareTo())?2:1},t.prototype._compare=function(){return!1},t})(v);t.Compare=p;vt=(function(n){function t(t,i){return n.call(this,t,i,l.equals.format(f.unwrap(i.compareTo)))||this}return __extends(t,n),t.prototype._compare=function(n,t){return n===t},t})(p);t.Equals=vt;yt=(function(n){function t(t,i){return n.call(this,t,i,l.caseInsensitiveComparison)||this}return __extends(t,n),t.prototype._compare=function(n,t){return rt(n)===rt(t)},t})(p);t.CaseInsensitiveComparison=yt;pt=(function(n){function t(t,i){return n.call(this,t,i,l.localeAwareCaseInsensitiveComparison)||this}return __extends(t,n),t.prototype._compare=function(n,t){return ut(n)===ut(t)},t})(p);t.LocaleAwareCaseInsensitiveComparison=pt;g=(function(n){function t(t,i,r,u,f,e){var o=this;return i&&i.type===14&&(r=i.min,u=i.max),o=n.call(this,t,i,f||l.lengthRange.format(r,u),e||l.Success.lengthRange.format(r,u))||this,o._min=r,o._max=u,o}return __extends(t,n),t.prototype._validate=function(n){var t,i;return(n=e.trim(n),(a(n)||e.trim(n)==="")&&this.isEmptyValid())?2:(t=0,a(n)||(t=n.length),i=0,a(this._min)||(i=this._min),t>=i&&(a(this._max)||t<=this._max))?2:1},t})(v);t.LengthRange=g;it=(function(n){function t(t,i,r,u){var f=this;return i&&i.type===15&&(r=i.min),n.call(this,t,i,r,null,u||l.minLength.format(r),l.Success.minLength.format(r))||this}return __extends(t,n),t})(g);t.MinLength=it;wt=(function(n){function t(t,i){return n.call(this,t,i,0,i.max,l.maxLength.format(i.max),l.Success.maxLength.format(i.max))||this}return __extends(t,n),t})(g);t.MaxLength=wt;bt=(function(n){function t(t,i){return n.call(this,t,i,1,l.required)||this}return __extends(t,n),t})(it);t.Required=bt;kt=(function(n){function t(t,i){return n.call(this,t,i,l.numeric,l.Success.numeric)||this}return __extends(t,n),t.prototype._validate=function(n){return(a(n)||e.trim(n)==="")&&this.isEmptyValid()?2:!a(n)&&n!==""?isNaN(+n)?1:2:1},t})(v);t.Numeric=kt;nt=(function(n){function t(t,i,r,u,e,o){var c=this,s,h;return i&&i.type===18&&(r=i.min,u=i.max),s=r,f.isObservable(s)||(s=function(){return r}),h=u,f.isObservable(h)||(h=function(){return u}),c=n.call(this,t,i,e||l.valueRange.format(s(),h()),o||l.Success.valueRange.format(s(),h()))||this,c.min=s,c.max=h,c}return __extends(t,n),t.prototype._validate=function(n){var t;return(a(n)||e.trim(n)==="")&&this.isEmptyValid()?2:(a(n)||n==="")&&a(this.min())&&a(this.max())?2:!a(n)&&(typeof n=="string"||typeof n=="number")&&n!==""&&(t=+n,!isNaN(t))?!a(this.min())&&t<this.min()?1:!a(this.max())&&t>this.max()?1:2:1},t})(v);t.ValueRange=nt;dt=(function(n){function t(t,i,r){var u=this;return i&&i.type===19&&(r=i.min),n.call(this,t,i,r,null,l.minValue.format(r),l.Success.minValue.format(r))||this}return __extends(t,n),t})(nt);t.MinValue=dt;gt=(function(n){function t(t,i,r){var u=this;return i&&i.type===20&&(r=i.max),n.call(this,t,i,null,r,l.maxValue.format(r),l.Success.maxValue.format(r))||this}return __extends(t,n),t})(nt);t.MaxValue=gt;ni=(function(n){function i(i,r,u,f){var e=this,s,o=t.DateFormatForJS+" "+t.TimeFormatForJS;return s=f?f:r&&u?b.minMax.format(c.toString(r,o),c.toString(u,o)):r?b.min.format(c.toString(r,o)):u?b.max.format(c.toString(u,o)):b.correctFormat,e=n.call(this,i,null,s)||this,e.minDateTime=r,e.maxDateTime=u,e}return __extends(i,n),i.prototype._validate=function(n){if(a(n))return this.isEmptyValid()?2:1;var t=n.getTime();return!a(this.minDateTime)&&Math.floor(t/1e3)<Math.floor(this.minDateTime.getTime()/1e3)?1:!a(this.maxDateTime)&&Math.floor(t/1e3)>Math.floor(this.maxDateTime.getTime()/1e3)?1:2},i})(v);t.DateTimeRange=ni;ti=(function(){function n(n,t){this.promise=n;this.asyncRequestId=t}return n})();ii=(function(n){function t(t,i,r){var u=n.call(this,t,i,"")||this,f;return i&&i.type?(f=function(n){return i.validate(n)},u._validationHandler=u._convertValidateFunction(f,r)):u._validationHandler=i,u._pendingAsyncRequests=[],u._latestValidationAsyncRequestId=null,u}return __extends(t,n),t.prototype._validate=function(n){var i=this,r=!1,t;return this._validationHandler?(this._latestValidationAsyncRequestId=w.getUniqueId(),t=this._validationHandler(n),this._pendingAsyncRequests.push(new ti(t,this._latestValidationAsyncRequestId)),t.then((function(n){i._updateValidationResult(t,n,2)})).catch((function(n){i._updateValidationResult(t,n&&n.message||"",1)})).finally((function(){r=!0})),r)?(this._removePendingAsyncRequest(t),this.validationState()):3:2},t.prototype._convertValidateFunction=function(n,t){return function(u){var e=n(u),f;return e?Q(e).then((function(n){if(n){if(n.valid)return n.message;throw r.createError(n.message);}else{var u=r.createError(h.Field.invalidValidationResult,{data:{message:"CustomValidation function '"+t+"' was resolved with invalid ValidationResult: "+n+". ValidationResult.message is required to inform customer why customer's input is invalid."}}),f=-1,e=void 0;t&&(f=t.indexOf("-"))>0&&(e=t.substr(0,f));r.Rpc.client.log(e||"fx",{level:2,code:0,area:"Viva.Validators",message:i.getLogFriendlyMessage(u)});throw u;}})):(f=r.createError("Extension validation handler did not return a promise. Proxied observable id is: '{0}'".format(t)),oi.error(f),Q.reject(f))}},t.prototype._updateResult=function(n,t){n&&this.message(n);this.validationState(t)},t.prototype._updateValidationResult=function(n,t,i){var r;r=this._pendingAsyncRequests.length<=1?this._pendingAsyncRequests.pop():this._removePendingAsyncRequest(n);r&&r.asyncRequestId===this._latestValidationAsyncRequestId&&this._updateResult(t,i)},t.prototype._removePendingAsyncRequest=function(n){for(var t=0,i=-1,r=null,t=0;t<this._pendingAsyncRequests.length;t++)if(this._pendingAsyncRequests[t].promise===n){i=t;break}return i>=0?(r=this._pendingAsyncRequests[i],this._pendingAsyncRequests.splice(i,1),r):null},t})(v);t.CustomAsyncValidator=ii;ri=(function(n){function t(t,i){var r=this;return i instanceof ei.InvalidValidation?n.call(this,t,i,l.invalid)||this:n.call(this,t,null,i||l.invalid)||this}return __extends(t,n),t.prototype._validate=function(){return 1},t})(v);t.Invalid=ri;ui=(function(n){function t(t,i){var r=n.call(this,t,i,"",l.Success.uri)||this;return r._options=i.options,r}return __extends(t,n),t.prototype._validate=function(n){var t=s.validateAbsoluteHttpUri(n,this._options);return t?2:1},t})(v);t.Uri=ui;t.getValidationResults=si}));
define("Viva.Controls/Controls/Base/Viva.ValidatableControl",["require","exports","f","o","ko","Viva.Controls/Controls/Base/Viva.EditableControl","Viva.Controls/Controls/Base/Viva.Validators"],(function(n,t,i,r,u,f,e){"use strict";var o;return (function(n){var t="azc-validatableControl",o=(function(n){function t(t){var i=n.call(this,t)||this;i.enableValidation=u.observable(!0);i.validationState=u.observable(0);i.validators=u.observableArray();i.validationPlacements=u.observableArray();i.validationResults=u.observableArray();var r=i.validationState(),f=i.validators().length,e=!i.enableValidation()||f===0||i.enableValidation()&&f>0&&(r===0||r===2);return i.valid=u.observable(e),i}return __extends(t,n),t})(f.ViewModel),s;n.ViewModel=o;s=(function(n){function f(i,r,u){var f=this;return u=u||{},u.viewModelType=u.viewModelType||o,f=n.call(this,i,r,u)||this,f._validationStateInternal=null,f.element.addClass(t),f._initializeValidation(),f._initializeSubscriptions(f.options),f._initialized=!0,f.options.dirty()&&f.validate(!0),f._validationState.notifySubscribers(f._validationState()),f}return __extends(f,n),f.prototype.dispose=function(){this._checkExistsOrRegisterDestroyId(n.prototype.dispose)||(n.prototype.dispose.call(this),this.element.removeClass(t),i.disposeDisposable([].concat(this.options.validators.removeAll(),this.options.validationPlacements.removeAll())))},r.defineProperty(f.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),f.prototype.validate=function(n){var u=this,t,i,f=!!n,r;this._shouldValidate()&&(r=this.options,t=r.validators(),t&&t.length>0&&(i=r.value(),t.forEach((function(n){var r=n&&n.fxViewModel&&n.fxViewModel.map,t,e=function(i){i===null&&(i=undefined);i!==n.validate()?n.validate(i):i===undefined&&i===n.validate()||f?n.validate.notifySubscribers(i):t!==undefined&&n.validationState(t)};r?n.validationState.fxOnceAndRun(u._validationLifetimeManager,(function(u){t=u;n.validationState(3);Q(r(i)).then(e).catch((function(){return n.validationState()===3&&n.validationState(t)}))}),(function(n){return n!==3})):e(i)}))))},f.prototype._initializeSubscriptions=function(t){var i=this,r,f,e,o;n.prototype._initializeSubscriptions.call(this,t);r=this.options;f=this.ltm;r.value.subscribe(f,(function(n){i._onValueChanged(n)}));e=this._validationState;e||(e=this._validationState=u.observable(0));e.subscribe(f,(function(n){r.validationState(n)}));this._validationStateInternal&&(o=function(n){var t=i._validationLifetimeManager;t&&(t.dispose(),i._validationLifetimeManager=null);n&&(t=i._validationLifetimeManager=f.createChildLifetime(),i._validationStateInternal.subscribe(t,(function(n){e(n)})),r.dirty()&&i.validate(!0))},r.enableValidation.subscribe(f,o),o(r.enableValidation()));t.validators.subscribeArrayChanges(f,(function(){i._onValidatorsChanged()}),(function(){i._onValidatorsChanged()}))},f.prototype._afterCreate=function(){n.prototype._afterCreate.call(this);this._initializeValidationPlacements()},f.prototype._onValueChanged=function(){this._hasValidators()&&this._valueChangeValidation()},f.prototype._valueChangeValidation=function(){this.validate()},f.prototype._initializeValidationPlacements=function(){var n=this,t=this.options.validationPlacements.removeAll();this.options.validationPlacements.subscribeArrayChanges(this.ltm,(function(t){t.initialize(n.element,n.options)}),(function(n){n.dispose()}));this.options.validationPlacements(t)},f.prototype._hasValidators=function(){var n=this.options.validators();return this.options.enableValidation()&&!this.$disabled()&&n&&n.length>0},f.prototype._initializeValidation=function(){var i=this,n=this.options,t=this.ltm;this._valid=u.computed(t,(function(){var t=!n.enableValidation()||n.validators().length===0||n.enableValidation()&&n.validators().length>0&&(n.validationState()===0||n.validationState()===2);return t!==n.valid.peek()&&n.valid(t),t}));this._validationStateInternal=u.computed(t,(function(){var t=0;if(i._shouldValidate()&&(n.validators().some((function(n){return t=n.validationState(),t===1||t===3||t===0})),t===1)){var r=0,u=0,f=!0;n.validators().forEach((function(n){var t=n.validationState();n.maxDateTime?(r++,t===2&&u++):t!==2&&(f=!1)}));f&&r>0&&u>0&&(t=2)}return t}));u.reactor(t,(function(){n.validationResults(e.getValidationResults(n.validators))}))},f.prototype._onValidatorsChanged=function(){this._initialized&&this.validate(!0)},f.prototype._shouldValidate=function(){var n=this.options.validators();return this.options.enableValidation()&&!this.$disabled()&&n&&n.length>0?!0:!1},f})(f.Widget);n.Widget=s})(o||(o={})),o}));
define("Viva.Controls/Controls/Base/Viva.ValueUpdateTrigger",["require","exports"],(function(){"use strict";var n;return (function(n){n.DefaultDelayValidationTimeout=500;var t;(function(n){n[n.Default=0]="Default";n[n.AfterKeyDown=1]="AfterKeyDown";n[n.KeyPress=2]="KeyPress";n[n.Blur=3]="Blur";n[n.Input=4]="Input"})(t=n.ValueUpdateTrigger||(n.ValueUpdateTrigger={}))})(n||(n={})),n}));
define("Viva.Controls/Controls/Base/Viva.TypableControl",["require","exports","o","ko","$","Viva.Controls/Controls/Base/Viva.ValueUpdateTrigger","Viva.Controls/Controls/Base/Viva.ValidatableControl"],(function(n,t,i,r,u,f,e){"use strict";var o;return (function(n){function o(n){s.clearTimeout(n)}var t=f.ValueUpdateTrigger,s=window,l=r.observable,h=(function(n){function i(i){var r=n.call(this,i)||this;return r.delayValidationTimeout=l(500),r.valueUpdateTrigger=t.Default,r.onEnterPressed=u.noop,r}return __extends(i,n),i})(e.ViewModel),c;n.ViewModel=h;c=(function(n){function r(t,i,r){var u=this;return r=r||{},r.viewModelType=r.viewModelType||h,u=n.call(this,t,i,r)||this,u.ltm.registerForDispose(u.element.setEvents(["keyup",function(n){n.which===13&&u.element.trigger("typableControl-commit",{widget:u,model:u.options})},])),u}return __extends(r,n),r.prototype.dispose=function(){this._checkExistsOrRegisterDestroyId(n.prototype.dispose)||(this._timer=o(this._timer),n.prototype.dispose.call(this))},i.defineProperty(r.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),r.prototype.validate=function(t){this._timer=o(this._timer);n.prototype.validate.call(this,t)},r.prototype._valueChangeValidation=function(){var t=this,i=this.options.delayValidationTimeout();if(i>0&&this._shouldDelayValidation()){o(this._timer);this._timer=s.setTimeout((function(){t._timer=o(t._timer);t.validate()}),i);return}n.prototype._valueChangeValidation.call(this)},r.prototype._getValueUpdateTrigger=function(){var n;switch(this.options.valueUpdateTrigger){case t.AfterKeyDown:case t.KeyPress:case t.Input:n="input";break;case t.Blur:case t.Default:n=""}return n},r.prototype._shouldDelayValidation=function(){switch(this.options.valueUpdateTrigger){case t.AfterKeyDown:case t.KeyPress:case t.Input:return!0}return!1},r})(e.Widget);n.Widget=c})(o||(o={})),o}));
define("_generated/Less/Viva.Controls/Controls/Forms/Viva.TextBox.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".azc-textBox{height:23px}.azc-textBox-wrapper{width:100%}.azc-textBox-wrapper .azc-input{border-style:solid;border-width:1px;box-sizing:border-box;font-size:12px;height:23px;outline:0;padding:2px 8px 4px;width:100%}.azc-textBox-wrapper .azc-input::-moz-placeholder{font-style:italic}.azc-textBox-wrapper .azc-input:-ms-input-placeholder{font-style:italic}.azc-textBox-wrapper .azc-input::-webkit-input-placeholder{font-style:italic}.azc-textBox-wrapper [placeholder]{text-overflow:ellipsis}.fxc-inputhasvalue ::placeholder{color:transparent!important}")}));
define("Viva.Controls/Controls/Forms/Viva.TextBox",["require","exports","o","ko","Viva.Controls/Controls/Base/Viva.TypableControl","MsPortalImpl.Controls/Controls/Base/WidgetBindingHandler","MsPortalImpl/Base/Base.EventTypes","_generated/Less/Viva.Controls/Controls/Forms/Viva.TextBox.css"],(function(n,t,i,r,u,f,e){"use strict";var o;return (function(n){var o="azc-inputbox azc-textBox",s="azc-has-focus",c="__azc-textBox",l='<div class=\'azc-inputbox-wrapper azc-textBox-wrapper\' tabindex=\'-1\'><input class=\'azc-input azc-formControl azc-validation-border\' type=\'text\' aria-multiline=\'false\' data-bind=\'value: $ctl._value, css: { "fxs-br-error": data.validationState() === 1, "fxs-br-dirty": data.dirty(), "azc-disabled": $disabled, "azc-br-focused": data.focused() }, valueUpdate: $ctl._getValueUpdateTrigger(), attr: { name: $ctl._name, placeholder: data.placeholder, readonly: data.readonly, spellcheck: data.spellcheck().toString(), disabled: $disabled, tabindex: $tabIndex, "aria-required":$ctl._required, "aria-readonly": data.readonly, "aria-disabled": $disabled }\' /><\/div>',a=0,h=(function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.placeholder=r.observable(null),t.readonly=r.observable(!1),t.spellcheck=r.observable(!1),t}return __extends(t,n),t})(u.ViewModel),t;n.ViewModel=h;t=(function(n){function t(t,i,u){var f=this,e;return u=u||{},u.viewModelType=u.viewModelType||h,f=n.call(this,t,i,u)||this,e=f.options,t.addClass(o).html(l),f._name=e.name||c+a++,f._input=t.find("input"),f._required=r.computed(f.ltm,(function(){return 0!==e.validators.filter(f.ltm,(function(n){return 1===n.type}))().length})),f._value=r.computed(f.ltm,{read:function(){return e.value()},write:function(n){(n||e.value())&&e.value(n)}}),f._attachEvents(),f._bindDescendants(),f._afterCreate(),f._supportsFocus(!0),f}return __extends(t,n),t.prototype.dispose=function(){this._checkExistsOrRegisterDestroyId(n.prototype.dispose)||(this._cleanElement(o),n.prototype.dispose.call(this))},i.defineProperty(t.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),t.prototype._getElementToFocus=function(){return this._input[0]},t.prototype._attachEvents=function(){var i=this,t=this.options,n=t.events;this.ltm.registerForDispose(this.element.setEvents([e.default.keydown,function(n){n.which===13&&t.value(i._input.val())},],[e.default.keyup,function(r){if(r.which===13){r.preventDefault();var u=i._input.val();if(n&&n.enterPressed)n.enterPressed(u);else if(t.onEnterPressed)t.onEnterPressed(u)}else r.which===40&&n&&n.downPressed&&n.downPressed()},]));this.ltm.registerForDispose(this._input.setEvents([e.default.focus,function(){t.focused(!0);i.element.toggleClass(s,!0);n&&n.focus&&n.focus()},],[e.default.blur,function(){t.focused(!1);i.element.toggleClass(s,!1);n&&n.blur&&n.blur()},]))},t})(u.Widget);n.Widget=t;r.bindingHandlers.azcTextBox=f.getBindingHandler(t)})(o||(o={})),o}));
define("_generated/Templates/WidgetsSearch",["require","exports"],(function(){"use strict";return function(){return'<div class="fxs-search" role="search" data-bind="css: { \'fxs-search-expanded\': data.isExpanded() }, attr: { \'aria-label\': searchLabel }"> <div class="fxs-box-wrapper" data-bind="css: { \'fxs-searching\': data.showSearching() }"> <div class="fxs-icon msportalfx-svg-flip-horizontal" data-bind="image: data.icons.search, attr: { title: searchLabel}"><\/div> <div class="fxs-searchbox fxs-topbar-input"><\/div> <div class="fxs-indicator"> <div><\/div><div><\/div><div><\/div> <\/div> <div role="presentation" aria-hidden="true" class="fxs-cross">&times;<\/div> <\/div> <a href="#" class="fxs-search-icon fxs-topbar-button fxs-trim-svg fxs-trim-hover" role="button" data-bind="attr: { title: searchLabel, \'aria-label\': searchLabel }" > <div class="msportalfx-svg-flip-horizontal" data-bind="image: data.icons.search"><\/div> <\/a> <div class=\'fxs-menu fxs-popup fxs-portal-bg-txt-br fxs-dropmenu-content\' data-bind=\'visible: data.showMenu()\' title=\'\'><\/div> <\/div>'}}));
define("MsPortalImpl/Widgets/Widgets.Search",["require","exports","f","o","ko","MsPortalImpl/Resources/ImplScriptResources","Viva.Controls/Controls/Forms/Viva.TextBox","MsPortalImpl/Widgets/Widgets.WidgetBase","_generated/Templates/WidgetsSearch","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Svg/Startup/Search.svg","_generated/Less/MsPortalImpl/Widgets/Widgets.Search.css"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";var a,l,v,y;r.defineProperty(t,"__esModule",{value:!0});a=i.Base;t.searchClass="fxs-search";t.searchBoxClass="fxs-searchbox";l=f.Search;v=(function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.isExpanded=u.observable(!1),t.showMenu=u.observable(!1),t.showResults=u.observable(!1),t.showSearching=u.observable(!1),t.showExternalColumn=u.observable(!1),t.showAllSubscriptionsSearch=u.observable(!1),t.showChangeSubscriptions=u.observable(!1),t.icons={search:a.Images.CustomImageWithOptions(c,{isLogo:!0})},t.text=l,t.filter=u.observable(),t.searchInFilterText=u.observable(),t.subscriptionSummary=u.observable(),t.mruItems=u.observableArray(),t.results=u.observableArray(),t}return __extends(t,n),t})(o.ViewModel);t.ViewModel=v;y=(function(n){function r(r,o){var c=n.call(this,r,o)||this,p,v;c._initialized=Q.defer();r.addClass(t.searchClass).html(s());window.fx.environment.chrome.hideSearchBox&&r.addClass("fxs-hidden-important");c._bindDescendants({text:o.text,searchLabel:f.KeyboardShortcuts.search});p=i.isFeatureEnabled("globalsearch")?l.globalPlaceholder:l.placeholder;v=c._textWidget=new e.Widget(r.findByClassName(t.searchBoxClass),{placeholder:u.observable(p),readonly:u.observable(!1)});v.element.find(".azc-input").attr("aria-label",p);var g=c._textField=$(v._getElementToFocus()),w,b,k,a=h.default.focusin,d=h.default.mousedown,y=r.findByClassName("fxs-search-icon");r.on(a,w=function(){r.off(a,w);o.showMenu(!0);var n=c._initOptions;(n&&n()||Q(!0)).then((function(){i.require("MsPortalImpl/Widgets/Widgets.SearchDefered").then((function(n){c._initialized.resolve();n.initialize(c,g)}))}))});y.on(a,b=function(n){n.preventDefault();c.setFocus()});y.on(d,k=function(n){n.preventDefault();c.setFocus()});return c.ltm.registerForDispose((function(){v.dispose();r.off(a,w);y.off(a,b);y.off(d,k)})),c}return __extends(r,n),r.prototype.setFocus=function(){this.options.isExpanded(!0);this._textField.focus()},r.prototype.initOptions=function(n){this._initOptions=n},r.prototype.isDropdownInitialized=function(){return this._initialized.promise},r})(o.Widget);t.Widget=y}));
define("MsPortalImpl/Svg/Startup/AllServices.svg",[],(function(){"use strict";return{type:344,data:"<svg viewBox='0 0 50 50' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M19.432 22.112h27.119v6.307H19.432zm0 13.875h27.119v6.307H19.432zm0-27.75h27.119v6.307H19.432z' class='msportalfx-svg-c04'/><circle opacity='.6' cx='6.818' cy='39.152' r='3.784' class='msportalfx-svg-c15'/><circle opacity='.6' cx='6.818' cy='11.907' r='3.784' class='msportalfx-svg-c15'/><circle cx='6.818' cy='25.53' r='3.784' class='msportalfx-svg-c16'/><\/g><\/svg>"}}));
define("MsPortalImpl/Svg/Startup/CaretUp.svg",[],(function(){"use strict";return{type:287,data:"<svg viewBox='0 0 12 12' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M1 8.1l.7.8L6 4.6l4.3 4.3.7-.8-5-5z'/><\/g><\/svg>"}}));
define("MsPortalImpl/Svg/Startup/DoubleChevron.svg",[],(function(){"use strict";return{type:345,data:"<svg viewBox='0 0 8 8.4' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M4 3.7l-4 4 .7.7L4 5l3.3 3.4.7-.7-4-4z'/><path d='M4 0L0 4l.7.7L4 1.4l3.3 3.3L8 4 4 0z'/><\/g><\/svg>"}}));
define("MsPortalImpl/Svg/Startup/Ellipsis.svg",[],(function(){"use strict";return{type:176,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><circle cx='14.4' cy='7.6' r='1.6'/><circle cx='8' cy='7.6' r='1.6'/><circle cx='1.6' cy='7.6' r='1.6'/><\/g><\/svg>"}}));
define("MsPortalImpl/Svg/Startup/Hyperlink.svg",[],(function(){"use strict";return{type:31,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M4.992 9.819l8.018-7.991v4.005H14V0H8.167v1h4.038L4.232 8.987l.76.833z'/><path d='M12.993 13.03H1.01V1.028h4.823V0H0v14h14V8.167h-1.007v4.863z'/><\/g><\/svg>"}}));
define("MsPortalImpl/Svg/Startup/Plus.svg",[],(function(){"use strict";return{type:297,data:"<svg viewBox='0 0 18 18' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M8 18h2v-8h8V8h-8V0H8v8H0v2h8z'/><\/g><\/svg>"}}));
define("MsPortalImpl/Svg/Startup/Star.svg",[],(function(){"use strict";return{type:283,data:"<svg viewBox='0 0 12 12' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M6 .3l1.5 4.3 4.5.1-3.6 2.7 1.3 4.3L6 9.1l-3.7 2.6 1.3-4.3L0 4.7l4.5-.1z'/><\/g><\/svg>"}}));
define("MsPortalImpl/Services/Services.Permissions",["require","exports","f","i","o","FxInternal/Di","FxHubs/Permissions","MsPortalImpl/Extension/ExtensionManager","MsPortalImpl/Services/Services.AssetTypes"],(function(n,t,i,r,u,f,e,o,s){"use strict";function b(n,t){return Q(l.hasPermissionsToHubs.invoke(h.client,a,{entityId:n,requestedActions:t,providedActions:null}))}function k(n){return Q(l.getPermissionsToHubs.invoke(h.client,a,{entityId:n}))}function d(){return l.isCoAdminEndpoint.invoke(h.client,a,{})}var p,c;u.defineProperty(t,"__esModule",{value:!0});var v=r.Extension,h=r.Rpc,w=i.ViewModels.Services.ResourceTypes,y=e.PermissionChecker,l=e.Rpc,a=v.getHubsWindowId();t.Internal={};p=(function(){function n(n,t){var r=this,i;this._extensionManager=n;this._assetTypeService=t;i=e.createCachedPermissionsGetter(k);this._cachedPermissionsGetter=i;this._getPermissionsCallback=function(n){return i.getPermissions(n)};v.hasPermissionsToShell.register(h.client,null,(function(n){return r.hasPermission(n.entityId,n.requestedActions)}))}return n.prototype.isCoAdmin=function(){return d()},n.prototype.hasPermission=function(n,i){return t.Internal.hasPermissionOverride?Q(t.Internal.hasPermissionOverride(n,i)):y.isRDFEAction(i)?b(n,i):w.isResourceManagerId(n,!0)?Q(y.hasPermission(n,i,null,this._getPermissionsCallback)):Q("The entity ID for hasPermission must be a resource ID, a subscription ID or a resource group ID")},n.prototype.getCachedPermissions=function(){return this._cachedPermissionsGetter.getCachedPermissions()},n})();c=(function(){function n(){}return n.create=function(n,t){return new p(n,t)},n})();__decorate([f.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[o.ExtensionManager,s.AssetTypeService]),__metadata("design:returntype",c)],c,"create",null);t.PermissionsManager=c}));
define("MsPortalImpl/UI/Hubs/UI.BrowseManager",["require","exports","f","i","o","ko","FxInternal/Di","MsPortalImpl/Extension/ExtensionManager","MsPortalImpl/Services/Services.AssetTypes","MsPortalImpl/Services/Services.Permissions"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";function d(n,t){var i=n.toLocaleLowerCase(),r=t.toLocaleLowerCase();return i===r?0:i<r?-1:1}function g(n){return function(){w(n,(function(n,t){t()}))}}var l,a;u.defineProperty(t,"__esModule",{value:!0});var v=i.Base,nt=v.Constants,tt=nt.ResourceTypes.ResourceGroups,it=v.Diagnostics,y=i.ViewModels.Services,rt=y.Browse,ut=y.GridColumns,p=i.getUniqueId,c=it.createLog(n),ft=tt.toLowerCase(),w=i.forEachKey,et=1,b=3,k=0,ot=i.isFeatureEnabled("supportthirdpartyresources"),st=r.getErrorMap({badCriteria:""});t.compareAssetTypeForSort=d;l=(function(){function n(n){this.value=n}return n.create=function(){return new n(f.observable(!1))},n})();__decorate([e.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",l)],l,"create",null);t.RdfeAccessObservable=l;a=(function(){function n(n,t,u,e){var h=this,s,o;if(this._browsePackages={},this._registeredResourceProviders=f.observableArray(["*"]),this._haveRdfeAccess=!1,this._callbacks={},this._isCoAdmin=!1,this._extensionManager=n,this._assetTypeService=t,this._permissionsService=u,s=this._ltm=new r.TriggerableLifetimeManager,o=g(this._callbacks),this._registeredResourceProviders.subscribe(s,o),this._haveRdfeAccess=e.value(),e.value.subscribe(s,(function(n){h._haveRdfeAccess=n;o()})),i.isFeatureEnabled("loadassetsasync"))n.on("assetTypes",(function(){return o(),t.assetTypes.subscribe(s,o),!0}));else n.on("assetTypes").then((function(){o();t.assetTypes.subscribe(s,o)}));s.registerForDispose((function(){w(h._browsePackages,(function(n,t){t.cancel();t.dispose()}));h._browsePackages=null}))}return n.prototype._assetTypeSupportsCriteria=function(n,t){return n.extension===t.assetOwner&&n.assetTypeManifest.name===t.assetType},n.prototype._releaseViewModel=function(n,t){i.disposeViewModelProperties(t);n.releaseViewModel(t)},n.prototype._assetTypeMeetsRequirements=function(n){var i,s,r,u,f,e,o,h;if(!n)return!1;var t=n.browseType,c=n.browseRequirements&1,l=!c||this._isCoAdmin;if(t===undefined||!l)return!1;i=this._haveRdfeAccess;s=!n.browseRequiresRdfe||i;switch(t){case b:case k:case et:if(!s)return!1}return(r=n.resourceType,!r)?!0:(u=r.resourceTypeName,f=u.toLowerCase(),f===ft)?!0:!ot&&!i&&!f.startsWith("microsoft.")?!1:(e=u.split("/"),e.length<2)?!1:t===b?!0:(o=this._registeredResourceProviders,o().some((function(n){return n.toLowerCase()==="*"})))?!0:(h=e[0].toLowerCase(),o().some((function(n){return n.toLowerCase()===h})))},n.prototype.dispose=function(){var n=this._ltm;n&&(n.dispose(),this._ltm=null)},n.prototype.initialize=function(){this._extensionManager.getHubsExtension()},n.prototype.registerAssetTypesUpdateCallback=function(n){var t=p();return this._callbacks[t]=n,t},n.prototype.unregisterAssetTypesUpdateCallback=function(n){var t=this._callbacks;t[n]&&delete t[n]},n.prototype.addRegisteredResourceProvider=function(n){this._registeredResourceProviders.push(n)},n.prototype.initiateBrowse=function(n){var t=this,u;return n||st.badCriteria(),u=new rt.ResultsViewModel(n,[]),i.require("MsPortalImpl/UI/Hubs/UI.BrowseManagerDelayed").then((function(i){var s="All browse operations returned.",h="browse-"+p(),f=new i.BrowsePackage(u,t),v=f.ltm;t._browsePackages[h]=f;var e=0,o=0,l=!1,a=[];return t._assetTypeService.assetTypes().forEach((function(i){var y,h;if(!f.canceled&&t._assetTypeSupportsCriteria(i,n)&&(y=i.assetTypeManifest,y.browseType===k)){var u=function(){++o;l&&o===e&&(c.verbose(s),f.allOperationsReturned())},p=y.browseServiceViewModel,w=r.Extension.getWindowId({name:i.extension})+"."+y.name+"."+p;c.verbose("Browse provider "+w+" using optimized browse.");h="browse operation from "+w+" browse provider";a.push(t._extensionManager.getExtensionByName(i.extension).then((function(r){return r.getViewModel(p).then((function(e){var o=e.content,s,a,l;o?(s=!1,v.registerForDispose((function(){s=!0;t._releaseViewModel(r,e)})),s?(c.verbose("The "+h+" was already disposed."),u()):(a=function(n,t){f.canceled||(c.verbose("Got "+h+"."),f.addOperation(i,n,t));u()},l=void 0,typeof o.onInputsSet=="function"&&(l=o.onInputsSet({criteria:n})),Q(l||!0).then((function(){a(w,o)})).catch((function(n){c.verbose("The "+h+" rejected the load promise: "+n);u()})))):(c.verbose("$Failed to get the "+h+"."),u())})).catch((function(n){c.verbose("Failed to get browse operation "+p+": "+n+".");u()}))})).catch((function(n){c.error("Failed to get extension for browse operation "+p+": "+n);u()})));c.verbose("Getting "+h+".");++e}})),l=!0,o===e&&(c.verbose(s),f.allOperationsReturned()),Q.all(a).then((function(){return h}))}))},n.prototype.getViewModelForBrowse=function(n){var t=this._browsePackages;return n in t?t[n].viewModel:null},n.prototype.releaseBrowse=function(n){var t=this._browsePackages,i;n in t&&(i=t[n],i.cancel(),i.dispose(),delete t[n])},n.prototype.getFilteredAssetTypes=function(){var n=this,t,r;return this._isCoAdminPromise||(this._isCoAdminPromise=Q(this._permissionsService.isCoAdmin()).then((function(t){n._isCoAdmin!==t&&(n._isCoAdmin=t,g(n._callbacks)())}))),t=[],r=[],this._assetTypeService.assetTypes().forEach((function(i){var r=i.assetTypeManifest;n._assetTypeMeetsRequirements(r)&&(r.privateBrowse||t.push(i))})),t.length&&i.stableSort(t,(function(n,t){return d(n.compositeDisplayName.service,t.compositeDisplayName.service)})).forEach((function(n){r.push(n)})),r},n.prototype.getGridColumnsPromiseForAssetType=function(n,t){var r=this,i=n.assetTypeManifest.gridColumnsServiceViewModel;return i?Q(this._extensionManager.getExtensionByName(n.extension)).then((function(n){return n.getViewModel(i).then((function(i){var e=!1,u,f;return(t.registerForDispose((function(){e=!0;r._releaseViewModel(n,i)})),!e)?(u=i.content,f=void 0,typeof u.onInputsSet=="function"&&(f=u.onInputsSet({usage:ut.Usage.Default})),f)?f.then((function(){return u})):u:Q.reject("The grid columns service view model was already disposed.")}))})):Q.reject("The asset type does not have a grid columns service view model.")},n.prototype.getDynamicBladePromiseForAssetType=function(n,t){var r=this,i=n.assetTypeManifest.dynamicBladeServiceViewModel;return i?Q(this._extensionManager.getExtensionByName(n.extension)).then((function(n){return n.getViewModel(i).then((function(i){var u=!1;return(t.registerForDispose((function(){u=!0;r._releaseViewModel(n,i)})),!u)?i.content:Q.reject("The dynamic blade service view model was already disposed.")}))})):Q.reject("The asset type does not have a dynamic blade service view model.")},n})();a=__decorate([e.Class(),__metadata("design:paramtypes",[o.ExtensionManager,s.AssetTypeService,h.PermissionsManager,l])],a);t.BrowseManager=a}));
define("MsPortalImpl/UI/Hubs/UI.FavoritesManager",["require","exports","f","i","o","ko","FxInternal/Di","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Services/Services.AssetManagement","MsPortalImpl/Services/Services.AssetTypes","MsPortalImpl/Services/Services.BrowseCuration","MsPortalImpl/UI/Hubs/UI.BrowseManager","MsPortalImpl/UI/Hubs/UI.NotificationManager"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a){"use strict";function dt(n,t,r,u){var e=f.computed(n,t,i.identity),o;e.extend(et);o=e.subscribe(n,r);u&&o.callback(e())}function ot(n,t){return t&&n.kindMap&&n.kindMap[(t||"").toLowerCase()]}function p(n,t,i){t===w.BrowseResourceGroupBlade&&(t=w.ResourceGroups);var r=vt.getWindowId({name:n});return yt.getAssetTypeOrResourceTypeIdByWindowId(r,t)+(i?"."+i.toLowerCase():"")}function st(n,t){return t&&(t.serviceDisplayName||t.pluralDisplayName||tt.assetPlusKindFormat.format(n.compositeDisplayName.service,t.name))||n.compositeDisplayName.service}function ht(n,t){return t&&t.icon||n.icon}function ct(n,t){return t&&t.keywords||n.assetTypeManifest.keywords}function gt(n,t){return n.extensionName===t.extension&&n.assetType===t.assetTypeManifest.name}function lt(n,t,i){var e,r,u,f;return t?(u=t.indexOf("."),u>0&&(r=t,t=r.substring(0,u),e=r.substring(u+1)),f=n.first((function(n){return n.id===t})),f&&g(f,e,i,[],r)):null}function ni(n,t,i){var o=[],r=[[],["Microsoft_AAD_IAM_AzureActiveDirectory","Microsoft_Azure_Monitoring_AzureMonitoring","Microsoft_Azure_Security_SecurityDashboard","Microsoft_Azure_Billing_Billing","Microsoft_Azure_Support_HelpAndSupport",],["Microsoft_Azure_Expert_AzureAdvisor",],["HubsExtension_Dashboard",],],u;if(i&&n.version()<r.length-1){var f=n.favorites,s=f().toLowerCase(),e=v(f()),h=function(n){r[n].forEach((function(t){var i=t.toLowerCase();s.indexOf(i)<0&&(n===3?e.unshift(t):e.push(t),o.push(t))}))};for(u=(n.version()||0)+1;u<r.length;u++)h(u);f(y(e))}t(o);n.version(r.length-1)}function g(n,t,i,r,u){var o=n.assetTypeManifest,e=ot(n,t),s=st(n,e),h=n.id.toLowerCase(),c=!!d(r,(function(n){return n.toLowerCase()===h}));return{id:u||n.id,image:ht(n,e),isFavorite:f.observable(!1),opensDashboard:o.name===w.Dashboard&&n.extension===k.ExtensionNames.Hubs,isFilteredOut:f.observable(!1),isHidden:f.observable(c),label:s,labelId:s.replace(rt,""),keywords:ct(n,e),matches:f.observable(),uri:i.assetTypeService.getAssetTypeDeepLink(n,t),opensExternal:o.browseType===3,isPreview:n.isPreview,assetType:n,kind:t}}function ti(n){var t=[];return n.forEach((function(n){t=i.union(t,(n.associated||[]).map((function(n){return p(n.extensionName,n.assetType,n.kind)})))})),t}var et,at,b;u.defineProperty(t,"__esModule",{value:!0});var nt=i.Base,k=nt.Constants,w=k.AssetNames,vt=r.Extension,yt=r.Assets,pt=i.Hubs.Notifications.NotificationStatus,wt=nt.Diagnostics,tt=o.Favorites,it=tt.Notification,ii=wt.createLog(n),v=JSON.parse,y=JSON.stringify,bt="uncurated",rt=/\s+/g,d=i.find,ut=i.stableSort,ft=l.compareAssetTypeForSort,kt={};r.getAssetTypeMappingData=function(){return kt};et={deferred:!0};t.connectDebouncedObservable=dt;t.calculateHiddenAssetTypes=ti;at=(function(){function n(n){var t=this;this.categories=f.observableArray();this.categoriesLookup={};this.showCategories=f.observable(!1);this.possibleFavorites=f.observableArray();this.possibleFavoritesLookup={};this.favorites=f.observableArray();this._notificationsForItems=f.observable();this._ltm=new r.TriggerableLifetimeManager;this._extensionToDefaultCategoryMap={};this._missingFavoritesWithIndex={};this._hiddenAssetTypes=[];this._assetTypes=f.observable();this._initialFavorites=[];this._categoriesInitialized=!1;this.remove=function(n){var i=t._savedFavorites().length&&v(t._savedFavorites())||[],r=i.indexOf(n);r!==-1&&(i.splice(r,1),t._savedFavorites(y(i)))};this.add=function(n){var i=v(t._savedFavorites())||[];i.includes(n)||(i.push(n),t._savedFavorites(y(i)))};this.move=function(n){var i=v(t._savedFavorites())||[],r=t.favorites()[n],u=i.indexOf(r.id);i.splice(n,0,i.splice(u,1)[0]);t._savedFavorites(y(i))};this._services=n;this._savedFavorites=f.observable("")}return n.prototype.initializeFavorites=function(n){var t=this._savedFavorites=n.favorites,r=t&&t().length;return r?(i.isFeatureEnabled("skipfavoritesupgrade")||ni(n,this._notificationsForItems,r),this._initialFavorites=v(t())):this._initialFavorites.push(p(k.ExtensionNames.Hubs,w.Dashboard,undefined)),this._registerDependency(),this.loadFavorites()},n.prototype.initializeCategories=function(){var n=this,t=this._curationPromise||c.getBrowseCuration();return this._categoriesInitialized=!0,t.then((function(t){var s,u;n._discoveryPolicy=t.discoveryPolicy||0;var e=function(n,t){var i={id:n,showLabel:f.observable(!0),isFilteredOut:f.observable(!1),isHidden:f.pureComputed((function(){return!i.possibleFavorites().some((function(n){return!n.isHidden()&&!n.isFilteredOut()}))})),label:h.provideCategoryName(n),count:f.observable(0),possibleFavorites:f.observableArray(),sourceCategory:t};return i},o=t.categories||[],r=o.map((function(n){return e(n.id,n)}));r&&r.length&&(s=n._uncuratedCategory=e(bt),r.push(s));n.categories(r);n.possibleFavorites().forEach((function(t){var r=ot(t.assetType,t.kind),u=t.assetType,f=st(u,r);t.label=f;t.labelId=f.replace(rt,"");t.image=ht(u,r);t.keywords=ct(u,r);t.isHidden(t.isHidden()&&!!i.find(n._hiddenAssetTypes,(function(n){return n===t.id})))}));u={};o.forEach((function(t){(t.discoveryExtensions||[]).forEach((function(i){u[i]=d(r,(function(n){return n.id===t.id}))||n._uncuratedCategory}))}));n._extensionToDefaultCategoryMap=u;n._loadFlyoutMenu()}))},n.prototype.loadFavorites=function(){var n=this,f=function(t){var i=[];return t.forEach((function(n){switch(typeof n){case"string":if(n.startsWith("{"))try{var t=v(n);typeof t.typeId=="string"&&t.typeId&&i.push(t.typeId)}catch(r){}else i.push(n);break;case"object":typeof n.typeId=="string"&&i.push(n.typeId)}})),n._savedFavorites(y(i)),i},t=this._savedFavorites&&this._savedFavorites().length&&f(v(this._savedFavorites()))||[],i=[],e=this._services.assetTypeService.allManifestsLoaded(),r=function(t,r){var u=lt(n._assetTypes(),t,n._services);u?(u.isFavorite(!0),i.push(u)):n._missingFavoritesWithIndex[t]=r},u=function(){var t=n._notificationsForItems()||[],r=t.slice(0);t.forEach((function(n){var t=d(i,(function(t){return n===t.id})),u,f;t&&(u=it.titleFmt.format(t.label),f=t.assetType.assetTypeManifest||{},a.getNotificationManager().addClientNotification({title:u,description:it.Description[(f.name||"").toLowerCase()]||u,status:pt.Information,timestamp:new Date,uri:t.uri}),r.remove(n))}));n._notificationsForItems(r);n.favorites(i)};return t.length?(t.forEach((function(n){n&&r(n,t.indexOf(n))})),u(),Q()):(this._curationPromise=c.getBrowseCuration()).then((function(t){var i=n._initialFavorites;t.favorites.forEach((function(n){var t=p(n.extensionName,n.assetType,n.kind);i.push(t)}));n._initialFavorites.forEach((function(n){r(n,i.indexOf(n))}));n._savedFavorites(y(i));u()}))},n.prototype.dispose=function(){var n=this._ltm;n&&n.dispose();this._ltm=null},n.prototype._registerDependency=function(){var n=this,r=this._ltm,t,i;this._assetTypes([]);t=this._services.browseManager;i=t.registerAssetTypesUpdateCallback((function(){n._createAssetTypes();n._updateFavorites(n._assetTypes());n._categoriesInitialized&&n._loadFlyoutMenu()}));r.registerForDispose((function(){t.unregisterAssetTypesUpdateCallback(i)}))},n.prototype._createAssetTypes=function(){var n=this._services.browseManager.getFilteredAssetTypes()||[];n.length&&this._assetTypes(n)},n.prototype._updateFavorites=function(n){var t=this;i.forEachKey(this._missingFavoritesWithIndex,(function(i,r){if(r!==-1){var u=lt(n,i,t._services);u&&(u.isFavorite(!0),t.favorites.splice(r,0,u),t._missingFavoritesWithIndex[i]=-1)}}))},n.prototype._addBrowseMenuItem=function(n,t){var u=p(n.extension,n.assetTypeManifest.name,t),i=g(n,t,this._services,this._hiddenAssetTypes,u),r;this.possibleFavoritesLookup[u]||(this.possibleFavorites().push(i),r=this.favorites().first((function(n){return n.id===i.id})),r&&(i.isFavorite=r.isFavorite),this.possibleFavoritesLookup[i.id]=i)},n.prototype._addBrowseMenuItemToCategory=function(n,t,i,r,u){var s=p(n.extension,n.assetTypeManifest.name,i),e=g(n,i,this._services,this._hiddenAssetTypes,s),o,f;u.some((function(n){return n.id===s}))||(f=this.possibleFavoritesLookup[e.id],f&&(e.isFavorite=f.isFavorite,o=e.isHidden=f.isHidden,o(o()||r)),u.splice(t,0,e));r&&(f=this.possibleFavorites().filter((function(n){return n.id===e.id}))[0],f&&f.isHidden(r))},n.prototype._loadFlyoutMenu=function(){var n=this,f=this.possibleFavoritesLookup,t,i,r,e,o;this._assetTypes().forEach((function(t){n._addBrowseMenuItem(t,undefined)}));t=this.categories();this.showCategories(!!t.length);i=u.keys(f).slice(0);t.forEach((function(t){var u=t.possibleFavorites;u();var f=t.sourceCategory,e=f&&f.items||[],r=[];e.length&&(e.forEach((function(t,u){var f=-1,e,o;n._assetTypes().some((function(n){if(gt(t,n)){var i=(t.kind||"").toLowerCase();o=i&&n.kindMap&&n.kindMap[i]&&t.kind;f=u;e=n}return f>-1}));f>-1&&(o&&n._addBrowseMenuItem(e,o),i.remove(e.id),n._addBrowseMenuItemToCategory(e,f,o,!!t.isHidden,r))})),u(r),t.count(r.filter((function(n){return!n.isHidden()})).length))}));r=this._uncuratedCategory;e=[];r&&(o=ut(i.map((function(n){return f[n]})),(function(n,t){return ft(n.label,t.label)})),o.forEach((function(t){var o=t.assetType,u=n._extensionToDefaultCategoryMap[o.extension],s=u||r,h=!u&&n._discoveryPolicy===1,f,i;n.possibleFavorites().filter((function(n){return n.id===t.id}))[0].isHidden(h);f=s.possibleFavorites;i=[];i=u?f():e;n._addBrowseMenuItemToCategory(o,i.length,undefined,h,i);f(i);s.count(i.length)})));this.possibleFavorites(ut(this.possibleFavorites(),(function(n,t){return ft(n.label,t.label)})))},n})();b=(function(){function n(){}return n.create=function(n,t,i){return new at({assetTypeService:n,assetManager:t,browseManager:i})},n})();__decorate([e.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[h.AssetTypeService,s.AssetManager,l.BrowseManager]),__metadata("design:returntype",b)],b,"create",null);t.FavoritesManager=b}));
define("MsPortalImpl/Widgets/Widgets.SideBar",["require","exports","f","i","o","ko","MsPortalImpl/Base/Base.Router","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/UI/Hubs/UI.FavoritesManager","MsPortalImpl/Base/Telemetry","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Base/Base.Timers","MsPortalImpl/Svg/Startup/AllServices.svg","MsPortalImpl/Svg/Startup/CaretUp.svg","MsPortalImpl/Svg/Startup/DoubleChevron.svg","MsPortalImpl/Svg/Startup/Ellipsis.svg","MsPortalImpl/Svg/Startup/Hamburger.svg","MsPortalImpl/Svg/Startup/Hyperlink.svg","MsPortalImpl/Svg/Startup/Plus.svg","MsPortalImpl/Svg/Startup/Star.svg","MsPortalImpl/Services/Services.GeneralSettings","FxHubs/RpcEndPoints","MsPortalImpl/Interactions/Interactions.KeyboardNavigation","_generated/Less/MsPortalImpl/Widgets/Widgets.SideBar.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt){"use strict";function ii(){return i.isFeatureEnabled("artbrowse")&&tt.settings.optIntoNewBrowse()}function lt(n,t,i){wt.Diagnostics.Telemetry.trace({source:c.Source.SideBar,name:t,action:n,data:i})}function ci(n,t,i,r){var u=r?ut.expand:ut.collapse;n.toggleClass("fxs-sidebar-is-collapsed",r);t.attr({title:u,"aria-expanded":!r});et&&(t.hasClass(yt)?t.removeClass(yt):t.addClass(yt))}function li(n){var f=n.isCollapsed,e=f(),t=!e,r=n.saveCollapseState,u;i.isFeatureEnabled("sideBarAutoCollapsedInJourney")?(u=n.getStartboardVisible,u&&u()&&r&&r(t)):r&&r(t);f(t);lt(ct.SideBarViewChanged,"",t?"collapsed":"expanded")}function ui(n,t,i){var f;if(t){var r=i.favorites,u=r.indexOf(n),e=r.indexOf(t);if(u||!t.opensExternal)return lt(ct.SideBarFavoriteMoved,t.id,{oldIndex:e,newIndex:u}),r.valueWillMutate(),f=r(),f.splice(u,0,f.splice(e,1)[0]),i.favoritesManager().move(u),r.valueHasMutated(),u}return-1}function ai(n,t,i){var u=$(document.activeElement).parent(),e=i===40?u.next(gt)[0]:u.prev(gt)[0],o,r;e&&(o=f.dataFor(e),r=ui(o,n,t),r>=0&&Q.fcall((function(){var i=t.favorites()[r].uri,n=$("."+dt+" [href|='"+i+"']")[0];n&&n.focus()})))}var ri,fi;u.defineProperty(t,"__esModule",{value:!0});var wt=i.Base,ft=wt.Images,ei=window,bt=ei.fx.environment,ot=a.default.click,at=".fxs-sidebar-droppable",oi=r.Extension.getHubsWindowId()+"_BrowseAllResources",st="fxs-sidebar-entered",ht=".fxs-sidebar-entered",kt="fxs-sidebar-flyout",vt=a.default.keydown,dt="fxs-sidebar-bar",gt="li.fxs-sidebar-item",yt="fxs-sidebar-collapse-button-flip",ut=o.SideBar,ct=c.Action,et=i.isFeatureEnabled("improvedsidebar"),pt=".fxs-sidebar-item-link",ni='<button class="fxs-sidebar-collapse-button fxs-trim-hover fxs-trim-svg" role="button" data-bind="image: data.collapseIcon"><\/button><button class="fxs-sidebar-create fxs-trim-hover fxs-trim-border" role="button" data-bind="attr: { title: data.createTooltip, \'aria-label\': data.createTooltip }, visible: !data.hideCreateButton()"><div class="fxs-sidebar-button-flex"><div class="fxs-sidebar-create-icon fxs-fill-success" data-bind="image: data.icons.plus"><\/div><div class="fxs-sidebar-create-label fxs-sidebar-show-if-expanded fxs-trim-text" aria-hidden="true" data-bind="text: data.createText"><\/div><\/div><span class="fxs-hide-accessible-label" data-bind="text: data.newResourceAriaLabel"><\/span><\/button>',ti='<div class="fxs-sidebar-middle"><ul class="fxs-sidebar-favorites" data-bind="attr: { \'aria-label\': data.svcListText }"><!-- ko foreach: func._favorites --><li class="fxs-sidebar-item fxs-trim-hover fxs-sidebar-draggable fxs-sidebar-droppable fxs-trim-border" draggable="true" data-bind="attr: {\'aria-label\': label }"><a tabindex=\'-1\' href=\'\' class=\'fxs-sidebar-item-link fxs-trim-text\' data-bind="attr: { href: uri, title: label }"><div class="fxs-sidebar-icon fxs-trim-svg" data-bind="image: image"><\/div><div class="fxs-sidebar-label fxs-sidebar-show-if-expanded" aria-hidden="true" data-bind="text: label"><\/div><div class="fxs-sidebar-external fxs-sidebar-show-if-expanded" data-bind="visible: $data.opensExternal"><div class="fxs-trim-svg-secondary" data-bind="image: $root.data.icons.hyperlink"><\/div><\/div><div class="fxs-sidebar-handle fxs-trim-svg-secondary" data-bind="image: $root.data.icons.ellipsis"><\/div><span class="fxs-hide-accessible-label" data-bind="text: label"><\/span><\/a><\/li><!-- /ko --><\/ul><\/div>',si='<nav class="fxs-sidebar-bar fxs-trim fxs-trim-text" data-bind="attr: { \'aria-label\': data.svcNavLabel }"><div class="fxs-sidebar-top">'+ni+"<\/div>"+(""+ti)+'<div class="fxs-sidebar-bottom"><div class="fxs-sidebar-browse fxs-trim-hover fxs-menu-browse msportalfx-vertical-center" tabindex="0" role="button" aria-expanded="false" data-bind="attr: { title: data.browseTooltip, \'aria-label\': data.browseText }"><div class="fxs-sidebar-button-flex"><div class="fxs-sidebar-browse-label fxs-trim-text fxs-sidebar-show-if-expanded" data-bind="text: data.browseText"><\/div><div class="fxs-sidebar-browse-icon fxs-trim-svg" data-bind="image: data.icons.caretUp"><\/div><\/div><\/div><div class="fxs-sidebar-flyout fxs-popup fxs-portal-bg-txt-br fxs-sidebar-flyout-is-hidden" role="presentation"><\/div><\/div><\/nav>',hi='<nav class="fxs-sidebar-bar fxs-trim fxs-trim-text" data-bind="attr: { \'aria-label\': data.svcNavLabel }"><div class="fxs-sidebar-top">'+ni+'<div class="fxs-sidebar-browse fxs-trim-hover fxs-menu-browse msportalfx-vertical-center" tabindex="0" role="button" aria-expanded="false" data-bind="attr: { title: data.browseTooltip, \'aria-label\': data.browseText }"><div class="fxs-sidebar-button-flex"><div class="fxs-sidebar-browse-icon fxs-trim-svg" data-bind="image: data.icons.allServices"><\/div><div class="fxs-sidebar-browse-label fxs-trim-text fxs-sidebar-show-if-expanded" data-bind="text: data.browseText"><\/div><\/div><\/div><div class="fxs-sidebar-flyout fxs-popup fxs-portal-bg-txt-br fxs-sidebar-flyout-is-hidden" role="presentation"><\/div><\/div><div class="fxs-sidebar-favorites-section"><div class="fxs-sidebar-pre-divider fxs-trim-border"><\/div><div class="fxs-sidebar-star-icon" data-bind="image: data.icons.star"><\/div><span class="fxs-sidebar-myfavorites" data-bind="text: data.myFavoritesText, visible: !data.isCollapsed()"><\/span><div class="fxs-sidebar-post-divider fxs-trim-border"><\/div><\/div>'+(""+ti)+"<\/nav>";it.ArtBrowse.isArtBrowseEnabledEndpoint.register(r.Rpc.client,[r.Extension.getHubsWindowId()],(function(){return ii()}));ri=(function(n){function t(){var t=n.call(this)||this;return t.browseText=i.isFeatureEnabled("brandingsidebar")?bt.branding.browseLabel:ut.allServices,t.svcListText=ut.svcList,t.svcNavLabel=ut.svcNavLabel,t.closeText=ut.close,t.myFavoritesText=ut.myFavorites,t.browseTooltip=t.browseText,t.createText=et?ut.createResource:ut.create,t.createTooltip=ut.createTooltip,t.newResourceAriaLabel=ut.newResourceAriaLabel,t.favorites=f.observableArray(),t.isCollapsed=f.observable(!0),t.onFavoritesChanged=f.observableArray([]),t.openFavorite=function(n,i,r){var u,f;if(typeof n=="number"){var e=t.favoritesManager(),o=e&&e.favorites||t.favorites,s=o();if(n||s.length)u=o()[n];else t.onDashboardFavoriteClick(c.Source.SideBar)}else u=n;if(u){if(u.opensExternal)return t.openExternal(u.uri),!0;if(!i&&!r){if(u.opensDashboard)t.onDashboardFavoriteClick(c.Source.SideBar);else f=u.uri,u.id===oi&&ii()&&(f="#blade/HubsExtension/ArtBrowseBlade/resourceType/Microsoft.Resources%2Fresources"),t.launchBlade(f);return!0}}},t.possibleFavorites=f.observableArray(),t.previewText=ut.preview,t.icons={hamburger:ft.CustomImageWithOptions(k,{isLogo:!0}),allServices:y,doubleChevron:ft.CustomImageWithOptions(w,{palette:5}),star:ft.CustomImageWithOptions(nt,{isLogo:!0,customClass:"msportalfx-svg-c11"}),plus:ft.CustomImageWithOptions(g,{isLogo:!0}),hyperlink:ft.CustomImageWithOptions(d,{isLogo:!0}),ellipsis:ft.CustomImageWithOptions(b,{isLogo:!0}),caretUp:ft.CustomImageWithOptions(p,{isLogo:!0})},t.collapseIcon=et?t.icons.doubleChevron:t.icons.hamburger,t.favoritesManager=f.observable(),t.hideCreateButton=f.observable(!0),t.hideCreateButton(bt.chrome.hideCreateButton),t}return __extends(t,n),t.prototype.openExternal=function(n){window.open(n,"_blank")},t.prototype.attachFavoritesManager=function(n){this.favoritesManager(n)},t.prototype.initLifetime=function(n){var t=this;this.favoritesManager.subscribeAndRun(n,(function(i){i&&h.connectDebouncedObservable(n,i.favorites,t.favorites)}))},t})(l.ViewModel);t.ViewModel=ri;fi=(function(n){function t(t,r){var u=n.call(this,t,r)||this,y,e,o,h,c,l;return t.attr("role","presentation").html(et?""+hi:""+si),et&&t.addClass("fxs-sidebar-improvedsidebar"),u._createButton=t.findByClassName("fxs-sidebar-create"),u._browseLink=t.findByClassName("fxs-sidebar-browse"),y=u._collapseButton=t.findByClassName("fxs-sidebar-collapse-button"),u._sideBar=t.findByClassName(dt),e=u.ltm,r.initLifetime(e),o=u._favorites=r.favorites.filter(e,(function(n){return!!n})).map(e,(function(n,t){return t.image=t.image&&i.Base.Images.CustomImageWithOptions(t.image,{isLogo:!0}),t})),o.extend({deferred:!0}),h=t.find(".fxs-sidebar-favorites"),o.subscribeAndRun(e,(function(){v.requestAnimationFrame((function(){var n=h.find(pt+'[tabindex="0"]:eq(0)');n.length||h.find(pt+":eq(0)").attr("tabindex","0")}))})),c=t.find(".fxs-sidebar-middle"),l=v.throttleByAnimationFrame((function(){var n="",t;r.isCollapsed()&&(t=Math.min(30,c.scrollTop()),n="linear-gradient(transparent,#000 "+t+"px,#000 calc(100% - 20px),transparent)");c.css({"-webkit-mask-image":n,"mask-image":n})})),new rt.KeyboardNavigation(e,{element:h,tabTriggers:12,itemSelector:pt}),e.registerForDispose([c.setEvents([a.default.scroll,l,]),]),u._bindDescendants(),u._flyout=t.findByClassName(kt),u._attachEventHandlers(e,t,r),f.computed(e,r.onFavoritesChanged,(function(n){if(n.length){o();var i=s.findByClassName(t,"fxs-sidebar-favorites:first .fxs-sidebar-item");n.slice().forEach((function(n){n(i)}))}})),u._getSidebarFlyout=i.memoizeQ((function(){return i.require("MsPortalImpl/Widgets/Widgets.SideBarFlyout").then((function(n){var i=new n.ViewModel,t=new n.Widget(u.element.findByClassName(kt),i,u.options.favoritesManager());return u._initOptions&&u._initOptions().then((function(){t.options.openFeedbackPane=u.options.openFeedbackPane})),t.options.launchBlade=u.options.launchBlade,t.options.openFavorite=u.options.openFavorite,t}))})),r.isCollapsed.subscribeAndRun(e,(function(n){ci(t,y,r,n);l()})),u}return __extends(t,n),t.prototype.dispose=function(){n.prototype.dispose.call(this);this._cleanElement()},t.prototype.initOptions=function(n){this._initOptions=n},t.prototype.toggleFlyout=function(){var n=this._flyout.hasClass("fxs-sidebar-flyout-is-hidden");i.tryImmediateResolve(this._getSidebarFlyout(),(function(t){t.toggle(n)}))},t.prototype.openCreate=function(){lt(ct.SideBarNewMenuOpened);this.options.launchBlade(e.getGalleryDeepLink("hub",""))},t.prototype.reorderFavorites=function(n){var t=f.dataFor(document.activeElement);ai(t,this.options,n)},t.prototype._attachEventHandlers=function(n,t,i){var u=this,s=this._flyout,h=this._sideBar,r=function(t,i,r,u){t.on(i,r,u);n&&n.registerForDispose((function(){t.off(i,r,u)}))},e,o;r(this._createButton,ot,null,(function(){u.openCreate()}));e=this._browseLink;o=function(n){s.addClass("fxs-sidebar-browse-shown");u.toggleFlyout();n.stopPropagation()};r(e,ot,null,o);r(e,vt,null,(function(n){var t=n.keyCode;if(t===13||t===32)return o(n),!1}));r(t,ot,".fxs-sidebar-item a",(function(n){var t=f.dataFor(n.target);lt(ct.SideBarItemOpened,t.id,{isFavorite:t.isFavorite()});u.options.openFavorite(t)&&n.preventDefault()}));r(this._collapseButton,ot,null,(function(){li(i)}));r(h,vt,null,(function(n){var i=n.keyCode,t;n.type===vt&&i===32&&(t=$(n.target),t.trigger(a.default.click),t.hasClass("fxs-sidebar-filter-input")||n.preventDefault(),n.stopPropagation())}));r(t,a.default.dragstart,".fxs-sidebar-draggable",(function(n){var t=n.originalEvent.dataTransfer;t.setData("text","fxs-draganddrop");t.effectAllowed="move";u._dragItem=f.dataFor(n.target)}));r(t,a.default.dragover,null,(function(n){n.preventDefault()}));r(t,a.default.dragenter,null,(function(n){var t=$(n.target),i=t.closest(at),r=t.closest(ht);r.length===0&&($(ht).removeClass(st),i.length&&i.addClass(st))}));r(t,a.default.dragleave,null,(function(n){var t=$(n.target).closest(at).length===0?!0:!1;t&&$(ht).removeClass(st)}));r(t,a.default.drop,null,(function(n){var t=n.target,r=$(t).closest(at),e=f.dataFor(t);n.preventDefault();$(ht).removeClass(st);r.length&&ui(e,u._dragItem,i)}))},t})(l.Widget);t.Widget=fi}));
define("MsPortalImpl/Widgets/Widgets.ToastViewModel",["require","exports","o","a","ko","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Widgets/Widgets.WidgetBase"],(function(n,t,i,r,u,f,e){"use strict";function o(n){var t=u.unwrap(n&&n.timeoutID);t&&s.clearTimeout(t)}var h;i.defineProperty(t,"__esModule",{value:!0});var s=window,c=5e3,l=3e4;t.clearItemTimeout=o;h=(function(n){function t(t){t===void 0&&(t={});var i=n.call(this)||this;return i.displayCount=4,i.shouldShowToasts=u.observable(!0),i._items=u.observableArray(),i.eventHandlers=u.observableArray(),i.closeTitle=f.NotificationMenu.dismissToast,i.displayCount=t.displayCount||i.displayCount,i.shouldShowToasts=t.shouldShowToasts||i.shouldShowToasts,i}return __extends(t,n),t.prototype.addToasts=function(n){var t=this,i=r.isArray(n)?n:[n];i.length&&i.forEach((function(n){var l=t._items(),a=n.icon,v=n.title,y=n.description,p=n.uri,w=n.time,r=n.ids||[],h=n.data||null,e=n.duration||0,b=n.htmlContent||"",k=n.clickable!==!1,d=n.descriptiveText||f.Toast.description.format(n.title),i,s;if(e!==3)if(r.length>0&&(i=l.first((function(n){var t=n.ids();return r.some((function(n){return t.indexOf(n)>-1}))}))),i)i.icon(a),i.title(v),i.description(y),i.uri(p),i.time(w),i.ids(r),i.data(h),i.clickable(k),i.htmlContent(b),i.descriptiveText(d),i.duration(e),i.formSection(n.formSection),o(i),t.startRemoveTimer(i);else{s={icon:u.observable(a),title:u.observable(v),description:u.observable(y),uri:u.observable(p),time:u.observable(w),ids:u.observableArray(r),data:u.observable(h),htmlContent:u.observable(b),timeoutID:u.observable(null),clickable:u.observable(k),onDismissFn:n.onDismissFn,descriptiveText:u.observable(d),duration:u.observable(e),formSection:u.observable(n.formSection)};(l.length<t.displayCount||t._canDeque(e))&&t._items.unshift(s);var tt=(h||{}).inlineForm,g=n.formSection,nt=g&&g.children()||[],c=nt.length>1&&nt[1].children();c&&tt.buttons.forEach((function(n,i){if(!n.endpoint){var r=c[i].onClick;c[i].onClick=function(){r();t.removeToast(s)}}}));t.startRemoveTimer(s)}}))},t.prototype._canDeque=function(n){for(var t,r,u=this._items(),i=0;i<=n+0;i++)for(t=u.length-1;t>=0;t--)if(r=u[t],r.duration()===i)return this.removeToast(r),!0;return!1},t.prototype.removeToast=function(n){o(n);this._items.remove(n)},t.prototype.removeAllToasts=function(){this._items().forEach((function(n){o(n)}));this._items.removeAll()},t.prototype.startRemoveTimer=function(n){var i=this,t=u.unwrap(n.duration)||0;t!==2&&n.timeoutID(s.setTimeout((function(){i._items.remove(n)}),t===1?l:c))},t})(e.ViewModel);t.ViewModel=h}));
define("_generated/Templates/WidgetsToast",["require","exports","f"],(function(){"use strict";return function(){return'<ul role="presentation" class="fxs-toast" data-bind="visible: data.shouldShowToasts, foreach: func._uiItems"> <li class="fxs-toast-item fxs-popup fxs-portal-bg-txt-br" role="alert" aria-live="polite" aria-atomic="true" data-bind="attr: { \'aria-label\': descriptiveText }"> <!-- ko ifnot: htmlContent --> <div class="fxs-toast-wrapper"> <div class="fxs-toast-header"> <div class="fxs-toast-icon" data-bind="image: icon"/> <!--ko if: clickable--> <a href="#" class="fxs-toast-title fxs-toast-link" data-bind="text: title"><\/a> <!-- /ko --> <!--ko ifnot: clickable--> <div class="fxs-toast-title fxs-portal-text" data-bind="text: title"><\/div> <!-- /ko --> <div class="fxs-toast-time fxs-portal-title" data-bind="attr: { datetime: time }, text: time"><\/div> <\/div> <div class="fxs-toast-description fxs-portal-title" data-bind="sanitizedHtml: description"><\/div> <!-- ko if: formSection --> <div class="msportalfx-form fxs-notification-inlineform" data-bind="pcControl: formSection"><\/div> <!-- /ko --> <\/div> <!-- /ko --> <!-- ko if: htmlContent --> <div class="fxs-toast-content" aria-hidden="true" data-bind="unsanitizedHtml: htmlContent"><\/div> <!-- /ko --> <button class="fxs-toast-close fxs-portal-svg" aria-hidden="true" data-bind="image: MsPortalFx.Base.Images.Shell.Close(), title: closeTitle"><\/button> <\/li> <\/ul>'}}));
define("MsPortalImpl/Widgets/Widgets.Toast",["require","exports","f","ko","MsPortalImpl/Base/Telemetry","MsPortalImpl/Widgets/Widgets.WidgetBase","_generated/Templates/WidgetsToast","MsPortalImpl/Widgets/Widgets.ToastViewModel","MsPortalImpl/Base/Base.EventTypes","_generated/Less/MsPortalImpl/Widgets/Widgets.Toast.css"],(function(n,t,i,r,u,f,e,o,s){"use strict";var h;return (function(n){var t=".fxs-toast-item",h=".fxs-toast-link",c=".fxs-toast-close",l=(function(n){function f(t,u){var f=n.call(this,t,u)||this;return f._uiItems=r.computed(f.ltm,u._items,i.identity).extend({deferred:!0}),f.element.attr("role","presentation").html(e()),f._attachEventHandlers(),f._bindDescendants(),f}return __extends(f,n),f.prototype._attachEventHandlers=function(){var n=this.element,f=this.options,e=this.ltm,l,a,v=function(n){var t=r.dataFor(n.currentTarget);o.clearItemTimeout(t)},y=function(n){var t=r.dataFor(n.currentTarget);t.duration&&f.startRemoveTimer(t)};n.on(s.default.focusin,t,v);n.on(s.default.focusout,t,y);n.on(s.default.mouseenter,t,v);n.on(s.default.mouseleave,t,y);n.on(s.default.click,h,l=function(t){var e=r.dataFor(t.currentTarget);e.clickable()&&(t.preventDefault(),i.Base.Diagnostics.Telemetry.trace({source:u.Source.ToastTray,action:u.Action.ToastClicked}),n.trigger(s.default.fxtoastclick,e.data()),f.removeToast(e))});n.on(s.default.click,c,a=function(n){n.preventDefault();var t=r.dataFor(n.currentTarget);t.onDismissFn&&t.onDismissFn();f.removeToast(t)});f.eventHandlers.map(e,(function(t,i){n.on(i.events,i.selector,i.data,i.handler);t.registerForDispose((function(){n.off(i.events,i.selector,i.handler)}))}));e.registerForDispose((function(){n.off(s.default.focusin,t);n.off(s.default.focusout,t);n.off(s.default.mouseenter,t);n.off(s.default.mouseleave,t);n.off(s.default.click,h,l);n.off(s.default.click,c,a)}))},f})(f.Widget);n.Widget=l})(h||(h={})),h}));
define("MsPortalImpl/Svg/Startup/Console.svg",[],(function(){"use strict";return{type:333,data:"<svg viewBox='0 0 50 50' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M22.988 42.926h25v3.5h-25zM2.412 8.075L4.887 5.6l17.677 17.677-2.475 2.475z'/><path d='M2.578 38.777L20.256 21.1l2.475 2.474L5.053 41.252z'/><\/g><\/svg>"}}));
define("MsPortalImpl/Svg/Startup/DirectoryFilter.svg",[],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 19.337 19.746' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M4.603.249h1v16.408h-1zM0 4h3.32v1H0zm0 8h3.32v1H0z'/><path d='M9.32 16H3.195a.842.842 0 0 1-.342-.068.894.894 0 0 1-.277-.188.924.924 0 0 1-.188-.277A1.948 1.948 0 0 1 2.324 15V1.875a.7.7 0 0 1 .076-.314 1.081 1.081 0 0 1 .482-.482A.7.7 0 0 1 3.195 1H14.32v6h1V0H3.07a1.545 1.545 0 0 0-.656.146 1.951 1.951 0 0 0-.557.391 1.93 1.93 0 0 0-.391.561 1.544 1.544 0 0 0-.146.652v13.5a1.7 1.7 0 0 0 .137.68 1.771 1.771 0 0 0 .376.558 1.743 1.743 0 0 0 .558.376A1.712 1.712 0 0 0 3.07 17h6.25z'/><path d='M6.887 8.8v1.6l4.5 4.5v4.849h3.45V14.9l4.5-4.5V8.8zm6.975 5.691v4.283h-1.5v-4.287l-4.5-4.5v-.216h10.5v.217z'/><\/g><\/svg>"}}));
define("MsPortalImpl/Svg/Startup/DirectoryFilteredSet.svg",[],(function(){"use strict";return{type:1,data:"<svg viewBox='0 0 19.337 19.746' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M4.603.249h1v16.408h-1zM0 4h3.32v1H0zm0 8h3.32v1H0z'/><path d='M9.32 16H3.195a.842.842 0 0 1-.342-.068.894.894 0 0 1-.277-.188.924.924 0 0 1-.188-.277A1.948 1.948 0 0 1 2.324 15V1.875a.7.7 0 0 1 .076-.314 1.081 1.081 0 0 1 .482-.482A.7.7 0 0 1 3.195 1H14.32v6h1V0H3.07a1.545 1.545 0 0 0-.656.146 1.951 1.951 0 0 0-.557.391 1.93 1.93 0 0 0-.391.561 1.544 1.544 0 0 0-.146.652v13.5a1.7 1.7 0 0 0 .137.68 1.771 1.771 0 0 0 .376.558 1.743 1.743 0 0 0 .558.376A1.712 1.712 0 0 0 3.07 17h6.25z'/><path d='M6.887 8.8v1.6l4.5 4.5v4.849h3.45V14.9l4.5-4.5V8.8zm6.975 5.691v4.283h-1.5v-4.287l-4.5-4.5v-.216h10.5v.217z'/><path fill='#8a2da5' d='M12.399 18.767h1.5v-4.283l4.5-4.5v-.217h-10.5v.217l4.5 4.5v4.283z'/><\/g><\/svg>"}}));
define("MsPortalImpl/Svg/Startup/Help.svg",[],(function(){"use strict";return{type:130,data:"<svg viewBox='0 0 22 22' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M11 0C4.93 0 0 4.93 0 11s4.93 11 11 11 11-4.93 11-11S17.07 0 11 0zm0 20.43c-5.2 0-9.43-4.23-9.43-9.43S5.8 1.57 11 1.57 20.43 5.8 20.43 11 16.2 20.43 11 20.43zm3.14-11.79c0 1.13-.52 2.18-1.46 2.96-.58.48-.89 1.1-.89 1.75v.79h-1.57v-.79c0-1.13.52-2.18 1.46-2.96.58-.48.89-1.1.89-1.75 0-.87-.7-1.57-1.57-1.57-.95 0-1.85.46-2.54 1.29l-1.21-1C8.24 6.16 9.57 5.5 11 5.5c1.73 0 3.14 1.41 3.14 3.14zm-2.35 7.86c0 .43-.35.79-.79.79s-.79-.35-.79-.79.35-.79.79-.79.79.36.79.79z'/><\/g><\/svg>"}}));
define("MsPortalImpl/Svg/Startup/Notifications.svg",[],(function(){"use strict";return{type:342,data:"<svg viewBox='0 0 22 22' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path opacity='.9' d='M18.86 17.29V7.86C18.86 3.52 15.33 0 11 0S3.14 3.52 3.14 7.86v9.43H1.57v1.57h6.29C7.86 20.59 9.27 22 11 22s3.14-1.41 3.14-3.14h6.29v-1.57h-1.57zm-14.15 0V7.86c0-3.47 2.82-6.29 6.29-6.29s6.29 2.82 6.29 6.29v9.43H4.71zM11 20.43c-.87 0-1.57-.7-1.57-1.57h3.14c0 .86-.7 1.57-1.57 1.57z'/><\/g><\/svg>"}}));
define("MsPortalImpl/Svg/Startup/Settings.svg",[],(function(){"use strict";return{type:341,data:"<svg viewBox='0 0 22 22' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M19.2 10.6v.8l2.8 1.7-1.7 4.1-3.2-.7-.5.5.7 3.2-4.2 1.8-1.7-2.8h-.8L8.9 22l-4.1-1.7.7-3.2-.5-.5-3.2.7L0 13.1l2.8-1.7v-.8L0 8.9l1.7-4.1 3.2.7.5-.5-.7-3.3L8.9 0l1.7 2.8h.8L13.1 0l4.1 1.7-.7 3.2.5.5 3.2-.7L22 8.9l-2.8 1.7zM17.9 12v-2l2.6-1.6-.9-2.2-2.9.7c-.2-.3-.5-.5-.7-.8-.2-.2-.5-.5-.8-.7l.7-2.9-2.2-.9L12 4.1h-2L8.4 1.5l-2.3.9.7 2.9c-.3.3-.5.5-.7.8-.3.2-.5.4-.7.7l-3-.7-.9 2.3L4.1 10v2l-2.6 1.6.9 2.2 2.9-.7c.2.3.5.5.7.8.2.2.5.5.8.7l-.7 2.9 2.2.9 1.6-2.6h2l1.6 2.6 2.2-.9-.7-2.9c.3-.2.5-.5.8-.7.2-.2.5-.5.7-.8l2.9.7.9-2.2-2.4-1.6zM11 6.9c.6 0 1.1.1 1.6.3s.9.5 1.3.9.7.8.9 1.3.3 1 .3 1.6-.1 1.1-.3 1.6-.5.9-.9 1.3-.8.7-1.3.9-1 .3-1.6.3-1.1-.1-1.6-.4-.9-.5-1.3-.9-.7-.8-.9-1.3-.3-1-.3-1.6.1-1 .4-1.5.5-.9.9-1.3.8-.7 1.3-.9.9-.3 1.5-.3zm0 7c.4 0 .8-.1 1.1-.2.3-.1.6-.4.9-.6.3-.3.5-.6.6-.9.1-.3.2-.7.2-1.1s-.1-.8-.2-1.1c-.1-.5-.3-.8-.6-1-.3-.3-.6-.5-.9-.6-.3-.1-.7-.2-1.1-.2s-.8.1-1.1.2c-.4.1-.7.3-.9.6-.3.2-.5.5-.6.9-.1.3-.2.7-.2 1.1s.1.8.2 1.1c.1.4.3.7.6.9.3.3.6.5.9.6.3.2.7.3 1.1.3z'/><\/g><\/svg>"}}));
define("MsPortalImpl/Svg/Startup/SmileyHappy.svg",[],(function(){"use strict";return{type:319,data:"<svg viewBox='0 0 32 32' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M16 0C7.16 0 0 7.16 0 16s7.16 16 16 16 16-7.16 16-16S24.84 0 16 0zm0 30C8.28 30 2 23.72 2 16S8.28 2 16 2s14 6.28 14 14-6.28 14-14 14zm6-16c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm-12 0c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm14.93 6.47C23.29 23.74 19.91 26 16 26s-7.29-2.26-8.93-5.53l1.79-.89C10.17 22.19 12.87 24 16 24s5.83-1.81 7.15-4.43l1.78.9z'/><\/g><\/svg>"}}));
define("MsPortalImpl/Svg/Library/Feedback.svg",[],(function(){"use strict";return{type:228,data:"<svg viewBox='0 0 15 15' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M13.903 2.152a2.626 2.626 0 0 0-.936-.651c-1.62-.674-3.959.165-5.425 2.246C5.289 1.028 2.594.517 1.094 2.152c-2.997 3.264.756 7.552 3.717 9.987 1.167.96 2.211 1.632 2.67 1.84V14l.016-.008s.016.007.022.008v-.021c1.62-.735 10.561-7.277 6.384-11.827z'/><\/g><\/svg>"}}));
define("MsPortalImpl/Svg/Library/LaunchCurrent.svg",[],(function(){"use strict";return{type:227,data:"<svg viewBox='0 0 15 15' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M8.883.942v1.586h3.118L6.314 8.214a.792.792 0 1 0 1.121 1.122l5.545-5.545v2.833h1.586V.942H8.883z'/><path d='M12.01 6.064a.316.316 0 0 0-.344.068l-.946.946a.316.316 0 0 0-.092.223v3.746c0 .601-.489 1.09-1.09 1.09H3.272c-.601 0-1.09-.489-1.09-1.09V6.07c0-.601.489-1.09 1.09-1.09h4.762a.315.315 0 0 0 .223-.092l.946-.946a.316.316 0 0 0-.223-.539H3.272A2.67 2.67 0 0 0 .605 6.07v4.977a2.67 2.67 0 0 0 2.667 2.667h6.266a2.67 2.67 0 0 0 2.667-2.667V6.355a.319.319 0 0 0-.195-.291z'/><\/g><\/svg>"}}));
define("MsPortalImpl/Svg/Library/Mail.svg",[],(function(){"use strict";return{type:267,data:"<svg viewBox='0 0 16 16' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M7.9 9.3c-.2 0-.3-.1-.5-.2l-7-5.8 1-1L8 7.7 14.7 2l1 1-7.4 6c0 .2-.1.3-.4.3z'/><path d='M15.2 1.1H.8c-.5 0-.8.4-.8.9v11c0 .5.3.9.8.9h14.4c.5 0 .8-.4.8-.9V2c0-.5-.3-.9-.8-.9zm-.8 11.2H1.6V2.7h12.8v9.6z'/><\/g><\/svg>"}}));
define("MsPortalImpl/Svg/Library/Person.svg",[],(function(){"use strict";return{type:44,data:"<svg viewBox='0 0 50 50' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M35.859 10.269c0 5.671-4.638 10.269-10.359 10.269S15.142 15.94 15.142 10.269 19.779 0 25.5 0c5.721 0 10.359 4.598 10.359 10.269m-2.785 13.789L25.5 34.578l-7.574-10.52H7.001V50H44V24.058z' class='msportalfx-svg-c15'/><\/g><\/svg>"}}));
define("MsPortalImpl/Svg/Library/Signout.svg",[],(function(){"use strict";return{type:226,data:"<svg viewBox='0 0 15 15' class='msportalfx-svg-placeholder' role='presentation' focusable='false' xmlns:svg='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><title><\/title><path d='M12.133 3.033a.995.995 0 1 0-1.408 1.408 4.543 4.543 0 0 1 1.336 3.225 4.544 4.544 0 0 1-1.336 3.225A4.547 4.547 0 0 1 7.5 12.227a4.54 4.54 0 0 1-3.224-1.336A4.544 4.544 0 0 1 2.94 7.666a4.543 4.543 0 0 1 1.336-3.225.995.995 0 1 0-1.408-1.408 6.537 6.537 0 0 0-1.92 4.633 6.535 6.535 0 0 0 1.92 4.633A6.537 6.537 0 0 0 7.5 14.218h.004a6.53 6.53 0 0 0 4.628-1.919 6.534 6.534 0 0 0 1.919-4.633 6.534 6.534 0 0 0-1.918-4.633zM7.5 8.662c.55 0 .996-.446.996-.996V1.655a.996.996 0 0 0-1.992 0v6.011c0 .55.446.996.996.996z'/><\/g><\/svg>"}}));
define("_generated/Templates/WidgetsAvatarMenu",["require","exports"],(function(){"use strict";return function(){return'<div class="fxs-avatarmenu-dropdown"> <ul class="fxs-avatarmenu-list-system" role="presentation"> <li class="fxs-portal-hover" role="presentation"> <a href="" class="fxs-avatarmenu-signout" role="menuitem" data-bind=\'attr: { title: text.signOutLabel }\'> <div class="fxs-dropmenu-list-content fxs-portal-text" data-bind="text: text.signOutLabel"><\/div> <div class="fxs-dropmenu-image fxs-fill-error" data-bind="image: data.icons.signout"><\/div> <\/a> <\/li> <\/ul> <div class="fxs-avatarmenu-scrollviewer"> <div class="fxs-avatarmenu-list-system"> <ul role="presentation"> <li class="fxs-portal-hover" data-bind="visible: changePasswordLink" role="presentation"> <a tabindex="-1" class="fxs-avatarmenu-changepassword" role="menuitem" target="_blank" rel="noopener noreferrer" data-bind=\'attr: { href: changePasswordLink, title: text.changePasswordLabel }\'> <div class="fxs-dropmenu-list-content fxs-portal-text" data-bind="text: text.changePasswordLabel"><\/div> <div class="fxs-dropmenu-image fxs-portal-svg" data-bind="image: data.icons.launchCurrent"><\/div> <\/a> <\/li> <li class="fxs-portal-hover" data-bind="visible: data.contactInfoEnabled" role="presentation"> <a tabindex="-1" class="fxs-avatarmenu-contactinfo" role="menuitem" href=""> <div class="fxs-dropmenu-list-content fxs-portal-text" data-bind="text: data.text.contactInfo"><\/div> <div class="fxs-dropmenu-image fxs-portal-svg" data-bind="image: data.icons.contactInfo"><\/div> <\/a> <\/li> <li class="fxs-portal-hover" role="presentation"> <a tabindex="-1" class="fxs-avatarmenu-myaccess" role="menuitem" href=""> <div class="fxs-dropmenu-list-content fxs-portal-text" data-bind="text: data.text.myAccessLabel"><\/div> <div class="fxs-dropmenu-image fxs-portal-svg" data-bind="image: data.icons.person"><\/div> <\/a> <\/li> <li class="fxs-portal-hover" data-bind="visible: !!data.links.giveFeedback" role="presentation"> <a tabindex="-1" class="fxs-avatarmenu-feedback" role="menuitem" href="" target="_blank" rel="noopener noreferrer" data-bind=\'attr: { href: data.links.giveFeedback, title: data.text.feedbackLabel }\'> <div class="fxs-dropmenu-list-content fxs-portal-text" data-bind="text: data.text.feedbackLabel"><\/div> <div class="fxs-dropmenu-image fxs-portal-svg" data-bind="image: data.icons.feedback"><\/div> <\/a> <\/li> <li class="fxs-portal-hover" data-bind="visible: data.links.accountPortal" role="presentation"> <a tabindex="-1" class="fxs-avatarmenu-billing" role="menuitem" href="" rel="noopener noreferrer"> <div class="fxs-dropmenu-list-content fxs-portal-text" data-bind="text: data.text.billingLabel"><\/div> <div class="fxs-dropmenu-image fxs-portal-svg" data-bind="visible: data.links.accountPortal && data.links.accountPortal.startsWith(\'#\')"><\/div> <\/a> <\/li> <li class="fxs-portal-hover" data-bind="visible: data.directoryPaneEnabled" role="presentation"> <a tabindex="-1" class="fxs-avatarmenu-switchdirectory" role="menuitem" href=""> <div class="fxs-dropmenu-list-content fxs-portal-text" data-bind="text: data.text.switchDirectoryLabel"><\/div> <div class="fxs-dropmenu-image fxs-portal-svg" data-bind="image: data.icons.switchDirectory"><\/div> <\/a> <\/li> <\/ul> <\/div> <div class="fxs-avatarmenu-list-tenant fxs-portal-border fxs-dropmenu-line-separator" data-bind="visible: listOfTenants().length" role="presentation"> <div class="fxs-avatarmenu-dropdown-title" id="avatarMenuTenantListId" data-bind="text: text.tenant" role="presentation"><\/div> <ul data-bind="foreach: listOfTenants" aria-labelledby="avatarMenuTenantListId" role="group"> <li class="fxs-portal-hover" role="presentation"> <a tabindex="-1" role="menuitemradio" data-bind="css: { \'fxs-avatarmenu-current-tenant fxs-portal-selected fxs-portal-activated\': $index() === 0 }, attr: { href: $index() === 0 ? \'#\' : \'\', \'aria-checked\': $index() === 0 }"> <div class="fxs-avatarmenu-tenant-name fxs-portal-text" data-bind="text: displayName, attr: { title: displayName }"><\/div> <div data-bind="text: domainName, attr: { title: domainName }" class="fxs-avatarmenu-tenant-uri"><\/div> <\/a> <\/li> <\/ul> <\/div> <\/div> <\/div>'}}));
define("_generated/Templates/WidgetsAvatarMenuButton",["require","exports"],(function(){"use strict";return function(){return'<div class="fxs-avatarmenu-header fxs-trim-hover" data-bind="attr: { title: tooltip }"> <div class="fxs-avatarmenu-tenant-container"> <div class="fxs-avatarmenu-username" data-bind="text: displayName"><\/div> <div class="fxs-avatarmenu-tenant" data-bind="text: currentTenantDisplayName"><\/div> <\/div> <img class="fxs-avatarmenu-tenant-image" data-bind="attr: { src: avatarUri }" alt=""/> <\/div>'}}));
define("MsPortalImpl/Widgets/Widgets.AvatarMenu",["require","exports","f","o","ko","$","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Telemetry","_generated/Templates/WidgetsAvatarMenu","_generated/Templates/WidgetsAvatarMenuButton","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.DropMenu","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Svg/Library/Feedback.svg","MsPortalImpl/Svg/Library/LaunchCurrent.svg","MsPortalImpl/Svg/Library/Person.svg","MsPortalImpl/Svg/Startup/DirectoryFilter.svg","MsPortalImpl/Svg/Library/Signout.svg","MsPortalImpl/Svg/Library/Mail.svg","MsPortalImpl/Resources/Resources.Images","_generated/Less/MsPortalImpl/Widgets/Widgets.AvatarMenu.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d){"use strict";function g(n){return(n||"").toLowerCase()}function ti(n){var t=n.userIdentity();return t&&(t.displayName||ii(t))||n.text.defaultDisplayName}function ii(n){var t=n.firstName||"",i=n.lastName||"";return!t&&!i||ft.test(t)&&ft.test(i)?"":e.AvatarMenu.displayNameFormat.format(t,i)}function ri(n,t){return t().first((function(t){return n().tenantId===t.id}))}function ui(n,t){return u.pureComputed((function(){var u=n(),r=u&&g(u.tenantId),i=t();return i.length===1&&i[0]&&g(i[0].id)===r?[]:i.sort((function(n,t){var e=g(n.id),f,i,u;return e===r?-1:(f=g(t.id),f===r)?1:(i=n.displayName,u=t.displayName,i<u?-1:i>u?1:0)}))}))}var ft,vt;r.defineProperty(t,"__esModule",{value:!0});var et=i.Base,tt=et.Images,yt=window,it=o.Source.TopBar,rt=o.Action,ut=et.Diagnostics.Telemetry.trace,ot="fxs-avatarmenu",pt=".fxs-avatarmenu-list-tenant a",st=".fxs-avatarmenu-signout",wt=".fxs-avatarmenu-billing",bt=".fxs-avatarmenu-feedback",kt=".fxs-avatarmenu-switchdirectory",dt=".fxs-avatarmenu-myaccess",gt=".fxs-avatarmenu-contactinfo",ht="signOut",ct="switchedTenant",lt="showDiagnostics",nt=a.default.click,at="a[role=menuitem], a[role=menuitemradio]",ni=(function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.directoryPaneEnabled=i.isFeatureEnabled("directorypane"),t.dropMenu=new l.ViewModel(h(),s(),at),t.userIdentity=u.observable(),t.userInfo=u.observable(),t.hideTenant=u.observable(),t.listOfTenants=u.observableArray(),t.showDiagnostics=null,t.contactInfoEnabled=u.observable(!1),t.signOut=null,t.signedOut=null,t.switchTenant=null,t.switchedTenant=null,t.text=e.AvatarMenu,t.links=yt.fx.environment.links,t.icons={contactInfo:tt.CustomImageWithOptions(k,{isLogo:!0}),feedback:v,launchCurrent:y,person:tt.CustomImageWithOptions(p,{palette:99}),signout:tt.CustomImageWithOptions(b,{isLogo:!0}),switchDirectory:tt.CustomImageWithOptions(w,{isLogo:!0})},t.avatarImage=u.observable(),t.showDiagnosticsDelay=3e3,t}return __extends(t,n),t})(c.ViewModel);t.ViewModel=ni;ft=/^(f(irst)?|l(ast)?)\s?name$/i;vt=(function(n){function t(t,i){var r=n.call(this,t,i)||this,c,f;r._lastTouchMillis=0;var o=r.element,s=r.ltm,h=i.dropMenu;o.addClass(ot);c=u.pureComputed((function(){return ti(i)}));f=u.pureComputed((function(){var n=i.userInfo();return i.hideTenant()||!n?"":n.uniqueDirectoryName}));h.buttonClass="fxs-menu-account";u.computed(s,(function(){var n=e.AvatarMenu.label+" ";n+=f()?i.text.userWithTenantLabel.format(f()):i.text.userLabel.format(c());h.buttonLabel(n)}));r._dropMenuWidget=new l.Widget(o,h);var y=u.pureComputed((function(){var n=i.userIdentity(),u,e,o,s;if(!n)return"";var f=i.text.Tooltip,h=f.tenant,t=[];return(n.firstName||n.lastName)&&t.push(f.name.format(n.firstName||"",n.lastName||"")),n.displayName&&t.push(f.email.format(n.displayName)),u=ri(i.userIdentity,i.listOfTenants),u&&!i.hideTenant()&&(t.push(h.format(u.displayName,u.id)),e=u.domainName||"",o=n.tenantDomain,t.push(o&&g(e)!==g(o)?h.format(e,o):f.domain.format(e))),s=t.join("\n"),r._dropMenuWidget.options.buttonTooltip(s),s})),a=u.observable(d.getAvatarMenu().defaultAvatarSmall),v=u.observable();return u.reactor(s,(function(){var n=i.userIdentity(),t;n&&(v(n.changePasswordUri),n.isAnonymous||(a(n.defaultAvatarUri),t=i.avatarImage(),t&&t.then((function(n){return a(n)}))))})),u.applyBindingsToDescendants({data:i,func:r,displayName:c,listOfTenants:i.directoryPaneEnabled?u.observableArray([]):ui(i.userIdentity,i.listOfTenants),text:i.text,currentTenantDisplayName:f,tooltip:y,avatarUri:a,changePasswordLink:v},o[0]),u.reactor(s,i.dropMenu.isMenuOpen,(function(n){n&&r._reactToMenuOpen()})),r._attachEventHandlers(),r}return __extends(t,n),t.prototype.dispose=function(){this._dropMenuWidget.dispose();this._cleanElement(ot);n.prototype.dispose.call(this)},t.prototype._signOut=function(n){(ut({source:it,action:rt.AvatarMenuSignOut}),this.trigger(ht,f.Event(ht),{completed:!!n}))&&this.trigger("signedOut")},t.prototype._switchTenant=function(n){var t=this.options.userIdentity();if(g(n.id)!==(t&&g(t.tenantId))){if(ut({source:it,action:rt.AvatarMenuSwitchTenant}),!this.trigger("switchTenant"))return;this.trigger(ct,f.Event(ct),{tenant:n})}},t.prototype._attachEventHandlers=function(){var n=this,t=this.options,i=t.links,r=this.element,o=function(){return n._lastTouchMillis=Date.now()},s=function(i){if(n._lastTouchMillis){var r=Math.abs(Date.now()-n._lastTouchMillis);n._lastTouchMillis=0;r>t.showDiagnosticsDelay&&(n.trigger(lt,f.Event(lt)),i.preventDefault())}},e=r.find(".fxs-avatarmenu-header");e.on([a.default.touchstart,a.default.mousedown].join(" "),o);e.on([a.default.touchend,a.default.mouseup].join(" "),s);this.ltm.registerForDispose(r.setEvents([nt,st,function(t){n._signOut(!1);t.preventDefault()}],[nt,pt,function(t){t.preventDefault();n._switchTenant(u.dataFor(t.target))}],[nt,wt,function(n){t.openAccountPortal();i.accountPortal.startsWith("#")&&n.preventDefault()}],[nt,bt,function(n){t.giveFeedback();i.giveFeedback.startsWith("#")&&n.preventDefault()}],[nt,kt,function(n){t.switchDirectory();n.preventDefault()}],[nt,dt,function(n){n.preventDefault();t.showMyAccessBlade()}],[nt,gt,function(n){n.preventDefault();t.showContactInfoBlade()}]))},t.prototype._reactToMenuOpen=function(){var n=this.element;n.find(at).attr("tabindex","-1");n.find(st).attr("tabindex","0").focus();ut({source:it,action:rt.AvatarMenuOpen})},t})(c.Widget);t.Widget=vt}));
define("_generated/Templates/WidgetsTopBar",["require","exports"],(function(){"use strict";return function(){return'<div class="fxs-topbar-exit-customize"> <div class="fxs-topbar-exit-customize-message" data-bind="text: data.text.exitCustomizeText"><\/div> <button type="button" class="fxs-topbar-exit-customize-button fxs-button fxs-portal-button-primary" data-bind="text: data.text.exitCustomizeButton"><\/button> <\/div> <div class="fxs-topbar-content fxs-hide-in-customize" role="banner" aria-labelledby="bannerlabel"> <div class="fxs-topbar-internal fxs-bg-warning" data-bind="visible:data.showPreview, text: data.text.internalText"><\/div> <h1 class="fxs-topbar-brand" id="bannerlabel"><a href="#" class="fxs-topbar-home fxs-trim-text-primary fxs-trim-hover" data-bind="text: data.productName, attr: { title: data.dashboardTooltip }"><\/a><\/h1> <div class="fxs-topbar-placeholder"><\/div> <!-- ko if: data.inDevMode --> <a class="fxs-topbar-exitdevmode fxs-trim-hover fxs-bg-warning" href="#" role="button" data-bind="text: data.text.exitDevModeLinkText, click: func._exitDevMode"><\/a> <!-- /ko --> <!-- ko if: data.canReportBug --> <a href="#" class="fxs-topbar-reportbug fxs-trim-hover fxs-bg-warning" role="button" data-bind="text: data.text.reportBug, click: func._reportBug, attr: { title: data.text.reportBugTitle, \'aria-label\': data.text.reportBug }"><\/a> <!-- /ko --> <div class="fxs-topbar-search" data-bind="stopBindings: true" role="presentation"><\/div> <div class="fxs-topbar-notifications fxs-trim-hover"> <a href="#" class="fxs-trim-svg fxs-topbar-button" role="button" data-bind="image: data.icons.notifications, attr: { title: data.text.notifications, \'aria-label\': data.text.notifications }"><\/a> <div class=\'fxs-notificationspane-progressbar fxs-display-none\'><div><\/div><\/div> <\/div> <div class="fxs-topbar-toast" role="presentation"><\/div> <a href="#" role="button" class="fxs-topbar-console fxs-topbar-button fxs-trim-hover fxs-trim-svg" data-bind="attr: { title: data.text.console }, image: data.icons.console"><\/a> <a href="#" class="fxs-topbar-settings fxs-menu-settings fxs-topbar-button fxs-trim-hover fxs-trim-svg" role="button" data-bind="attr: { title: data.text.settings }, image: data.icons.settings"><\/a> <!-- ko if: data.showFeedbackButton --> <a href="#" class="fxs-topbar-feedback fxs-menu-feedback fxs-topbar-button fxs-trim-hover fxs-trim-svg" role="button" data-bind="attr: { title: data.text.feedback }, image: data.icons.feedback"><\/a> <!-- /ko --> <a href="#" class="fxs-topbar-helpmenu fxs-topbar-button fxs-trim-hover fxs-trim-svg" role="button" data-bind="attr: { title: data.text.help }, image: data.icons.help"><\/a> <a href="#" class="fxs-topbar-peekmode fxs-topbar-button fxs-trim-hover fxs-trim-svg fxs-display-none" role="button" data-bind="attr: { title: data.text.peek }, image: peekModeIcon"><\/a> <!-- ko if: data.directoryPaneEnabled --> <a href="#" class="fxs-topbar-directory fxs-menu-directory fxs-topbar-button fxs-trim-hover fxs-trim-svg" role="button" data-bind="attr: { title: data.text.directory }, image: data.directoryFilterIcon"><\/a> <!-- /ko --> <div class="fxs-topbar-avatarmenu" data-bind="stopBindings: true"><\/div> <\/div> <div class="fxs-topbar-dashboard"> <div class="fxs-topbar-dashboard-message" data-bind="text: data.dashboardMessage"><\/div> <button type="button" class="fxs-button fxs-topbar-dashboard-done-customize" data-bind="text: data.text.exitCustomizeButton"><\/button> <button type="button" class="fxs-button fxs-topbar-dashboard-view" data-bind="text: data.text.viewDashboardButton"><\/button> <button type="button" class="fxs-button fxs-topbar-dashboard-save" data-bind="text: data.dashboardSaveButtonText"><\/button> <button type="button" class="fxs-button fxs-topbar-dashboard-discard" data-bind="text: data.text.discardDashboardButton"><\/button> <\/div> <div class="fxs-loading5dots-container fxs-blade-progress-translucent" data-bind="visible: loading"> <div><\/div> <div><\/div> <div><\/div> <div><\/div> <div><\/div> <\/div>'}}));
define("MsPortalImpl/Widgets/Widgets.TopBar",["require","exports","f","o","ko","$","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/JQueryHelper","MsPortalImpl/Base/Telemetry","MsPortalImpl/Widgets/Widgets.AvatarMenu","MsPortalImpl/Widgets/Widgets.WidgetBase","_generated/Templates/WidgetsTopBar","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Svg/Startup/Settings.svg","MsPortalImpl/Svg/Startup/Console.svg","MsPortalImpl/Svg/Startup/DirectoryFilter.svg","MsPortalImpl/Svg/Startup/DirectoryFilteredSet.svg","MsPortalImpl/Svg/Startup/Star.svg","MsPortalImpl/Svg/Startup/SmileyHappy.svg","MsPortalImpl/Svg/Startup/Help.svg","MsPortalImpl/Svg/Startup/Notifications.svg","MsPortalImpl/Services/Services.SelectedSubscriptions","_generated/Less/MsPortalImpl/Widgets/Widgets.TopBar.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt){"use strict";var lt,at;r.defineProperty(t,"__esModule",{value:!0});var ft=i.Base,tt=ft.Images,et=o.findByClassName,rt=window,vt=rt.fx.environment,ot="fxs-topbar",st="fxs-topbar-notifications",ht="fxs-topbar-dashboard-done-customize",ct="fxs-topbar-console",ut=a.default.fxexitorganizemode,it=i.isFeatureEnabled;t.fxfinishdashboardedit="fxfinishdashboardedit";lt=(function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.avatarMenu=new h.ViewModel,t.directoryPaneEnabled=it("directorypane"),t.productName=vt.branding.productName,t.showPreview=u.observable(i.getFeatureValue("internalonly")!=="false"),t.text=e.TopBar,t.dashboardTooltip=e.KeyboardShortcuts.GoTo.dashboard,t.canReportBug=u.observable(!1),t.reportBug=f.noop,t.showFeedbackButton=i.isFeatureEnabled("feedback"),t.inDevMode=u.observable(!1),t.exitDevMode=f.noop,t.icons={settings:tt.CustomImageWithOptions(v,{isLogo:!0}),help:tt.CustomImageWithOptions(d,{isLogo:!0}),console:tt.CustomImageWithOptions(y,{isLogo:!0}),notifications:tt.CustomImageWithOptions(g,{isLogo:!0}),feedback:tt.CustomImageWithOptions(k,{isLogo:!0}),directory:tt.CustomImageWithOptions(b,{isLogo:!0})},t.directoryFilterIcon=u.observable(tt.CustomImageWithOptions(p,{isLogo:!0})),t.dashboardMessage=u.observable(""),t.dashboardSaveButtonText=u.observable(""),t.dashboardChanged=u.observable(!1),t.dashboardWritable=u.observable(!1),t.dashboardVisible=u.observable(!1),t.isInOrganizeMode=u.observable(!1),t.peekMode=u.observable(!1),t}return __extends(t,n),t})(c.ViewModel);t.ViewModel=lt;at=(function(n){function r(t,r,e){var s=n.call(this,t,r)||this,c,v,b,y;if(s._loadingIdList=u.observableArray([]),c=s.ltm,t.addClass(ot).attr("role","presentation").html(l()),c.registerForDispose(new h.Widget(t.findByClassName("fxs-topbar-avatarmenu"),s.options.avatarMenu)),u.reactor(c,(function(){t.toggleClass("fxs-topbar-devmode",!!r.inDevMode()).toggleClass("fxs-bg-warning",!!r.inDevMode())})),u.reactor(c,(function(){var t=r.dashboardWritable(),n=r.text;r.dashboardSaveButtonText(t?n.saveDashboardButton:n.saveDashboardCopyButton);r.dashboardMessage(t?n.saveMessage:n.saveCopyMessage)})),u.reactor(c,(function(){f(".fxs-portal-main").add(t).toggleClass("fxs-topbar-dashboard-changed",!!r.dashboardChanged());t.toggleClass("fxs-topbar-dashboard-visible",!!r.dashboardVisible());o.toggle(et(t,ht),!!r.isInOrganizeMode());var i="fxs-portal-button-primary",u="fxs-button-default",n=et(t,"fxs-topbar-dashboard").findByClassName("fxs-button").filter(o.getUnhideSelector());n&&n.length&&(n.slice(1).removeClass(i).addClass(u),n.first().removeClass(u).addClass(i))})),v=u.observable(),s._bindDescendants({loading:u.computed(s.ltm,(function(){return s._loadingIdList().length>0})),peekModeIcon:v}),s._attachEventHandlers(t),it("azureconsole")){b=i.memoizeQ((function(){var n;return i.require("MsPortalImpl/Widgets/Widgets.Console").then((function(t){return n=t})).then((function(){return s.options.getConsoleViewModel()})).then((function(i){var r=function(n){return n.returnValue="*",""};return i.isVisible.subscribeAndRun(c,(function(n){t.findByClassName(ct).attr("aria-expanded",n);n?rt.addEventListener("beforeunload",r):rt.removeEventListener("beforeunload",r)})),new n.Widget(e,i)}))}));t.findByClassName(ct).css("display","flex").attr({"aria-controls":e.attr("id"),"aria-expanded":"false"}).on(a.default.click,(function(n){n.preventDefault();n.stopPropagation();b().then((function(n){return n.toggle()}))}))}t.findByClassName("fxs-topbar-feedback").on(a.default.click,(function(n){n.preventDefault();r.feedbackButtonClick&&r.feedbackButtonClick()}));y=t.findByClassName("fxs-topbar-directory");y.on(a.default.click,(function(n){n.preventDefault();r.directoryButtonClick&&r.directoryButtonClick()}));r.directoryPaneEnabled&&(y.addClass("fxs-menu-directory"),u.reactor(c,(function(){var n=nt.allSubscriptionsSelected()?p:w;r.directoryFilterIcon(tt.CustomImageWithOptions(n,{isLogo:!0}))})));t.findByClassName("fxs-topbar-helpmenu").on(a.default.click,(function(n){n.preventDefault();r.helpButtonClick&&r.helpButtonClick()}));t.findByClassName(st).on(a.default.click,(function(){r.notificationButtonClick&&r.notificationButtonClick()}));return!it("reservehozscroll")&&it("peekblades")&&(o.unhide(t.findByClassName("fxs-topbar-peekmode").on(a.default.click,(function(n){s.trigger(a.default.fxpeekmode);n.preventDefault()}))),s.options.peekMode.subscribeAndRun(c,(function(n){v((n?tt.Shell.ExitPeekMode:tt.Shell.PeekMode)({isLogo:!0}))}))),s}return __extends(r,n),r.prototype.loadingHint=function(n,t){t?this._loadingIdList.push(n):this._loadingIdList(this._loadingIdList().filter((function(t){return t!==n})))},r.prototype.dispose=function(){this._cleanElement(ot);n.prototype.dispose.call(this)},r.prototype._reportBug=function(n,t){t.preventDefault();n.data.reportBug()},r.prototype._exitDevMode=function(n,t){t.preventDefault();n.data.exitDevMode()},r.prototype._attachEventHandlers=function(n){function r(t,i){n.trigger(t,i&&{action:i}||undefined)}function i(t,i){n.on(a.default.click,t,i)}function u(n,t){ft.Diagnostics.Telemetry.trace({source:s.Source.TopBar,action:n,data:t})}function f(n,t,i){return function(f){f.preventDefault();t&&u(t,i);r(n)}}var e=this.options;i(".fxs-topbar-exit-customize-button, ."+ht,f(ut,s.Action.CustomizeModeExited,{dashboardChanged:!!e.dashboardChanged(),onDashboard:!!e.dashboardVisible()}));i(".fxs-topbar-home",f(a.default.fxhomebuttonclick,s.Action.HomeButtonClicked));i("."+st,(function(n){n.preventDefault()}));i(".fxs-topbar-settings",f(a.default.fxsettingsbuttonclick));i(".fxs-topbar-dashboard-save",(function(){var n=e.dashboardWritable(),i=n?1:2,f=n?s.Action.DashboardPublish:s.Action.DashboardSaveACopy;u(f);r(t.fxfinishdashboardedit,i);i===1&&r(ut)}));i(".fxs-topbar-dashboard-discard",(function(){u(s.Action.DashboardDiscard);r(t.fxfinishdashboardedit,3);r(ut)}));i(".fxs-topbar-dashboard-view",(function(){u(s.Action.DashboardView);r(a.default.fxhomebuttonclick)}))},r})(c.Widget);t.Widget=at}));
define("MsPortalImpl/Widgets/Widgets.Portal",["require","exports","f","ko","FxInternal/Di","MsPortalImpl/UI/UI.NavigationManager","MsPortalImpl/Interactions/Interactions.ContextMenuTouch","MsPortalImpl/Interactions/Interactions.OverflowAutoTooltip","MsPortalImpl/Services/Services.GeneralSettings","MsPortalImpl/Base/Telemetry","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.ContextPane","MsPortalImpl/Widgets/Widgets.Panorama","MsPortalImpl/Widgets/Widgets.Search","MsPortalImpl/Widgets/Widgets.SideBar","MsPortalImpl/Widgets/Widgets.ToastViewModel","MsPortalImpl/Widgets/Widgets.Toast","MsPortalImpl/Widgets/Widgets.TopBar","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Base/Base.KeyboardHelper","MsPortalImpl/Interactions/Interactions.FocusHandler"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g){"use strict";var nt;return (function(n){var ft=i.Base.UriBuilder,et=i.Base.Diagnostics.Telemetry,tt=window,it=i.getFeatureValue("rapidtoasts"),d="fxs-show-journey",rt="fxs-show-startboard",ut="fxs-blade-position-feature2",ot="fxs-portal-peekmode",t,nt;r.components.register("fxs-progress",{template:'<div class="fxs-progress-dots"><div><\/div><div><\/div><div><\/div><\/div>'});t=(function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.topBarViewModel=new b.ViewModel,t.sideBarViewModel=new y.ViewModel,t}return __extends(t,n),t})(c.ViewModel);t=__decorate([u.Class()],t);n.ViewModel=t;nt=(function(n){function t(t,u){var f=n.call(this,t,u)||this,c,ht,ct,lt,at,pt,vt,yt,wt,bt,nt;f.hasActiveJourney=!1;var et=f.ltm,h=u.sideBarViewModel,st=u.topBarViewModel,ft=new b.Widget(t.findByClassName("fxs-topbar"),st,t.findByClassName("fxs-portal-console"));return f.getTopBarWidget=function(){return ft},c=new a.Widget(t.findByClassName("fxs-portal-content"),new a.ViewModel("fxs-panorama-instanceid")),f.getPanorama=function(){return c},ht=new l.ViewModel,ht.collapsed=h.isCollapsed,ct=new l.Widget(t.findByClassName("fxs-portal-contextpane-left"),ht),f.getLeftContextPane=function(){return ct},lt=new l.Widget(t.findByClassName("fxs-portal-contextpane-right"),new l.ViewModel),f.getRightContextPane=function(){return lt},at=new v.Widget(t.findByClassName("fxs-topbar-search"),new v.ViewModel),f.getSearchWidget=function(){return at},e.register(t),o.register(t),pt=r.computed(et,(function(){return s.settings.notificationToastEnabledKey()&&it!=="0"&&it!=="true"})),vt=new p.ViewModel({shouldShowToasts:pt}),f.getToastVM=function(){return vt},et.registerForDispose(new w.Widget(t.findByClassName("fxs-topbar-toast"),vt)),h.getStartboardVisible=function(){return f.isStartBoardVisible()},yt=new y.Widget(t.findByClassName("fxs-sidebar"),h),f.getSideBarWidget=function(){return yt},wt=function(){f.isJourneyVisible()||(i.isFeatureEnabled("sideBarAutoCollapsedInJourney")||h.isCollapsed(s.settings.sideBarCollapsedKey()),f.element.removeClass(rt).addClass(d),st.dashboardVisible(!1),g.FocusHandler.Instance.journey(!0))},bt=function(n,t){var r,i;h.isCollapsed(s.settings.sideBarCollapsedKey());f.element.removeClass(d).addClass(rt);st.dashboardVisible(!0);g.FocusHandler.Instance.journey(!1);r=t&&t.skipFocus;r||(i=f.getPanorama().getStartBoardWidget(),i&&i.setFocus())},i.isFeatureEnabled("reservehozscroll")&&f.element.addClass(ut),nt=r.observable(!1),f.ltm.registerForDispose([ft,c,ct,lt,at,yt,function(){e.unregister(t);o.unregister(t)},f.element.setEvents([k.default.fxloadingontopbar,function(n,t){ft.loadingHint(t.id,!t.cancel);var i=c.getJourneyWidget();i&&i.loadingHint(t.id,!t.cancel)},],[k.default.fxshowstartboard,bt,],[k.default.fxshowjourney,wt,],[k.default.fxdashboardactivity,function(){var n=c.getJourneyWidget(),t=n&&n.getBlades()[0];t&&t.close(!1)},],[k.default.fxpeekmode,function(n,t){nt(t&&t.enter!==undefined?!!t.enter:!nt())},]),$(tt).setEvents([k.default.keyup,function(n){n.which===27&&nt(!1)},]),]),nt.subscribe(et,(function(n){f.element.toggleClass(ot,n);var t=f.getPanorama().getJourneyWidget();t&&t.peekMode(n);ft.options.peekMode(n)})),f}return __extends(t,n),t.create=function(n,i){return new t(n.portal,i)},t.prototype.dispose=function(){n.prototype.dispose.call(this);this._cleanElement(ut)},t.prototype.isStartBoardVisible=function(){return!this.element.hasClass(d)},t.prototype.isJourneyVisible=function(){return this.element.hasClass(d)},t.prototype._hasJourneyWithContent=function(){var n=this.getPanorama(),t=n&&n.getJourneyWidget(),i=this.getRightContextPane();return t&&t.hasChildren()||i&&i.options.opened()},t.prototype.handleStartButtonClick=function(){var t=h.ActionModifier.PortalScrolled,i=new ft(tt.location.href),r=!i.fragment,n;this.isStartBoardVisible()||(this._hasJourneyWithContent()&&r&&!this.hasActiveJourney?(n=this.getPanorama().getJourneyWidget(),n&&n.close()):(this.element.trigger(k.default.fxhomebuttonclick),t=h.ActionModifier.StartBoardRestored));et.trace({source:h.Source.Desktop,action:h.Action.HomeButtonClicked,actionModifier:t})},t})(c.Widget);__decorate([u.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[f.RootElements,t]),__metadata("design:returntype",nt)],nt,"create",null);n.Widget=nt})(nt||(nt={})),nt}));
define("MsPortalImpl/UI/UI.ContextPane",["require","exports","o","ko","FxInternal/Di","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Interactions/Interactions.PortalReader","MsPortalImpl/Widgets/Widgets.Common","MsPortalImpl/Widgets/Widgets.Portal","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";var l,a,v,y;i.defineProperty(t,"__esModule",{value:!0});l=(function(){function n(){}return n})();t.ContextPane=l;a=(function(){function n(n){var f=this,i,t,u;this._widget=n;i=this._viewModel=n.options;t=this._containerLifetime=n.ltm;this._contentLifetime=t.createChildLifetime();this.collapsed=i.collapsed;u={dismissFn:function(){f.close()},logName:"contextPane"};r.reactor(t,(function(){i.opened()?e.register(u):e.unregister(u)}));t.registerForDispose(n.element.setEvents([c.default.fxcontextpaneclosing,function(n){n.stopPropagation();f.close()},]))}return i.defineProperty(n.prototype,"opened",{get:function(){return this._viewModel.opened},enumerable:!0,configurable:!0}),n.prototype.hasContent=function(n){return this._contentProvider===n},n.prototype.getContent=function(){return this._contentProvider},i.defineProperty(n.prototype,"contentLifetime",{get:function(){return this._contentLifetime},enumerable:!0,configurable:!0}),n.prototype.tryOpen=function(n){var r=this,t,i;return this._contentProvider===n?(this._widget.setFocus(),Q(!0)):(t=this._tryRemoveContent(),t)?(this._contentProvider=n,this._previouslyFocusedElement=document.activeElement,i=this._viewModel,i.opened(!0),i.loading(!0),o.read(f.Shell.Reader.contextPaneLoading,0),n.onAddingContent(this._widget).finally((function(){return s.waitForBindings(r._widget.element[0]).finally((function(){i.loading(!1);o.read(f.Shell.Reader.contextPaneReady.format(r._widget.element.find(".fxs-contextpane-title").text()),1)}))})).then((function(){return r._widget.setFocus(),t}))):Q(t)},n.prototype.close=function(n){var t=!0,i;return n?this._clearContent():t=this._tryRemoveContent(),t&&(i=this._viewModel,i.opened(!1),i.loading(!1),o.read(f.Shell.Reader.contextPaneClosed,0),this._restoreFocus()),t},n.prototype._clearContent=function(){var t=this._contentProvider,n;t&&t.onRemovingContent(this._widget);this._contentProvider=null;n=this._contentLifetime;n&&(n.dispose(),this._contentLifetime=this._containerLifetime.createChildLifetime())},n.prototype._tryRemoveContent=function(){var n=this._contentProvider,t;return n?(t=!n.canRemoveContent||n.canRemoveContent(),t&&this._clearContent(),t):!0},n.prototype._restoreFocus=function(){var n=this._previouslyFocusedElement;n&&n.focus()},n})();t.ContextPaneImpl=a;v=(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.create=function(n){return new a(n.getRightContextPane())},t})(l);__decorate([u.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[h.Widget]),__metadata("design:returntype",v)],v,"create",null);t.RightContextPane=v;y=(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.create=function(n){return new a(n.getLeftContextPane())},t})(l);__decorate([u.Factory(),__metadata("design:type",Function),__metadata("design:paramtypes",[h.Widget]),__metadata("design:returntype",y)],y,"create",null);t.LeftContextPane=y}));
define("MsPortalImpl/UI/Commands/UI.ExtensionCommands",["require","exports","f","o","a","ko","Viva.Controls/Util/Viva.Util","MsPortalImpl/Base/Base.Sanitization","MsPortalImpl/Base/Base.BrowserDetection","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Interactions/Interactions.Command","MsPortalImpl/UI/Hubs/UI.NotificationManager","MsPortalImpl/Base/Telemetry","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Compositions/UI.Composition.BladeOpenerBase","MsPortalImpl/UI/Compositions/UI.Composition.CompositionBinder","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding","MsPortalImpl/UI/UI.ContextPane","MsPortalImpl/UI/UI.DesktopManager"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b){"use strict";function yt(n,t,i,r){var u;return t.lc2?u=new ii(n,i,r):t.viewModel?u=new ti(n,i,r):t.execute?u=new ai(n,i,r):t.navigateUriCallback?u=new kt(n,i,r):t.navigateUri?u=new vi(n,i,r):t.listItems?u=new dt(n,i,r):t.targetUri&&t.httpMethod?u=new ni(n,i,r):(r.commandItem.commandDefinition.details||t.bladeName)&&(u=new lt(n,i,r)),u}function ht(n){var t=n,i=null;if(!(n instanceof ct))throw new Error("Command context was not an instance of CompositionInstanceCommandContext. All context objects are expected to be of that type.");return t.compositionInstance&&t.compositionInstance.locator&&(i=t.compositionInstance.locator.toFriendlyString()),i}function ft(n){var t=n&&n.title,i=n&&n.description;l&&l.getNotificationManager()&&l.getNotificationManager().addClientNotification({title:t||g.uriCallbackCommandError,description:i||g.error,status:ui.Error,timestamp:new Date})}function bt(n,t){o.sanitizeUri(n)?et.open(n,t):(d.error(g.invalidUri.format(n)),ft())}function yi(n,t){var i=n;rt(["text","icon","enabled"],(function(n){gt(i[n],n,t)}));gt(i.onInputsSet,"onInputSet",t,!0)}function gt(n,t,i,r){ot(n)||typeof n!="function"||!r&&ot(n())||pi(t,i)}function pi(n,t){d.warning("The '"+n+"' property of a command viewModel contains a value. This value will be ignored when passing to '"+t+"' dynamic command viewModel.")}function wi(n){var t;return n.name?n.details||(t="OpenBladeCommand must provide a details blade definition."):t="OpenBladeCommand must provide a command name.",t&&d.error("{0} Command: '{1}'. CommandDefinition: '{2}'.".format(t,n.name,JSON.stringify(n))),!t}function bi(n){st=Q(n)}var ct,pt,kt,dt,ni,ti,lt,ii;r.defineProperty(t,"__esModule",{value:!0});var tt=i.Base,at=tt.Diagnostics,it=at.Telemetry,ri=tt.Resources,ui=i.Hubs.Notifications.NotificationStatus,fi=i.ViewModels,ei=fi.Dialogs,oi=v.CompositionType,si=p.CompositionBinder,hi=w.ReferenceScope,ci=tt.Net2,et=window,d=at.createLog(n),vt=function(){return i.require("MsPortalImpl/UI/UI.DialogManager")},ot=i.isNullOrUndefined,rt=i.uncurryThis(u.prototype.forEach),st=null,li={invocationInputArguments:[{valuesFrom:[{referenceType:4,property:"container.selectable"}]}]},k=h.FileDownloadCommand,g=h.UriCallbackCommand,ut=412;t.createExtensionCommand=yt;t.getCommandSourceTelemetryName=ht;ct=(function(n){function t(t,i,r){var u=n.call(this,t,i)||this;return u.compositionInstance=r,u}return __extends(t,n),t})(c.CommandContext);t.CompositionInstanceCommandContext=ct;pt=(function(){function n(){}return n})();t.ExtensionCommandImplOptions=pt;var nt=(function(){function n(n,t,r){var u=this,f;this._extension=r.extension;this._viewModelName=r.viewModelName;this.viewModel=t;this.commandItem=r.commandItem;this._commandContainer=r.container;f=this._ltm=n.createChildLifetime();this._propertyBindings=r.propertyBindings;this._services=r.services;f.registerForDispose((function(){u.viewModel&&(i.disposeViewModelProperties(u.viewModel),u._extension.releaseViewModel(u.viewModel),u.viewModel=null);u._propertyBindings&&(u._propertyBindings.unbind(),u._propertyBindings=null)}))}return n.prototype.init=function(){},n.prototype.execute=function(n){var t=this._services&&this._services.desktop.getActiveJourney();it.trace({extension:this._extension.name,source:ht(this._context()),action:a.Action.CommandExecuted,name:this._viewModelName,data:n,journeyId:t&&t.id})},n.prototype.dispose=function(){this._ltm&&(this._ltm.dispose(),this._ltm=null)},n.prototype._context=function(){return this.commandItem.getCommandContext()},n.prototype._getFormTarget=function(){var n=this._context();return n.getFormTarget()},n.prototype._target=function(){var n=this._context();return n&&n.target},n})(),ai=(function(n){function t(t,i,r){var u=n.call(this,t,i,r)||this;return u._viewModel=i.content,u._services.desktop.mode.subscribe(u._ltm,(function(n){u._getFormTarget().then((function(t){n===1&&t&&t.hideForm()}))})),u}return __extends(t,n),t.prototype.execute=function(t,i){var u=this,r;n.prototype.execute.call(this,t,i);r=this._viewModel;r.status()===1?Q.all([this._services.getService("DialogManager"),this._getFormTarget()]).spread((function(n,t){u._loadDialog(t,n,f.unwrap(r.dialog))})):r.status(1);r.execute(i)},t.prototype.init=function(){var n=this,t=this._viewModel,i=this._ltm;this._services.getService("DialogManager").then((function(r){t.status.subscribe(i,(function(t){n._context()&&n._getFormTarget().then((function(i){n._statusChanged(i,r,t)}))}));f.isObservable(t.dialog)&&t.dialog.subscribe(i,(function(t){n._getFormTarget().then((function(i){n._dialogChanged(i,r,t)}))}))}))},t.prototype._statusChanged=function(n,t,i){i===0?this._hideCommandForm(n):i===1&&this._loadDialog(n,t,f.unwrap(this._viewModel.dialog))},t.prototype._dialogChanged=function(n,t,i){this._viewModel.status()===1&&this._loadDialog(n,t,i)},t.prototype._loadDialog=function(n,t,r){var u=this;if(n&&(!i.deepEquals(this._currentDialogOptions,r)||!t.hasOpenDialog))if(this._currentDialogOptions=r,ot(r))this._hideCommandForm(n);else{if(!this._target())return;var o=$(n.getForm()),f=this._commandContainer.locator,s=f&&f.withCommand(this.commandItem.commandName);this.commandItem.pressed(!0);t.showDialog(o,r,s).then((function(n){u.commandItem.pressed(!1);var t=u._viewModel,i=t&&t.dialogClick;typeof i=="function"&&i.call(t,n)}));n.showForm(e.getBox(this._target()))}},t.prototype._hideCommandForm=function(n){n&&n.hideForm()},t})(nt),vi=(function(n){function t(t,i,r){var u=n.call(this,t,i,r)||this;return u._viewModel=i.content,u.canSkipBladeValidation=!0,u}return __extends(t,n),t.prototype.execute=function(t){var i=this._viewModel,r=i.navigateTarget?i.navigateTarget():"_blank";n.prototype.execute.call(this,t);et.open(i.navigateUri(),r)},t})(nt),wt=(function(n){function t(t,i,r){var u=n.call(this,t,i,r)||this;return u.canSkipBladeValidation=!0,u}return __extends(t,n),t.prototype._getDlgElem=function(n){var t=n&&n.getForm();return t&&$(t)},t.prototype._getLocator=function(){var n=this._commandContainer.locator;return n&&n.withCommand(this.commandItem.commandName)},t.prototype._showUriCbProgressDlg=function(n,t,i){this._showProgressDlg(n,t,this._uriCbProgressTitle,this._uriCbProgressText,i)},t.prototype._showDownloadProgressDlg=function(n,t,i){this._showProgressDlg(n,t,this._progressTitle,this._progressText,i)},t.prototype._showProgressDlg=function(n,t,i,r,u){var f=new ei.ProgressBox(i,r);t.showDialog(this._getDlgElem(n),f,this._getLocator());this._showForm(n,u)},t.prototype._showForm=function(n,t){t&&n&&n.showForm(e.getBox(this._target()))},t.prototype._hideForm=function(n,t){t&&n&&n.hideForm()},t.prototype._getResources=function(n){var t=n.uriCallbackConfirmationDialogOptions||{},i=n.downloadProgressDialogOptions||{};this._uriCbProgressTitle=t.uriCallbackProgressTitle||k.uriCallbackProgressTitle;this._uriCbProgressText=t.uriCallbackProgressText||k.uriCallbackProgressText;this._dnldTitle=t.downloadTitle||k.downloadTitle;this._dnldText=t.downloadText||k.downloadText;this._defaultBtnText=t.defaultButtonText||k.defaultButtonText;this._cancelBtnText=t.cancelButtonText||k.cancelButtonText;this._progressTitle=i.downloadProgressTitle||k.downloadProgressTitle;this._progressText=i.downloadProgressText||k.downloadProgressText},t})(nt);kt=(function(n){function t(t,i,r){var u=n.call(this,t,i,r)||this;return u._viewModel=i.content,u._getResources(u._viewModel),u.canSkipBladeValidation=!0,u}return __extends(t,n),t.prototype.execute=function(t){var i=this;n.prototype.execute.call(this,t);var e=this._viewModel.navigateTarget?this._viewModel.navigateTarget():"_blank",r=this._viewModel,s=r.navigateUriCallback&&r.navigateUriCallback(),l=this.commandItem,h=l.fxEnabled,a=r.showUriCallbackConfirmationDialog&&r.showUriCallbackConfirmationDialog(),c=function(n){i._hideForm(n,t);h(!0)},u,f=!0;s&&a?(h(!1),Q.all([this._services.getService("DialogManager"),this._getFormTarget()]).spread((function(n,o){return i._dlgMgr=n,i._showUriCbProgressDlg(o,n,t),Q(r.navigateUriCallback()()).then((function(t){return f=!1,vt().then((function(r){var u=new r.MessageBox(i._dnldTitle,i._dnldText,2);u.defaultButtonText=i._defaultBtnText;u.cancelButtonText=i._cancelBtnText;n.showDialogWithCallback(i._getDlgElem(o),u,(function(n){n===4&&bt(t,e);c(o)}),i._getLocator())}))}),(function(n){ft(n)})).finally((function(){f&&(d.error(g.callbackError.format("navigateUriCallback failed.")),u&&u.close(),i._dlgMgr&&i._dlgMgr.dismissOpenDialog(),c(o))}))})).catch((function(n){d.error(n)}))):s?(h(!1),u=et.open("about:blank",e),Q(s()).then((function(n){f=!1;o.sanitizeUri(n)?u.location.href=n:(d.error(g.invalidUri.format(n)),ft(),u.close())}),(function(n){ft(n)})).finally((function(){f&&(d.error(g.callbackError.format("navigateUriCallback failed.")),u.close());i._getFormTarget().then((function(n){c(n)}))}))):bt(r.navigateUri(),e)},t})(wt);dt=(function(n){function t(t,i,r){var u=n.call(this,t,i,r)||this,s=u._ltm,h=u.commandItem,e=i.content,c=h.widgetViewModel,o=c.dialogOptions;return f.reactor(s,(function(){o.listItems(e.listItems())})),e.selectedItem.subscribe(s,(function(n){o.selectedItem(n)})),o.selectedItem(e.selectedItem()),h.hasPopup(!0),o.selectedItem.subscribe(s,(function(n){e.selectedItem(n)})),u.canSkipBladeValidation=!0,u}return __extends(t,n),t.prototype.execute=function(t){n.prototype.execute.call(this,t)},t})(nt);ni=(function(n){function t(t,i,r){var u=n.call(this,t,i,r)||this;return u._viewModel=i.content,u._getResources(u._viewModel),s.isSafari&&s.webKitVersion<s.safari_11_webKitVersion&&(u.commandItem.fxEnabled(!1),u.commandItem.tooltip(h.FileDownloadCommand.safariDownload)),u.canSkipBladeValidation=!0,u}return __extends(t,n),t.prototype.execute=function(t){var r=this;n.prototype.execute.call(this,t);var u=null,e=this.commandItem,f=e.fxEnabled;f()&&tt.Promises.cancelOnDispose(this._ltm,i.require("MsPortalImpl/Commands/FileDownloadUtil")).then((function(n){var i=r._viewModel,o=n.getHttpMethod(i),s=function(n){r._hideForm(n,t);f(!0)};if(!o){n.notifyError(i,ut,k.typeError);r._getFormTarget().then((function(n){s(n)}));return}f(!1);i.downloadStatus(null);var h=r._services.getService("DialogManager"),e=r._getFormTarget(),c=Q.all([h,e]).spread((function(n,i){return r._getUri(i,n,t)}));return Q.all([h,c,e]).spread((function(f,e,s){var h=e&&e.startsWith("data:");if(!ri.isUriAbsolute(e)&&!h){n.notifyError(i,ut,k.absoluteUriError);return}if(i.showDownloadProgressDialog&&i.showDownloadProgressDialog()&&r._showDownloadProgressDlg(s,f,t),u=it.startTrace({extension:r._extension.name,source:ht(r._context()),action:a.Action.StartFileDownload,name:r._viewModelName,data:t}),h)n.dataUriHandler(i,f,e);else return ci.ajaxExtended(n.getAjaxOptions(i,e,o)).then((function(t){if(r.viewModel){var e=t.content,o=e&&e.length?e.length:0;return n.onSuccess(i,f,e,t.textStatus,t.jqXHR).then((function(){it.completeTrace(u,o)}))}}),(function(t){n.onError(i,f,t.textStatus,t.jqXHR.status,t.errorThrown);return it.cancelTrace(u),Q.reject(t.errorThrown)}))})).catch((function(n){n&&d.error(n);it.cancelTrace(u)})).finally((function(){e.then((function(n){s(n)}))}))})).catch((function(n){n&&d.error(n)}))},t.prototype._getUri=function(n,t,r){var f=this,u=this._viewModel,e=u.targetUriCallback&&u.targetUriCallback(),o=u.showUriCallbackConfirmationDialog&&u.showUriCallbackConfirmationDialog();return tt.Promises.cancelOnDispose(this._ltm,i.require("MsPortalImpl/Commands/FileDownloadUtil")).then((function(i){if(e)return o&&f._showUriCbProgressDlg(n,t,r),Q(e()).then((function(r){return r?o?vt().then((function(i){var r=new i.MessageBox(f._dnldTitle,f._dnldText,2);return r.defaultButtonText=f._defaultBtnText,r.cancelButtonText=f._cancelBtnText,t.showDialog(f._getDlgElem(n),r,f._getLocator())})).then((function(n){return n===4?Q(r):Q.reject()})):(i.dismissDialog(t,u),Q(r)):Q.reject(k.uriError)})).catch((function(n){i.dismissDialog(t,u);var r=null;return n&&(r=u.errorMessage()||"{0} {1}".format(k.downloadTargetUriCallbackFailed,n),i.notifyError(u,ut,r)),Q.reject(r)}));var s=u.targetUri&&u.targetUri();return s?Q(s):(i.notifyError(u,ut,k.uriError),Q.reject(k.uriError))}))},t})(wt);ti=(function(n){function t(t,r,u){var f=n.call(this,t,r,u)||this,o,e;return f._container=u.container,f._viewModel=r.content,f._selectionInList=u.selectionInList,o=f._ltm,f._viewModel.viewModel.subscribeAndRun(o,(function(n){var t,s,h,r,u;e&&e.dispose();e=o.createChildLifetime();t=f._nestedCommand;t&&(t.dispose(),f._nestedCommand=undefined);n&&(s=f.viewModel,h={container:f._container,extension:f._extension,viewModelName:f._viewModelName,commandItem:f.commandItem,propertyBindings:null,services:f._services,selectionInList:f._selectionInList},f.commandItem.commandDefinition.details=li,yi(n,f._viewModelName),r=i.clone(s),r.content=n,u=n,u.bladeName&&r.container.selectable.selectedValue({detailBlade:u.bladeName,detailBladeInputs:u.bladeInputs}),t=f._nestedCommand=yt(e,n,r,h),t.init(),f.canSkipBladeValidation=t.canSkipBladeValidation)})),f}return __extends(t,n),t.prototype.execute=function(t){n.prototype.execute.call(this,t);this._nestedCommand?this._nestedCommand.execute(t):d.error("The nested command is missed for the {0} dynamic command.".format(this._viewModelName))},t.prototype.dispose=function(){this._nestedCommand&&this._nestedCommand.dispose()},t})(nt);lt=(function(n){function t(t,r,u){var f=n.call(this,t,r,u)||this,o,e;f._addedOutputPropertyBindings=[];f._outputBindingDefinitions=[];f._viewModel=r;f._containerViewModel=r.container;f._options=u;o=f.commandItem;e=o.commandDefinition;f._commandInstanceId=u.selectionInList?i.newGuid():undefined;var h=wi(e),s=e.details,c=f._validateDetailsDefinition(s);return h&&c?(f._outputBindingDefinitions=si.mapInputBindingDefinitions(s.outputArguments||[],u.container,(function(n){n.source.scope=hi.DetailsContainer})),f.getBladeOpener()):u.commandItem.setEnabled(!1),f.canSkipBladeValidation=!0,f}return __extends(t,n),t.prototype.getBladeOpener=function(){var n=this,t;return this._ltm?(t=this._ltm,this._bladeOpenerPromise||(this._bladeOpenerPromise=i.tryImmediateResolve(st||(st=i.require("MsPortalImpl/UI/Compositions/UI.Composition.BladeOpener")),(function(i){var u=n._options,r=i.create(n._getBladeOpenerConfig(u.container,u.extension));return r.registerInvocationProperty(n.commandItem.commandDefinition.details),t.registerForDispose(r),r})))):Q.reject(new i.Errors.DisposedCanceledError)},t.prototype.execute=function(t){var r=this;n.prototype.execute.call(this,t);i.tryImmediateResolve(this.getBladeOpener(),(function(n){if(!n||r._ltm&&!r._ltm.isDisposed()){var t=r._containerViewModel,i=t&&t.selectable;i?i.isSelected(!0):d.error("OpenBladeCommand '{0}' from extension '{1}' was not initialized with a Selectable.".format(r.commandItem.commandDefinition.name,r._extension.name))}}))},t.prototype._getBladeOpenerConfig=function(n,t){var r=this,o=this.commandItem.commandDefinition.details,s=o?!!o.parameterCollector:!1,e=this._services;return{services:e,masterModelId:"{0}-[{1}-{2}]".format(n.toString(),"OpenBladeCommand",this.commandItem.commandDefinition.name),masterModel:this._viewModel,referenceComposition:n,referenceExtension:t,isBladeOpenedByMaster:function(t){return t.masterCommandName===r.commandItem.commandDefinition.name&&t.masterPartId===n.id&&t.masterCommandId===r._commandInstanceId},configureBindings:function(t){rt(t,(function(t){var i=t.source,u=i&&i.modelType;u===4&&(i.modelId=r.commandItem.commandDefinition.name,v.isPartComposition(n)&&(i.partLocator=n.locator,i.id=n.id))}))},configureBladeDescriptor:function(t){var i,e,h;if(t.masterCommandName=r.commandItem.commandDefinition.name,t.masterCommandId=r._commandInstanceId,t.masterCommandExtension=r._extension,t.masterPartId=n.id,i=t.bindings,u.isArray(i))for(e=i.length-1;e>=0;e--){var c=i[e],o=c.source,l=o&&o.modelType;l===4&&(t.model[c.targetProperty]=f.toJS(w.getModelValue(r._viewModel,o.property).value),h=r.commandItem.sourceBindableContainer,!s&&h&&h.isPartListItem&&i.splice(e,1))}},onBladeOpened:function(n){r._setCmdActivated(!0);n.onDispose((function(){r._bladeOpenerPromise&&i.tryImmediateResolve(r._bladeOpenerPromise,(function(t){t.notifyDetailBladeClosed(n)}));r._disposeOutputBindings();r._setCmdActivated(!1)}));n.awaitComposed().then((function(){r._createOutputBindings(n)}))},getCloseOtherDetailBladesHandler:function(t,i){if(i.openInContextPane){if(n.getCompositionType()===oi.StartboardPart){var r=e.desktop.getActiveJourney();return!r||r.isStartedWithContextBlade()?null:function(){return e.desktop.tryDeactivateJourney()}}if(!e.diContainer.get(b.RightContextPane).opened.peek())return function(){return!0}}return null}}},t.prototype._createOutputBindings=function(n){var t=this;rt(this._outputBindingDefinitions,(function(i){var u=t._propertyBindings,r;u&&(r=u.mapProperty(i.source.property,i.targetProperty).bind(n.toString()+"LaunchCommandOutputBinding",n.getViewModel()),r.compositionBindingDefinition=i,t._addedOutputPropertyBindings.push(r))}))},t.prototype._disposeOutputBindings=function(){var n=this;this._propertyBindings&&rt(this._addedOutputPropertyBindings,(function(t){n._propertyBindings.removeProperty(t)}));this._addedOutputPropertyBindings.length=0},t.prototype._validateDetailsDefinition=function(n){var t=[],i=function(n){var t,i=n.invocationInputArguments;return n.isMultiple?t="Command cannot open multiple blades. isMultiple value must be false.":i&&i[0].valuesFrom[0].referenceType!==4&&(t="Command invocation argument reference type can only be of type Command."),t},r=y.validateDetailsDefinition(n,t,i);return t.length&&d.error("{0} Command: '{1}'. Details: '{2}'.".format(t[0],this.commandItem.commandDefinition.name,JSON.stringify(n))),r},t.prototype._setCmdActivated=function(n){var t=this._commandContainer.getViewModel(),i=t&&t.container,r=i&&i.selectable;r&&r.isCommandSelected(n);this.commandItem.pressed(n)},t})(nt);ii=(function(n){function t(t,i,r){var o=n.call(this,t,i,r)||this,s=o._ltm,h=o.commandItem,u=i.content,c=h.widgetViewModel,e=c.dialogOptions;return f.reactor(s,(function(){e.listItems(u.listItems())})),u.selectedItem.subscribe(s,(function(n){e.selectedItem(n)})),e.selectedItem(u.selectedItem()),h.hasPopup(!0),e.selectedItem.subscribe(s,(function(n){u.selectedItem(n)})),o}return __extends(t,n),t.prototype.execute=function(t){n.prototype.execute.call(this,t)},t})(lt);t.setBladeOpenerModule=bi}));
define("MsPortalImpl/UI/Compositions/UI.Composition.Base",["require","exports","f","i","o","ko","$","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/Widgets/Widgets.UIElementBase","MsPortalImpl/Services/Services.Settings.Schema"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";function a(n,t,r){r=r||i.getUniqueId();var u=k[n];return u+=!t?"":"-"+t.name,u+("-"+r)}function d(n,t,r,u){return i.tryImmediateResolve(i.require(t,u),(function(t){if(!n||!n.isDisposed())try{return r(t)}catch(i){return Q.reject(i)}}))}function g(n){var t=e.Deferred();return n.then((function(n){t.resolve(n)})).catch((function(n){t.reject(i.getLogFriendlyMessage(n))})),t.promise()}function y(n,t){for(var i=n,r;i;)(i.hasOwnProperty(t)||typeof i[t]=="function")&&(r=i),i=i.parent;return r||c.error("Could not locate container with property or function '"+t+"' for composition '"+n+"'."),r}var v;u.defineProperty(t,"__esModule",{value:!0});var p=r.TriggerableLifetimeManager,w=i.Base,b=w.Diagnostics,k=o.CompositionType,c=b.createLog(n),l=o.getIdMatchFunc;t.createIdentifier=a;t.compositionRequire=d;v=(function(n){function t(t,r,u,o,s,h){var c=n.call(this)||this;if(c._childObjects=f.observableArray(),c._disposeCallbacks=e.Callbacks("memory once"),c._composedDeferred=i.Helpers.Deferred(),!r)throw new Error("CompositionServices are required.");return c.services=r,c.locator=u,c.id=h||c.createIdentifier(),c.widgetState=f.observable(s||{}),c._addChildrenInternal(o),c._toStringPrefix="{ Name: "+(t||"<NOT SPECIFIED>")+", Type: ",c}return __extends(t,n),u.defineProperty(t.prototype,"children",{get:function(){return this._childObjects()},enumerable:!0,configurable:!0}),t.prototype.subscribeChildren=function(n){return this._childObjects.subscribe(this,n)},u.defineProperty(t.prototype,"templateKey",{get:function(){return""+(this.locator||this.id)},enumerable:!0,configurable:!0}),t.prototype.getPerfData=function(){return{}},t.prototype.getCompositionType=function(){throw new Error("The getCompositionType method is not implemented.");},t.prototype.getCreationState=function(){return this._creationState},t.prototype.toString=function(){var n=this._toStringPrefix,t=this._toStringPostfix||(this._toStringPostfix=", Id: "+this.id+" }");return n+=this.locator||"<null>",n+t},t.prototype.compose=function(n){for(var r,i=[],t=1;t<arguments.length;t++)i[t-1]=arguments[t];r=[n,this._composedDeferred].concat(i);this._compose.apply(this,r)},t.prototype._compose=function(){for(var t=[],n=2;n<arguments.length;n++)t[n-2]=arguments[n];throw new Error("Not implemented.");},t.prototype.resetLayout=function(){var n=this.children;n&&n.forEach((function(n){n.resetLayout()}))},t.prototype._attachWidgetErrorEvent=function(){var n=this;if(!this.widget)throw new Error("Cannot attach to error event of undefined widget.");this.registerForDispose(e(this.widget).setEvents([s.Widget.errorEvent,function(t,i){c.error("[Widget Error] {0}\nCurent State: {1}".format(i,f.toJSON(n.getDiagnosticsData(),null,2)))}]))},t.prototype.dispose=function(t){this.isDisposed()||(n.prototype.dispose.call(this),this._disposeCallbacks.fire(),t||this._deleteSetting(),this.children.slice(0).forEach((function(n){n.dispose(t)})))},t.prototype._deleteSetting=function(){if(this._store!==undefined)this.services.sharedSettings.deleteSettings({store:this._store,keys:[this.id]});else if(this.parent){var n=this.parent.children,t=n.first(l(this.id));t&&n.remove(t);this.parent.save()}},t.prototype.save=function(n){if(this._store!==undefined){if(this.services.settings){var t=this.toJSON();this.services.settings.setSetting(this._store,this.id,JSON.parse(JSON.stringify(t)));n===1&&this.services.settings.flushSettings()}}else this.parent&&this.parent.save(n)},u.defineProperty(t.prototype,"isComposed",{get:function(){return this.awaitComposed().state()==="resolved"},enumerable:!0,configurable:!0}),t.prototype.getLoadDelayed=function(){return this._loadDelayed},t.prototype.awaitComposed=function(){return this._composedDeferred.promise()},t.prototype.awaitOnInputsSetComplete=function(){return Q.resolve(null)},t.prototype.awaitContentRevealed=function(){return Q.resolve(!1)},t.prototype.onDispose=function(n){this._disposeCallbacks.add(n)},t.prototype.offDispose=function(n){this._disposeCallbacks.remove(n)},t.prototype.addChild=function(n,t,i){i===void 0&&(i=!0);n&&this.addChildren([n],t,i)},t.prototype.addChildren=function(n,t,i){i===void 0&&(i=!0);this._addChildrenInternal(n,t);i&&this.save()},t.prototype._addChildrenInternal=function(n,t){var r=this,i;t===void 0&&(t=this.children.length);n&&n.length>0&&(i=this._childObjects(),n.forEach((function(n){i.splice(t,0,n);n.parent=r;t++;r.addChildWidget(n.widget)})),this._childObjects(i))},t.prototype.sortChildren=function(n){this._childObjects(this._childObjects().stableSort(n))},t.prototype.removeChildren=function(n){for(var t=this.children.length-1;t>=0;t--)this.removeChildAt(t,n,!1);this.save()},t.prototype.removeChildAt=function(n,t,i){if(i===void 0&&(i=!0),n>=0){var r=this._childObjects.splice(n,1)[0];this.removeChildWidget(r.id,t);t||r.dispose();i&&this.save()}},t.prototype.replaceChild=function(n,t){var i=this._childObjects,r;n&&t&&i&&(r=i.indexOf(n),r>=0&&(i.splice(r,1,t),t.parent=this,this.save()))},t.prototype.removeChild=function(n,t,i){if(i===void 0&&(i=!0),n&&this._childObjects){var r=this._childObjects.indexOf(n);this.removeChildAt(r,t,i)}},t.prototype.addChildWidget=function(n){this.widget&&n&&this.widget.addChild(n)},t.prototype.removeChildWidget=function(n,t){this.widget&&this.widget.removeChild(n,t)},t.prototype.getChildById=function(n){return this._childObjects?this._childObjects().first(l(n)):null},t.prototype.toJSON=function(n){var t={},i=this.children,r=n?i.filter(n):i;return this.id!==h.startBoardSettingsKey&&r.forEach((function(n){t[n.id]=n.toJSON()})),{id:this.id,locator:this.locator,widgetState:this.widgetState(),errorMessage:this.unrecoverableErrorMessage,children:r.map((function(n){return n.id})),childSettings:t}},t.prototype.loadFromJson=function(n){this.unrecoverableErrorMessage=n.errorMessage},t.prototype.getPartsContainer=function(){return this._partsContainer||(this._partsContainer=y(this,"masterContainer")),this._partsContainer},t.prototype.getBindableContainer=function(){return this._bindableContainer||(this._bindableContainer=y(this,"getViewModel")),this._bindableContainer},t.prototype.getTemplate=function(){return{key:this.templateKey,locator:this.locator.toJSON(),widgetId:this.id,widgetState:f.toJS(this.widgetState),children:this.children.map((function(n){return n.getTemplate()}))}},t.prototype.getDiagnosticsData=function(){return e.extend(this.toJSON(),{id:this.id,name:this._name,locator:this.locator&&this.locator.toString(),errorMessage:this.unrecoverableErrorMessage,children:(this.children||[]).map((function(n){return n.getDiagnosticsData()}))})},t.prototype.definitionExists=function(n){var t=this.services.finder,i=this.locator;return t.tryLocate(i,{})?0:t.tryLocate(i.getExtensionLocator(),{})&&n?1:2},t.prototype.discardWidgetStateOfUnusedChildren=function(){if(this.widget){var n=this.widget.discardStateOfUnusedChildren();n&&n.stateDiscarded&&c.warning("Unused widget state was discarded for composition '{0}'. \n{1} \nCurrent Children: {2}\nCurrent Widget State: {3}".format(this,n.message,JSON.stringify((this.children||[]).map((function(n){return""+n}))),JSON.stringify(this.widgetState())))}},t.prototype._markAsComposed=function(){this._composedDeferred.resolve()},t.prototype.createIdentifier=function(){return a(this.getCompositionType(),this.locator)},t})(p);t.Instance=v;t.QtoJ=g}));
define("MsPortalImpl/UI/Compositions/UI.Composition.Security",["require","exports","f","i","ko","$","MsPortalImpl/AsyncLoader","MsPortalImpl/Services/Services.AssetTypes","MsPortalImpl/Services/Services.Permissions"],(function(n,t,i,r,u,f,e,o,s){"use strict";var h;return (function(n){function c(n,t,i,u,f,e,s){if(n&&n.length){if(h[t]===undefined)return r.QReject("checkPermission: unexpect requirement: "+t);var a=t===h.All;return n.reduce((function(n,t){return n.then((function(r){var h,y,v;if(d(a,r))return n;if(h=void 0,t.permissionType===0)y=t,h=l(y,i,u,f,e,s);else if(t.permissionType===1)v=t,h=c(v.permissions,v.requirement,i,u,f,e,s);else throw new Error("unexpected permission.permissionType: "+t.permissionType);return h.catch((function(n){var t=o.warning;return t.call(o,n,1,["Failed check permissions:","compositionInfo:"+s,"reason: "+n].join("\n")),Q(!0)}))}))}),Q(a))}return Q(!0)}function l(n,t,i,r,f,h){if(!n)return Q(!1);var l=function(t){return f.diContainer.get(s.PermissionsManager).hasPermission(t,[n.action])},c;switch(n.assetId.sourceType){case 0:c=Q(t[n.assetId.property]);break;case 1:c=a(n,t,i,r,f);break;case 2:c=a(n,t,n.assetType||i,n.extensionName||r,f)}return c.then((function(t){var s,c,v,y,a;return t=u.unwrap(t),s=n.extensionName||r,c=n.assetType||i,g(t)?l(t):f.assetTypeService.hasAssetType(s,c,2)?(v=o.warning,y="",v.call(o,["Performance Warning: assetId is not in the form of resourceID. This result in slow code path to perform the conversion. Please contact the extension below to improve performance","assetTypeExtension: "+s+", assetType: "+c,"composition: "+(h||""),y,].join("\n")),a=f.assetTypeService.getAssetType(s,c,2),e.resourceMapManager(f.diContainer).then((function(n){return n.mapAssetIdToResourceId({extensionName:a.extension,assetType:a.assetTypeManifest.name,assetId:t})})).then((function(n){return l(n)}))):Q(!1)}))}function a(n,t,r,u,e){var o="[getAssetIdFromPropertyProvider]:";return e.extensionManager.getExtensionByName(u).then((function(u){var e=u.getManifest("assetTypes").assetTypes.first((function(n){return n.name===r}));if(!e)throw new Error(o+"Unknown extension Asset Type : "+r);return u.getViewModel(e.propertyProviderServiceViewModel).then((function(r){var e=new y;return e.registerForDispose((function(){i.disposeViewModelProperties(r);u.releaseViewModel(r)})),Q.fcall((function(){var i=r.content,u=i&&i.onInputsSet,e,s;if(typeof u=="function")return e=f.extend({providerKey:n.assetId.providerKey},t),s=u.call(i,e)||Q(),s.then((function(){var u=i.properties(),t=n.assetId.property,r=u.first((function(n){return n.property===t}));if(r)return r.value;throw new Error(o+"Can not find propertyDefinition for assetIdProperty: "+t);}));throw new Error(o+"ViewModel.content.onInputsSet is not a function.");})).finally((function(){e.dispose();e=null}))}))}))}function g(n){return n&&v.some((function(t){return t(n)}))}var y=r.TriggerableLifetimeManager,p=i.Base,w=p.Diagnostics,b=i.Extension,h=b.SetRequirement,k=i.ViewModels,t=k.Services.ResourceTypes,o=new w.Log("UI/Composition/Security"),d=i.xor,v;n.checkPermissions=c;n.checkPermission=l;v=[t.isResourceGroupId,t.isResourceId,t.isTenantResource,t.isSubscriptionId]})(h||(h={})),h}));
define("MsPortalImpl/Widgets/Widgets.CommandBarBase",["require","exports","f","o","ko","$","MsPortalImpl/Interactions/Interactions.Command","MsPortalImpl/Base/Telemetry"],(function(n,t,i,r,u,f,e,o){"use strict";var s;return (function(n){function c(n){return typeof n=="string"}var h=i.Base.Diagnostics.Telemetry,l=i.ViewModels.Dialogs,t=(function(n){function t(t,r,e,o){var s=this,l=o&&o.commandName,h;return s=n.call(this,t,r.label)||this,h=s._ltm,s._executeLifetime=o&&o.executeLifetime||h,s._model=r,s._locator=e,s.icon=u.computed(h,{read:function(){var n=u.unwrap(s._model.icon);return n&&i.extend2(n,{options:f.extend({palette:99},n.options)})},write:s._model.icon}),s.commandName=l||i.getUniqueId(),s.enabled=u.computed(s._executeLifetime,(function(){var n=r,t=!r.disabled(),i=!n.command||n.command.canExecute();return t&&i})),u.computed(h,(function(){s.unauthorized(!!u.unwrap(r.unauthorizedMessage))})),u.computed(h,(function(){var n=u.unwrap(r.unauthorizedMessage),t;n||(t=u.unwrap(r.disabled),n=c(t)?t:null);n=n||u.unwrap(r.tooltip);s.tooltip(n)})),s.isSeparator=u.observable(r.type===12),s}return __extends(t,n),r.defineProperty(t.prototype,"model",{get:function(){return this._model},enumerable:!0,configurable:!0}),r.defineProperty(t.prototype,"type",{get:function(){return this._model&&this._model.type},enumerable:!0,configurable:!0}),t.prototype.execute=function(t){h.trace({source:this._locator&&this._locator.toFriendlyString(),action:o.Action.CommandExecuted,name:this.model.name||"Toolbar name not specified",extension:this._locator&&this._locator.getExtensionLocator().name});n.prototype.execute.call(this,t)},t})(e.CommandImpl),s;n.ItemViewModel=t;s=(function(n){function t(t,i,r,f,e){var o=n.call(this,t,i,r,e)||this,s;return o.hasOpenDialog=u.observable(!1),o._services=f,s=i.dialogOptions,o.hasPopup(!!s&&s.type===4),o}return __extends(t,n),r.defineProperty(t.prototype,"dialogOptions",{get:function(){return this._model.dialogOptions},enumerable:!0,configurable:!0}),t.prototype.execute=function(t){var r=this;i.Base.Promises.cancelOnDispose(this._executeLifetime,Q.all([this._services.getService("DialogManager"),this._currentContext.getFormTarget()]).spread((function(u,e){if(r.hasOpenDialog())u.dismissOpenDialog(),r.hasOpenDialog(!1);else{var o=r._currentContext,s=o&&o.target,c=e&&e.getForm(),h=r._model;r.hasOpenDialog(!0);i.Base.Promises.cancelOnDispose(r._executeLifetime,u.showDialog(f(c),r.dialogOptions,r._locator)).then((function(n){r.hasOpenDialog(!1);h.command&&h.command.execute(n);e&&e.getDismissHandler&&e.getDismissHandler()&&(e.hideForm(),e.getDismissHandler().restoreFocus())}),(function(){r.hasOpenDialog(!1)}));e&&s&&i.Base.Promises.cancelOnDispose(r._executeLifetime,i.require("Viva.Controls/Controls/Viva.Balloon")).then((function(n){e.showForm(n.getBox(s))}))}n.prototype.execute.call(r,t)})))},t})(t);n.DialogButton=s})(s||(s={})),s}));
define("MsPortalImpl/UI/Commands/UI.Commands",["require","exports","f","i","o","a","ko","MsPortalImpl/Base/Base.SelectableSet2","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl.Controls/Fields/Base/FormValidation","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Interactions/Interactions.Command","MsPortalImpl/UI/Compositions/UI.Composition.Base","MsPortalImpl/UI/Compositions/UI.Composition.CompositionBinder","MsPortalImpl/UI/Compositions/UI.Composition.Security","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/UI/Commands/UI.ExtensionCommands","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.CommandBarBase","MsPortalImpl/Base/Base.KnockoutExtensions.OverrideComputed"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k){"use strict";function kt(n){return w.getCommandSourceTelemetryName(n)}function dt(n){var t=b.Widget.getWidget(n,null);if(n.hasClass("fxs-bladecontent"))return t}function gt(n){var t=b.Widget.getWidget(n,null);if(n.hasClass("fxs-blade"))return t}function ni(n,t,i){var r=i.commandGroupReference,u=r?r.name:i.commandGroup;return u?n.locate(it.forExtension(t).withCommandGroup(u)):null}function st(n,t,i,r,u){var f=new pt.DialogButton;return f.dialogOptions=new yt.ListPopup,f.dialogOptions.type=u?4:0,new k.DialogButton(n,f,r.locator.withCommand(t.name),i,t.name)}function ti(n,t,i,r,u,f){var e={name:f,details:{invocationInputArguments:[{valuesFrom:[{property:"container.selectable",referenceType:4}]}]}};return ct(n,t,i,(function(n,t){return new d.OpenBladeCommand(t)}),e,r,u,f)}function ii(n,t,i,r,u,f,e){return ct(n,t,i,(function(){var n=new d.UriCommand;return n.navigateUri=e.uri,n.navigateTarget=e.target,n}),{name:f},r,u,f)}function ct(n,r,u,f,e,o,s,h){var a="__{0}ViewModel__".format(h),c=i.Extension.composeViewModel(f,a,undefined,!0),l=new nt(n,s,u,e,o,r),y={container:u,extension:s,viewModelName:a,commandItem:l,propertyBindings:null,services:r,selectionInList:!1},v=w.createExtensionCommand(n,c.content,c,y);return l.bind(new t.CompositionInstanceCommandContext(null,null,u)),n.registerForDispose([c.container,l,v]),v}var g,ot,nt,ht;u.defineProperty(t,"__esModule",{value:!0});var it=s.Locator,rt=i.Base,lt=rt.Diagnostics,ut=rt.Images,at=i.Extension,vt=at.SetRequirement,d=i.ViewModels,yt=d.Dialogs,pt=d.Toolbars,wt=v.CompositionBinder,bt=i.Helpers,ft=lt.createLog(n),et=c.Commands,tt=i.uncurryThis(f.prototype.forEach);t.CompositionInstanceCommandContext=w.CompositionInstanceCommandContext;t.getCommandSourceTelemetryName=kt;t.getBladeContentWidget=dt;t.getBladeContainerWidget=gt;t.getCommandGroupForDefinitionItem=ni;g=(function(n){function t(t,i,r,u,f){var o=this,s=e.observable(!1);return o=n.call(this,t,r)||this,o.commandName=i,o._services=f,o._compositionContainer=u,o.enabled=s.extend({allowOverride:u}),o._init(f.desktop),o}return __extends(t,n),u.defineProperty(t.prototype,"services",{get:function(){return this._services},enumerable:!0,configurable:!0}),u.defineProperty(t.prototype,"container",{get:function(){return this._compositionContainer},enumerable:!0,configurable:!0}),u.defineProperty(t.prototype,"sourceBindableContainer",{get:function(){return null},enumerable:!0,configurable:!0}),t.prototype._init=function(n){var t=this;e.reactor(this._ltm,(function(){var i=t.enabled,r=n.commandsEnabled();r&&n.mode()!==1?i.restoreLastWrittenValue():i.override(!1)}))},t})(l.CommandImpl);t.ExtensionCommandMenuItemBase=g;ot=(function(n){function t(t,i,r,u,f,s,h){var c=this,l=u.name;c=n.call(this,t,l,u.text,r,s)||this;var a=c._ltm,v=r+"[Command: "+l||u.text+"]",y=o.getSelectedItems(h);return c._subcommands=y.map((function(n){var t={viewModel:n.data,viewModelName:v,isPartListItem:!0};return new nt(a,i,r,u,f,s,t)})),e.reactor(a,(function(){var n=c._subcommands.reduce((function(n,t){return t.enabled()&&n}),!0);c.enabled(n)})),c}return __extends(t,n),t.prototype.bind=function(n){tt(this._subcommands,(function(t){t.bind(n)}))},t.prototype.activate=function(){tt(this._subcommands,(function(n){n.activate()}))},t.prototype.execute=function(n){tt(this._subcommands,(function(t){t.execute(n)}))},t})(g);t.ExtensionMultiselectCommandMenuItemImpl=ot;nt=(function(t){function o(n,i,r,u,f,e,o,s){var h=t.call(this,n,u.name,u.text,r,e)||this;return h._extension=i,h._commandDefinition=u,h._commandContainerDefinition=f,h._sourceBindableContainer=o,h._selectionInList=s,h}return __extends(o,t),o.prototype.extensionName=function(){return this._extension&&this._extension.name},u.defineProperty(o.prototype,"commandDefinition",{get:function(){return ft.assert(!this._commandDefinition.reference,"External CommandDefinition not resolved."),this._commandDefinition},enumerable:!0,configurable:!0}),o.prototype.getInputBindingsFromDefinition=function(n){var i,t=this._getCommandReference(n);return t&&f.isArray(t.bindings)&&t.bindings.length>0?i=t.bindings:n&&(i=n.bindings),i||[]},u.defineProperty(o.prototype,"widgetViewModel",{get:function(){return this._widgetViewModel},enumerable:!0,configurable:!0}),u.defineProperty(o.prototype,"sourceBindableContainer",{get:function(){return this._sourceBindableContainer},enumerable:!0,configurable:!0}),o.prototype.activate=function(){this._loadViewModel()},o.prototype.execute=function(n){var t=this,i=this.widgetViewModel,r=i&&i.dialogOptions;r&&r.type&&i.type===5?this._getFormTarget().then((function(i){var f=i&&i.getForm(),u=t.container.locator,e=u&&u.withCommand(t.commandName);t._services.getService("DialogManager").then((function(n){return n.showDialog($(f),r,e)})).then((function(){t._execute(n)}))})):this._execute(n)},o.prototype.getCommandContext=function(){return this._currentContext},o.prototype._getFormTarget=function(){return this._currentContext&&this._currentContext.getFormTarget()},o.prototype._target=function(){return this._currentContext&&this._currentContext.target},o.prototype._getCommandReference=function(n){var t=this._commandContainerDefinition&&this._commandContainerDefinition.commandGroupReference,i=null;return t&&t.commands&&n.name&&(i=t.commands.first((function(t){return t.name===n.name}))),i},o.prototype._execute=function(n){var i=this,u=this._currentContext.compositionInstance,r;if(!this._extensionCommand){this._loadViewModel();return}r=u&&u.widget;r&&!this._extensionCommand.canSkipBladeValidation?(this._overrideEnabledPropertyWith(!1),h.ensureFormFieldValidation(r.element).then((function(r){t.prototype.execute.call(i,n);i._extensionCommand.execute(n,r)})).finally((function(){i._clearEnabledPropertyOverride()}))):(t.prototype.execute.call(this,n),this._extensionCommand.execute(n))},o.prototype.dispose=function(){var r=this,n=this._viewModelLoadedPromise,i=function(){t.prototype.dispose.call(r)};n&&(n.done(i),this._viewModelLoadedPromise=null);i()},o.prototype.setEnabled=function(n){this._extensionEnabledProperty=n;this._overrideEnabledProperty||this.enabled(n)},o.prototype.getViewModel=function(){var n=this._extensionCommand;return n&&n.viewModel},o.prototype.getViewModelAsync=function(){return this._loadViewModel(),this._viewModelLoadedPromise},u.defineProperty(o.prototype,"canRebind",{get:function(){var n=this._getContentViewModel(),t=n&&e.unwrap(n.status);return t!==1},enumerable:!0,configurable:!0}),o.prototype._getContentViewModel=function(){var n=this.getViewModel();return n&&n.content},o.prototype._overrideEnabledPropertyWith=function(n){this._overrideEnabledProperty=!0;this.enabled(n)},o.prototype._clearEnabledPropertyOverride=function(){this._overrideEnabledProperty&&(this._overrideEnabledProperty=!1,this.enabled(this._extensionEnabledProperty))},o.prototype._resolveCommandDefinition=function(){var n=this,r,t=this._commandDefinition,u,f;return t.reference?(u=it.forExtension(t.reference.extension||this._extension.name),f=u.withCommandType(t.reference.commandType),this.icon(ut.Loading.EllipsisSquare()),this.text(et.loading),r=a.QtoJ(this.services.finder.locateAsync(f)).then((function(r){n._extension=n.services.finder.locate(u,n._extension.name);var f=n.getInputBindingsFromDefinition(t);n._commandDefinition=i.extend2(r,{name:t.name});f.length>0&&(n._commandDefinition.bindings=f);n.text(r.text)}))):r=bt.Deferred().resolve().promise(),r},o.prototype._logError=function(t){r.Rpc.client.log(this._extension.name,{level:2,code:0,area:n.normalize("."),message:i.getLogFriendlyMessage(t)+" \nCommand name: "+this._commandDefinition.name+" \nView model name: "+this._commandDefinition.viewModel})},o.prototype._createExtensionCommandHandler=function(n){var e=this,o=this._ltm,u;if(o){var h=n.content,t=o.createChildLifetime(),f={container:this.container,extension:this._extension,viewModelName:this._commandDefinition.viewModel,commandItem:this,propertyBindings:null,services:this._services,selectionInList:this._selectionInList},s=new ht(t,n,f);s.init();f.propertyBindings=s.propertyBindings;u=this._extensionCommand=w.createExtensionCommand(t,h,n,f);u?(t.registerForDispose([u]),u.init()):this._logError(r.createError("Error loading command view model. Unknown view model type."));n.container.unauthorizedMessage.subscribeAndRun(t,(function(t){e.unauthorized(!i.isNullOrUndefined(t));e.tooltip(t||n.content.tooltip&&n.content.tooltip())}))}},o.prototype._loadViewModel=function(){var n=this,t;if(!this._viewModelLoadedPromise){if(t=this._ltm,!t)return;this._viewModelLoadedPromise=this._resolveCommandDefinition().then((function(){if(t=n._ltm,t){var u=n._extension,i=n._commandDefinition,r=i.commandKind===4;return(!i.commandKind||r)&&(n._widgetViewModel=st(n._ltm,i,n._services,n.container,r)),a.QtoJ(u.getViewModel(i.viewModel,{createSelectable:!0}))}}));this._viewModelLoadedPromise.done((function(i){(t=n._ltm,t)&&(i.content.lc2&&(n._widgetViewModel=st(t,n._commandDefinition,n._services,n.container,!0)),n._createExtensionCommandHandler(i))})).fail((function(t){n.icon(ut.Blank());n.text(et.failedToLoad);n._logError(r.createError("Error loading command view model.\nReason: {0}".format(t)))}))}},o})(g);t.ExtensionCommandMenuItemImpl=nt;ht=(function(){function n(n,t,i){var u=this,r;this._onInputsSetPending=e.observable(!1);this._hasPermissions=e.observable(!0);this._extension=i.extension;this._viewModelName=i.viewModelName;this._composedViewModel=t;this._commandViewModel=t.content;this._commandItem=i.commandItem;this._services=i.services;r=this._ltm=n.createChildLifetime();this._initializeInputBindings(i.container,i.commandItem);r.registerForDispose((function(){u._commandViewModel=null}))}return n.prototype.init=function(){var n=this._commandViewModel,t=this._commandItem;e.isObservable(n.icon)&&n.icon.subscribeAndRun(this._ltm,t.icon);e.isObservable(n.text)&&n.text.subscribeAndRun(this._ltm,(function(n){return n!==undefined&&t.text(n)}));e.isObservable(n.ariaLabel)&&n.ariaLabel.subscribeAndRun(this._ltm,t.ariaLabel);e.isObservable(n.tooltip)&&n.tooltip.subscribeAndRun(this._ltm,t.tooltip);e.computed(this._ltm,[n.enabled,this._hasPermissions,this._onInputsSetPending,],(function(n,i,r){return t.setEnabled(n&&i&&!r)}))},u.defineProperty(n.prototype,"propertyBindings",{get:function(){return this._propertyBindings},enumerable:!0,configurable:!0}),n.prototype.dispose=function(){this._ltm&&(this._ltm.dispose(),this._ltm=null)},n.prototype._initializeInputBindings=function(n,t){var i=this,o=this._ltm,s,r,h,u;o&&(s=t.getInputBindingsFromDefinition(t.commandDefinition),r={bindableTarget:{viewModelName:n.toString()+"-["+this._viewModelName+"]",viewModel:this._composedViewModel},inputs:s,referenceComposition:n,referenceCompositionIsContainer:!0,customBindHandler:function(n){var i=t.sourceBindableContainer;if(i&&i.viewModel&&n.source.modelType!==0)return{sourceModelName:i.viewModelName,sourceModel:i.viewModel}},beforeViewModelPropertyUpdate:function(r){var u=t.commandDefinition,f;return u&&u.permissions?(i._hasPermissions(!1),f=n&&n.locator&&n.locator.toString()+"-",f=(f||"")+u.name,y.checkPermissions(u.permissions,vt.All,r,u.assetType,i._extension.name,i._services,f).then((function(n){return i._updateForHasPermissions(n),n}))):(i._updateForHasPermissions(!0),Q(!0))}},r.inputs&&f.isArray(r.inputs)&&r.inputs.length>0&&(this._onInputsSetPending(!0),r.inputsSetCalled=function(r,u){i._onInputsSetPending(!0);i._currentOnInputsSetPromise=u;u.then((function(){i._currentOnInputsSetPromise===u&&i._onInputsSetPending(!1)}),(function(u){ft.error("Command '{0}' on composition '{1}' rejected its onInputsSet promise.\nView Model Name: {2}\nInputs Provided: {3}\nReason: {4}".format(t.commandName,n.toString(),i._viewModelName,e.toJSON(r),u||"N/A"))}))}),h=wt.bindViewModelInputs(r),u=this._propertyBindings=h.propertyBindings,o.registerForDispose((function(){u&&(u.unbind(),i._propertyBindings=null)})))},n.prototype._updateForHasPermissions=function(n){var t=this._composedViewModel&&this._composedViewModel.container;t&&(n?t.unauthorizedMessage(undefined):t.unauthorized());this._hasPermissions(n)},n})();t.createOpenBladeCommand=ti;t.createOpenLinkCommand=ii}));
define("MsPortalImpl/UI/Dashboard/DashboardRepository",["require","exports","o"],(function(n,t,i){"use strict";i.defineProperty(t,"__esModule",{value:!0});t.ArmDashboardRepository="ArmDashboardRepository";t.PrivateDashboardRepository="PrivateDashboardRepository";t.RecommendedDashboardRepository="RecommendedDashboardRepository";t.SessionDashboardRepository="SessionDashboardRepository"}));
define("MsPortalImpl/UI/Dashboard/ArmDashboardRepository",["require","exports","f","i","o","MsPortalImpl/UI/Dashboard/DashboardRepository","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/AsyncLoader"],(function(n,t,i,r,u,f,e,o){"use strict";function c(n){try{return g.parseResourceDescriptor(n)}catch(t){return nt.error(t,0,"Failed to parse ARM dashboard id '"+n+"'."),null}}function v(n){var e=n.tags&&n.tags[l]||n.name,t=n.properties,r=t&&t.metadata,o=r&&r.model||{},i=t&&t.lenses,f=i&&i["0"]&&i["0"].parts||{};return{title:e,model:o,parts:u.keys(f).map((function(n){return f[n]}))}}function s(n){var t=n.substr(h.length);return i.ensurePrefix(t,"/")}function y(n){return n.startsWith("/")&&(n=n.substr(1)),""+h+n}function p(n){return i.startsWith(n,h)}function tt(n,t){return t.length?n.filter((function(n){if(!p(n.id))return!0;var r=s(n.id),i=c(r);return i?t.indexOf(i.subscription)>-1:!1})):n}function b(n,t){var r={};return r[l]=n,i.extend2(t,r)}var w;u.defineProperty(t,"__esModule",{value:!0});var k=i.Base,d=k.Diagnostics,g=i.ViewModels.Services.ResourceTypes,nt=d.createLog(n),h="arm/",l="hidden-title",a=e.Dashboard.NotFound;t.normalizedDashboard=v;t.getArmDashboardId=s;t.buildDashboardId=y;t.filterDashboards=tt;w=(function(){function n(n,t,u){var f=this;this._permissionsManager=n;this._compressor=u;this._storageService=t;this._dashboardClient=i.memoizeQ((function(){return Q.all([r.Extension.getArmEndpointEndPoint.invoke(r.Rpc.client,r.Extension.getHubsWindowId(),undefined),o.armDashboardClient(),]).spread((function(n,t){var r=i.trimEnd(n,"/");return new t(r,f._storageService)}))}))}return n.prototype.getTypeName=function(){return f.ArmDashboardRepository},n.prototype.createDashboard=function(n){var t=this;return this._dashboardClient().then((function(r){var u=t._compressor.compress({id:"",title:"",settings:n.settings}),f={name:i.getUniqueId(),model:u.model,parts:u.parts,subscriptionId:n.extras.subscriptionId,resourceGroupName:n.extras.resourceGroupName,tags:b(n.title)};return r.createDashboard(f)})).then((function(n){return t._convertToDashboard(n)}))},n.prototype.readDashboard=function(n){var t=this;return this._dashboardClient().then((function(t){var i=s(n);return t.readDashboard(i)})).then((function(n){return t._convertToDashboard(n)}))},n.prototype.updateDashboard=function(n,t){var i=this,r=s(n);return this._dashboardClient().then((function(n){return t.title?n.readDashboard(r).then((function(n){return n.tags})):Q({})})).then((function(n){var u=i._compressor.compress({id:"",title:"",settings:t.settings}),f={model:u.model,parts:u.parts,tags:!t.title?undefined:b(t.title,n)};return i._dashboardClient().then((function(n){return n.updateDashboard(r,f)}))})).then((function(n){return i._convertToDashboard(n)}))},n.prototype.deleteDashboard=function(n){return this._dashboardClient().then((function(t){var i=s(n);return t.deleteDashboard(i)}))},n.prototype.readArmDashboards=function(n){return n===void 0&&(n=[]),this._dashboardClient().then((function(t){return t.readDashboards(n)}))},n.prototype.readDashboards=function(n){var t=this;return n===void 0&&(n=[]),this.readArmDashboards(n).then((function(n){return n.map((function(n){return t._convertToDashboard(n)}))}))},n.prototype.isDashboardWritable=function(n){return Q(this._permissionsManager.hasPermission(s(n),["Microsoft.Portal/dashboards/write"]))},n.prototype.identifyDashboard=function(n){return p(n)},n.prototype.getDashboardProperties=function(n){var t=n.id,u=n.title,i=s(t),r=c(i)||{subscription:"",resourceGroup:""};return{id:t,title:u,originalId:i,subscription:r.subscription,resourceGroup:r.resourceGroup}},n.prototype.getNotFoundMessage=function(n){var r=n.id,i=n.title,u=s(r),t=c(u);return t?a.armMessageFormat.format(i,t.resourceGroup,t.subscription):a.defaultMessageFormat.format(i)},n.prototype._convertToDashboard=function(n){var t=y(n.id);return this._compressor.uncompress(t,v(n))},n})();t.ArmDashboardRepository=w}));
define("MsPortalImpl/UI/Commands/UI.ShellCommands",["require","exports","f","o","ko","$","MsPortalImpl/Base/Base.Events","MsPortalImpl/UI/Dashboard/ArmDashboardRepository","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Interactions/Interactions.Command","MsPortalImpl/Base/Telemetry","MsPortalImpl/UI/Commands/UI.Commands","MsPortalImpl/UI/Compositions/UI.Composition.PartSize","MsPortalImpl/UI/UI.ContextPane","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.Tile","MsPortalImpl/Widgets/Widgets.TileActionBar","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k){"use strict";function et(n){return p.Widget.getWidget(n.closest(".fxs-tile"),w.Widget)}function ki(n,t){return ot||(ot=[{size:0,text:d.partSizeMini},{size:1,text:d.partSizeSmall},{size:2,text:d.partSizeNormal},{size:3,text:d.partSizeWide},{size:4,text:d.partSizeTall},{size:10,text:d.partSizeLarge},{size:5,text:d.partSizeHeroWide},{size:6,text:d.partSizeHeroTall},{size:11,text:d.partSizeHero},],ot.forEach((function(n){n.icon=rt.Mini({customClass:"msportalfx-contextmenu-grid-"+ct.InternalPartSize[n.size].toLowerCase()})}))),ot.map((function(i){return new st(n,i.text,i.size,i.icon,t)}))}var nt,vt,yt,pt,wt,bt,st,ot,kt,dt,gt,ni,ti,ii,ri,ui,fi,ei,oi,si,hi,ci,li,ai;r.defineProperty(t,"__esModule",{value:!0});var ht=i.Base,vi=ht.Diagnostics.Telemetry,it=ht.Images,rt=it.Shell,ct=i.Parts,lt=i.ViewModels,yi=lt.FileDownload,pi=lt.Controls.FileDownloadButton,wi=i.ViewModels.Dialogs,bi=l.CompositionInstanceCommandContext,tt=i.tryImmediateResolve,ut=i.require,d=s.ShellCommands,g="MsPortalImpl.UI.Commands.",ft=1,at=it.Blank();t.CommandNames={BladeDisplayState:g+"BladeDisplayState",CloneDashboard:g+"CloneDashboard",CustomizeTileData:g+"CustomizeTileData",DeleteDashboard:g+"DeleteDashboard",DeleteListItem:g+"DeleteListItem",DownloadDashboard:g+"DownloadDashboard",EnterOrganizeMode:g+"EnterOrganizeMode",ExitOrganizeMode:g+"ExitOrganizeMode",FilterDashboard:g+"FilterDashboard",FullscreenDashboard:g+"FullscreenDashboard",NewDashboard:g+"NewDashboard",OpenBrowseDashboardsPane:g+"OpenBrowseDashboardsPane",PartSize:g+"PartSize",PinBlade:g+"PinBlade",PinListItem:g+"PinListItem",PinToStartboard:g+"PinToStartboard",ResetLayout:g+"ResetLayout",ResetStartBoard:g+"ResetStartBoard",ShareDashboard:g+"ShareDashboard",UnpinFromStartboard:g+"UnpinFromStartboard",UploadDashboard:g+"UploadDashboard"};nt=(function(n){function t(t,i,r,u){var f=n.call(this,t,r,u)||this;return f._services=i,f.isShellCommand=!0,f}return __extends(t,n),t.prototype.bind=function(t){var i=this;t.getFormTarget||(t.getFormTarget=function(){return i._services.getService("PortalFormTarget")});n.prototype.bind.call(this,t)},t.prototype.execute=function(t){n.prototype.execute.call(this,t);var i=this._services&&this._services.desktop.getActiveJourney();vi.trace({source:l.getCommandSourceTelemetryName(this._currentContext),action:c.Action.CommandExecuted,name:this.commandName,data:{fromContextMenu:t,desktopMode:this._getDesktopMode()},journeyId:i&&i.id})},t.prototype.createAction=function(n){var i=this,t=new b.TileActionViewModel;return t.command=this,t.bindCommand=function(){var t=n.widget;t?i.bind(new bi(t.element[0],null,n)):i.enabled(!1)},this._setActionClassName(t),t},t.prototype._getComposition=function(){return this._currentContext.compositionInstance},t.prototype._getDesktopMode=function(){return this._services?this._services.desktop.mode():null},t.prototype._setActionClassName=function(n){var t=this._getActionClassIdentifier();this._actionClassName="fxs-tile-actionbar-command-"+t;n.className=this._actionClassName},t.prototype._getActionClassIdentifier=function(){throw new Error("Not implemented.");},t})(h.CommandImpl);t.ShellCommand=nt;vt=(function(n){function t(t,i){var r=n.call(this,t,null,i.text)||this;return r._command=i,r}return __extends(t,n),t.prototype.execute=function(t){this._command.handler().execute();n.prototype.execute.call(this,t)},t})(nt);t.ControlCommand=vt;yt=(function(n){function i(i,r){var u=n.call(this,i,r,d.unpinFromStartboard,!0)||this;return u.commandName=t.CommandNames.UnpinFromStartboard,u.icon(it.Delete({isLogo:!0})),u}return __extends(i,n),i.prototype.execute=function(t){var i=et(f(this._currentContext.target));i&&i.trigger(k.default.fxunpin,null,{tileId:i.options.id});n.prototype.execute.call(this,t)},i.prototype._getActionClassIdentifier=function(){return"unpinfromstartboard"},i})(nt);t.UnpinFromStartboard=yt;pt=(function(n){function i(i,r){var u=n.call(this,i,r,d.customizeTileData,!0)||this;return u.commandName=t.CommandNames.CustomizeTileData,u.icon(it.GearAlternate({isLogo:!0})),u}return __extends(i,n),i.prototype.execute=function(){var n=this._getComposition();n.openPartSettingsBlade()},i.prototype.bind=function(t){n.prototype.bind.call(this,t);this.enabled(this._getDesktopMode()!==ft)},i.prototype._getActionClassIdentifier=function(){return"customizetiledata"},i})(nt);t.CustomizeTileData=pt;wt=(function(n){function t(t,i,r){var u=n.call(this,t,i,r,!0)||this;return u.icon(it.Ellipsis({isLogo:!0})),u}return __extends(t,n),t.prototype.bind=function(t){var e=this,i,r;n.prototype.bind.call(this,t);i=this._partWidget=et(f(t.target));r=i.options.commands.filter((function(n){return n.bind(t),n.visible()&&n.enabled()}));this.enabled(r.length>0);u.computed(this._ltm,(function(){var n=i.actionBarWidget.contextMenuWidget.options.visible(),t=i.element.findByClassName(e._actionClassName);t.toggleClass("fxs-tile-actionbar-action-pressed",n)}))},t.prototype.execute=function(t){var u=this._partWidget,i=u.element,o=i.findByClassName(this._actionClassName),r,e;if(o.length<=0)throw new Error("Context menu requires an anchor element.");r=f.Event(k.default.fxcontextmenu);e=i.offset();r.clientX=e.left+i.outerWidth(!1);r.clientY=e.top;i.trigger(r,{commands:u.options.commands,contextMenu:u.actionBarWidget.contextMenuWidget});n.prototype.execute.call(this,t)},t.prototype._getActionClassIdentifier=function(){return"opencontextmenu"},t})(nt);t.OpenContextMenu=wt;bt=(function(n){function i(i,r){var u=n.call(this,i,r,d.pinToStartboard,!1)||this;return u.commandName=t.CommandNames.PinToStartboard,u.icon(it.Pin()),u}return __extends(i,n),i.prototype.bind=function(t){var e,i,r;if(n.prototype.bind.call(this,t),e=!1,this.baseInstance=this._getComposition(),e=this.baseInstance.allInputsSet(),i=et(f(t.target)),r=!1,i){var h=a.isVariableSize(i.options.size()),s=u.unwrap(i.options.supportedSizes),o=void 0,c=i.element.parentsUntil(".fxs-blade",".fxs-blade-summary-container").length>0;c?r=!1:h?(o=s&&s.first((function(n){return a.isFixedSize(n)})),o!==null&&o>=0&&(r=!0)):r=!0}this.enabled(r&&e)},i.prototype.execute=function(t){var i=this;tt(ut("MsPortalImpl/UI/UI.Desktop.Actions"),(function(n){return Q(n.pinPartToStartboard(i.baseInstance,i._services))})).finally((function(){n.prototype.execute.call(i,t)}))},i.prototype._getActionClassIdentifier=function(){return"pintostartboard"},i})(nt);t.PinToStartboard=bt;st=(function(n){function i(i,r,u,f,e){var o=n.call(this,i,e,r,!0)||this;return o.commandName=t.CommandNames.PartSize+ct.InternalPartSize[u],o._sizeTarget=u,o.icon(f),o}return __extends(i,n),i.prototype.execute=function(t){var i=et(f(this._currentContext.target)),r;i&&(r=a.AllSizes[this._sizeTarget],i.element.trigger(k.default.fxsizechange,[i.options.id,r.size.width,r.size.height]),Q.fcall((function(){i.setFocus()})));n.prototype.execute.call(this,t)},i.prototype.bind=function(t){var i=et(f(t.target)),r=i&&i.options;if(!i||this._sizeTarget===r.size()||a.isVariableSize(r.size())||this._getDesktopMode()!==ft){this.enabled(!1);return}this.enabled(r.supportedSizes().indexOf(this._sizeTarget)!==-1);n.prototype.bind.call(this,t)},i})(nt);t.PartSizeCommand=st;t.CreatePartSizeCommandCollection=ki;kt=(function(n){function i(i,r){var u=n.call(this,i,r,d.resetLayout,!0)||this;return u.commandName=t.CommandNames.ResetStartBoard,u.icon(at),u}return __extends(i,n),i.prototype.execute=function(t){this._services.desktop.startBoard.resetLayout();n.prototype.execute.call(this,t)},i.prototype.bind=function(t){n.prototype.bind.call(this,t);this.enabled(this._getDesktopMode()===ft)},i})(nt);t.ResetStartBoardCommand=kt;dt=(function(n){function i(i,r,f){var e=n.call(this,i,r,d.enterOrganizeMode,!0)||this;return e.commandName=t.CommandNames.EnterOrganizeMode,e.icon(it.Edit()),e._expandTileGallery=!!f,u.reactor(e._ltm,(function(){var n=r.desktop.mode()!==ft,t=!r.diContainer.get(v.LeftContextPane).opened();e.enabled(n&&t)})),e}return __extends(i,n),i.prototype.execute=function(t){var i=this._getComposition();i&&i.widget?i.widget.element.trigger(k.default.fxenterorganizemode,{trigger:1,expandTileGallery:this._expandTileGallery}):this._services.desktop.mode(ft);n.prototype.execute.call(this,t)},i})(nt);t.EnterOrganizeMode=dt;gt=(function(n){function i(i,r){var u=n.call(this,i,r,d.exitOrganizeMode,!0)||this;return u.commandName=t.CommandNames.ExitOrganizeMode,u.icon(at),u}return __extends(i,n),i.prototype.execute=function(t){this._services.desktop.portalWidget.trigger(k.default.fxexitorganizemode);n.prototype.execute.call(this,t)},i.prototype.bind=function(t){n.prototype.bind.call(this,t);this.enabled(this._getDesktopMode()===ft)},i})(nt);t.ExitOrganizeMode=gt;ni=(function(n){function i(i,r){var u=n.call(this,i,r,d.shareDashboard,!0)||this;return u.commandName=t.CommandNames.ShareDashboard,u.icon(rt.Share()),u}return __extends(i,n),i.prototype.bind=function(t){n.prototype.bind.call(this,t);this.enabled(!this._services.diContainer.get(v.RightContextPane).opened.peek())},i.prototype.execute=function(t){var r=this,i;n.prototype.execute.call(this,t);i=this._services;tt(ut("MsPortalImpl/Widgets/Widgets.ShareDashboardPane"),(function(n){var u=i.diContainer.get(v.RightContextPane),t=r._ltm.createChildLifetime();u.tryOpen(new n.ShareDashboardPane(t,i)).then((function(n){n?u.contentLifetime.registerForDispose(t):t.dispose()})).catch((function(n){return t.dispose(),Q.reject(n)}))}))},i})(nt);t.ShareDashboard=ni;ii=(function(n){function i(i,r){var u=n.call(this,i,r,d.deleteDashboard,!0)||this;return u.commandName=t.CommandNames.DeleteDashboard,u.icon(ti||(ti=rt.TrashOutline())),u}return __extends(i,n),i.prototype.execute=function(t){var r=this,i;n.prototype.execute.call(this,t);i=this._services;i.desktop.getDashboardManager().then((function(n){var t=n.isCurrentDashboardShared(),u=i.desktop.startBoard.notFound()?Q(!0):n.isCurrentDashboardWritable();u.then((function(u){Q.all([i.getService("DialogManager"),r._currentContext.getFormTarget()]).spread((function(i,f){var e=new wi.MessageBox(d.deleteDashboard,u?d.deleteDashboardConfirm:d.noPermissionToDeleteDashboard,u?2:1),o;e.confirmationRequired=u&&t;e.confirmationMessage=d.deleteDashboardConfirmation;o=r._currentContext;i.showShellDialog(e,f,o.target).then((function(t){u&&t===4&&n.deleteCurrentDashboard(1)}))}))}))}))},i})(nt);t.DeleteDashboard=ii;ui=(function(n){function i(i,r){var u=n.call(this,i,r,d.newDashboard,!0)||this;return u.commandName=t.CommandNames.NewDashboard,u.icon(ri||(ri=rt.Add())),u}return __extends(i,n),i.prototype.execute=function(t){n.prototype.execute.call(this,t);tt(this._services.desktop.getDashboardManager(),(function(n){n.startNewDashboard()}))},i})(nt);t.NewDashboard=ui;ei=(function(n){function i(i,r){var u=n.call(this,i,r,d.cloneDashboard,!0)||this;return u.commandName=t.CommandNames.CloneDashboard,u.icon(fi||(fi=it.Clone())),u}return __extends(i,n),i.prototype.execute=function(t){n.prototype.execute.call(this,t);tt(this._services.desktop.getDashboardManager(),(function(n){n.cloneCurrentDashboard()}))},i})(nt);t.CloneDashboard=ei;si=(function(n){function i(i,r,u){var f=n.call(this,i,r,d.filterDashboard,!0)||this;return f.commandName=t.CommandNames.FilterDashboard,f._startboard=u,f.icon(oi||(oi=rt.Filter())),f}return __extends(i,n),i.prototype.execute=function(t){n.prototype.execute.call(this,t);var i=this._services,r=this._startboard;tt(ut("MsPortalImpl/Widgets/Widgets.FilterPane"),(function(n){var t=n.FilterPane.getSingleton(i.diContainer.get(v.RightContextPane),r);t.open()}))},i})(nt);t.FilterDashboard=si;hi=(function(n){function i(i,r){var u=n.call(this,i,r,d.fullscreenDashboard,!0)||this;return u.commandName=t.CommandNames.FullscreenDashboard,u.icon(rt.Fullscreen()),u}return __extends(i,n),i.prototype.execute=function(t){n.prototype.execute.call(this,t);e.isFullscreen()?e.exitFullscreen():e.requestFullscreen()},i})(nt);t.FullscreenDashboard=hi;ci=(function(n){function i(i,r){var u=n.call(this,i,r,"",!0)||this;return u.commandName=t.CommandNames.OpenBrowseDashboardsPane,u}return __extends(i,n),i.prototype.execute=function(t){var r=this,i;n.prototype.execute.call(this,t);i=this._services;tt(ut("MsPortalImpl/UI/Dashboard/BrowseDashboardsPane"),(function(n){return tt(i.desktop.getDashboardManager(),(function(t){var u=i.diContainer.get(v.RightContextPane),f=u.getContent(),e;if(f instanceof n.BrowseDashboardsPane){u.tryOpen(f);return}e=new n.BrowseDashboardsPane(t,{defaultDashboardType:r._dashboardType,dashboardTypeChanged:function(n){return r._dashboardType=n}});u.tryOpen(e)}))}))},i})(nt);t.OpenBrowseDashboardsPane=ci;li=(function(n){function r(i,r){var f=n.call(this,i,r,d.uploadDashboard,!0)||this;return f._fileUploaderMap={},f._fileUploadModel={uploadContext:u.observable("")},f.commandName=t.CommandNames.UploadDashboard,f.fileInputOptions(new h.FileInputOptions(".json",1)),f}return __extends(r,n),r.prototype.execute=function(t){var i=this;n.prototype.execute.call(this,t);this._fileUpload?this._execute(t):tt(ut("MsPortalImpl/Services/Services.FileUpload"),(function(n){i._fileUpload=n;i._execute(t)}))},r.prototype._execute=function(){var f=this,t=this.fileInputOptions().files(),n,r,u;t&&t.length>0&&(n=t[0],r=new this._fileUpload.FileUploader(this._ltm,this._fileUploaderMap,n,this._fileUploadModel),this._fileUploaderMap[n.name]=r,[].push(r.uploadTask),u=new this._fileUpload.FileReaderHelper(n),u.readNextChunk().then((function(t){var r=new FileReader;r.onload=function(t){try{var r=o.normalizedDashboard(JSON.parse(t.target.result));f._services.desktop.getDashboardManager().then((function(t){r.title=r.title||n.name.replace(/\.json$/i,"");t.importDashboard(r)}))}catch(u){i.Hubs.Notifications.ClientNotification.publish({title:d.uploadErrorTitle,description:d.uploadErrorDescription,status:i.Hubs.Notifications.NotificationStatus.Error})}};r.readAsText(new Blob([t.content],{type:"application/octet-stream"}))})))},r})(nt);t.UploadDashboard=li;ai=(function(n){function i(i,r){var u=n.call(this,i,r,d.downloadDashboard,!0)||this;return u.commandName=t.CommandNames.DownloadDashboard,u}return __extends(i,n),i.prototype.execute=function(t){var i=this;n.prototype.execute.call(this,t);tt(ut("MsPortalImpl/Commands/Commands.FileDownloadCommand"),(function(n){i._services.desktop.getDashboardManager().then((function(t){t.getArmDashboardJson().then((function(t){t.location.localeCompareIgnoreCase("INSERT LOCATION")===0&&delete t.id;var f=new yi.Context({targetUri:u.observable("data:,"+encodeURIComponent(JSON.stringify(t,null,2))),targetFileName:u.observable(t.tags["hidden-title"]+".json"),addDefaultAuthorizationToken:!1}),r=new pi.ViewModel(i._ltm,{context:u.observable(f),disabled:u.observable(!1)});i._instance=new n.FileDownloadCommand(r.context(),i._services);i._instance.execute(r.context())}))}))}))},i})(nt);t.DownloadDashboard=ai}));
define("MsPortalImpl/UI/Compositions/UI.Composition.ContextMenuContainer",["require","exports","f","a","MsPortalImpl/Base/Base.SelectableSet2","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Commands/UI.ShellCommands"],(function(n,t,i,r,u,f,e){"use strict";var o;return (function(n){function s(n,t,i,u,f){if(h(i,t,u),u){var e=c(n,t,f);r.prototype.push.apply(i,e)}}function h(n,i,r){n.filter((function(n){return i.getCompositionType()===t.StartboardPart&&r?n instanceof e.ShellCommand&&!(n instanceof e.CustomizeTileData):n instanceof e.ShellCommand})).forEach((function(t){n.remove(t);t.dispose()}))}function c(n,i,r){var u=[],o,f;return i.getCompositionType()===t.StartboardPart?(u.push(new e.EnterOrganizeMode(n,r)),u.push.apply(u,e.CreatePartSizeCommandCollection(n,r)),u.push(new e.UnpinFromStartboard(n,r),new e.ExitOrganizeMode(n,r))):(o=i.instanceDefinition,f=o&&o.reference,f&&f.extension==="HubsExtension"&&f.partTypeName==="MonitorChartPart"||u.push(new e.PinToStartboard(n,r))),u}function l(n,t){var i,r;return(n instanceof u.SelectableSet2?i=t:n._msPortalFxCreateSelectionAsync?(r=o.Deferred(),n._msPortalFxCreateSelectionAsync(t).then((function(n){r.resolve(n)}),(function(n){r.reject(n)})),i=r.promise()):i=n.createSelection(t),Q.isPromiseAlike(i))?i:o.Deferred().resolve(i).promise()}var t=f.CompositionType,o=i.Helpers;n.composeShellCommands=s;n.createSelection=l})(o||(o={})),o}));
define("MsPortalImpl/UI/Compositions/UI.Composition.PartSettingsManager",["require","exports","f","i","o","ko","$","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding","MsPortalImpl/Base/Base.ImplUtils"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";function c(n,r,u){var e=""+t.partIdentityStatePrefix+n.toString(),s;return u&&(e+="-"+u),r&&(s=r.hasOwnProperty(o.PartContainerModelIdProperty)&&[o.PartContainerModelIdProperty],e+="-"+i.toSortedString(f.toJS(r),s)),e}function p(n){var t;try{t=JSON.parse(JSON.stringify(n))}catch(i){t=n}return t}function g(n){return n.some((function(n){var t=p(n.propertyValue),r=p(n.propertyOldValue);return!i.deepEquals(t,r)}))}var w;u.defineProperty(t,"__esModule",{value:!0});var b=i.Base,k=b.Diagnostics,l=o.CompositionType,a=s.PropertyBindings,v=k.createLog(n),y=u.keys(i.trace.partsettings||{}),d=y.length>0;t.partIdentityStatePrefix="[PartIdentityState]-";t.buildIdentitySettingKey=c;w=(function(){function t(){this._trace=!1}return t.prototype.configure=function(n){this._options=n;this._settingsStore=n.part.getCompositionType()===l.StartboardPart?13:2},t.prototype.configureInstanceProperties=function(n){this._options.instanceProperties=n},t.prototype.initialize=function(){var n=this;this.dispose();this._registerPartIdentityStateChangeHandler();this._registerPartSharedKeyChangeHandler();this._registerPartInstanceChangedHandler();d&&(this._trace=y.some((function(t){return n._options.partViewModelId.toLowerCase().indexOf(t)>=0})))},t.prototype.saveIdentityPartSettings=function(n,t){var f=this._options,e=f.part,o=f.services,s=o.sharedSettings,i=this.getKeyForIdentitySettings(n),u;e.getCompositionType()===l.StartboardPart&&(i=c(e.locator,n));i&&(this._identityState&&(u=r.toSerializableObject(this._identityState.targetModel),this._traceOperationWithSettings("Save identity part settings.",u,i),s.setSetting(t&&13||this._settingsStore,i,u)),this._options.part.notifySettingChanged())},t.prototype.clearIdentityPartSettings=function(){var t=this._options;if(t){var i=t.part,r=i.containerModel,n=[this.getKeyForIdentitySettings(r)];i.getCompositionType()===l.StartboardPart&&n.push(c(i.locator,r));n=n.filter((function(n){return!!n}));n.length>0&&t.services.sharedSettings.deleteSettings({store:this._settingsStore,keys:n})}},t.prototype.getPartSettingsAsync=function(){if(this._options.part.getCompositionType()===l.StartboardPart)return this.getStartboardPartIdentitySettings();var n=this.getIdentityPartSettingsAsync(),t=this.getSharedPartSettingsAsync();return Q.all([n,t]).spread((function(n,t){return e.extend(!0,{},n,t)}))},t.prototype.registerInstanceStateProperty=function(n,t,i){i===void 0&&(i=!0);var r=this._options.part,u=this._getOrCreateInstanceStatePropertyBindings(),f=u.targetModel,e=r.getSettingsModel();this._registerViewModelPropertyChangeHandler(t,e,f,u,(function(){r.save()}),n);i&&r.save()},t.prototype.savePart=function(){var n=this._options;n&&n.part.save()},t.prototype.dispose=function(){var i=this._partInstanceState,n,t;i&&(i.unbind(),this._partInstanceState=null);n=this._identityState;n&&(n.unbind(),this._identityState=null);t=this._sharedKey;t&&(t.unbind(),this._sharedKey=null)},t.prototype.getKeyForIdentitySettings=function(n){var o=null,t=this._options,r=t.part,s=t.partStateDefinition,u=t.identityInputs,l=r.getInputPropertyBindings(),h=s&&s.inputIdentityProperties,e;return r.allInputsSet()&&h&&h.length>0&&(e="",u&&u.length>0&&(e=i.toSortedString(f.toJS(l.targetModel),u)),o=c(r.locator,n,e)),o},t.prototype._registerPartIdentityStateChangeHandler=function(){var u=this,t=this._options,i=t.part,r=t.partStateDefinition,n=r&&r.inputIdentityProperties;n&&n.length>0&&(this._identityState=new a(i.toString()+"-[PartIdentitySettings]",{}),this._registerViewModelChangeHandler(n,this._identityState,(function(n){var t=g(n);t&&u.saveIdentityPartSettings(i.containerModel)})))},t.prototype._registerPartSharedKeyChangeHandler=function(){var e=this,t=this._options,o=t.part,u=t.partStateDefinition,h=t.services,n=u&&u.sharedProperties,f,i;n&&n.length>0&&(f=n.map((function(n){return n.property})),i={},this._sharedKey=new a(o.toString()+"-[PartSharedSettings]",i),this._registerViewModelChangeHandler(f,this._sharedKey,(function(){var t={},u;n.forEach((function(n){var u=s.getModelValue(i,n.property).value;t[n.key]=r.toSerializableObject(u)}));u={store:5,settings:t};e._traceOperationWithSettings("Save shared part settings.",t);h.sharedSettings.setSettings(u)})))},t.prototype._registerPartInstanceChangedHandler=function(){var n=this._options,i,t=n.instanceProperties,r=function(n){return n.some((function(n){return n.propertyName==="content.pollingOptions"}))};t&&t.length>0&&(i=this._getOrCreateInstanceStatePropertyBindings(),this._registerViewModelChangeHandler(t,this._partInstanceState,(function(t){n.part.save();r(t)&&n.part.notifySettingChanged()})))},t.prototype._registerViewModelChangeHandler=function(n,t,i){var r=this,u=t.targetModel,f=this._options.part.getSettingsModel();n.forEach((function(n){r._registerViewModelPropertyChangeHandler(n,f,u,t,i)}))},t.prototype._registerViewModelPropertyChangeHandler=function(t,i,r,u,e,o){var l=this,c;s.getModelValue(r,t).exists||s.setModelValue(r,t,f.toJS(s.getModelValue(i,t).value));c=u.addProperty(t).bind(this._options.partViewModelId,i,!1,e,(function(t){h.logToExtension(n,l._options.part.locator.getExtensionLocator().name,2,"[PartState] Failed to bind changes from viewmodel to part state. Error: "+t)}));o&&o.registerForDispose((function(){u.removeProperty(c)}))},t.prototype.getIdentityPartSettingsAsync=function(){var t=this,i=this._options,r=i.partStateDefinition,u=i.part.containerModel,f=r&&r.inputIdentityProperties,n,o;return(f&&f.length>0)?(n=this.getKeyForIdentitySettings(u),o={store:this._settingsStore,keys:[n]},this._getPartSettingsAsync("Get identity part settings.",o,undefined).then((function(i){if(n===t.getKeyForIdentitySettings(u)){var r=t._identityState;return r&&e.extend(!0,r.targetModel,i),i}}))):Q.resolve(null)},t.prototype.getStartboardPartIdentitySettings=function(){var i=this._options,n=i.part,r=i.partStateDefinition,u=r&&r.inputIdentityProperties,t;return(u&&u.length>0)?(t=!(n.flags&2)?[]:[c(n.previousLocator,n.containerModel)],t=t.concat([this.getKeyForIdentitySettings(n.containerModel),c(n.locator,n.containerModel),]),this._getPartSettingsAsync("Get identity part settings.",{store:this._settingsStore,keys:t},undefined)):Q.resolve(null)},t.prototype.getSharedPartSettingsAsync=function(){var f=this._options,r=f.partStateDefinition,n=r&&r.sharedProperties,t,i,u;return(n&&n.length>0)?(t=[],i={},n.forEach((function(n){t.push(n.key);i[n.key]=n.property})),u={store:5,keys:t},this._getPartSettingsAsync("Get shared part settings.",u,i)):Q.resolve(null)},t.prototype._traceOperationWithSettings=function(n,t,i){if(this._trace){if(i){var r={};r[i]=t;t=r}v.verbose("[PartSettingsManager] {0} Part: {1}.\nSettings: {2}".format(n,this._options.part.toString(),f.toJSON(t,null,2)))}},t.prototype._traceOperationWithKeys=function(n,t){this._trace&&v.verbose("[PartSettingsManager] {0} Part: {1}.\nKeys: {2}".format(n,this._options.part.toString(),f.toJSON(t,null,2)))},t.prototype._getPartSettingsAsync=function(n,t,i){var f=this,u;return this._traceOperationWithKeys("BEGIN - "+n,t.keys),u=[this._options.services.sharedSettings.querySettings(t)],Q.all(u).then((function(u){var h,o={};return h=u[0]||{},t.keys.forEach((function(n){var t=h[n],f=r.isSerializedObject(t),u=f?r.fromSerializableObject(t):t;i?h[n]!==undefined&&i[n]&&s.setModelValue(o,i[n],u):e.extend(!0,o,u)})),f._traceOperationWithSettings("END - "+n,o),o}))},t.prototype._getOrCreateInstanceStatePropertyBindings=function(){if(!this._partInstanceState){var n=this._options.part;this._partInstanceState=new a(n.toString()+"-[PartInstanceState]",n.partState)}return this._partInstanceState},t})();t.PartSettingsManager=w}));
define("MsPortalImpl/UI/Compositions/UI.Composition.Part",["require","exports","f","i","o","ko","$","FxInternal/Composition/ViewModel","MsPortalImpl.Controls/Fields/Base/FormValidation","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Base/Base.Events","MsPortalImpl/Base/Base.Events","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Base/Base.Router","MsPortalImpl/Base/Base.Selectable2","MsPortalImpl/Base/Base.SelectableSet2","MsPortalImpl/Base/Base.Timers","MsPortalImpl/Base/Telemetry","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/Parts/Parts","MsPortalImpl/Services/Services.AssetTypes","MsPortalImpl/Services/Services.EditScopeManagement","MsPortalImpl/Widgets/Widgets.Common","MsPortalImpl/Widgets/Widgets.Tile","MsPortalImpl/Widgets/Widgets.UIElementBase","MsPortalImpl/UI/Commands/UI.Commands","MsPortalImpl/UI/Commands/UI.ShellCommands","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/UI/UI.NavigationManager","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Compositions/UI.Composition.Base","MsPortalImpl/UI/Compositions/UI.Composition.BladeOpenerBase","MsPortalImpl/UI/Compositions/UI.Composition.CompositionBinder","MsPortalImpl/UI/Compositions/UI.Composition.ContextMenuContainer","MsPortalImpl/UI/Compositions/UI.Composition.PartSettingsManager","MsPortalImpl/UI/Compositions/UI.Composition.PartSize","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding","MsPortalImpl/UI/Compositions/UI.Composition.Security","MsPortalImpl/Parts/Parts.Error"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,wt,bt){"use strict";function fi(n){return n&&n.toFriendlyString()}function oi(n){var t=n.getPartsContainer();return t&&t.getCompositionType()===ht.CompositionType.Blade&&t}function cu(n){var t=oi(n);return!!(t&&t.bladeDefinition&&t.bladeDefinition.locked)}function lu(n,t){return t.masterPartId===n.id&&nr(t.masterCommandName)}function af(n){var i=n.services.desktop,r=i.tryCloseBlade.bind(i),t=n.getPartsContainer();return function(i,u){var e,f,o;switch(i){case 1:case 2:return e=t.detailContainers.filter((function(t){var r=!!(t.flags&1);return lu(n,t)&&i===1?!r:r})),e.length===0?!1:!e.some((function(n){return!r(n.id)}));default:return f=t.masterContainer,o=f&&f.bladeDefinition,o&&o.menuBlade&&(t=f),t.returnValue=u,r(t.id,2)}}}function vf(t,r,u){var e=u&&u.children||[],o=e.indexOf(r,1),f;if(o>0&&(f=e[o-1],f.bladeDefinition&&f.bladeDefinition.menuBlade))return{switchItem:function(r){rf(t,i.require("../../../MsPortalImpl.Controls/Controls/Lists/Menu",n)).then((function(n){var i=f.widget.element.findByClassName("fxc-menu"),t=ut.Widget.getWidget(i,n.Widget);t&&t.switchItem(r)}))}}}function fr(n,t){t===void 0&&(t=!0);var r;return n&&(t&&!n.hasOwnProperty(ht.PartContainerModelIdProperty)&&(n=f.toJS(n),n[ht.PartContainerModelIdProperty]=i.getUniqueId()),r=dt.createObservableModel(n)),r}function ar(n,t){var i;return n&&t?(i={},su(n,(function(n){i[n]=null}))):i=n,r.toSerializableObject(i)}function vr(n){return r.isSerializedObject(n)?r.fromSerializableObject(n):{}}function au(n,t,i,r,u){var f=new lr(n,t,null,i);return f.calculateInitialSize(),f.containerModel=fr(r),f.overridesModel=fr(u||{},!1),f}function yf(n,t){var i,r,u;return pt.isFixedSize(t.size())?(u=pt.getGridPixelSize(t.gridWidth(),t.gridHeight()),i=u.height,r=u.width,t.locked()||(i-=30,r-=30)):(i=n.height(),r=n.width()),{height:i,width:r}}function yr(n,t,i,r,u){if(u===void 0&&(u=!0),u){var e="content.size",o=gt(n,e);o.exists&&f.isObservable(o.value)&&wt.setModelValue(n,e,r)}b.requestAnimationFrame((function(){var f=yf(t,i),u=n&&n.container;u&&(u.width&&u.width(f.width),u.height&&u.height(f.height),u.size({partSize:r,dimensions:f}))}))}function ki(n){var t=n.partDefinition,i=n.adapter,r=t&&t.viewModel?t.viewModel:"N/A",u=i?"AdapterPart. Extension: "+i.extension.name+", ViewModel: "+i.viewModelName+", Wrapped ViewModel: "+r:"ViewModel: "+r;return n+" ("+u+")"}function pf(n){var t=n.partDefinition;return t&&t.partKind===ri.Custom&&t.htmlTemplate&&!(t.htmlTemplate in n.extension.definition.htmlTemplates)}function wf(n,t,i){var r=n.getInputPropertyBindings();(i||[]).forEach((function(i){var u=r.properties.first((function(n){var r=n.compositionBindingDefinition;return n.sourceProperty===i.source.property&&r&&r.source&&r.source.id===t.id}));u||(ir(n,r,[i]),i.source.id=t.id,n.bindings.push(i),n.save())}))}function bf(n,t){var i=n.getInputPropertyBindings(),r=n.bindings||[],u=r.filter((function(n){return n.source.scope!==ei.DetailsContainer}));u.length!==r.length&&(i.properties.filter((function(n){var i=n.compositionBindingDefinition;return i&&i.source&&i.source.id===t.id})).forEach((function(n){i.removeProperty(n)})),n.bindings=u,n.save())}function vu(n){var t=n.adapter,i=t.inputPropertyBindings,r=i.targetModel;ir(n,t.inputPropertyBindings,t.bindings,(function(t){return r[t.targetProperty]=f.observable(),n.bindAgainstOverridesOrContainerModel(t)}))}function kf(n,t,i){var r=!!t;return t&&(t.assetType&&!t.assetIdInputProperty?(kt.error("'assetIdProperty' is required if 'assetType' is defined on part definition. Locator:'"+n.locator+"'."),r=!1):!i&&!!t.editScopeType&&n.bindings&&n.bindings.some((function(n){return n.targetProperty===vi}))&&(r=!1,kt.error("Declaring an 'editScopeType' and an input binding with '"+vi+"' as a target property is not supported. "+("A part cannot be the owner of an edit scope and also receive an edit scope id from an external source. Part: '"+n+"'. Bindings: "+JSON.stringify(n.bindings)+".")))),r}function df(n,t){var i=[],r=!0;return t&&t.invocationInputArguments&&t.invocationInputArguments.length&&(r=lt.validateDetailsDefinition(t,i)),i.length&&ef.logDetailDefinitionError(i[0],n.toString(),t),r}function gf(n,t){var i=[],r=dt.validateInputBindings(n,t,i);return i.length&&kt.error(i[0]+" Part:'"+n+"'."),r}function ne(n){var t=n.adapter,i=t?t.allInputsSet:n.allInputsSet;f.computed(n,(function(){if(i()){var t=yu(n);t&&t.exists&&n.assetId(f.unwrap(t.value))}}))}function yu(n){var i=n.adapter,r=i?i.inputPropertyBindings:n.getInputPropertyBindings(),t=r.properties.first((function(t){return t.targetProperty===n.assetInstanceDefinition.assetIdInputProperty}));return t?gt(t.sourceModel,t.sourceProperty):null}function te(n){var f,i,t,r,u;return n.isComposed&&(i=n.getViewModel(),i&&(t=i.container,t&&(r=t.partTitle&&t.partTitle(),u=t.assetName&&t.assetName(),(r||u)&&(f={partTitle:r,assetName:u})))),f}function pu(n){typeof n=="object"&&su(n,(function(t,i){sf[t]?delete n[t]:typeof i=="object"&&pu(i)}))}function pr(n){return n&&n._msPortalFx_viewModelApiV2_wrapper}function wu(t){var u=ou[t],i,r;return u||(i=ti(),u=ou[t]=i.promise(),r=pi[t],r?i.resolve(r):wi(null,t,(function(n){i.resolve(r=pi[t]=n)}),n).catch((function(n){i.reject(n)}))),u}function ie(n){var t=wu(cr);return t.then((function(){return n}))}function wr(){return wu(hr)}function br(){return pi[hr]}function re(){return pi[cr]}function ue(n){pi[cr]=n}function fe(n){pi[hr]=n}function ee(n){return{property:n,modelType:t.inferredReferenceType,scope:ei.CurrentContainer,cardinality:wt.ReferenceCardinality.OneToOne}}function kr(n){return n&&n.modelType===t.inferredReferenceType}function bu(n){return n.isDynamicBinding&&!kr(n.source)}function oe(t,i){return wi(t,"./UI.Composition.Selectable2Registrar",i,n)}function ku(n){return n&&n.partKind===ri.Frame}function du(n){var t=n.getPartsContainer(),r,i;return t&&(r=t.getCompositionType(),r===si.Blade)?t.locator.getExtensionLocator().name:(i=n.locator,i&&i.getExtensionLocator().name)}function se(n,t){var i=n.locator,r=n.extension,u=i&&i.getExtensionLocator().name,f=r&&r.name;return u!==t?u:f!==t?f:undefined}function he(n,t){var r={},i;return(n&&t&&(t.forEach((function(n){n.isIdentityInput&&!!n.property&&(r[n.property]=!0)})),n.forEach((function(n){n.isIdentityInput=!!r[n.property]}))),n&&t)?(i=n.slice(0),t.forEach((function(t){var r=t.valuesFrom;r&&r.length&&r[0].referenceType===5&&(n.some((function(n){return n.property===t.property}))||i.push(t))})),i):n||t||[]}var ni,lr;u.defineProperty(t,"__esModule",{value:!0});var er=d.Locator,ii=d.LocatorType,dr=r.Extension,li=r.TelemetryContext,gr=li.ContextType,nu=r.ViewModels.Part,gu=i.Base,tu=gu.Diagnostics,or=tu.Telemetry,nf=i.Extension,tf=nf.SetRequirement,di=i.Parts,ri=di.PartKind,ce=i.ViewModels,si=ht.CompositionType,dt=at.CompositionBinder,ei=wt.ReferenceScope,iu=wt.PropertyBindings,hi=k.Action,wi=ct.compositionRequire,ti=i.Helpers.Deferred,rf=i.Base.Promises.cancelOnDispose,ru=i.Errors,uu=ru.CanceledError,gi=ru.DisposedCanceledError,uf=window,ff=c.Asset,nr=i.isNullOrUndefined,ui=i.startTimer,kt=tu.createLog(n),fu="fxs-part",ef={logDetailDefinitionError:function(n,t,i){kt.error(n+" "+"Part: '{0}'. Details: '{1}'.".format(t,JSON.stringify(i)))}},eu=lt.PartContainerSelectable_ViewModelPath,of=[eu+".isSelected",eu+".isCommandSelected",],ai=or,tr=k.Source.Shell,ci=7,bi=9,vi=ht.EditScopeIdPropertyName,ir=dt.setupPropertyBindings,yi=er.forExtension,gt=wt.getModelValue,rr=dt.mapInputBindingDefinitions,ur=dt.createAllInputsSetWatcherConfigExtended,sr=wt.mapSourceModelToTargetModel,sf={isActivated:!0,isSelected:!0,itemsWithChildEdits:!0,selectedValue:!0,activatedItems:!0,selectedItems:!0},hr="./UI.Composition.DynamicPartBinder",cr="./UI.Composition.BladeOpener",pi={},ou={};var hf=i.getFeatureValue("autosettings"),cf=i.isFeatureEnabled("partdelayloadbyviewport"),lf=0,su=i.forEachKey,hu=i.disposeViewModelProperties;t.fxpartsettingchanged="fxpartsettingchanged";t.EmptyViewModel=nu.composePartViewModel(i.noop);t.fxpartinputchanged="fxpartinputchanged",(function(n){n[n.OldInputsNotHandled=1]="OldInputsNotHandled";n[n.UnrecoverableError=2]="UnrecoverableError";n[n.CustomPartWithMissingTemplate=3]="CustomPartWithMissingTemplate";n[n.PartDefinitionNotFound=4]="PartDefinitionNotFound";n[n.IncorrectPartType=5]="IncorrectPartType";n[n.ErrorLocatingPartDefinition=6]="ErrorLocatingPartDefinition";n[n.ErrorAcquiringViewModel=7]="ErrorAcquiringViewModel";n[n.ViewModelMissing=8]="ViewModelMissing";n[n.ErrorLoadingControl=9]="ErrorLoadingControl";n[n.ErrorCreatingWidget=10]="ErrorCreatingWidget";n[n.TransitionedToErrorState=11]="TransitionedToErrorState"})(ni||(ni={}));lr=(function(b){function k(n,i,r,u,e,o){var s=b.call(this,o||"Part",n,i,[],r,u)||this;return s.bindings=[],s.editScopeId=f.observable(),s.invocationThrottleDuration=25,s.allInputsSet=f.observable(!1),s.calledOnInputsSet=f.observable(!1),s.failedOnInputsSet=f.observable(!1),s.assetId=f.observable(),s.triggeringLockedBladeSpinner=f.observable(!1),s._viewStateProperties=[],s._partDefinitionDeferred=Q.defer(),s._registrationDeferred=ti(),s._disabled=!1,s._restoredFromJson=!1,s._perfData={instanceExtensionLoad:0,referenceExtensionLoad:0,adapterViewModelLoad:0,partViewModelLoad:0,extenderViewModelLoad:0,checkPermissions:0,prepareViewModel:0,finalizePartCompose:0,allInputBindingsBoundPreprocess:0,allInputBindingsBound:0,srcExtension:"",contentRevealedCalled:!1},s._sequence=lf++,s._rebindCount=0,s._showShellCommands=!0,s._allInputPropertyBindingsBound=ti(),s._frameInitialized=Q.defer(),s._frameRevealed=Q.defer(),s._frameBlockingUi=f.observable(!1),s._partShellApiDeferred=Q.defer(),s._contentInitializing=f.observable(!0),s._setupPromises(),s._updateRebindSequenceNumber(),s._vm=e||t.EmptyViewModel,s.partState={},s.containerModel=null,s.overridesModel=fr({},!1),s._registrationDeferred.catch((function(n){s._allInputPropertyBindingsBound.reject(n)})),s.registerForDispose(s._partSettingsManager=new yt.PartSettingsManager),s}return __extends(k,b),k.prototype.shouldAlertOnClose=function(){var n=this._getContainer(),i,t;return n?(i=f.utils.peekObservable(n.suppressAlert),t=f.utils.peekObservable(n.configureAlert),i)?!1:t?t.showAlert:!!this.widget&&s.gatherFormFields(this.widget.element).some((function(n){var t=n.viewmodel;return t._msPortalFxViewModelValueChangesAreClean&&t.dirty&&t.dirty()})):!1},k.prototype.getAlertMessage=function(){var t=this._getContainer(),n=f.utils.peekObservable(t.configureAlert);return n&&n.showAlert?n.message:""},k.prototype.suppressAlert=function(){var n=this._getContainer();return n?f.utils.peekObservable(n.suppressAlert):!0},k.prototype.notifySettingChanged=function(){var n=this.widget;n&&n.element.trigger(t.fxpartsettingchanged,{part:this,isUserInteraction:this.hasUserInteractedRecently()})},k.prototype.getViewModel=function(n,i){var r=t.EmptyViewModel,u=this.adapter,f,e;if(n=n||0,n===0)r=this._vm;else if(n===4)if(f=this._contextMenuViewModels,f)r=f.getViewModel(n,i);else{var s=this._getCommands(),o=ht.findCommand(s,i,""+this),h=o&&o.getViewModel();r=h||t.EmptyViewModel}else n===ci?r=u&&u.viewModel:n===bi?(e=u&&u.inputPropertyBindings,r=e&&e.targetModel):kt.error("Invalid model type '"+n+"' for part '"+this.locator.toString()+"'.");return r},k.prototype.getViewModelAsync=function(n,t){var i=this;return this._registrationDeferred.then((function(){var r,f,u;return n===4?(r=i._contextMenuViewModels,r?r.getViewModelAsync(n,t):(f=i._getCommands(),u=ht.findCommand(f,t,""+i),u&&u.getViewModelAsync())):i.getViewModel(n)}))},k.prototype.setViewModel=function(n){this._vm=n||t.EmptyViewModel},k.prototype.setBladeOpener=function(n){this.registerForDispose(this._bladeOpener=n)},k.prototype.getBladeOpener=function(){return this._bladeOpener},u.defineProperty(k.prototype,"isDisabled",{get:function(){return this._disabled},enumerable:!0,configurable:!0}),u.defineProperty(k.prototype,"canClone",{get:function(){var n=this.awaitComposed().state()!=="pending",t=this.getInputPropertyBindings().allBound,i=this.partDefinition.partKind===ri.ResourceSummary;return n&&t&&!i},enumerable:!0,configurable:!0}),u.defineProperty(k.prototype,"eligibleForBinding",{get:function(){return!this.containerModel},enumerable:!0,configurable:!0}),u.defineProperty(k.prototype,"templateKey",{get:function(){var n=this.locator.toString(),t=this.containerModel;return t&&(n+="-"+i.toSortedString(f.toJS(t))),n},enumerable:!0,configurable:!0}),u.defineProperty(k.prototype,"journeyPath",{get:function(){return this.getPartsContainer().journeyPath.concat(this.templateKey)},enumerable:!0,configurable:!0}),u.defineProperty(k.prototype,"dirtyAndNotSaving",{get:function(){return this.services.diContainer.get(tt.EditScopeManager).getStateObservable(this.editScopeId())()===1},enumerable:!0,configurable:!0}),u.defineProperty(k.prototype,"instanceDefinition",{get:function(){return this._partInstanceDefinition},enumerable:!0,configurable:!0}),k.prototype.getCompositionType=function(){return si.Part},k.prototype.getPartSettingsManager=function(){return this._partSettingsManager},k.prototype.getPerfData=function(){return this._perfData},k.prototype.getSettingsModel=function(){var n=this._settingsModel,t;if(!n&&(t=this.getViewModel())){var u=o.isV2(t.content),e=this.partDefinition,r=e&&e.partState,s=i.unique((r?(r.inputIdentityProperties||[]).concat((r.sharedProperties||[]).map((function(n){return n.property}))):[]).concat(!u&&this._viewStateProperties||[]));this._settingsModel=n=i.clone(t);n.content={};s.forEach((function(i){if(i.startsWith("content.")){var r=u?f.observable():gt(t,i).value;wt.setModelValue(n,i,r)}}))}return n},k.prototype.hasUserInteractedRecently=function(){return!1},k.prototype.dispose=function(n){b.prototype.dispose.call(this,n);this._releaseResources(n);[this._loadedMarker,this._readyMarker,this._revealedMarker,this._onInputsSetResolvedMarker].forEach((function(n){n&&ai.cancelTrace(n)}))},k.prototype._setExtension=function(n){this.extension=n;this._partContainer&&this._partContainer.attr("data-extensionname",this.extension?this.extension.name:null)},k.prototype.resourceLTM=function(){return this._ltm||(this._ltm=this.widget.ltm.createChildLifetime())},k.prototype._releaseResources=function(n){var u,f,i,e,r,o;this._ltm&&(this._ltm.dispose(),this._ltm=null);this._clearLoadingReactor();u=this._inputBindings;u&&(u.unbind(),this._inputBindings=null);f=this._part;f&&(f.dispose(),this._part=null);i=this._vm;e=this.extension;e&&i&&i!==t.EmptyViewModel&&e.releaseViewModel(i);this._releaseAdapter();r=this._extenderVM;o=this._extenderVMExtn;r&&o&&(hu(r),o.releaseViewModel(r));n||this._disposeEditScope();this._journey=null;this._vm=t.EmptyViewModel},k.prototype._clearLoadingReactor=function(){var n=this._loadingReactorLifetime;n&&(n.dispose(),this._loadingReactorLifetime=null)},k.prototype._releaseAdapter=function(){var n=this.adapter,t;n&&(n.inputPropertyBindings.unbind(),hu(n.viewModel),t=n.viewModel,t&&n.extension.releaseViewModel(t),this.adapter=null)},k.prototype._getContainer=function(){return r.shellInterface(this.isDisposed()||!this._vm?{}:this._vm.container)},k.prototype.getInputPropertyBindings=function(){if(!this._inputBindings)this._inputBindings=new iu(ki(this),{},!1);return this._inputBindings},k.prototype.getAssetId=function(){var e=this,t=this.assetInstanceDefinition,o=t&&t.assetIdInputProperty;if(!o)return Q.reject();var i=function(n){var t=yu(e);t&&t.exists?n.resolve(f.unwrap(t.value)):n.reject()},n=Q.defer(),r=this.adapter,u=r?r.allInputsSet:this.allInputsSet;return u()?i(n):u.subscribe(this,(function(t){t&&!n.promise.isFulfilled()&&i(n)})),n.promise},k.prototype.toJSON=function(){var n=b.prototype.toJSON.call(this),t,i;return n.assetInstanceDefinition=this.assetInstanceDefinition,n.partState=r.toSerializableObject(this.partState||{}),n.initialSize=this.initialSize,n.bindingsInitialized=this._bindingsInitialized,n.savedContainerState=te(this),n.containerModel=ar(this.containerModel,this.modelContainsSensitiveData),n.overridesModel=ar(this.overridesModel,!1),n.originalPartLocator=this.previousLocator,n.flags=this.flags,t=this.adapter,i=this.bindings,n.adapterBindings=t&&t.bindings,n.bindings=t?i.filter((function(n){return n.source.scope===ei.DetailsContainer})):i,n},k.prototype.cloneAs=function(n,t){var r=this,o=ti(),i,u=this.widget?this.widget.options:null,s=[this.awaitComposed(),this.getInputPropertyBindings().awaitAllBound],h=this.adapter;return h&&s.push(h.inputPropertyBindings.awaitAllBound),e.when.apply(e,s).done((function(){var l=r.getNonDetailsContainerPropertyBindings(),h={},c,s;l.forEach((function(n){var t=gt(n.targetModel,n.targetProperty).value;wt.setModelValue(h,n.sourceProperty,f.toJS(t))}));c=f.toJS(r.overridesModel);i=n(h,c);i.widgetState(e.extend(!0,{},r.widgetState()));u&&u.size&&(i.initialSize=u.size(),i.initialSize===99&&(i.initialWidth=u.gridWidth(),i.initialHeight=u.gridHeight()));s=r._partSettingsManager;s&&s.saveIdentityPartSettings(i.containerModel,t);o.resolveWith(r,[i])})).fail((function(){o.rejectWith(r)})),o.promise()},k.prototype.clone=function(){var n=this;return this.cloneAs((function(t,i){return au(n.services,n.locator,null,t,i)}))},k.fromJSON=function(n,t){return ht.createCompositionFromJSON(t,(function(){var i=new k(n,er.fromJSON(t.locator),t.widgetState,t.id);return i.loadPropertiesFromJson(t),i}),(function(i,r){var u=new k(n,i,null,t.id);return u.unrecoverableErrorMessage=r,u}))},k.prototype.getAssetInstanceMetadataAsync=function(){var n=this,t=ti();return this._registrationDeferred.then((function(){var i;n.isDisabled||n.isDisposed()?t.resolve(i):n.getAssetId().then((function(t){i={id:t,type:n.assetType}})).finally((function(){t.resolve(i)}))}),(function(){t.reject()})),t.promise()},u.defineProperty(k.prototype,"assetType",{get:function(){var n=this.assetInstanceDefinition;return n&&n.assetType},enumerable:!0,configurable:!0}),k.prototype.addWidgetToUI=function(n){var t=this.widget;n.parentElement.addChild(t);t.addChild(this._partContainer)},k.prototype.recompose=function(n){this._compose(n,ti(),!0)},k.prototype._compose=function(n,t,r,u){var f=this,h,s,k,l,y,p,c,w;r===void 0&&(r=!1);var o,b=du(this),d=fi(this.locator),a=function(n,t){return f._completeTraceWithState(n,t)};u=u||{};h=function(n){return ai.startTrace({extension:b,source:tr,action:n,name:d,journeyId:f._getTelemetryJourneyId()})};this.calledOnInputsSet.subscribe(this,(function(n){n&&(f._onInputsSetResolvedMarker=h(hi.OnInputsSetResolved))}));this._allOnInputsSet.then((function(){var t=f._readyMarker,n;t&&(a(t,f._perfData),f._readyMarker=null);n=f._onInputsSetResolvedMarker;n&&(f.fullReadyTime=a(n,f._perfData),f._onInputsSetResolvedMarker=null)}));this.awaitContentRevealed().then((function(n){var t=f._revealedMarker;t&&(f._perfData.contentRevealedCalled=n,a(t,f._perfData),f._revealedMarker=null)}));this._registrationDeferred.then((function(){t.resolve()}),(function(){t.reject()}));this._clearLoadingReactor();this._ltm&&this._ltm.dispose();s=this.widget;s&&r?(this._partContainer=s.element.find("."+fu),o=s.options,k=o.commands.splice(0,o.commands.length),k.forEach(i.disposeDisposable),o.actionBarViewModel.update(),this._ltm=s.ltm.createChildLifetime()):(this._partContainer=e("<div class='"+fu+"'><\/div>"),o=new rt.ViewModel(this.id,this.widgetState()),o.inLockedContext=n.options.locked(),o.size()===undefined&&o.size(this.initialSize),o.size()===99&&(o.gridWidth(Math.max(1,this.initialWidth)),o.gridHeight(Math.max(1,this.initialHeight))),s=this.widget=rt.createTileWidget(e("<div/>"),o,(function(){return f._getActions()})),this.widgetState(s.saveViewSettings()),this._ltm=s.ltm.createChildLifetime(),this.addWidgetToUI({parentElement:n,doNotSaveSettings:!0}));l=s.element;y=this._ltm;n.options.locked()||o.isInBlockingLoadingState(!0);l.data(ht.CompositionInstanceDataName,this);y.registerForDispose(l.setEvents([v.default.fxregistermenu,function(n,t){f._menu=t},]));p=function(){if(f._loadedMarker=h(hi.PartLoaded),f._readyMarker=h(hi.PartReady),f._revealedMarker=h(hi.PartRevealed),f.unrecoverableErrorMessage&&f.unrecoverableErrorMessage.length>0)return f._createErrorPart(ni.UnrecoverableError,f.unrecoverableErrorMessage);f._locateDefinitionAndStartCompose(y,o);f._perfData.srcExtension=se(f,b);var t=f.createChildLifetime();n.options.locked.subscribeAndRun(t,(function(n){f._toggleShellCommands(t,!n,o.commands)}))};c=u.delayLoad;cf&&(c=c||function(n){return!it.isElementFullyInViewport(n,0,!0).fullyVisible});w=u.delayLoadPromise;w&&c&&c(l[0])?(this._loadDelayed=!0,Q(w).finally(p)):p()},k.prototype._completeTraceWithState=function(n,t){var r=this,u=function(){return r._menu&&(t=i.extend2(t,r._menu.getTelemetryInfo())),ai.completeTrace(n,t)};return this._creationState?li.usingState(u,this._creationState):u()},k.prototype._locateDefinitionAndStartCompose=function(t,r){var u=this,l=ui(),s,e=function(n,t,i){u._createErrorPart(n,t,i)},a=wr(),o=ct.QtoJ(this.services.finder.locateAsync(this.locator));return this.flags&2&&(o=o.then(null,(function(t){return h.logToExtension(n,u.locator.getExtensionLocator().name,2,"Failed to find redirected part '"+fi(u.locator)+"'.  Failling back to orginal part '"+fi(u.previousLocator)+"'. Error: "+t),ai.trace({source:tr,action:hi.RedirectFallback,actionModifier:or.ActionModifier.Complete,name:fi(u.locator),data:{to:fi(u.previousLocator),error:t},journeyId:u._getTelemetryJourneyId()}),u.flags&=-3,u.locator=u.previousLocator,ct.QtoJ(u.services.finder.locateAsync(u.locator))}))),o.then((function(n){return u._perfData.instanceExtensionLoad=l(),s=ui(),u._processLocatedDefinitionAsync(n)})).then((function(n){return a.then((function(){return n}))})).then((function(n){var a,o,l,h;if(!t.isDisposed())if(u._perfData.referenceExtensionLoad=s(),n){if(u._isRestoredPartLackingBinding(n))if(u.eligibleForBinding)u._bindingsInitialized=!1,u.bindings=[];else if(!n.canUseOldInputVersions){kt.warning("[Definition Change] Bindings for part '"+u+"' have been changed in the definition in an incompatible way.");a={reason:f.observable(i.isDevelopmentMode?c.PartError.titleSettingsDevMode:c.PartError.titleSettings),clickable:!1};e(ni.OldInputsNotHandled,"Bindings for part have been changed in the definition in an incompatible way. Locator: "+u.locator+".",a);return}if(o=u.adapter,u._restoredFromJson&&u._bindingsInitialized!==!1){var v=o?o.bindings:u.bindings,y=o?o.inputDefinitions:n.inputDefinitions,p=br(),w=p.inferInitialBindingsForInputDefinitions(u,y),b=w.filter((function(n){return v.every((function(t){return t.targetProperty!==n.targetProperty}))}));[].push.apply(v,b)}else o?o.bindings=u._constructAdaptedBindings():u._setBindings(n),u.assetInstanceDefinition={assetType:n.assetType,assetIdInputProperty:n.assetIdInputProperty},o&&((o.assetType||o.adaptedPart.assetType)&&(u.assetInstanceDefinition.assetType=o.assetType||o.adaptedPart.assetType),o.assetIdInputProperty&&(u.assetInstanceDefinition.assetIdInputProperty=o.assetIdInputProperty)),l=u._partInstanceDefinition,h=l&&l.reference,h&&h.assetType&&(u.assetInstanceDefinition.assetType=h.assetType),u._bindingsInitialized=!0,u.save();if(u.partDefinition=n,u._partDefinitionDeferred.resolve(),pf(u))e(ni.CustomPartWithMissingTemplate,c.UiCompositionPart.missingTemplateMessage);else return u._composeCommandsAndPart(r,u._partContainer)}else e(ni.PartDefinitionNotFound,"Unable to find the definition for the part. Locator: "+u.locator+".")})).then(null,(function(n){u._partDefinitionDeferred.reject(n);t.isDisposed()||e(ni.ErrorLocatingPartDefinition,n)}))},k.prototype.getInstanceBindings=function(){var n=this._partInstanceDefinition;return n?n.inline?n.inline.bindings:n.reference.bindings:undefined},k.prototype._setBindings=function(n){var r=this.getInstanceBindings(),t=he(r,n.bindings),i;gf(this,t)&&(this.bindings=this.bindings.concat(rr(t,this)));this.bindings.length<=0&&this.locator.type===ii.PartType&&(i=br(),this.bindings=this.bindings.concat(i.inferInitialBindingsForInputDefinitions(this,n.inputDefinitions)))},k.prototype._constructAdaptedBindings=function(){var n=this.adapter,t;return n.bindings.length<=0&&this.locator.type===ii.PartType?(t=br(),t.inferInitialBindingsForInputDefinitions(this,n.inputDefinitions)):rr(n.adaptedPart.bindings,this)},k.prototype._isRestoredPartLackingBinding=function(n){if(this._restoredFromJson){var t=this.adapter,i=t?this._constructAdaptedBindings():rr(n.bindings||[],this),r=t?t.bindings:this.bindings,u=function(n){return!n.optional&&r.firstIndex((function(t){return t.targetProperty===n.targetProperty}))<0};return!!i.some(u)}return!1},k.prototype._getActions=function(){var t=this.services,n=[];return this.getCompositionType()===si.StartboardPart&&n.push(new et.UnpinFromStartboard(this,t).createAction(this)),n.push(new et.OpenContextMenu(this,t,c.ContextMenu.ariaLabel).createAction(this)),n},k.prototype.resetLayout=function(){var n=this.initialSize,r=pt.AllSizes[n>=0?n:pt.getDefaultSize().name],t=r.size,i=this.widget;i.element.trigger(v.default.fxsizechange,[i.options.id,t.width,t.height])},k.prototype.clearIdentitySettings=function(){var n=this._partSettingsManager;n&&n.clearIdentityPartSettings()},k.prototype._processLocatedDefinitionAsync=function(n){var f=this,u=this.services.finder,r=n,t,i;switch(this.locator.type){case ii.PartInstance:case ii.StartboardPartInstance:this._partInstanceDefinition=n;break;case ii.PartType:t=n;t&&t.reference&&(this._partInstanceDefinition={reference:{partTypeName:t.name,bindings:t.bindings,assetType:t.assetType,initialSize:t.initialSize}})}if(i=this._partInstanceDefinition,i){if(i.reference){var e=i.reference.extension||this.locator.getExtensionLocator().name,o=yi(e),s=this._locatorContainingDef=o.withPartType(i.reference.partTypeName);return ct.QtoJ(u.locateAsync(o)).then((function(n){return f._setExtension(n),ct.QtoJ(u.locateAsync(s))})).then((function(n){return n&&n.reference?f._processAdapterAsync(n,e):n}))}r=i.inline}return this.initialSize===99&&(this.initialWidth=r.initialWidth,this.initialHeight=r.initialHeight),this._setExtension(u.locate(this.locator.getExtensionLocator())),ti().resolve(r).promise()},k.prototype._processAdapterAsync=function(n,t){var i=this,r=yi(n.reference.extension||t),e=r.withPartType(n.reference.partTypeName),u=this.services.finder;return ct.QtoJ(u.locateAsync(r)).then((function(t){var o=i+" (AdapterPart. Extension: "+i.extension.name+", ViewModel: "+n.viewModel+")",r;return i.adapter={extension:i.extension,viewModel:null,viewModelName:n.viewModel,viewModelId:o,bindings:i._adapterBindings||[],inputDefinitions:n.inputDefinitions,adaptedPart:i._partInstanceDefinition.reference,allInputsSet:f.observable(!1),calledOnInputsSet:f.observable(!1),failedOnInputsSet:f.observable(!1),inputPropertyBindings:new iu(o,{},!1),assetType:n.assetType,assetIdInputProperty:n.assetIdInputProperty},i._partInstanceDefinition={name:i._partInstanceDefinition.name,reference:n.reference},r=i.adapter.adaptedPart.assetType,r&&(i._partInstanceDefinition.reference.assetType=r),i._setExtension(t),ct.QtoJ(u.locateAsync(e))})).then((function(r){var u=ti();return r&&r.reference?(kt.error("Error processing the part defintion for part '{0}'. Adapted part definition '{0}:{1}' cannot reference another adapted part definition '{2}:{3}'.".format(i,i.adapter.extension.name,n.reference.partTypeName,r.reference.extension||t,r.reference.partTypeName)),u.reject()):(i._setBindings(r),u.resolve(r)),u.promise()}))},k.prototype.getTitle=function(){var t=this.getViewModel(),n;return t&&(n=t.container,n)?n.partTitle&&n.partTitle()||"":""},k.prototype._composeCommands=function(n){var t=this,i=ft.getCommandGroupForDefinitionItem(this.services.finder,this.extension.name,this.partDefinition),r=[],u={viewModelName:this+"-[ContainerModel]",viewModel:this.containerModel};i&&(i.commands.forEach((function(n){t._canPopulateCommand(n)&&r.push(new ft.ExtensionCommandMenuItemImpl(t,t.extension,t,n,t.partDefinition,t.services,u))})),n.splice.apply(n,[0,0].concat(r)))},k.prototype._canPopulateCommand=function(n){var t=this.parent&&this.getPartsContainer();return t?n.details&&t.flags&1?(kt.error("Part '"+this+"' cannot have the open blade command '"+(n.name||n.text)+"', because it is inside the context blade."),!1):!0:!0},k.prototype.disableForAssetDeleted=function(n,t){var u,e,r,f,o;this._disabled=!0;u=this._vm;u&&u.container&&(e=this._getNotFoundMessage(),e(ff.deletedTitle));r=this.widget;r&&r.options&&(f=r.options.commands,o=f.splice(0,f.length,new et.UnpinFromStartboard(this,this.services)),o.forEach(i.disposeDisposable));this.save();kt.warning("Part '{0}' disabled because asset was deleted. {1}".format(this,t))},k.prototype._composeCommandsAndPart=function(n,t){try{this._composeCommands(n.commands);this._composePart(t,n);this._attachEventHandlers(t)}catch(i){return e.Deferred().reject(i).promise()}},k.prototype._attachEventHandlers=function(n){var t=this,i=function(n,i){t.widgetState(i);t.save();n.stopPropagation()},r=function(i,r){var f=t.widget.options,u=!!di.InternalPartSize[r];r=u?r:t.widget.options.size();yr(t._vm,n,f,r,u)},u=function(n,i){t._handleRightClick(n,i)},f=function(n,i){i.masterPartId=t.id},e=function(n,i){n.stopPropagation();var r=t.locator.getExtensionLocator();t.services.desktop.pinMultipleParts(i.partReferences,r.name)};this.resourceLTM().registerForDispose(this.widget.element.setEvents([ut.Widget.viewSettingsChanged,i],[v.default.fxsizechanged,r],[v.default.fxrightclick,u],[v.default.fxensurebladevisible,f],[l.fxpinmultipleparts,e]))},k.prototype._toggleShellCommands=function(n,t,i){vt.composeShellCommands(n,this,i,this._showShellCommands=t,this.services)},k.prototype._getPartContext=function(){var n=oi(this)||{},t=this.getPartsContainer(),i=!!n,r=t&&t.getCompositionType()===si.Startboard;return{id:fi(this.locator),instanceId:this.instanceId,bladeId:fi(n.locator),bladeInstanceId:n.instanceId,onBlade:i,onStartBoard:r,bladeCustomized:!1,loadDelayed:!!this._loadDelayed}},k.prototype._updateRebindSequenceNumber=function(){this.instanceId="Part_"+i.sessionId+"_"+this._sequence+"_"+this._rebindCount++},k.prototype._getPartViewModelAsync=function(n,t,u,e,s,h,c){var l=this,v,y=lt.needContainerSelectable(this.partDefinition.details),p=ui(),w=li.provideContext((function(){l._creationState=li.getState();var i=l.parent&&l.getPartsContainer(),o=i?i.getCompositionType():si.Unknown,c=i?o===si.Startboard?1:2:0,e=i&&i.bladeDefinition,a=e&&e.templateBlade?1:0,r;return r=i&&i.flags&1?1:0,r|=cu(l)?2:0,(v=vf(l,i,l._journey))&&(r|=4),l.extension.getPartViewModel(n,{initialState:f.toJS(l.partState),createSelectable:y,partSize:t,partLocation:c,collapsed:u,onInputsSetParameters:s,onViewModelAcquired:h&&function(n){pr(n&&n.content)||h(n)},locator:l.locator,containerType:a,flags:r})}),gr.Part,this._getPartContext());return w.then((function(n){var t=n&&n.content,i=pr(t)&&t.chrome._msPortalFxV2ShellApi&&t.chrome._msPortalFxV2ShellApi();return l._partShellApiDeferred.resolve(i),n}),(function(n){return l._partShellApiDeferred.reject(n),Q.reject(n)})).then((function(n){var f,u,e=n&&n.content,s,t;return pr(e)?(u=i.cloneAndRebindFunctions(n),u.content=o.markAsV2(e.chrome),f=e.viewModel.fxAwaitAndRun(l).then((function(t){var r=i.cloneAndRebindFunctions(n);return r.content=t,h&&h(r),r})),l._setupLoadingReactor(c,n.container.operations)):f=Q.resolve(u=n),l.partDefinition.shareVmWithParentBlade&&(s=oi(l),s.setViewModelForTemplateOrMenuBlade(u),s.setInputsSetPromise(l._allOnInputsSet)),t=n&&r.shellInterface(n.container),t&&(t.closeBlade(af(l)),t.menu(v),t.openDialog((function(t,i){return l.services.getService("DialogManager").then((function(r){n.internal.dialog(t);var u=cu(l)?function(){return Q(oi(l).widget)}:function(){return l.services.getService("PortalFormTarget")},f=i?function(){return l.services.getService("PortalFormTarget")}:u;return f().then((function(n){var u=l.widget.element[0];return typeof i=="string"?u=l.widget.element.find(i)[0]:typeof i=="object"&&(u=a.unwrapFxElement(i)),r.showShellDialog(t,n,u,l.locator,!1).then((function(n){t.onClosed&&t.onClosed({button:n})})),!0}))}))}))),f})).then((function(n){var r=l.services.finder,t=r.locate(l.locator),u=ui(),i=n&&n.content;return s&&dt.notifyOnInputsSetCalled(e,s,n&&n.onInputsSetPromise&&Q(n.onInputsSetPromise)),t&&t.reference&&t.reference.extenderViewModel?(l._extenderVMExtn=r.locate(l.locator.getExtensionLocator(),l.extension.name),Q(l._extenderVMExtn.getViewModel(t.reference.extenderViewModel)).then((function(r){return r&&r.content?i&&f.isObservable(i.extenderViewModel)?(l._extenderVM=r,i.extenderViewModel(r.content)):kt.error("Part '"+l+"' defines extender view model '"+t.reference.extenderViewModel+"' but the referenced part is not marked as extensible."):kt.error("Extender view model '"+t.reference.extenderViewModel+"' for part '"+l+"' must be an object."),n})).finally((function(){l._perfData.extenderViewModelLoad=u()}))):n})).finally((function(){l._perfData.partViewModelLoad=p()}))},k.prototype._getAdapterViewModelAsync=function(){var n=this;if(!this.adapter)return Q(null);vu(this);var t=ur(this._getAdapterAllInputsSetWatcherConfig()),r=dt.loadOnInputsSetParameters(t),i=this.adapter;return r.then((function(r){n._earlyAdapterOnInputsSet=!!r;n._perfData.earlyOnInputsSetAdapter=n._earlyAdapterOnInputsSet;var u=ui();return i.extension.getViewModel(i.viewModelName,{onInputsSetParameters:r}).then((function(n){return i.viewModel=n,r&&dt.notifyOnInputsSetCalled(t,r,n&&n.onInputsSetPromise),t})).finally((function(){n._perfData.adapterViewModelLoad=u()}))}))},k.prototype._bindAssetNameFromAdapter=function(){var r=this,t=this.adapter,n,i;t&&(n=gt(t.viewModel,"content.assetName"),n.exists)&&(f.isObservable(n.value)?(i=n.value,f.computed(this,(function(){var t=i(),n=r._vm;!nr(t)&&n&&n.container&&wt.setModelValue(n,"container.assetName",t)}))):kt.error("Failed to bind the asset name from the adapter view model for Part '{0}', because the asset name needs to be an observable.".format(t.viewModelId)))},k.prototype._composePart=function(n,t){var r=this,a;if(!this.isDisposed()){var y=this.locator,h=this.partDefinition,k=h.partKind,f=g.getPartFactory(this.extension.name,h,this.extension.definition.htmlTemplates),u,s,p;if(f){h.resizeMode!==1?t.supportedSizes(f.supportedSizes):t.supportedSizes([]);this._inputBindings=null;this.getInputPropertyBindings();var w=ct.QtoJ(this._getAdapterViewModelAsync()),l=this.services.finder.locate(y),d=l&&l.reference&&l.reference.extenderViewModel,b=this.bindings||[],nt=b.some((function(n){return n.source&&n.source.scope===ei.DetailsContainer})),tt=this.adapter&&b.some((function(n){return n.source&&n.source.modelType===ci}));d||nt||!this.extension.canUseInputsSetParameters(y)?s=ti().resolve(null).promise():(a=function(){return r.isDisposed()?ti().resolve(null).promise():(r._registerInputPropertyBindings(),u=ur(r._getAllInputsSetWatcherConfig()),ct.QtoJ(dt.loadOnInputsSetParameters(u)))},s=tt?w.then(a):a());s=ie(s);this._vmPromise=s.then((function(s){if(r.isDisposed()){r._releaseResources();return}r._earlyOnInputsSet=!!s;r._perfData.earlyOnInputsSetPart=r._earlyOnInputsSet;var h=r.partDefinition,p=h.partKind===ri.ResourceSummary?r._getSummaryPartViewModelState():null,y=r.widget,l=y&&y.options,a=l?l.size():r.initialSize,b=ct.QtoJ(r._getPartViewModelAsync(h.viewModel,a,p,u,s,u&&function(n){return r._setupInvocationProperties(f.viewStateProperties,n)},t));return e.when(b,w).fail((function(n){r.isDisposed()||i.Errors.isInstanceOfErrorType(n,i.Errors.CanceledError)||r._createErrorPart(ni.ErrorAcquiringViewModel,n)})).done((function(i,e){var s=ui();if(r.setViewModel(i),r.isDisposed())r._releaseResources();else if(i){if(!r.isDisabled){r._bindAssetNameFromAdapter();r.resourceLTM().registerForDispose(r.widget.element.setEvents([v.default.fxportalcontrolloadfailed,function(n,t){r._createErrorPart(ni.ErrorLoadingControl,t)},]));h.partKind===ri.ResourceSummary&&r._autoOpenSettingsFromSummary();var y=l?l.size():r.initialSize,p=y!==a,w=h.partKind===ri.Provisioning;yr(r._vm,n,t,y,p);o.isV2(i.content)||r._setupLoadingReactor(t,i.container.operations);t.userResizable(r.getCompositionType()===si.StartboardPart&&h.resizeMode===2);p?r.extension.processMessages().finally((function(){r.isDisposed()||r._setupPartWidget(n,f,u,e,a,w,s)})):r._setupPartWidget(n,f,u,e,a,w,s)}}else r._createErrorPart(ni.ViewModelMissing,c.UiCompositionPart.viewModelRequired)}))}))}else p="Incorrect part type '{0}'.".format(k),this._createErrorPart(ni.IncorrectPartType,p)}},k.prototype._setupPartWidget=function(n,t,u,e,o,s,h){var c=this,l=this.widget,y=this.getViewModel(),a;this._perfData.prepareViewModel=h();a=ui();p.setSelectableContext(this,this._vm,this._partContainer);i.tryImmediateResolve(this._createPartWidget(t,y,s),(function(){var o,s,i;if(c.isDisposed())return Q.reject(new gi);if(o=c.partDefinition,o.shareVmWithParentBlade||f.reactor(c,(function(){var n=c._getNotFoundMessage()();c._part.notFoundMessage(n)})),yr(c._vm,n,l.options,l.options.size(),!1),c.register(t.viewStateProperties,u,e),ne(c),c._ensureAssetAffinity(),c._perfData.finalizePartCompose=a(),o.resizeMode===1){if(s=c.extension&&c.extension.name,s!=="AppInsightsExtension"&&s!=="SamplesExtension")return;i=r.shellInterface(c._vm.container);i.autoSize.subscribe(c,(function(n){if(n){i.autoSize(!1);var r=c.widget,t=r.element,u=t.find(".fxs-part-content"),f=u.find("> div");if(f.length!==1)return;var e=f[0],o=u[0],s=t.outerWidth()+Math.floor(e.clientWidth-o.clientWidth),h=t.outerHeight()+Math.floor(e.clientHeight-o.clientHeight);t.trigger(v.default.fxsizechange,[r.options.id,s,h])}}));i.resize.subscribe(c,(function(n){if(n&&n.width&&n.height){var t=pt.getGridPixelSize(n.width,n.height);c.widget.element.trigger(v.default.fxsizechange,[l.options.id,t.width,t.height])}}))}}),(function(n){c._createErrorPart(ni.ErrorCreatingWidget,n)}))},k.prototype.register=function(t,i,r){var u=this,e=this.parent&&this.getPartsContainer(),o,s,f;this._removeOutputArgumentValuesFromContainerModel();(this.bindings||[]).forEach((function(n){var t=n.source.modelType;u._hasRebindableInputs||n.source.scope!==ei.CurrentContainer||t!==1&&t!==ci&&t!==bi||(u._hasRebindableInputs=!0)}));this._listenForPartMutation();this.adapter&&!r&&vu(this);i||(this._registerInputPropertyBindings(),this._setupInvocationProperties(t,this._vm));this._partSettingsManager.configureInstanceProperties(this._viewStateProperties);this._partSettingsManager.initialize();wi(this,"./UI.Composition.SelectableRegistration",(function(n){n.listenForRegistrationChanges(u,u._vm,u)}),n);oe(this,(function(n){n.autoRegisterSelectables(u,u._vm,u)}));o=this.getInputPropertyBindings();this._setupBladeRebindingHandlers(e);s=ui();this.save();i||(i=ur(this._getAllInputsSetWatcherConfig()));i.bindableTarget.viewModel=this._vm;this._setContainerInputsChanging=function(n,t){n?dt.turnOnInputsSetSuppressionOn(i):t?dt.turnOnInputsSetSuppressionOff(i,t):dt.turnOnInputsSetSuppressionOff(i)};dt.setupAllInputsSetWatcherFromExtendedConfig(i);this.adapter&&(r||(r=ur(this._getAdapterAllInputsSetWatcherConfig())),r.bindableTarget.viewModel=this.adapter.viewModel,dt.setupAllInputsSetWatcherFromExtendedConfig(r));wr().then((function(n){n.listenForConfigurationChanges(u,r,i)}));f=function(){u._finishCompose(e,o,s)};this.partDefinition.shareVmWithParentBlade?setTimeout(f):this.extension.processMessages().finally(f)},k.prototype._finishCompose=function(n,t,i){var r=this,u,o,f;this.isDisabled||this.isDisposed()||(n&&n.notifyPartComposed(this),this._registrationDeferred.resolve(),u=[t.awaitAllBound],this.adapter&&u.push(this.adapter.inputPropertyBindings.awaitAllBound),o=i(),f=this._allInputPropertyBindingsBound,e.when.apply(e,u).done((function(){var n=r._perfData;f.resolve();n.allInputBindingsBoundPreprocess=o;n.allInputBindingsBound=i();r._loadedMarker&&(r.compositionTime=r._completeTraceWithState(r._loadedMarker,n),ai.trace({source:tr,action:hi.PartLoadedNoExtensionDerived,actionModifier:or.ActionModifier.Complete,name:fi(r.locator),duration:r.compositionTime-n.referenceExtensionLoad-n.instanceExtensionLoad,data:n,journeyId:r._getTelemetryJourneyId()}),r._loadedMarker=null)})).fail((function(){f.reject()})),this.save())},k.prototype._registerInputPropertyBindings=function(){var n=this,i=[],r=[],u=[],t;this._journey=this.services.desktop.getActiveJourney();(this.bindings||[]).forEach((function(n){n.source.scope===ei.DetailsContainer?u.push(n):r.push(n);!n.isIdentityInput||i.push(n.targetProperty)}));this._partSettingsManager.configure(this._getPartSettingsManagerConfig(i,this._viewStateProperties));t=this.getInputPropertyBindings();ir(this,t,u);ir(this,t,r,(function(t){return n.adapter?n.adapter?n.bindAdaptedInput(t):void 0:n.bindAgainstOverridesOrContainerModel(t)}));this._setEditScope();this._setupJourneyEditScopeReactor()},k.prototype.bindAdaptedInput=function(n){var t=n.source,i=t&&t.modelType;switch(i){case ci:return{sourceModel:this.adapter.viewModel,sourceModelName:this+"-[Adapter]"};case bi:return{sourceModel:this.adapter.inputPropertyBindings.targetModel,sourceModelName:this+"-[AdapterInputs]"}}},k.prototype.getNonDetailsContainerPropertyBindings=function(n){n===void 0&&(n=!0);var t=this.adapter,i=n&&t?t.inputPropertyBindings:this.getInputPropertyBindings();return i.properties.filter((function(n){var t=n.compositionBindingDefinition,i=t&&t.source&&t.source.scope;return i!==ei.DetailsContainer}))},k.prototype.bindAgainstOverridesOrContainerModel=function(n){var t,r,i,u;if(n.source.id!==this.id){if(bu(n))return null;if(t=n.source.property,r=this.overridesModel,gt(r,t).exists)return{overridesConstantBindings:!0,sourceModelName:this+"-[OverridesModel]",sourceModel:r};if(i=this.containerModel,i&&gt(i,t).exists)return{sourceModelName:this+"-[ContainerModel]",sourceModel:i};if(kr(n.source))return u={},wt.setModelValue(u,t,undefined),{sourceModelName:this+"-[Inferred]",sourceModel:u}}},k.prototype._setupInvocationProperties=function(n,t){var i=this,r=this.partDefinition,u;(this._vm=t,!this._vm||this.isDisposed()||this.isDisabled)||(this._setViewStateProperties(r.viewStateProperties,n),u=re(),this.setBladeOpener(u.create(this._getBladeOpenerConfig())),kf(this,this.partDefinition,this._restoredFromJson)&&r.details&&r.details.length&&(r.details.forEach((function(n){df(i,n)&&i._registerInvocationProperty(n)})),this.resourceLTM().registerForDispose(this.widget.element.setEvents([v.default.fxopeninnewtab,function(n,t){var r=t.selectable,u=lt.getAssociatedDetailDefinition(r||t.selectableSet,i.getViewModel(),i.partDefinition),f,e;u&&(f=r?r.selectedValue():vt.createSelection(t.selectableSet,t.item),e=Q(f).then((function(n){var t=i._bladeOpener.createBladeModelForSelectedItem(u,n),r=t&&t.locator;return r?y.getBladeDeepLink(r.getExtensionLocator(),r.name,uf.location.href,t.model):null})),i.services.diContainer.get(st.WindowManager).openWindow(e))}]))))},k.prototype.selectOnReady=function(n,t){var i=this;return Q.all([this.awaitComposed(),this._allInputPropertyBindingsBound.promise()]).then((function(){return i._part.selectOnReady(n||function(){return!0},t)}))},k.prototype.getSelectableAsync=function(n){return this.getViewModelAsync().then((function(t){var r=typeof n=="string"?n:lt.getSelectablePath(n),i=gt(t,r);if(i.exists)return f.unwrap(i.value)}))},k.prototype._getBladeOpenerConfig=function(){var n=this;return{services:this.services,masterModelId:ki(this),masterModel:this.getViewModel(),referenceComposition:this,referenceExtension:this.extension,invocationThrottleDuration:this.invocationThrottleDuration,isBladeOpenedByMaster:function(t){return lu(n,t)},onBladeOpened:i.noop,addOutputBindings:function(t,i){wf(n,t,i)},removeOutputBindings:function(t){bf(n,t)},configureBladeDescriptor:function(t){t.masterPartId=n.id;t.bindings&&t.bindings.forEach((function(i){i.source&&i.source.id===n.id&&(t.model[i.targetProperty]=f.toJS(gt(n._vm,i.source.property).value))}))},initialViewModelState:f.toJS(this.partState)}},k.prototype.loadState=function(n){var i=this;this.partDefinition&&n&&this._vm&&this._vm!==t.EmptyViewModel&&this._viewStateProperties.forEach((function(t){var r=gt(n,t);r.exists&&!t.startsWith("internal.")&&wt.setModelValue(i._vm,t,r.value)}))},k.prototype._setupLoadingReactor=function(n,t){var r=this,i,u;this.partDefinition.partKind!==ri.Provisioning&&(this._frameBlockingUi(ku(this.partDefinition)),this._loadingReactorLifetime=this.createChildLifetime(),f.reactor(this._loadingReactorLifetime,(function(){var i=t.inProgress();n.hasOngoingOperation(i&&!n.locked());r.triggeringLockedBladeSpinner(i&&n.locked())})),i=oi(this),u=f.computed(this._loadingReactorLifetime,(function(){return t.blockingUi()||r._frameBlockingUi()||r._contentInitializing()})),i&&i.bladeDefinition&&i.bladeDefinition.templateBlade&&(f.reactor(this._loadingReactorLifetime,(function(){i.shieldType&&i.shieldType(t.shieldType())})),i.uiBlockers.push(u)),u.subscribe(this._loadingReactorLifetime,(function(i){var f=t.shieldType()===1||n.locked(),u;n.isInBlockingLoadingState(i&&!f);i||(u=n.hasOngoingOperation(),r._contentRevealed.resolve(u))})),u()||(this._contentRevealed.resolve(t.inProgress()),n.isInBlockingLoadingState(!1)))},k.prototype._removeOutputArgumentValuesFromContainerModel=function(){var n=this.partDefinition,t=this.containerModel;t&&n&&n.details&&n.details.forEach((function(n){var i=n.outputArguments;i&&i.forEach((function(n){var i=n.valuesFrom;i&&i.forEach((function(n){var i=n.property;gt(t,i).exists&&wt.setModelValue(t,i,undefined)}))}))}))},k.prototype._getPartSettingsManagerConfig=function(n,t){return{services:this.services,part:this,instanceProperties:t,partViewModelId:ki(this),partStateDefinition:this.partDefinition&&this.partDefinition.partState,identityInputs:n}},k.prototype._listenForPartMutation=function(){var n=this,r=this.partDefinition,t,u=this._vm.container,i;u.mutate&&!r.shareVmWithParentBlade&&(i=this.createChildLifetime(),u.mutate.subscribe(i,(function(u){var o=n.locator.getExtensionLocator(),f;if(u.partName)t=u.extensionName?yi(u.extensionName).withPartType(u.partName):o.withPartType(u.partName);else{if(f=r.assetTypeDefinition,!f){kt.error("Mutate function on part {0} was called with an object but the mutating part doesn't have an asset type definition.".format(n.locator.toString()));return}t=yi(o.name).withPartType(f.partName)}var e=n.getPartsContainer(),s=e&&e.locator&&e.locator.type===ii.Blade,h={newPartContainerModel:u.containerModel,preventNewPartActivation:u.preventActivation||s,invoker:"mutation"};n.services.desktop.replacePart(n,t,h).fail((function(i){var r="Unable to replace provisioning part '"+n.locator.toString()+"' with the part for the created asset defined by the locator '"+t.toString()+"'\r\n"+i+".";kt.error(r)})).finally((function(){n._disposeEditScope();i.dispose()}))})))},k.prototype._updateForHasPermissions=function(n){var i=this;return this._vmPromise.then((function(){var r=i._vm,u,f;r===t.EmptyViewModel||i.isDisposed()?kt.warning("Part '{0}' has not retrieved view model when checking permissions.".format(i.locator.toString())):(u=r.container,f=i.widget,n?u.unauthorizedMessage(null):(f&&f.options.isInBlockingLoadingState(!1),u.unauthorized(),r.updatePartForUnauthorized()))}))},k.prototype._getAllInputsSetWatcherConfig=function(){var t=this,f=this.widget,o={bindableTarget:{viewModelName:ki(this)},propertyBindings:this.getInputPropertyBindings(),allInputsSet:this.allInputsSet,calledOnInputsSet:this.calledOnInputsSet,failedOnInputsSet:this.failedOnInputsSet,referenceComposition:this,notifyWhenInputsChangeWithSameValues:!0,inputsSetCalled:function(n,i){i.finally((function(){t._onInputsSet.resolve();t._contentRevealed.resolve(!1);t._lastRebindOnInputsSetProperties&&(e.isEmptyObject(t._lastRebindOnInputsSetProperties)||ht.deepSubset(n,t._lastRebindOnInputsSetProperties))&&f&&f.options.isInBlockingLoadingState(!1)}))},beforeViewModelPropertyUpdate:function(r){if(t.partDefinition.permissions){var u=ui(),f=t.locator.toString();return bt.checkPermissions(t.partDefinition.permissions,tf.All,r,t.partDefinition.assetType,t.extension.name,t.services,f).then((function(r){return t._updateForHasPermissions(r).catch((function(r){h.logToExtension(n,t.widget.element,2,"Part permission check failed. Error: "+i.getLogFriendlyMessage(r))})),r})).finally((function(){t._perfData.checkPermissions=u()}))}return Q(!0)},getInputsMetadata:function(){return Q(wr()).then((function(n){var i=n.getConfigurableInputsMetadata(t);return u.keys(i).forEach((function(n){var t=i[n];(t&&t.bindingSources||[]).forEach((function(n){delete n.sourceReference}))})),i}))},getDashboardFilters:function(){var n=t.parent&&t.getPartsContainer();return n&&n.getFilters?n.getFilters():{}},getPartFilters:function(){return t.filters||{}}};return this.partDefinition&&this.partDefinition.partState&&this._partSettingsManager&&(o.getStateAsync=function(){return Q(t._partSettingsManager.getPartSettingsAsync()).then((function(n){return t._part&&t._part.partSettingFailed(!1),n}),(function(n){return t._part&&t._part.partSettingFailed(!0),r.QReject("Failed to retrieve part settings for part '"+t+"'.",{innerErrors:n})}))}),o},k.prototype._getAdapterAllInputsSetWatcherConfig=function(){var n=this.adapter;return{bindableTarget:{viewModelName:n.viewModelId},propertyBindings:n.inputPropertyBindings,allInputsSet:n.allInputsSet,calledOnInputsSet:n.calledOnInputsSet,failedOnInputsSet:n.failedOnInputsSet,referenceComposition:this,notifyWhenInputsChangeWithSameValues:!0}},k.prototype.notifyDetailBladesRehydrated=function(n){!this.isComposed||this.isDisabled||this.isDisposed()||this._bladeOpener.notifyDetailBladesOpened(n)},k.prototype.notifyDetailBladeClosed=function(n){var t=this;this.awaitComposed().done((function(){var r=n.masterCommandName,u=t._vm.container,i;t.isDisabled||t.isDisposed()||!nr(r)||t._bladeOpener.notifyDetailBladeClosed(n);i=u&&u.selectable;i&&!nr(r)&&i.isCommandSelected(!1)}))},k.prototype.beforeActivateCommandMenuItems=function(n){n.isControlContextMenu||this._contextMenuViewModels&&(this._contextMenuViewModels.dispose(),this._contextMenuViewModels=null)},k.prototype._handleRightClick=function(t,r){var u=this,e=r&&r.listData&&r.listData.selectableSet,o,s;this.isDisabled||this.isDisposed()||(e instanceof w.SelectableSet2&&e.commandGroupProvider?(o=f.utils.peekObservable(r.viewModel.data),e.commandGroupProvider(o).then((function(n){var f=i.clone(r,!1,!1);f.viewModel=o;f.commandGroupOwner=n[0].owner;f.commandGroup=n[0].id;u._determineExtensionAndTriggerContextMenu(t,f)}))):(s=w.isSelectableSet2(e)?undefined:e,r.supplyCommands||s&&s._msPortalFxSupplyCommands?wi(this,"./UI.Composition.ContextMenuV2",(function(n){var i={partComposition:u,services:u.services},f=n.OpenContextMenuPipeline.createPipeline(u,i,u);f.startTask({dataItem:r.viewModel,extension:u.extension,contextMenuArgs:r,evt:t})}),n):this._determineExtensionAndTriggerContextMenu(t,r)))},k.prototype._determineExtensionAndTriggerContextMenu=function(t,i){var r=this,f=this.services,u=this.extension,o=function(n){var t=f.finder.locateAsync(yi(n.commandGroupOwner));return t.fail((function(){kt.error("Could not find extension '{0}' for commandGroup {1} from part in extension {2}.".format(n.commandGroupOwner,n.commandGroup,u.name))})),t},e=function(n,u){r._contextMenuViewModels=n.fireContextMenuEvent(r,f,r,u,t,i,r._showShellCommands,r._bladeOpener)};wi(this,"./UI.Composition.ContextMenuContainer.DemandLoad",(function(n){i.commandGroupOwner&&i.commandGroupOwner!==u.name?o(i).then((function(t){e(n,t)})):e(n,u)}),n)},k.prototype.isSelected=function(){var t=f.unwrap(this._vm.container).selectable,n=f.unwrap(t);return n&&f.unwrap(n.isSelected)},k.prototype.awaitComposed=function(){return this._registrationDeferred.promise()},k.prototype.awaitPartDefinition=function(){return this._partDefinitionDeferred.promise},k.prototype.awaitOnInputsSetComplete=function(){return this._allOnInputsSet},k.prototype.awaitContentRevealed=function(){return this._allContentRevealed},k.prototype._createErrorPart=function(n,t,r){var e,s,u;if(this.isDisposed())return Q.reject(new gi);var o=this.locator,a=g.getPartFactory(dr.getWindowId(o.getExtensionLocator()),{partKind:ri.Error}),h=this.extension,c=nu.composePartViewModel((function(){return r=r||{},r.title=f.observable(o&&o.name),r.subtitle=f.observable(h&&h.name),r})),l=i.getLogFriendlyMessage(t);return this._traceErrorTelemetry(n,l),kt.error("Error composing part '"+this+"'. Details: "+l,1),e=this._savedContainerState,s=c.container,e&&(s.partTitle(e.partTitle),s.assetName(e.assetName)),this._registrationDeferred.reject(t),u=oi(this),u&&u.bladeDefinition&&u.bladeDefinition.templateBlade&&u.widget.options.loaded(!0),this._createPartWidget(a,c,!0,!0)},k.prototype._createPartWidget=function(n,t,r){var u=this;if(this.isDisposed())return Q.reject(new gi);var e=oi(this),o=!!(e&&e.bladeDefinition&&e.bladeDefinition.templateBlade),s={size:this.widget.options.size,locator:this.locator,getDebugId:function(){return ki(u)},traceErrorTelemetry:function(n){u._traceErrorTelemetry(ni.TransitionedToErrorState,n)},isV2Part:this.partDefinition&&this.partDefinition.isV2,isVirtualPartForTemplateBlade:o};return r&&this.widget.options.isInBlockingLoadingState(!1),i.tryImmediateResolve(n.createPart(this._partContainer[0],t,s,this.services),(function(n){var i,r,t,e;if(u.isDisposed())return Q.reject(new gi);u._part=n;ku(u.partDefinition)&&n.awaitContentRevealed?(i=n,i.awaitContentRevealed().then((function(){u._frameRevealed.resolve(!0);u._frameBlockingUi(!1)})),i.awaitInitializationComplete().then((function(){u._frameRevealed.resolve(!1);u._frameInitialized.resolve();u._frameBlockingUi(!1)}))):(u._frameRevealed.resolve(!1),u._frameInitialized.resolve());r=u.partDefinition;n.setupContent({extensionWindowId:u.extension&&dr.getWindowId(u.extension),styleSheets:r&&r.styleSheets}).finally((function(){u._contentInitializing(!1)}));f.computed(u,(function(){var n=u.parent,t=n&&n.widget,i=t&&t.options.locked();u.widget&&u.widget.options.locked(i);u._part&&u._part.lockedUiContext(i)}));t=u.widget;e=t&&t.ltm&&t.element;e&&u.resourceLTM().registerForDispose(e.setEvents([v.default.fxerrorpartclicked,function(){u.services.desktop.replacePart(u,u.locator,{newPartContainerModel:u.containerModel,newPartOverridesModel:u.overridesModel,doNotSaveSettings:!0})},]))}))},k.prototype.loadPropertiesFromJson=function(n,t,i){t===void 0&&(t=!1);var f=dt.bindingsFromJSON,u=n.partState;this.assetInstanceDefinition=n.assetInstanceDefinition;this.bindings=i?rr(i,this):f(n.bindings)||[];this.initialSize=n.initialSize;this._bindingsInitialized=n.bindingsInitialized;this._restoredFromJson=!0;this.loadFromJson(n);this._savedContainerState=n.savedContainerState;this.containerModel=vr(n.containerModel);this.overridesModel=vr(n.overridesModel)||{};this.partState=r.isSerializedObject(u)?r.fromSerializableObject(u):u;t&&pu(this.partState);n.originalPartLocator&&(this.previousLocator=er.fromJSON(n.originalPartLocator));this.flags=n.flags||0;this._adapterBindings=f(n.adapterBindings)},k.prototype.calculateInitialSize=function(){var n,h,a,v,i={},c=this.services.finder,f=this.locator,e=f.type,o,t,r,y,p,l,u,s;e===ii.PartInstance||e===ii.StartboardPartInstance?c.tryLocate(f,i)&&(o=i.value,o&&(t=o.inline,r=o.reference,h=t?t.initialSize:r.initialSize,a=t?t.initialWidth:r.initialWidth,v=t?t.initialHeight:r.initialHeight,t?n=t:(y=yi(r.extension||f.getExtensionLocator().name),p=y.withPartType(r.partTypeName),i={},c.tryLocate(p,i)&&(n=i.value)))):e===ii.PartType?(i={},c.tryLocate(f,i)&&(n=i.value)):kt.error("Unable to create Part composition. Invalid locator type: '{0}'".format(e));this._bindingsInitialized=!1;l=g.getPartSizeOrDefault(n);u=l;di.InternalPartSize[h]?u=h:n&&di.InternalPartSize[n.initialSize]?u=n.initialSize:n&&(s=g.getPartFactory(this.extension&&this.extension.name,n,{}),u=s&&s.defaultSize!==undefined?s.defaultSize:l);this.initialSize=u;this.initialSize===99&&(this.initialWidth=a||n&&n.initialWidth,this.initialHeight=v||n&&n.initialHeight)},k.prototype.getDiagnosticsData=function(){return e.extend(b.prototype.getDiagnosticsData.call(this),{bindings:dt.mapBindingsToFriendlyObjects(this.bindings)})},k.prototype._getSummaryPartViewModelState=function(){var n=v.default.fxsummarycollapsed,t=e.Event(n);return this.widget.trigger(n,t),t.result},k.prototype._autoOpenSettingsFromSummary=function(){var t=this,n;hf==="true"&&(this._restoredFromJson||(n=this.getPartsContainer(),Q.all([n.getPermissionPromise(),this.awaitComposed()]).then((function(){var u=gt(t._vm,"content.hasSettings"),i,r,e;u.exists&&f.unwrap(u.value)&&(i=gt(t._vm,"content.settingsSelectable"),i.exists&&(r=f.unwrap(i.value),e=n.detailContainers,r&&(e||[]).length<=0&&n.canAutoOpenSettings()&&(t.widget.element.trigger(v.default.fxautosettings,{masterBladeId:n.instanceId,masterPartId:t.instanceId}),r.isSelected(!0))))}))))},k.prototype._getEditScopeIdFromSettings=function(){var n=this._journey,t=n&&n.ambientSettings.getItem(this.journeyPath),i=t&&t.value,r=i&&i.editScope;return r&&r.editScopeId},k.prototype._setupJourneyEditScopeReactor=function(){var n=this.partDefinition,t=this._journey;n&&n.editScopeType&&t&&t.observeEditScopeChanges(this,{editScopeId:this.editScopeId,ownerType:this.locator.type,ownerLocatable:this})},k.prototype._setEditScope=function(){var f=this.partDefinition,t,n,r,e,u;if(f&&f.editScopeType){if(t=this._getEditScopeIdFromSettings(),n=this.editScopeId,t)n(t);else{n(i.getUniqueId());this.services.diContainer.get(tt.EditScopeManager).onEditScopeCreated(n())}r=this.getInputPropertyBindings();e=r.properties.some((function(n){return n.targetProperty===vi}));e||(u={},u[vi]=n,r.mapProperty(vi,vi).bind(this+"-[EditScopeId]",u,!0))}},k.prototype._getCommands=function(){if(!this.isComposed||!this.widget)throw new Error("Part '"+this+"' needs to be composed before retrieving its commands.");var n=this.widget;return n.options.commands},k.prototype._setupPromises=function(){this._onInputsSet=Q.defer();this._contentRevealed=Q.defer();this._allOnInputsSet=Q.all([this._onInputsSet.promise,this._frameInitialized.promise]);this._allContentRevealed=Q.all([this._contentRevealed.promise,this._frameRevealed.promise]).spread((function(n){return n}))},k.prototype._setupBladeRebindingHandlers=function(n){var t=this;if(n&&n.onRebind){var i=function(n){var i,r,u,f,e;if(t._setContainerInputsChanging(!0),t._updateRebindSequenceNumber(),li.provideContext((function(){t._creationState=li.getState()}),gr.Part,t._getPartContext()),i=t.editScopeId()&&t.services.diContainer.get(tt.EditScopeManager).getStateObservable(t.editScopeId()),r=t.widget,t._onInputsSet.reject(new uu("Part binding canceled due to rebinding for part '"+t+"'")),t._contentRevealed.reject(new uu("Part reveal canceled due to rebinding for part '"+t+"'")),t._setupPromises(),t._hasRebindableInputs&&(u=(t.parent.parent||t.parent).widget,!r||u&&u.options.locked()||r.options.isInBlockingLoadingState(!0),t._lastRebindOnInputsSetProperties=sr(n,t.bindings,1,""+t),t._setupAdaptedInputsReboundReactor()),i&&i()===0)t.services.diContainer.get(tt.EditScopeManager).onEditScopeDisposed(t.editScopeId());t.editScopeId(undefined);t._ensureAdapterAtomicityForBindings();t.bindings.forEach((function(n){if(n.source.scope===ei.DetailsContainer){var i=gt(t._vm,n.targetProperty);i.exists&&wt.setModelValue(t._vm,n.targetProperty,undefined)}}));t._vm.container.unauthorizedMessage(null);t.partDefinition.shareVmWithParentBlade?(f=oi(t),f.setInputsSetPromise(t._onInputsSet.promise)):(e=t._getNotFoundMessage(),e(null))},r=function(){t.isComposed&&(t._setEditScope(),t.partDefinition.partKind===ri.ResourceSummary&&t._autoOpenSettingsFromSummary())},u=function(){t._setContainerInputsChanging(!1)};n.onRebind(i,r,u);this.registerForDispose((function(){n.offRebind(i,r,u)}))}},k.prototype._ensureAssetAffinity=function(){var u=this,n=this.parent&&this.getPartsContainer(),t=this.assetType,i=n&&n.assetType,r=this._part.inContainerOfSameAsset;if(!n||!i||!t||i!==t||!f.isObservable(n.assetId))return r(!1);f.computed(this,(function(){var t=n.assetId(),i=u.assetId(),f=t&&i&&nt.compareAssetId(t,i);r(f)}))},k.prototype._ensureAdapterAtomicityForBindings=function(){var t=this.adapter,n;t&&(n=[],this.bindings.forEach((function(t){var i=t.source;i.modelType===ci&&n.push(i.property)})),n.forEach((function(n){wt.setModelValue(t.viewModel,n,undefined)})))},k.prototype._setupAdaptedInputsReboundReactor=function(){var n=this,t=this.adapter;t&&!t.allOutputsReboundComputed&&(t.allOutputsReboundComputed=f.computed(this,(function(){var r=n.bindings.filter((function(n){var t=n.source.modelType;return t===ci||t===bi})).every((function(t){var i=n.bindAdaptedInput(t).sourceModel,r=gt(i,t.source.property).value;return f.unwrap(r)!==undefined}));if(r){var i=""+n,u=sr(t.viewModel,n.bindings,ci,i),o=sr(t.inputPropertyBindings.targetModel,n.bindings,bi,i);n._lastRebindOnInputsSetProperties=e.extend(u,o)}})))},k.prototype._disposeEditScope=function(){var t=this.editScopeId(),n;if(t){this.services.diContainer.get(tt.EditScopeManager).onEditScopeDisposed(t);n=this._journey;n&&n.ambientSettings.removeItem(this.journeyPath)}},k.prototype._setViewStateProperties=function(n,t){var f=this,e=n||[],i=t||[],r,u;i=i.filter((function(n){var t=n.split(".");return t.length>1?(t.pop(),typeof gt(f._vm,t.join(".")).value=="object"):!0}));this._viewStateProperties=e.concatUnique(i);r=this._vm;u=r&&r.container;u&&u.selectable&&(this._viewStateProperties=this._viewStateProperties.concatUnique(of))},k.prototype._registerInvocationProperty=function(n){var i=this,r=this._bladeOpener,t,u=lt.detailsIsPartContainer(n);u&&(t=f.pureComputed((function(){return!i._vm.container.isSelectable()})));r.registerInvocationProperty(n,t)},k.prototype._getNotFoundMessage=function(){var n=this._vm.container;return n.notFoundMessage},k.prototype._traceErrorTelemetry=function(n,t){ai.trace({extension:du(this),source:tr,action:hi.PartErrored,actionModifier:ni[n],name:fi(this.locator),data:{details:t},journeyId:this._getTelemetryJourneyId()})},k.prototype._getTelemetryJourneyId=function(){var n=this._journey||this.services.desktop.getActiveJourney();return n&&n.id},k})(ct.Instance);t.Instance=lr;t.prepareContainerModel=fr;t.getSerializableContainerModel=ar;t.createContainerModel=vr;t.create=au;t.setBladeOpenerModule=ue;t.setDynamicPartBinderModule=fe;t.inferredReferenceType=-999;t.createOverridesOrContainerModelSourceReference=ee;t.isOverridesOrContainerModelSourceReference=kr;t.isDynamicBindingWithNonLocalSource=bu}));
define("MsPortalImpl/UI/Compositions/UI.Composition.DynamicPartBinder",["require","exports","f","o","ko","MsPortalImpl/UI/Compositions/UI.Composition.CompositionBinder","MsPortalImpl/UI/Compositions/UI.Composition.Part","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding"],(function(n,t,i,r,u,f,e,o){"use strict";function d(n,t){var i=n.parent&&n.getPartsContainer(),f=function(n){if(i&&i.getCompatibleSourceReferences){var t=i.getCompatibleSourceReferences(n);return t&&t[0]}},u,r;return t=t||[],u=n.overridesModel,r=[],t.forEach((function(n){var i=n.name,t;t=o.getModelValue(u,i).exists?null:f(n);r.push(s(n,t))})),r}function a(n){if(n.adapter){var i=v(n),t={},r=y(n,!1);return r.forEach((function(n){var r,f=n.compositionBindingDefinition,u=f&&f.source,e;u&&u.modelType===l&&(e=u.property,r=i[e]);r||(r={bindingSources:[],activeBindingSourceName:null});t[n.targetProperty]=r})),t}return v(n)}function g(n,t,i){function e(e,s){var y,b,l,v;t&&f.CompositionBinder.turnOnInputsSetSuppressionOn(t);f.CompositionBinder.turnOnInputsSetSuppressionOn(i);try{var k=e.inputs,p=e.settings,d=e.inputsMetadata,w=n.getSettingsModel(),c=n.partDefinition&&n.partDefinition.partState,g=c?(c.inputIdentityProperties||[]).concat((c.sharedProperties||[]).map((function(n){return n.property}))):[],it=r.keys(p);g.forEach((function(n){var r=u.unwrap(o.getModelValue(w,n).value),t=n.startsWith("content.")?n.slice(8):n,i=u.toJS(o.getModelValue(p,t).value);h(i,r)||(o.setModelValue(w,n,i),y=!0);it.remove(t)}));l=a(n);r.keys(l).forEach((function(t){var i=l[t],r=d[t],u=k[t];tt(n,t,i,r.activeBindingSourceName,u)&&(b=!0)}));b&&(n.widgetState.valueHasMutated(),nt(n,n.hasUserInteractedRecently()),n.save())}finally{return v=(y?2:1)|(s?0:4),Q.all([t&&f.CompositionBinder.turnOnInputsSetSuppressionOff(t,v,!0)||Q(),f.CompositionBinder.turnOnInputsSetSuppressionOff(i,v,!0),])}}n.getViewModel().internal.updateConfigFn(e)}function nt(n,t){var i=n.widget;i&&i.element.trigger(e.fxpartinputchanged,{part:n,isUserInteraction:t})}function s(n,t){var r=n,i=n,f=i.targetProperty||r.name,o=!!n.optional,u;return t||(u=i.source&&i.source.property||r.name,t=e.createOverridesOrContainerModelSourceReference(u)),{targetProperty:f,optional:o,source:t,isDynamicBinding:!0}}function v(n){var t=n.parent&&n.getPartsContainer(),i=n.adapter?n.adapter.inputDefinitions:n.partDefinition.inputDefinitions,f=function(n){var u,r;return i&&t&&t.getCompatibleSourceReferences&&(r=i.first((function(t){return t.name===n})),r&&(u=t.getCompatibleSourceReferences(r))),(u||[]).map((function(n){return{sourceReference:n,name:n.property,acceptsValueUpdates:!1}}))},r=n.overridesModel,s=function(n){if(!n||e.isDynamicBindingWithNonLocalSource(n))return!1;var t=n.source&&n.source.property;return r&&t&&o.getModelValue(r,t).exists},u={},h=y(n);return h.forEach((function(n){var r=n.targetProperty,e=f(r),t=n.compositionBindingDefinition,i=t&&t.source,o=!s(t)&&i&&(e||[]).first((function(n){var t=n.sourceReference;return t.modelType===i.modelType&&t.property===i.property}));u[r]={bindingSources:e,activeBindingSourceName:o&&o.name}})),u}function y(n,t){return t===void 0&&(t=!0),n.getNonDetailsContainerPropertyBindings(t).filter((function(n){var t=n.targetProperty;return!b.isBladeCallerInput(t)&&t!==p.EditScopeId}))}function tt(n,t,i,r,e){var y=r&&i.bindingSources.first((function(n){return n.name===r})),p,a,b,d,rt,ut,w,it;if(r&&!y){c.error("Source with name '{0}' for configurable Part input named '{1}' does not exist at the Dashboard/Blade-level.".format(r,t));return}if(p=n.getInputPropertyBindings(),a=p.properties.first((function(n){return n.targetProperty===t})),y?(rt=i.activeBindingSourceName,y.name!==rt&&(b=!0)):(ut=u.unwrap(o.getModelValue(a.targetModel,a.targetProperty).value),h(u.toJS(e),ut)||(d=!0)),!(b||d))return!1;if(n.adapter){var ft=n.bindings.first((function(n){return n.targetProperty===t})),g=ft&&ft.source,et=g&&g.modelType===l&&g.property;if(et)w=et;else return c.error("For Adapted Part '{0}', input named '{1}' to the inner Part is not configurable.  Presently, only those inner Part inputs using the 'AdapterInput' binding are configurable.".format(n.toString(),t)),!1}else w=t;var nt=n.adapter?n.adapter.inputPropertyBindings:n.getInputPropertyBindings(),tt=nt.properties.first((function(n){return n.targetProperty===w})),ot=tt.compositionBindingDefinition,st=n.overridesModel,v;if(b){var ht=n.adapter?n.adapter.inputDefinitions:n.partDefinition.inputDefinitions,ct=ht.first((function(n){return n.name===w})),lt=y.sourceReference;v=s(ct,lt)}return d&&(o.setModelValue(st,tt.sourceProperty,u.toJS(e)),v=s(ot)),v&&(nt.removeProperty(tt),it=n.adapter?n.adapter.bindings:n.bindings,k(it,ot),f.CompositionBinder.setupPropertyBindings(n,nt,[v],(function(t){return n.bindAgainstOverridesOrContainerModel(t)})),it.push(v),n.adapter&&(p.removeProperty(a),f.CompositionBinder.setupPropertyBindings(n,p,a&&[a.compositionBindingDefinition],(function(t){return n.bindAdaptedInput(t)})))),!0}r.defineProperty(t,"__esModule",{value:!0});var p=i.Base.Constants.BladeParameterNames,w=i.Base.Diagnostics,b=i.ViewModels.Internal,k=i.remove,h=i.deepEquals,c=w.createLog(n),l=9;t.inferInitialBindingsForInputDefinitions=d;t.getConfigurableInputsMetadata=a;t.listenForConfigurationChanges=g}));
define("MsPortalImpl/UI/Compositions/UI.Composition.SelectableRegistration",["require","exports","o","ko","MsPortalImpl/ViewModels/ViewModels.BladeCaller"],(function(n,t,i,r,u){"use strict";var f;return (function(n){function e(n,t,u){var e=t.internal,f=r.observableArray([]);f.map(n,(function(n,t){r.ignoreDependencies((function(){o(n,t,e,u)}))}));r.computed(n,e.registeredSelectables,(function(n){n===void 0&&(n={});f.splice.apply(f,[0,f.peek().length].concat(i.keys(n)))})).extend({deferred:!0})}function o(n,i,e,o){var l=o.getBladeOpener(),h={invocationInputArguments:[{valuesFrom:[{referenceType:0,property:t+"."+i}]}]},c=r.unwrap(e.registeredSelectableOptions),s;c&&(s=c[i],s&&(s.parameterCollector&&u.addCallerBindings(f+"."+i+".parameterCollector.bladeCaller",h,0),h.openInContextPane=s.openInContextPane,h.persistentContextPane=s.persistentContextPane));l.registerInvocationProperty(h,null,n)}var t="internal.registeredSelectables",f="internal.registeredSelectableOptions";n.listenForRegistrationChanges=e})(f||(f={})),f}));
define("MsPortalImpl/UI/Commands/UI.CommandManager",["require","exports","f","i","ko","$","MsPortalImpl/UI/Commands/UI.Commands","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/Widgets/Widgets.ContextMenu","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u,f,e,o,s,h){"use strict";var c;return (function(t){function w(n){return new c(n)}function l(n){var r,i,t;if((p?n.metaKey:n.ctrlKey)||(r=v.getSelection(),r.rangeCount&&!r.getRangeAt(0).collapsed)||(i=f(n.target),i.filter("input,textarea").length)||i.add(f(n.target).parents("a")).filter("a[href]:not([href='#']):not([href=''])").length)return!0;n.preventDefault();n.stopPropagation();t=f.Event(h.default.fxcontextmenurequest);t.pageX=n.pageX;t.pageY=n.pageY;t.clientX=n.clientX;t.clientY=n.clientY;i.trigger(t)}var a=r.TriggerableLifetimeManager,v=window,y="<div class='fxs-commands-contextMenu'><\/div>",p=navigator.platform.indexOf("Mac")!==-1,c;t.createCommandManager=w;t.onContextMenu=l;c=(function(){function t(n){this._previouslyFocusedElement=u.observable();this._ltm=new a;this._body=f("body");this._desktop=n;this._initializeContextMenu()}return t.prototype.dispose=function(){this.stopListeningForEvents();this._ltm.dispose()},t.prototype.startListeningForEvents=function(){var u=this,n=this._body;n.on(h.default.fxcontextmenu,this._fxMenuEventHandler=function(n,t){u._showContextMenu(n,t)}).on(h.default.contextmenu,this._browserMenuEventHandler=function(n){l(n)});var t=this._contextMenuElement,i=this._desktop.portalWidget,r=i&&i.element;return r?r.append(t):n.append(t),this},t.prototype.stopListeningForEvents=function(){var n=this._body;this._fxMenuEventHandler&&(n.off(h.default.fxcontextmenu,this._fxMenuEventHandler),this._fxMenuEventHandler=null);this._browserMenuEventHandler&&(n.off(h.default.contextmenu,this._browserMenuEventHandler),this._browserMenuEventHandler=null);this._contextMenu.hide();this._contextMenuElement.detach()},t.prototype.getFormTarget=function(){var t=this;return this._formTargetPromise||(this._formTargetPromise=i.require("../UI.PortalFormTarget",n).then((function(n){return new n.PortalFormTarget(t._desktop,t._ltm,t._previouslyFocusedElement)}))),this._formTargetPromise},t.prototype._initializeContextMenu=function(){this._contextMenuElement=f(y);this._contextMenu=new s.Widget(this._contextMenuElement);this._contextMenu.hide()},t.prototype._showContextMenu=function(n,t){var y=this,h=t.contextMenu?t.contextMenu:this._contextMenu,v=h.options.menuItems,r,u,p,c=n.clientX,l=n.clientY,a,i,s;if(t.commands&&t.commands.length!==0){if(t.srcElement){for(a=t.srcElement,i=a,f(a).hasClass("fxs-tile")&&(i=f(a).find(".fxs-part")[0]);i&&typeof i.focus!="function";)i=f(i).closest("[tabindex]")[0];this._previouslyFocusedElement(i)}p=t.formTarget&&t.formTarget.length>0?function(){return Q(e.getBladeContentWidget(t.formTarget))}:function(){return y.getFormTarget()};h.hide();v.splice(0,v().length);do u=u?u.parentNode:n.target,r=f(u).data(o.CompositionInstanceDataName);while(!r&&u.parentNode);(o.isContextMenuContainer(r)&&r.beforeActivateCommandMenuItems(t),t.commands.forEach((function(t){y._shouldShowCommand(t)&&(t.activate(),t.bind(new e.CompositionInstanceCommandContext(n.target,p,r)),v.push(t))})),h.options.hasVisibleCommands())&&(c||l||(s=n.target.getClientRects()[0],c=s&&s.left||c,l=s&&s.bottom||l),h.show(c,l,t&&t.forceLeft))}},t.prototype._shouldShowCommand=function(n){return this._desktop.mode()!==1||!this._isExtensionCommand(n)},t.prototype._isExtensionCommand=function(n){return!!n._extension},t})();t.PortalCommandManager=c})(c||(c={})),c}));
define("MsPortalImpl/UI/Compositions/UI.Composition.CompositionAwaiter",["require","exports","f","o"],(function(n,t,i,r){"use strict";r.defineProperty(t,"__esModule",{value:!0});var u={pending:"pending"},f=(function(){function n(n,t){this.deferred=i.Helpers.Deferred();this.targetId=n;this.isSource=t}return n})(),e=(function(){function n(n){this._awaitableCompositions=[];this.resolvedCompositions=[];this._trackResolvedCompositions=n}return n.prototype.await=function(n,t){var r=this,i=new f(n&&n.toString(),t),e=this.resolvedCompositions.firstIndex((function(n){return t(n)}));if(e>=0)i.deferred.resolve(this.resolvedCompositions[e]);else if(this._awaitableCompositions.push(i),n)n.onDispose((function(){if(i.deferred.state()===u.pending){i.deferred.reject();var n=r._awaitableCompositions.indexOf(i);n>=0&&r._awaitableCompositions.splice(n,1)}}));return i.deferred.promise()},n.prototype.resolve=function(n){var r=this,t,i;if(this._trackResolvedCompositions){this.resolvedCompositions.push(n);n.onDispose((function(){var t=r.resolvedCompositions.indexOf(n);t>=0&&r.resolvedCompositions.splice(t,1)}))}for(t=this._awaitableCompositions.length-1;t>=0;t--)i=this._awaitableCompositions[t],i.isSource(n)&&(i.deferred.resolve(n),this._awaitableCompositions.splice(t,1))},r.defineProperty(n.prototype,"waitingCompositions",{get:function(){return this._awaitableCompositions.map((function(n){return n.targetId}))},enumerable:!0,configurable:!0}),n})();t.CompositionAwaiter=e}));
define("MsPortalImpl/UI/Dashboard/FiltersSerialization",["require","exports","f","o","Fx/Composition/DashboardFilters"],(function(n,t,i,r,u){"use strict";function o(n){return c[n]||l}function b(n){var t=n&&r.keys(n);return!t||t.length===0?undefined:t.reduce((function(t,i){var r=o(i);return t[i]={model:r.toJSON(r.normalizeModel(n[i]))},t}),{})}function k(n){var t=n&&r.keys(n);return!t||t.length===0?undefined:t.reduce((function(t,i){var r=o(i);return t[i]=r.denormalizeModel(r.fromJSON(n[i].model)),t}),{})}function d(n){var t={format:n.format?"local":"utc",granularity:s[n.granularity]};return n.relative?t.relative=""+n.relative.duration+h[n.relative.timeUnit]:t.absolute=n.absolute,t}function g(n){function f(n){var u,t,r;return n=n&&n.trim(),n&&n.length>1?(u=n.slice(-1),t=h.firstIndex((function(n){return n===u})),t!==-1&&(r=parseInt(n.slice(0,n.length-1)),i.isNumeric(r)))?{duration:r,timeUnit:t}:undefined:void 0}function e(n){var t=s.firstIndex((function(t){return t===n}));return t!==-1?t:0}var r={format:n.format==="local"?1:0,granularity:e(n.granularity)},u=n.relative,t;return u?r.relative=f(u):(t=n.absolute,t&&(r.absolute={fromDate:new Date(t.fromDate),toDate:new Date(t.toDate)})),r}function f(n){return{operator:n.operator===1?"notEquals":"equals",values:n.values}}function e(n){return{operator:n.operator==="notEquals"?1:0,values:n.values}}var s,h,c,l;r.defineProperty(t,"__esModule",{value:!0});var a=u.TimeRangeFilter,v=u.LocationFilter,y=u.ResourceGroupFilter,p=u.ResourceTypeFilter,w=u.SubscriptionFilter;t.getFilterProcessors=o;t.serializeFilters=b;t.parseFilters=k;s=(function(){var n=[];return n[0]="auto",n[1]="1m",n[2]="5m",n[3]="15m",n[4]="30m",n[5]="1h",n[6]="6h",n[7]="12h",n[8]="1d",n[9]="7d",n[10]="1mo",n})();h=(function(){var n=[];return n[0]="m",n[1]="h",n[2]="d",n[3]="w",n})();c=(function(){var n=[{filterId:a.filterId,normalizeModel:function(n){return n},denormalizeModel:function(n){return n},toJSON:d,fromJSON:g},{filterId:w.filterId,normalizeModel:function(n){return{operator:n.operator,values:n.subscriptionIds}},denormalizeModel:function(n){return{operator:n.operator,subscriptionIds:n.values}},toJSON:f,fromJSON:e},{filterId:v.filterId,normalizeModel:function(n){return{operator:n.operator,values:n.locations}},denormalizeModel:function(n){return{operator:n.operator,locations:n.values}},toJSON:f,fromJSON:e},{filterId:y.filterId,normalizeModel:function(n){return{operator:n.operator,values:n.resourceGroupIds}},denormalizeModel:function(n){return{operator:n.operator,resourceGroupIds:n.values}},toJSON:f,fromJSON:e},{filterId:p.filterId,normalizeModel:function(n){return{operator:n.operator,values:n.resourceTypes}},denormalizeModel:function(n){return{operator:n.operator,resourceTypes:n.values}},toJSON:f,fromJSON:e},];return n.reduce((function(n,t){return n[t.filterId]=t,n}),{})})();l={filterId:null,normalizeModel:function(n){return n},denormalizeModel:function(n){return n},toJSON:f,fromJSON:e}}));
define("MsPortalImpl/UI/Compositions/UI.Composition.StartboardPart",["require","exports","f","o","a","ko","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Compositions/UI.Composition.CompositionBinder","MsPortalImpl/UI/Compositions/UI.Composition.ContextMenuContainer","MsPortalImpl/UI/Compositions/UI.Composition.Part","MsPortalImpl/UI/Commands/UI.ShellCommands","MsPortalImpl/UI/Dashboard/FiltersSerialization","MsPortalImpl/Services/Services.EditScopeManagement","Fx/Composition/Selectable"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){"use strict";function et(n,t,i,r){r=r||{};var u=new k(n,t,null,r.id);return u.calculateInitialSize(),u.modelContainsSensitiveData=r.modelContainsSensitiveData,u.containerModel=a.prepareContainerModel(i||{}),u.filters=r.filters,u.overridesModel=a.prepareContainerModel(r.overridesModel||{}),u.validateBindings(i)||(b.error("Unable to create instance of startboard part '{0}', check log for errors.".format(t.toString())),u.locator.name="##INVALID##"),r.doNotSaveSettings||u.save(),u}var b,k;r.defineProperty(t,"__esModule",{value:!0});var d=o.Locator,tt=o.LocatorType,it=i.Base,rt=it.Diagnostics,g=i.Parts.PartKind,ut=h.CompositionType,ft=c.CompositionBinder,nt=window.fx.getTimestamp;t.startboardPartName="StartboardPart";t.fxpartfilterschanged="fxpartfilterschanged";b=rt.createLog(n);k=(function(n){function o(t,i,r,u){var e=n.call(this,t,i,r,u,null,"StartboardPart")||this;return e.dontSetupWidget=!1,e.partFilterState=f.observable(0),e._lastUserInteraction=0,e.containerModel={},e._store=4,e._partShellApiDeferred.promise.then((function(n){n&&f.isObservable(n.updateFilters)&&n.updateFilters((function(n){return e.updateFilters(n)}))})),e.awaitComposed().then((function(){e._updatePartFilterState(!e._isComposingDuringPortalStartup);e._isComposingDuringPortalStartup=!1})),e}return __extends(o,n),o.fromJSON=function(n,t,i,r){return h.createCompositionFromJSON(t,(function(){var u=new o(n,d.fromJSON(t.locator),t.widgetState,t.id);return u.loadPropertiesFromJson(t,!0,i),u._storedEditScopeId=t.editScopeId,u.dontSetupWidget=t.dontSetupWidget,u.defaultMenuItemId=t.defaultMenuItemId,u.containerModel=u.containerModel||{},u.deepLink=t.deepLink,u._isComposingDuringPortalStartup=!!r,u.filters=y.parseFilters(t.filters),u}),(function(i,r){var u=new o(n,i,null,t.id);return u.unrecoverableErrorMessage=r,u}))},o.prototype.getCompositionType=function(){return ut.StartboardPart},o.prototype.register=function(t,i,r){var u=this,e,o;n.prototype.register.call(this,t,i,r);var s,h=this.deepLink,f=this._part,c=this.services;h&&(e=f.getSelectable(),s={isClickable:e.isClickable,isSelected:e.isSelected,value:e.value,onClick:function(){c.router.route(h)}});f.configure({onStartboard:!0,selectable:s});o=this.editScopeId();o&&this.partDefinition.partKind===g.Provisioning&&c.diContainer.get(p.EditScopeManager).getStateObservable(o).subscribe(this,(function(n){var t=n===1||n===2;t&&(u.dontSetupWidget=!1,u.addWidgetToUI({parentElement:u.getPartsContainer().widget}))}));f.openPartSettingsBlade=function(n,t){t&&t.stopPropagation();u.openPartSettingsBlade()};this.partFilterState.subscribe(this,(function(n){f.partFilterState(n)}))},o.prototype.toJSON=function(){var t=n.prototype.toJSON.call(this);return t.editScopeId=this.editScopeId(),t.dontSetupWidget=this.dontSetupWidget,t.defaultMenuItemId=this.defaultMenuItemId,t.deepLink=this.deepLink,t.filters=y.serializeFilters(this.filters),t},o.prototype.validateBindings=function(n){var r=this,t,i;return this.bindings&&this.bindings.length>0?(t=this.bindings.filter((function(n){return n.source.id!==r.id})),i=t.map((function(n){return n.source.property})),ft.modelHasProperties(""+this,i,n)):!0},o.prototype.matchesLocatorAndModel=function(n,t,r,u,f){return!this.locator.equals(t)&&!this._matchesPartReferenceLocator(n,t)?!1:this.defaultMenuItemId!==u||!i.deepEquals(this.filters||{},f||{})?!1:h.deepSubset(this.containerModel,r||{})},o.prototype.addWidgetToUI=function(t){var r=this,u,f,o,c,a,h;this.dontSetupWidget||(u=this.widget,i.isFeatureEnabled("dashboardfilters")?this.getDashboardFiltering().then((function(n){n.supportsFiltering&&u.options.commands.push(new v.CustomizeTileData(r,r.services));l.composeShellCommands(r,r,u.options.commands,!0,r.services)})):l.composeShellCommands(this,this,u.options.commands,!0,this.services),n.prototype.addWidgetToUI.call(this,t),t.doNotSaveSettings||this.save(),f=u.element,o=this._ltm,f&&o&&(c=this._isFramePart=(this.partDefinition&&this.partDefinition.partKind)===g.Frame,c||(a=function(n,t,i){return n.addEventListener(t,i,!0),{dispose:function(){n&&(n.removeEventListener(t,i,!0),n=null)}}},h=function(){r._lastUserInteraction=nt()},f&&o&&o.registerForDispose([$(this.services.desktop).setEvents([s.DesktopManagerEvents.bladeClosed,function(n,t){t.masterPartId===r.id&&h()}])].concat([e.default.click,e.default.mousedown,e.default.keydown].map((function(n){return a(f[0],n,h)})))))))},o.prototype.hasUserInteractedRecently=function(){if(this._isFramePart||this._lastUserInteraction+2e3>nt())return!0;var n=this.services.desktop.getActiveJourney(),t=n&&n.children&&n.children[0];return(t&&t.masterPartId)===this.id},o.prototype.save=function(){},o.prototype._forceSave=function(t){n.prototype.save.call(this,t)},o.prototype._getEditScopeIdFromSettings=function(){return this._storedEditScopeId},o.prototype._setupJourneyEditScopeReactor=function(){},o.prototype.getDashboardFiltering=function(){var n=this;return this.awaitPartDefinition().then((function(){var t=n.partDefinition;return{supportsFiltering:t.supportsFiltering,staticFilters:t.filters||[],partApi:n._partShellApiDeferred.promise}}))},o.prototype.notifyFiltersChanged=function(n){var t=this;this.awaitComposed().then((function(){t._setContainerInputsChanging(!0);var i=2|(n?4:0);t._setContainerInputsChanging(!1,i);t._updatePartFilterState(!t._isComposingDuringPortalStartup)}))},o.prototype._disposeEditScope=function(){var n=this.editScopeId();if(n)this.services.diContainer.get(p.EditScopeManager).onEditScopeDisposed(n)},o.prototype._getBladeOpenerConfig=function(){var t=this,i=n.prototype._getBladeOpenerConfig.call(this),r=function(){var n=t.getPartsContainer().detailContainers;return n&&n.length>0&&n[0]};return i.onBladesOpening=function(){t.isDisposed()&&t.dontSetupWidget&&b.error("Cannot open new blades for part '"+t+"', it has already been disposed and removed from the starboard. If this part was created from a Hub action, make sure it doesn't change the target blade after it has been opened.")},i.getCloseOwnedDetailBladesHandler=function(n){var u,f=n&&n.source&&n.source.property,i=r();return i&&i.masterPartId===t.id&&i.masterInvocationProperty===f&&!i.masterCommandName&&(u=function(){var n=t.services.desktop,i=n.getActiveJourney();return i?n.tryDiscardJourney(i.id):n.tryDeactivateJourney()}),u},i.getCloseOtherDetailBladesHandler=function(n){var u,f=n&&n.source&&n.source.property,i=r();return i&&(i.masterPartId!==t.id||i.masterInvocationProperty!==f)&&(u=function(){var n=t.services.desktop,i=n.getActiveJourney();return i.isStartedWithContextBlade()?n.tryDiscardJourney(i.id):n.tryDeactivateJourney()}),u},i},o.prototype._updatePartFilterState=function(n){var t=this,i=this.parent&&this.getPartsContainer();return i&&i.getDashboardFiltersForPart(this.id,n).then((function(n){var u=t.filters||{},i,f;n=n||{};i=0;(r.keys(u).length>0||r.keys(n).length>0)&&(i=1);for(f in u)if(!t._deepEquals(u[f],n[f])){i=2;break}t.partFilterState(i)}))},o.prototype._matchesPartReferenceLocator=function(n,t){var u=!1,f={},r,i,e,o;return this.locator.type===tt.StartboardPartInstance&&n.tryLocate(this.locator,f)&&(r=f.value,i=r&&r.reference,i&&(e=i.extension?d.forExtension(i.extension):this.locator.getExtensionLocator(),o=e.withPartType(i.partTypeName),u=t.equals(o))),u},o.prototype.updateFilters=function(n){var r=this.parent&&this.getPartsContainer(),t,i;return r?(u.isArray(n)?t=n.reduce((function(n,t){return n[t.filterId]=t.filterModel,n}),{}):n.dashboard||n.part?(t=n.dashboard,i=n.part):t=n,i&&this._updatePartFilters(i),t)?r.updateFilters(this,t):(this.notifyFiltersChanged(!0),Q()):Q.reject(new Error("Only Parts located on Dashboards can call 'updateFilters'"))},o.prototype._updatePartFilters=function(n){for(var i,e,u=this.filters||{},o=r.keys(n),f=0;f<o.length;f++)i=o[f],e=n[i],e?u[i]=e:delete u[i];this.filters=u;this.widget.element.trigger(t.fxpartfilterschanged,{part:this,isUserInteraction:this.hasUserInteractedRecently()})},o.prototype._getTelemetryJourneyId=function(){return undefined},o.prototype.openPartSettingsBlade=function(){var n=this;this.getViewModel().container.openContextPane(new w.PdlBladeReference("PartSettingsBlade","HubsExtension",{onClosed:function(t,i){if(i){var u={};r.keys(i.filters).forEach((function(n){u[n]=y.getFilterProcessors(n).denormalizeModel(i.filters[n])}));n._updatePartFilters(u);n.notifyFiltersChanged(!1)}},parameters:{partId:this.id}}))},o.prototype._deepEquals=function(n,t){var o=this,u,s,e;if(n=f.unwrap(n),t=f.unwrap(t),n===t)return!0;if(!n||!t||(u=i.getTypeOf(n),u!==i.getTypeOf(t)))return!1;switch(u){case"array":return s=n,n.length!==t.length?!1:s.every((function(n){for(var r=!1,i=0;i<t.length;){if(o._deepEquals(t[i],n)){r=!0;break}i++}return r}));case"date":return n.getTime()===t.getTime();case"object":return e=r.keys(n),e.length===i.keysLength(t)&&e.every((function(i){return o._deepEquals(n[i],t[i])}));default:return!1}},o})(a.Instance);t.Instance=k;t.create=et}));
define("MsPortalImpl/UI/UI.DashboardFiltersManager",["require","exports","f","o","ko","Fx/Composition/DashboardFilters","MsPortalImpl/Base/Languages","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/UI/Dashboard/FiltersSerialization","MsPortalImpl/Services/Services.SelectedSubscriptions","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Base/Telemetry"],(function(n,t,i,r,u,f,e,o,s,h,c,l){"use strict";function w(n,t){var r,i,u;if(!t)return!1;r=!1;switch(n){case 0:i=t;r=i.absolute&&!!i.absolute.fromDate&&!!i.absolute.toDate||i.relative&&typeof i.relative.duration=="number"&&typeof i.relative.timeUnit=="number";break;case 1:case 2:case 3:case 5:case 4:u=t;r=typeof u.operator=="number"}return r}function k(n){return i.isNullOrUndefined(b[n])?1:b[n]}function kt(n,t){return{kind:k(n),model:p(n).fromJSON(t.model),displayCache:t.displayCache,filteredPartIds:t.filteredPartIds}}function ft(n){var r=n&&n.selectedDisplayLanguage||"",u=n&&n.selectableDisplayLanguages||[],t=i.find(u,(function(n){return n.locale&&n.locale.localeCompareIgnoreCase(r)===0}));return t&&t.specificCulture||"en-us"}function et(n){var i=n.filterKind;return t.intrinsicFilterDescriptors[i]?t.intrinsicFilterDescriptors[i].filterId:n.filterId}function ot(n){return n&&n.operator||0}function ht(n,t){var i=rt(n,t);return i&&yt({subscription:i.subscription.toLowerCase(),resourceGroup:i.resourceGroup})}function rt(t,r,u){var f,e;try{return vt(t)}catch(o){f=o}!u&&f&&(e="Invalid resource group id '"+JSON.stringify(t)+"', inner exception: "+i.getLogFriendlyMessage(f),r?c.logToExtension(n,r.widget.element,pt,e,f):bt.error(e))}var b,st,v,d,g,nt,tt,it,y;r.defineProperty(t,"__esModule",{value:!0});var ut=i.Base,ct=ut.Diagnostics,lt=f.TimeRangeFilter,at=f.ResourceTypeFilter,vt=i.ViewModels.Services.ResourceTypes.parseResourceGroupDescriptor,yt=i.ViewModels.Services.ResourceTypes.buildResourceGroupIdFromDescriptor,pt=i.Base.Diagnostics.LogEntryLevel.Error,wt=ut.Diagnostics.Telemetry,a=o.Filtering,bt=ct.createLog(n),p=s.getFilterProcessors;t.intrinsicFilterDescriptors=(function(){var n=[{kind:0,filterId:f.TimeRangeFilter.filterId,displayText:a.Intrinsics.timeRange},{kind:2,filterId:f.SubscriptionFilter.filterId,displayText:a.Intrinsics.subscription},{kind:3,filterId:f.LocationFilter.filterId,displayText:a.Intrinsics.location},{kind:5,filterId:f.ResourceGroupFilter.filterId,displayText:a.Intrinsics.resourceGroup},{kind:4,filterId:at.filterId,displayText:a.Intrinsics.resourceType},];return n.reduce((function(n,t){return n[t.kind]=t,n}),[])})();t.isCompleteFilterModel=w;b=(y={},y[f.TimeRangeFilter.filterId]=0,y[f.SubscriptionFilter.filterId]=2,y[f.LocationFilter.filterId]=3,y[f.ResourceGroupFilter.filterId]=5,y[f.ResourceTypeFilter.filterId]=4,y);t.getFilterKindFromId=k;t.getCultureSpecificLanguage=ft;t.getStaticFilterId=et;t.getOperator=ot;st=(function(){function n(n){var t=this,f,r,o,s;this._filtersLocale=u.observable();this._appliedFilters=u.observableArray();this._currentSessionLocale=ft(e.currentLocaleContext);this._equalityFilterRuntimes=[];this._parent=n;this._dashboardLifetime=n.createChildLifetime();this._initializeFiltersWidgetsViewModel();f={getAllSubscriptions:function(){return Q(i.Azure.getAllSubscriptions())},getSelectedSubscriptions:h.getSelectedSubscriptions,selectedSubsUpdateTriggered:h.selectedSubsUpdateTriggered};this._equalityFilterRuntimes[1]=new d;this._equalityFilterRuntimes[2]=new g(f);this._equalityFilterRuntimes[3]=new nt;this._equalityFilterRuntimes[5]=new tt(f);this._equalityFilterRuntimes[4]=new it;r=u.observableArray([]);n.subscribeChildren((function(){r(t._parent.children.map((function(n){return n})))}));r.subscribeArrayBulkChanges(this._parent,(function(n,i){i&&i.length&&i.forEach((function(n){var i=t._appliedFilters.peek();i.forEach((function(t){return t.filteredPartIds.remove(n.id)}))}))}));o=u.pureComputed(r).extend({throttle:100});s=u.pureComputed(this._appliedFilters).extend({throttle:100});u.reactor(this._parent,[o,s],(function(n,r){var u=t._isFilterUpdatingModuleLoadingOrLoaded()?t._getFilterUpdatingApi().then((function(n){return n.getAllFilterDescriptors(!0).then((function(n){return n.map((function(n){return n.filterId}))}))})):(function(){var r=[];return Q.all(n.map((function(n){return t._getPartStaticFilters(n).then((function(n){i.pushUnique(r,n)}))}))).then((function(){return r}))})();return u.then((function(n){t._ensureTimeRangeFilter(n);r.forEach((function(t){var i=t.filteredPartIds&&t.filteredPartIds.length>0||n.includes(t.id());t.isApplicable(i)}))}))}))}return n.prototype.updateFilters=function(n,t){return this._getFilterUpdatingApi().then((function(i){return i.updateFilters(n,t)}))},n.prototype.getFilters=function(){var n=this,t=this._appliedFilters.peek();return t.reduce((function(t,i){var r=i.id(),u=i.model(),f=i.kind(),e=typeof r=="string"&&w(f,u);return e&&(t[r]=n.denormalizeFilterModel(f,u)),t}),{})},n.prototype.loadDashboard=function(n){var t=this,f;this.dispose();this._dashboardLifetime=this._parent.createChildLifetime();this._filtersLocale(n&&n.filterLocale||this._currentSessionLocale);var i=n&&n.filters||{},u=r.keys(i),e=u.map((function(n){var r=kt(n,i[n]),f=r.kind,u;if(w(f,r.model))return u=t._createDashboardFilterViewModel({id:n,model:r.model,kind:f,filterIdDisplayText:r.displayCache.name,filterValueDisplayText:r.displayCache.value,filteredPartIds:r.filteredPartIds}),t._activateFilter(u),u})).filter((function(n){return!!n}));(f=this._appliedFilters).push.apply(f,e);wt.trace({source:l.Source.DashboardFilters,action:l.Action.DashboardFiltersLoaded,data:{filterIds:u.toString()}})},n.prototype.setFilters=function(n){var t=this,i;this._dashboardLifetime||(this._dashboardLifetime=this._parent.createChildLifetime());i=r.keys(n).map((function(i){var r=n[i];return t._createDashboardFilterViewModel({id:i,model:t.normalizeFilterModel(r.filterKind,r.filterModel),kind:r.filterKind})}));this._appliedFilters(i)},n.prototype.toJSON=function(){return this._getFilterUpdatingApi().then((function(n){return n.toJSON()}))},n.prototype.getDashboardFiltersForPart=function(n,t){var r=this,u;return t||this._isFilterUpdatingModuleLoadingOrLoaded()?this._getFilterUpdatingApi().then((function(t){return t.getDashboardFiltersForPart(n)})):(u=i.find(this._parent.children,(function(t){return t.id===n})),this._getPartStaticFilters(u).then((function(t){var i=r._appliedFilters.peek().filter((function(i){var r=i.filteredPartIds.includes(n);return r||t.includes(i.id())}));return i.reduce((function(n,t){return n[t.id()]=r.denormalizeFilterModel(t.kind(),t.model()),n}),{})})))},n.prototype.getFilterValues=function(n,t,i){return this._getFilterUpdatingApi().then((function(r){return r.getFilterValues(n,t,i)}))},n.prototype.getFilterIdText=function(n,t){return this._getFilterUpdatingApi().then((function(i){return i.getFilterIdText(n,t)}))},n.prototype.getFilterValueDisplayText=function(n,t,i){return this._getFilterUpdatingApi().then((function(r){return r.getFilterValueDisplayText(n,t,i)}))},n.prototype.getFiltersSupportedByPart=function(n){return this._getFilterUpdatingApi().then((function(t){return t.getFiltersSupportedByPart(n)}))},n.prototype.getFilterWarning=function(n,t){return this._equalityFilterRuntimes[k(n)].getFilterWarning(t)},n.prototype._initializeFiltersWidgetsViewModel=function(){var n=this;this.filtersWidgetViewModel={appliedFilters:this._appliedFilters,createDashboardFilterViewmodel:function(){return n._createDashboardFilterViewModel({})},getFilterUpdatingApi:function(){return n._getFilterUpdatingApi().then((function(n){return n.filtersWidgetViewModel}))}}},n.prototype._createDashboardFilterViewModel=function(n){var t=n.model,i=this._dashboardLifetime.createChildLifetime();return{id:u.observable(n.id),kind:u.observable(n.kind),kindLifetime:i,model:u.observable(t),isApplicable:u.observable(!0),filterIdDisplayText:n.filterIdDisplayText,operator:ot(t),filterValueDisplayText:n.filterValueDisplayText,warningMessage:u.observable(""),filteredPartIds:n.filteredPartIds||[]}},n.prototype._ensureTimeRangeFilter=function(n){var t=this._appliedFilters.peek(),i=t.filter((function(n){return!!n&&n.kind()===0})).first(),r=n.includes(lt.filterId);!i&&r&&this._getFilterUpdatingApi().then((function(n){return n.addTimeRangeFilter()}))},n.prototype.dispose=function(){this._dashboardLifetime&&(this._dashboardLifetime.dispose(),this._dashboardLifetime=null);this._filtersLocale("");this._appliedFilters([])},n.prototype.denormalizeFilterModel=function(n,t){return n===0?t:this._equalityFilterRuntimes[n].denormalizeFilterModel(t)},n.prototype.normalizeFilterModel=function(n,t){return n===0?t:this._equalityFilterRuntimes[n].normalizeFilterModel(t)},n.prototype._activateFilter=function(n){var i=n.kind,r=n.kindLifetime,t=i();t!==0&&this._equalityFilterRuntimes[t].activateFilter(r,n)},n.prototype._normalizeEqualityFilterValue=function(n,t){return this._equalityFilterRuntimes[n].normalizeFilterValue(t)},n.prototype._getFilterUpdatingApi=function(){var n=this;return this._filterUpdatingModulePromise||(this._filterUpdatingModulePromise=i.require("MsPortalImpl/UI/UI.DashboardFiltersManager.Updating").then((function(t){return n._parent.widget&&n._parent.widget.element.attr("data-filterupdatingloaded",!0),new t.DashboardFiltersUpdatingImpl(n._parent,{appliedFilters:n._appliedFilters,getDashboardLifetime:function(){return n._dashboardLifetime},activateFilter:function(t){return n._activateFilter(t)},createDashboardFilterViewModel:function(t){return n._createDashboardFilterViewModel(t)},ensureTimeRangeFilter:function(t){return n._ensureTimeRangeFilter(t)},normalizeEqualityFilterValue:function(t,i){return n._normalizeEqualityFilterValue(t,i)}})}))),this._filterUpdatingModulePromise},n.prototype._isFilterUpdatingModuleLoadingOrLoaded=function(){return!!this._filterUpdatingModulePromise},n.prototype._getPartStaticFilters=function(n){return n.getDashboardFiltering().then((function(n){return(n.staticFilters||[]).map(et)}))},n})();t.DashboardFiltersManager=st;v=(function(){function n(){}return n.prototype.activateFilter=function(){},n.prototype.getFilterWarning=function(){return Q("")},n})();t.EqualityFilterRuntimeBase=v;d=(function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.normalizeFilterModel=function(n){return n},t.prototype.denormalizeFilterModel=function(n){return n},t.prototype.normalizeFilterValue=function(n){return n},t})(v);t.EqualityFilterRuntime=d;g=(function(n){function t(t){var i=n.call(this)||this,r;return i._subscriptions=t,r=p(f.SubscriptionFilter.filterId),i._normalizeFilterModel=r.normalizeModel,i._denormalizeFilterModel=r.denormalizeModel,i}return __extends(t,n),t.prototype.normalizeFilterModel=function(n){return this._normalizeFilterModel(n)},t.prototype.denormalizeFilterModel=function(n){return this._denormalizeFilterModel(n)},t.prototype.activateFilter=function(n,t){var i=this;u.reactor(n,[t.model,this._subscriptions.selectedSubsUpdateTriggered],(function(){return i.getFilterWarning(t.model()).then((function(n){t.warningMessage(n)}))}))},t.prototype.normalizeFilterValue=function(n){return n.toLowerCase()},t.prototype.getFilterWarning=function(n){return Q(this._subscriptions.getSelectedSubscriptions().then((function(t){var i=!n.values.some((function(n){return!t.some((function(t){return t.subscriptionId.toLowerCase()===n.toLowerCase()}))}));return i?"":a.Subscription.subscriptionFilterUsingExcludedSubscriptions})))},t})(v);t.SubscriptionFilterRuntime=g;nt=(function(n){function t(){var t=n.call(this)||this,i=p(f.LocationFilter.filterId);return t._normalizeFilterModel=i.normalizeModel,t._denormalizeFilterModel=i.denormalizeModel,t}return __extends(t,n),t.prototype.normalizeFilterModel=function(n){return this._normalizeFilterModel(n)},t.prototype.denormalizeFilterModel=function(n){return this._denormalizeFilterModel(n)},t.prototype.normalizeFilterValue=function(n){return n},t})(v);t.LocationFilterRuntime=nt;tt=(function(n){function t(t){var i=n.call(this)||this,r;return i._subscriptions=t,r=p(f.ResourceGroupFilter.filterId),i._normalizeFilterModel=r.normalizeModel,i._denormalizeFilterModel=r.denormalizeModel,i}return __extends(t,n),t.prototype.normalizeFilterModel=function(n){return this._normalizeFilterModel(n)},t.prototype.denormalizeFilterModel=function(n){return this._denormalizeFilterModel(n)},t.prototype.activateFilter=function(n,t){var i=this;u.reactor(n,[t.model,this._subscriptions.selectedSubsUpdateTriggered],(function(){i.getFilterWarning(t.model()).then((function(n){t.warningMessage(n)}))}))},t.prototype.getFilterWarning=function(n){return Q(this._subscriptions.getSelectedSubscriptions().then((function(t){var i=!n.values.some((function(n){var i=rt(n),r=i.subscription;return!t.some((function(n){return n.subscriptionId.toLowerCase()===r.toLowerCase()}))}));return i?"":a.ResourceGroup.resourceGroupFilterUsingExcludedSubscriptions})))},t.prototype.normalizeFilterValue=function(n,t){return ht(n,t)||n},t})(v);t.ResourceGroupFilterRuntime=tt;it=(function(n){function t(){var t=n.call(this)||this,i=p(f.ResourceTypeFilter.filterId);return t._normalizeFilterModel=i.normalizeModel,t._denormalizeFilterModel=i.denormalizeModel,t}return __extends(t,n),t.prototype.normalizeFilterModel=function(n){return this._normalizeFilterModel(n)},t.prototype.denormalizeFilterModel=function(n){return this._denormalizeFilterModel(n)},t.prototype.normalizeFilterValue=function(n){var r=n.resourceType,t=n.resourceKind,i={resourceType:r.toLowerCase()};return t&&(i.resourceKind=t.toLowerCase()),i},t})(v);t.ResourceTypeFilterRuntime=it;t.normalizeResourceGroupId=ht;t.parseResourceGroupId=rt}));
define("MsPortalImpl/UI/Compositions/UI.Composition.StartBoard",["require","exports","f","o","ko","$","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Services/Services.Settings.Schema","MsPortalImpl/Base/Telemetry","MsPortalImpl/UI/Commands/UI.Commands","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Compositions/UI.Composition.Base","MsPortalImpl/UI/Compositions/UI.Composition.CompositionAwaiter","MsPortalImpl/UI/Compositions/UI.Composition.PartSettingsManager","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding","MsPortalImpl/UI/Compositions/UI.Composition.StartboardPart","MsPortalImpl/UI/UI.DashboardFiltersManager","MsPortalImpl/UI/Commands/UI.ShellCommands","MsPortalImpl/Widgets/Widgets.StartBoard","MsPortalImpl/Widgets/Widgets.UIElementBase","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g){"use strict";function ut(n){return n!==o.desktopSettingsKey&&n!==o.startBoardSettingsKey&&!i.startsWith(n,v.partIdentityStatePrefix)}function ct(n){var t=new nt(n);return t.save(),t}function lt(n,t,i){var f=r.keys(t).filter(ut).map((function(i){return p.Instance.fromJSON(n,t[i])})),u=new nt(n,f,i.widgetState);return u.logChildren(),u.loadFromJson(i),u}function at(n,t){var i=[],r=new b.EnterOrganizeMode(n,t,!0);return r.text(e.Dashboard.edit),i.push(new b.ResetStartBoardCommand(n,t),r,new b.ExitOrganizeMode(n,t)),i}var nt;r.defineProperty(t,"__esModule",{value:!0});var ft=i.Base,tt=ft.Diagnostics,et=tt.Telemetry,ot=i.Parts,st=c.CompositionType,ht=y.ReferenceScope,it=tt.createLog(n),rt=c.getIdMatchFunc;t.fxstartboardsettingchanged="fxstartboardsettingchanged";t.isStartboardPartKey=ut;nt=(function(n){function e(t,r,f){var e=n.call(this,"Startboard",t,null,r,f,o.startBoardSettingsKey)||this;return e._partAwaiter=new a.CompositionAwaiter(!0),e._containerAwaiter=new a.CompositionAwaiter,e.masterContainer=null,e.detailContainers=[],e.notFound=u.observable(!1),e._store=4,i.isFeatureEnabled("dashboardfilters")&&e.registerForDispose(e.dashboardFiltersManager=new w.DashboardFiltersManager(e)),e}return __extends(e,n),e.prototype.getCompositionType=function(){return st.Startboard},e.prototype.setGetDashboard=function(n){if(this._getDashboard)throw new Error("GetDashboard can only be set once by DashboardManager");this._getDashboard=n},e.prototype.removeGetDashboard=function(){this._getDashboard=null},e.prototype.getDashboard=function(){var n=this._getDashboard;return n?n():null},e.prototype.onDetailContainersChanged=function(){},e.prototype.getDeepLink=function(){return Q("")},e.fromJSON=function(n,t,i){return c.createCompositionFromJSON(i,(function(){return lt(n,t,i)}),(function(t,i){var r=new e(n);return r.unrecoverableErrorMessage=i,r}))},e.prototype.toJSON=function(){var t=n.prototype.toJSON.call(this),r=this._getDashboard?this._getDashboard():null,f;return r&&(t.dashboardId=r.id,t.dashboardTitle=r.title,f=r.model,t.dashboardModel=f?{model:u.toJS(f.model),metadata:i.clone(f.metadata,!0)}:undefined),delete t.children,t},r.defineProperty(e.prototype,"eligibleForBinding",{get:function(){return!1},enumerable:!0,configurable:!0}),e.prototype.getInputPropertyBindings=function(){throw new Error("Unreachable code");},e.prototype.getViewModel=function(n){var r,t;if(n=i.isNullOrUndefined(n)?8:n,n===8){if(t=this._getDashboard&&this._getDashboard().model,!t)throw new Error("There is no current Dashboard.");r=t.model}return r||{}},e.prototype.getViewModelAsync=function(n){return f.Deferred().resolve(this.getViewModel(n)).promise()},e.prototype.getCompatibleSourceReferences=function(n){var u=this._getDashboard&&this._getDashboard().model,t=u&&u.metadata,i,f;return t&&(i=n.type,i)?(f=r.keys(t).filter((function(n){var r=t[n];return r===i})),f.map((function(n){return{property:n,modelType:8,scope:ht.CurrentContainer,cardinality:y.ReferenceCardinality.OneToOne}}))):null},e.prototype.logChildren=function(){this.children.forEach((function(n){var t=n&&n.widgetState(),i=t&&t.NormalState?ot.InternalPartSize[t.NormalState.size]:"";et.trace({extension:n.locator.getExtensionLocator().name,source:s.Source.StartBoardPart,action:s.Action.StartBoardPartLoaded,name:n.locator.toFriendlyString(),data:i})}))},e.prototype.getFilters=function(){return this.dashboardFiltersManager&&this.dashboardFiltersManager.getFilters()},e.prototype.updateFilters=function(n,t){return this.dashboardFiltersManager&&this.dashboardFiltersManager.updateFilters(n,t)||Q()},e.prototype.getDashboardFiltersForPart=function(n,t){return this.dashboardFiltersManager&&this.dashboardFiltersManager.getDashboardFiltersForPart(n,t)||Q({})},e.prototype.getFilterIdsForPart=function(n){return this.dashboardFiltersManager&&this.dashboardFiltersManager.getFiltersSupportedByPart(n)},e.prototype.setFilters=function(n){return this.dashboardFiltersManager&&this.dashboardFiltersManager.setFilters(n)},e.prototype.getPartInstance=function(n){return i.find(this.children,(function(t){return t.id===n}))},e.prototype._compose=function(n,r){var s=this,f=new k.ViewModel(this.id,this.widgetState(),this,this.dashboardFiltersManager&&this.dashboardFiltersManager.filtersWidgetViewModel),o=this.services,e=this.createChildLifetime();u.utils.arrayPushAll(f.commands,at(e,this.services));var p=f.addPartsCommand=i.find(f.commands,(function(n){return n.commandName===b.CommandNames.EnterOrganizeMode})),w=f.newCommand=new b.NewDashboard(e,o),nt=f.cloneCommand=new b.CloneDashboard(e,o),tt=f.filterCommand=new b.FilterDashboard(e,o,this),ut=f.fullscreenCommand=new b.FullscreenDashboard(e,o),ft=f.deleteCommand=new b.DeleteDashboard(e,o),et=f.shareCommand=new b.ShareDashboard(e,o),ot=f.browseCommand=new b.OpenBrowseDashboardsPane(e,o),st=f.uploadCommand=new b.UploadDashboard(e,o),ht=f.downloadCommand=new b.DownloadDashboard(e,o),a=this._getDashboard?this._getDashboard().title:null;a&&f.title(a);var v=this.widget=new k.Widget(n.getStartBoardArea(),f),l=v.element,y=function(n,t){n.bind(new h.CompositionInstanceCommandContext(l.findByClassName(t)[0],null,s))};y(p,k.widgetClass+"-title");[[w,"new"],[nt,"clone"],[tt,"filter"],[ut,"fullscreen"],[ft,"delete"],[et,"share"],[ot,"browse"],[st,"upload"],[ht,"download"],].forEach((function(n){var t=n[0],i=n[1];y(t,k.headerButtonClass+"-"+i)}));l.data(c.CompositionInstanceDataName,this);v.ltm.registerForDispose([e,l.setEvents([d.Widget.viewSettingsChanged,function(n,i){n.stopPropagation();s.widgetState(i);l.trigger(t.fxstartboardsettingchanged)},],[g.default.fxunpin,function(n,t){var r=s.children.first(rt(t.tileId)),f;if(r){var e=s.widget,u=e.getDomOrderedChildren(),i=u.indexOf(t.tileId);i=i===0?1:i-1;i=i>=u.length?-1:i;f=i!==-1?s.children.first(rt(u[i])):null;it.warning("Part '{0}' is about to be removed due to user unpin operation.".format(r));s.services.desktop.removeTile(r.id);setTimeout((function(){f?f.widget.setFocus():e.setFocus()}),50)}},]),]);r.resolve()},e.prototype.matchesLocatorAndModel=function(){return!1},e.prototype.resetLayout=function(){this.services.desktop.resetStartBoard()},e.prototype.dispose=function(){it.warning("UI.Composition.Startboard.dispose() has been called.");n.prototype.dispose.call(this,!0)},r.defineProperty(e.prototype,"journeyPath",{get:function(){return[]},enumerable:!0,configurable:!0}),e.prototype.getComposedParts=function(){return this._partAwaiter.resolvedCompositions},e.prototype.awaitComposedPart=function(n,t){return this._partAwaiter.await(n,t)},e.prototype.notifyPartComposed=function(n){this._partAwaiter.resolve(n)},e.prototype.awaitContainer=function(n,t){return this._containerAwaiter.await(n,t)},e.prototype.notifyContainer=function(n){this._containerAwaiter.resolve(n)},e.prototype.onInvocationStarted=function(){},e.prototype.getDiagnosticsData=function(){return f.extend(n.prototype.getDiagnosticsData.call(this),{detailBlades:this.detailContainers.map((function(n){return n+""}))})},e})(l.Instance);t.Instance=nt;t.create=ct}));
define("MsPortalImpl/UI/Dashboard/DashboardCompressor",["require","exports","f","i","o","ko","FxInternal/Di","MsPortalImpl/Extension/DefinitionPreprocessor","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Compositions/UI.Composition.Base","MsPortalImpl/UI/Compositions/UI.Composition.PropertyBinding","MsPortalImpl/UI/Compositions/UI.Composition.Part","MsPortalImpl/UI/Compositions/UI.Composition.StartBoard","MsPortalImpl/UI/Compositions/UI.Composition.PartSettingsManager","MsPortalImpl/UI/Compositions/UI.Composition.PartSize","MsPortalImpl/Services/Services.Settings.Schema","MsPortalImpl/Widgets/Widgets.FlowLayout"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b){"use strict";function ft(n,t){var v=t[d],p=v.widgetState,w=p.NormalState.layoutSettings.positions,r=w.first((function(t){return t.id===n})),c,u;if(!r)return k.warning("Cannot compress part '"+n+"', because it does not have position in startboard."),null;var i=t[n],e=f.toJS(rt(i.containerModel)),b=f.toJS(rt(i.overridesModel)),o=(i.adapterBindings||i.bindings||[]).map((function(n){var t=n.source,o=t&&t.property,s=n.targetProperty,r=t&&t.modelType,u,i,c,v;if(a.isDynamicBindingWithNonLocalSource(n)){if(r!==8)return k.error("For binding for property '{0}', encountered unsupported reference type '{1}'.".format(s,h.referenceTypeMap[r]||r)),null;u={name:s,binding:o}}else i=void 0,c=l.getModelValue(b,o),c.exists?i=f.unwrap(c.value):r===5?i=t.constantValue:(v=l.getModelValue(e,o),v.exists&&(i=f.unwrap(v.value))),u={name:s,value:i};return!n.optional||(u.isOptional=!0),u}));if(o.firstIndex((function(n){return!n}))>=0)return null;c=e[h.PartContainerModelIdProperty];u={};u[h.PartContainerModelIdProperty]=c;var nt=s.Locator.fromJSON(i.locator),tt=y.buildIdentitySettingKey(nt,u),it=t[tt]||undefined,ut=ot(i.locator),ft=ht(i.partState),et=lt(i.assetInstanceDefinition);return{position:{x:r.position.col,y:r.position.row,colSpan:g(r.colSpan),rowSpan:g(r.rowSpan)},metadata:{inputs:o,type:ut,settings:it,isAdapter:i.adapterBindings?!0:undefined,viewState:ft,asset:et,defaultMenuItemId:i.defaultMenuItemId,filters:i.filters}}}function et(n,t,i,u){var e=n.metadata,k=st(e.type),nt=ct(e.viewState),rt=at(e.asset),d=p.getDefaultSize().name,ut={NormalState:{size:d}},a={},g;a[h.PartContainerModelIdProperty]=f.observable(t);var w=s.Locator.fromJSON(k),ft=c.createIdentifier(h.CompositionType.StartboardPart,w,i),et=w.name.startsWith(o.PinPrefix),v={locator:k,partState:nt,assetInstanceDefinition:rt,initialSize:d,widgetState:ut,id:ft,bindingsInitialized:!0,dontSetupWidget:!1,defaultMenuItemId:e.defaultMenuItemId,childSettings:{},children:[],containerModel:undefined,overridesModel:undefined,editScopeId:undefined,bindings:undefined,adapterBindings:undefined,errorMessage:undefined,originalPartLocator:undefined,filters:e.filters},b=[];return e.inputs.forEach((function(n){var t=n.name,i,r=n.binding,u,f;r?i={property:r,modelType:8,cardinality:tt.OneToOne,scope:it.CurrentContainer}:(u=n.value,i={property:t,constantValue:u,modelType:5,cardinality:tt.OneToOne,scope:it.CurrentContainer},et&&t.startsWith(o.collisionPrefix)&&(f=t.split(".")[1],l.setModelValue(a,f,u)));b.push({source:i,targetProperty:t,optional:!!n.isOptional,isDynamicBinding:r?!0:undefined})})),v.containerModel=r.toSerializableObject(a),e.isAdapter?v.adapterBindings=b:v.bindings=b,e.settings&&(g=y.buildIdentitySettingKey(w,a),u(g,e.settings)),v}function ot(n){var i=encodeURIComponent,r=[],t=n,u,f;do u=i(s.LocatorType[t.type]),f=[u,i(t.name)],r.unshift(f.join("/")),t=t.parent;while(t);return r.join("/")}function st(n){var r=decodeURIComponent,u=[],i=[],t;return n.split("/").forEach((function(n,t){i.push(n);t%2==1&&(u.push(i),i=[])})),u.forEach((function(n){var e=r(n.pop()),i=n.pop(),f=i.match(/\[(.*?)\]/),u;f&&(i=i.substring(0,i.lastIndexOf(f[0])));i=r(i);u={name:e,type:s.LocatorType[i]};t&&(u.parent=t);t=u})),t}function ht(n){n=r.isSerializedObject(n)?r.fromSerializableObject(n):n;var f=u.keys(n).filter((function(n){return n!=="container"&&n!=="internal"})),t={};return i.shallowCopyFromObject(t,n,f),ut(t)?undefined:t}function ct(n){return r.toSerializableObject(n||{})}function lt(n){return ut(n)?undefined:{idInputName:n.assetIdInputProperty,type:n.assetType}}function at(n){return n?{assetIdInputProperty:n.idInputName,assetType:n.type}:{}}function vt(n){if(!n)return undefined;var t=n.model,r=n.metadata,i={};return u.keys(t).forEach((function(n){i[n]={value:t[n],type:r[n]}})),i}function yt(n){if(!n)return undefined;var t={},i={};return u.keys(n).forEach((function(r){var u=n[r];t[r]=u.value;i[r]=u.type})),{model:t,metadata:i}}u.defineProperty(t,"__esModule",{value:!0});var tt=l.ReferenceCardinality,it=l.ReferenceScope,rt=a.createContainerModel,ut=i.isEmpty,k=i.Base.Diagnostics.createLog(n),d=w.startBoardSettingsKey,g=function(n){return Math.min(Math.max(n,1),25)},nt=(function(){function n(){}return n.prototype.compress=function(n){var t=n.settings,i=n.title,r=u.keys(t).filter((function(n){return v.isStartboardPartKey(n)})).map((function(n){return ft(n,t)})).filter((function(n){return!!n}));return{title:i,model:vt(t[d].dashboardModel),parts:r}},n.prototype.uncompress=function(n,t,r,u){var f={},e=[];t.parts.forEach((function(n,t){var c=r?r(t):i.getUniqueId(),l=u?u(t):undefined,s=et(n,c,l,(function(n,t){f[n]=t})),o,h;f[s.id]=s;o=n.position;h={id:s.id,colSpan:g(o.colSpan),rowSpan:g(o.rowSpan),position:{col:o.x,row:o.y}};e.push(h)}));try{var o=b.validateGrid(e),h=o.success,s=o.result;h||k.warning("Part '"+s.misplacedPart+"' is misplaced and overlaps with '"+s.overlappedParts.join(", ")+"'.")}catch(c){k.error(c,1)}var l={NormalState:{layoutSettings:{positions:e}}},a=yt(t.model),v={id:d,childSettings:{},locator:null,errorMessage:undefined,widgetState:l,dashboardId:n,dashboardTitle:t.title,dashboardModel:a};return f[d]=v,{id:n,title:t.title,settings:f}},n})();nt=__decorate([e.Class()],nt);t.DashboardCompressor=nt}));
define("MsPortalImpl/UI/Dashboard/PrivateDashboardRepository",["require","exports","f","o","MsPortalImpl/UI/Dashboard/DashboardRepository","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Services/Services.Settings.Schema"],(function(n,t,i,r,u,f,e,o){"use strict";function a(n){var i=r.keys(n);if(i.length>=100)throw new Error("There are no more dashboard stores available.");for(var f=i.map((function(t){return n[t].storeName})),u=0,t=w(u);f.indexOf(t)>-1;)t=w(++u);return t}function b(n,t){for(var u=t||p,o=r.keys(n).map((function(t){return n[t].title.toLowerCase()})),s=function(n){return o.indexOf(n.toLowerCase())>=0},f=function(n){return n<=1?u:u+" ("+n+")"},e=1,i=f(e);s(i);)i=f(++e);return i}function k(n,t,i,r){var u=r.settings[o.startBoardSettingsKey];u.dashboardId=i;n.setSetting(h(t),i,r);n.setSetting(s,i,{storeName:t,id:r.id,title:r.title});n.flushSettings()}function d(){var n=i.getUniqueId();return""+v+n}function g(n,t){return n[t]&&n[t].storeName}function nt(n){return!!h(n)}function tt(n){return n.queryStore(s).then((function(n){return n||{}}))}var it;r.defineProperty(t,"__esModule",{value:!0});var rt=i.Base,ut=rt.Diagnostics,c=f.Dashboard,ft=ut.createLog(n),v="private/",l="recentDashboards",y=10,s=11,p=c.defaultTitle,w=e.getDashboardStoreName,h=e.getDashboardStoreId,et=i.forEachKey;t.buildNextStoreName=a;t.createDashboardTitle=b;it=(function(){function n(n){this._settingsManager=n}return n.prototype.getTypeName=function(){return u.PrivateDashboardRepository},n.prototype.createDashboard=function(n){var r=this,t=n.extras&&n.extras.id||d(),i={id:t,title:n.title,settings:n.settings};return this._getDashboards().then((function(n){return k(r._settingsManager,a(n),t,i),i}))},n.prototype.readDashboard=function(n){var t=this;return this._getDashboards().then((function(i){var r=g(i,n);if(r)return t._settingsManager.querySetting(h(r),n)}))},n.prototype.updateDashboard=function(n,t){var r=this;return this.readDashboard(n).then((function(u){if(u){var f={};return i.shallowCopyFromObject(f,u),i.shallowCopyFromObject(f,t),r._getDashboards().then((function(t){var i=g(t,n)||a(t);return k(r._settingsManager,i,n,f),f}))}return r.createDashboard({title:t.title,settings:t.settings,extras:{id:n}})}))},n.prototype.deleteDashboard=function(n){var t=this._settingsManager;return tt(t).then((function(i){var f=i[n],u,e,o;u=f?f.storeName:r.keys(i).filter(nt).first((function(t){return(i[t]||{}).id===n}));u&&t.deleteSettings({store:h(u),keys:[n]});e=u&&i[u]&&i[u].id===n;o=e?[u,n]:[n];t.deleteSettings({store:s,keys:o});t.flushSettings()}))},n.prototype.readDashboards=function(){return this._getDashboards().then((function(n){return r.keys(n).map((function(t){return n[t]}))}))},n.prototype.identifyDashboard=function(n){return i.startsWith(n,v)},n.prototype.isDashboardWritable=function(){return Q(!0)},n.prototype.getNotFoundMessage=function(n){return c.NotFound.privateMessageFormat.format(n.title)},n.prototype.canCreateNewDashboard=function(){return this._getDashboards().then((function(n){return r.keys(n).length<100}))},n.prototype.cloneDashboard=function(n,t){return this.createDashboard({settings:n,title:c.cloneTitleFormat.format(t)})},n.prototype.getRecentDashboards=function(){return this._settingsManager.querySetting(s,l).then((function(n){var t=(n||[]).slice(0,y).filter((function(n){return!!n.id}));return i.unique(t,(function(n,t){return n.id.toLowerCase()===t.id.toLowerCase()}))}))},n.prototype.addToRecent=function(n){var t=this;return this.getRecentDashboards().then((function(r){var u=i.findIndex(r,(function(t){return t.id.toLowerCase()===n.id.toLowerCase()}));return u===0?r:(u>0&&r.splice(u,1),r.unshift({id:n.id,title:n.title}),r=r.slice(0,y),t._settingsManager.setSetting(s,l,r),r)}))},n.prototype.removeFromRecent=function(n){var t=this;return this.getRecentDashboards().then((function(r){var u=i.findIndex(r,(function(t){return t.id.toLowerCase()===n.toLowerCase()}));return u>=0&&(r.splice(u,1),t._settingsManager.setSetting(s,l,r)),r}))},n.prototype.createDefaultDashboard=function(n){var t;return t=n?Q(n):this._getDashboards().then((function(n){return b(n)})).catch((function(n){return ft.error(n,0,"Failed to generate a dashboard title with index."),p})),t.then((function(n){var t=d();return{id:t,title:n}}))},n.prototype._getDashboards=function(){var n=this;return tt(this._settingsManager).then((function(t){return et(t,(function(t,i,r){if(i){var u;n.identifyDashboard(t)?(u=i,r[u.id]=u):nt(t)&&(u=i,r[u.id]||(r[u.id]=u))}}),{})}))},n})();t.PrivateDashboardRepository=it}));
define("MsPortalImpl/UI/Dashboard/DashboardClient",["require","exports","f","o","FxInternal/Di","MsPortalImpl/Extension/ExtensionManager"],(function(n,t,i,r,u,f){"use strict";var e,o;r.defineProperty(t,"__esModule",{value:!0});e=(function(){function n(n){this._extensionManager=n}return n.prototype.connect=function(n,t,r){var u,f;return this._extensionManager.getExtensionByName(n).then((function(n){return u=n,u.getViewModel(t(u))})).then((function(n){return f=n,Q(r(n.content))})).finally((function(){i.disposeViewModelProperties(f);u&&f&&u.releaseViewModel(f)}))},n})();e=__decorate([u.Class(),__metadata("design:paramtypes",[f.ExtensionManager])],e);t.ViewModelConnector=e;o=(function(){function n(n){this._connector=n}return n.prototype.getDashboard=function(n,t){return this._connector.connect(t,(function(n){return n.definition.dashboardProvider.viewModel}),(function(t){return Q(t.getDashboard(n))}))},n})();o=__decorate([u.Class(),__metadata("design:paramtypes",[e])],o);t.DashboardClient=o}));
define("MsPortalImpl/UI/Dashboard/RecommendedDashboardRepository",["require","exports","f","i","o","FxInternal/Di","MsPortalImpl/UI/Dashboard/DashboardClient","MsPortalImpl/UI/Dashboard/DashboardCompressor","MsPortalImpl/UI/Dashboard/DashboardRepository"],(function(n,t,i,r,u,f,e,o,s){"use strict";function l(n){var t=n.substr(c.length).split("/");return{dashboardParam:t.slice(1).join("/"),extensionName:t[0]}}var c,h;u.defineProperty(t,"__esModule",{value:!0});c="recommended/";t.parseDashboardId=l;h=(function(){function n(n,t){this._dashboardClient=n;this._compressor=t}return n.prototype.createDashboard=function(){return r.QReject("Cannot create a recommended dashboard")},n.prototype.readDashboard=function(n){var i=this,t=l(n);return this._dashboardClient.getDashboard(t.dashboardParam,t.extensionName).then((function(t){return i._compressor.uncompress(n,t)}))},n.prototype.updateDashboard=function(){return r.QReject("Cannot update a recommended dashboard")},n.prototype.deleteDashboard=function(){return Q()},n.prototype.readDashboards=function(){return Q([])},n.prototype.getTypeName=function(){return s.RecommendedDashboardRepository},n.prototype.identifyDashboard=function(n){return i.startsWith(n,c)},n.prototype.isDashboardWritable=function(){return Q(!1)},n})();h=__decorate([f.Class(),__metadata("design:paramtypes",[e.DashboardClient,o.DashboardCompressor])],h);t.RecommendedDashboardRepository=h}));
define("MsPortalImpl/UI/Dashboard/DashboardManager",["require","exports","f","o","ko","$","MsPortalImpl/Base/Base.Router","MsPortalImpl/UI/Dashboard/ArmDashboardRepository","MsPortalImpl/UI/Dashboard/DashboardCompressor","MsPortalImpl/UI/Dashboard/DashboardRepository","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/UI/Dashboard/PrivateDashboardRepository","MsPortalImpl/Services/Services.Permissions","MsPortalImpl/Services/Services.SelectedSubscriptions","MsPortalImpl/Services/Services.Settings.Schema","MsPortalImpl/Base/Telemetry","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Compositions/UI.Composition.Base","MsPortalImpl/UI/Compositions/UI.Composition.CompositionBinder","MsPortalImpl/UI/Compositions/UI.Composition.Part","MsPortalImpl/UI/Compositions/UI.Composition.PartSettingsManager","MsPortalImpl/UI/Compositions/UI.Composition.StartBoard","MsPortalImpl/UI/Compositions/UI.Composition.StartboardPart","MsPortalImpl/UI/Dashboard/RecommendedDashboardRepository","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/Widgets/Widgets.Common","MsPortalImpl/Widgets/Widgets.StartBoard","MsPortalImpl/Widgets/Widgets.TopBar","MsPortalImpl/Base/Base.Timers"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st){"use strict";function ci(n){var r=n||{},u=r.model,f=r.metadata;return{model:i.extend2(t.defaultDashboardModelJson.model,u),metadata:i.extend2(t.defaultDashboardModelJson.metadata,f)}}function lt(n,t,i){return new gt(n,t||new Error,i)}function ki(n){var t=n.services,f=new yi(t.settings),e=new ui(t),r=t.diContainer.get(s.DashboardCompressor),i=new fi(n.services.diContainer,f,n.services.desktop.portalWidget.getTopBarWidget(),n.lifetime,e,r,n.services.storageService),h=new o.ArmDashboardRepository(t.diContainer.get(v.PermissionsManager),t.storageService,r),u;return i.addRepository(h),u=t.diContainer.get(rt.RecommendedDashboardRepository),i.addRepository(u),i}function li(n){return n.id.toLowerCase().replace(/\/\/+/g,"/")}function bt(n,t){return li(n)===li(t)}function ri(n){return Q(n)}function ni(n,t){return nt.buildIdentitySettingKey(n,t)}function ti(n){return vt.start({source:w.Source.Dashboard,action:n,actionModifier:vt.ActionModifier.Start})}function ai(n,t,i,r){var u=i.id;return Q.allSettled(r.children.map((function(n){return Q(n.awaitComposed()).then((function(){return n.awaitOnInputsSetComplete()})).then((function(){return n}),(function(){return n}))}))).then((function(i){vt.completeTrace(n,{success:!0,dashboardId:u,parts:i.map((function(n){var t=n.value;return{name:t.locator.toFriendlyString(),deepLink:t.deepLink,visible:ft.isElementFullyInViewport(t.widget.element[0]).fullyVisible}})),interactionSource:t})}))}function vi(n){var t=n&&n.widgetState||{};return t.NormalState&&t.NormalState.layoutSettings||{}}function di(n){var t={},f=n[wt],e=vi(f),o=[];return r.keys(n).filter((function(n){return tt.isStartboardPartKey(n)})).forEach((function(r){var f=n[r],a=c.Locator.fromJSON(f.locator),v=g.createContainerModel(f.containerModel),tt=ni(a,v),w=u.toJS(v),y,s,p,d,nt,h,l;w[b.PartContainerModelIdProperty]=i.getUniqueId();y=ii(w);f.containerModel=g.getSerializableContainerModel(y,!1);s=k.createIdentifier(b.CompositionType.StartboardPart,a);f.id=s;t[s]=f;p=n[tt];p&&(d=ni(a,y),t[d]=p);f.flags&2&&(nt=c.Locator.fromJSON(f.originalPartLocator),h=ni(nt,v),n[h]&&(t[h]=n[h]));l=(e.positions||[]).first((function(n){return n.id===r}));l&&(l.id=s,o.push(l))})),e.positions=o,t[wt]=f,JSON.parse(JSON.stringify(t))}function gi(n){var r=n&&n.relative,f=n&&n.absolute,t="",i,u;if(r){i=r.duration;u=r.timeUnit;switch(u){case 3:i===1&&(t=dt.pastWeek);break;case 1:i===1?t=dt.pastHour:i===24&&(t=dt.past24Hours)}}else f&&(t=dt.custom);return t}function nr(n){var t=n&&n.model&&n.model.model;return t&&t.timeRange}function at(n,t,i){t&&e.updateDashboardUri(n,t.id,i)}function ht(n,t){n._startboard.widget.options.loading(t)}var gt,ui,fi;r.defineProperty(t,"__esModule",{value:!0});var ei=i.Base,yi=a.PrivateDashboardRepository,pi=i.Composition.Configuration,vt=ei.Diagnostics.Telemetry,kt=w.Action,wi=window,pt=wi.fx,ct=ei.Diagnostics.createLog(n),wt=p.startBoardSettingsKey,bi=10,yt=l.Dashboard,dt=l.Filter.Option,ii=d.CompositionBinder.createObservableModel,oi="create",si="clone",hi="unpublish";t.defaultDashboardModelJson={model:{timeRange:{relative:{duration:24,timeUnit:1}}},metadata:{timeRange:pi.TimeRangeValueType}};t.backfillDashboardModel=ci;gt=(function(n){function t(t,i,r){return n.call(this,{code:t,data:r||{},message:i.message,stack:i.stack,innerErrors:i})||this}return __extends(t,n),t})(i.Errors.Error);gt.TypeName="MsPortalImpl.UI.DashBoardError";t.create=ki;t.isSameDashboard=bt;t.startTrace=ti;ui=(function(){function n(n){this._desktopManager=n.desktop;this._settingsManager=n.settings;this._notificationManager=n.notificationManager}return n.prototype.collectDashboardSettings=function(n){var s=this,e={},r=n.toJSON(),t=n.children.filter((function(n){return!n.dontSetupWidget&&!n.isDisposed()})),o=n.widget.getDomOrderedChildren(),u;return t.length!==o.length&&ct.error("There should be the same number of composed parts to save ("+t.length+") as the number of positioned elements in the layout ("+o.length+"). The settings will be incorrect."),u=[],o.forEach((function(n){var r=i.remove(t,(function(t){return t.id===n}));if(r.length!==1){ct.error("There should be a composed part with ID '"+n+"' yet none was found. The saved content will be incorrect. The settings will be incorrect.");return}u.push(s.getPartSettings(r[0]))})),t.length>0&&t.forEach((function(n){ct.error("Part '"+n.id+"' should have a position defined in the layout, yet none was found. The settings will be incorrect.");u.push(s.getPartSettings(n))})),Q.allSettled(u).then((function(t){return t.forEach((function(n){f.extend(e,n.value)})),n.dashboardFiltersManager&&n.dashboardFiltersManager.toJSON().catch((function(){return ct.error("Failed to get part filters information."),r.dashboardModel.model}))})).then((function(n){return n&&(r.dashboardModel.model.filterLocale=n.filterLocale,r.dashboardModel.model.filters=n.filters),e[wt]=r,JSON.parse(JSON.stringify(e))}))},n.prototype.getPartSettings=function(n){var t=this;return Q(n.awaitComposed()).then((function(){var o;if(n.isDisposed())return{};var s={},r=n.toJSON(),e=n.containerModel;return e[b.PartContainerModelIdProperty]||(o=u.toJS(g.createContainerModel(r.containerModel)),o[b.PartContainerModelIdProperty]=i.getUniqueId(),e=ii(o),r.containerModel=g.getSerializableContainerModel(e,!1)),s[r.id]=r,t.getPartIdentitySettings(n,e).then((function(n){return f.extend(s,n)}))})).catch((function(t){return ct.error(t,8,"part: '"+n.id+"'."),{}}))},n.prototype.getPartIdentitySettings=function(n,t){var r=n.partDefinition,i;return!r||!r.partState?Q({}):(i=ni(n.locator,t),Q(n.getPartSettingsManager().getStartboardPartIdentitySettings()).then((function(n){if(!n)return{};var t={};return t[i]=n,t})).catch((function(t){return ct.error(t,9,"Failed to get part '"+n.id+"' identify settings for key '"+i+"'."),{}})))},n.prototype.clearStartboard=function(n,t){var i=this._desktopManager;n.children.filter((function(n){return!n.dontSetupWidget})).forEach((function(n){return i.removeTile(n.id,{force:!0,skipSave:t})}))},n.prototype.renderStartboard=function(n,t,u,f){var s=u.delayRendering,e=r.keys(t),h={},a=function(n,t){var r={};return i.shallowCopyFromObject(r,n,t),r},v=e.filter((function(n){return i.startsWith(n,nt.partIdentityStatePrefix)})),l,o;return this._settingsManager.setSettings({store:13,settings:a(t,v)}),l=t[wt],n.widget.options.applyViewSettings(l.widgetState),e=e.filter((function(n){return tt.isStartboardPartKey(n)})),o=[],e.forEach((function(i){var u=t[i],r,f,e;try{r=c.Locator.fromJSON(u.locator)}catch(s){ct.error("Error deserializing locator for part setting.\r\nError:'"+s+"'\r\nKey:'"+i+"'\r\nJSON:'"+u+"'")}r&&(f=r.getExtensionLocator(),(r.type===c.LocatorType.PartType||r.type===c.LocatorType.PartInstance&&r.parent&&r.parent.type===c.LocatorType.Lens&&r.parent.parent&&r.parent.parent.type===c.LocatorType.Blade)&&(e=n.services.extensionManager.on("assetTypes").then((function(){var s=r.type===c.LocatorType.PartType?c.Locator.forPartTypeRedirect(f.name,r.name):c.Locator.forPartInstanceRedirect(f.name,r.name,r.parent.parent.name,r.parent.name),e={},t,o;n.services.finder.tryLocate(s,e)&&(t=e.value,h[i]=t.bindings,f=t.toExtension?c.Locator.forExtension(t.toExtension):f,o=f.withPartType(e.value.toPart),u.originalPartLocator=u.locator,u.flags||(u.flags=0),u.flags|=2,u.locator=o.toJSON(),vt.trace({source:w.Source.Dashboard,action:kt.Redirect,name:r.toFriendlyString(),data:{to:o.toFriendlyString()}}))})).catch((function(n){ct.error("Error locating or applying part redirect.\r\nError: '"+n+"'\r\nKey: '"+i+"'\r\nStack: "+(n&&n.stack))})),o.push(e)))})),Q.all(o).then((function(){var i=[];e.forEach((function(r){var o=t[r],e=it.Instance.fromJSON(n.services,o,h[r],f),s=e.locator.getExtensionLocator(),c=n.services.extensionManager.getExtension(s.name);(c||!u.isDefault)&&i.push(e)}));i.length&&(n.addChildren(i),s||i.forEach((function(t){t.compose(n.widget);t.save()})));s||(n.discardWidgetStateOfUnusedChildren(),n.save())}))},n.prototype.readDashboardsOfMaxCount=function(n,t,i,r){n=n.slice();i=i.slice();var u=[],e=i.map((function(n){return n.id.toLowerCase()})),f=function(){var i=n.shift();return i.readDashboards().then((function(n){return r(n,i.getTypeName()),n.filter((function(n){return e.indexOf(n.id.toLowerCase())<0})).slice(0,t-u.length)})).catch((function(n){var t=i.getTypeName();return ct.error(n,10,"Failed to read dashboards from '"+t+"' repository."),[]})).then((function(i){return u.push.apply(u,i),u.length>=t||!n.length?Q():f()}))};return f().then((function(){return u}))},n.prototype.enterOrganizeMode=function(n){var t=this._desktopManager;t.mode(1);n&&t.portalWidget.options.sideBarViewModel.isCollapsed(!n)},n.prototype.isStartboardReady=function(){return this._desktopManager.startBoardPartsLoaded()},n.prototype.getStartboardReadyPromise=function(){return this._desktopManager.getStartboardPartsLoadedPromise()},n.prototype.popNotification=function(n,t,r){r===void 0&&(r=i.Hubs.Notifications.NotificationStatus.Error);this._notificationManager.addClientNotification({title:n,description:t,status:r,timestamp:new Date})},n})();t.DashboardHelperImpl=ui;fi=(function(){function n(n,t,i,r,f,e,o){var s=this;this.currentDashboardId=u.observable("");this._notifyDashboardChanged=st.throttle((function(){if(!s._startboard.notFound()){var n=s._privateRepo.identifyDashboard(s._curDashboard.id);n?s.saveCurrentDashboard():s._topbarWidget.options.dashboardChanged(!0)}}));this._diContainer=n;this._privateRepo=t;this._topbarWidget=i;this._lifetime=r;this._helper=f;this._compressor=e;this._storage=o;this._otherRepos=[];this._isStartboardChanging=!1;this._isMigrated=!1;this._armDashboardCache=[];this._isStartboardShared=u.observable(!1);r.registerForDispose(this._notifyDashboardChanged)}return n.prototype.resetLayout=function(n){var t=this._helper,i=o.normalizedDashboard(pt.environment.defaultDashboard||{}),r=this._compressor.uncompress(yt.defaultTitle,i);return t.clearStartboard(n),t.renderStartboard(n,r.settings,{delayRendering:!1,isDefault:!0,isCurrentDashboardShared:this.isCurrentDashboardShared()})},n.prototype.isCurrentDashboardShared=function(){var n=this._curDashboard&&this._findOwningRepo(this._curDashboard.id);return n&&n.getTypeName()===h.ArmDashboardRepository},n.prototype.isCurrentDashboardWritable=function(){return this._isWritable(this._curDashboard.id)},n.prototype.getCurrentDashboardProperties=function(){var n=this._curDashboard,t=this._findOwningRepo(n.id);return t&&t.getDashboardProperties?t.getDashboardProperties(n):{id:n.id,title:n.title}},n.prototype.initialize=function(n,t,r,u,f){var o=this,s,h;return this._startboard=n,this._registerEventHandlers(this._lifetime),s=i.isFeatureEnabled("addsessiondashboardrepository")?i.require("MsPortalImpl/UI/Dashboard/SessionDashboardRepository").then((function(n){var t=new n.SessionDashboardRepository(o._storage);o.addRepository(t)})):Q(),h=s.then((function(){return t?(o._isMigrated=!0,o._initDashboard(t,f)):o._migrateStartboard().then((function(){return f.dashboardMigration=pt.getTimestamp(),r?o.switchDashboard({id:r,title:r},"DeepLinkAfterMigration"):Q()}))})).then((function(){f.dashboardInitialized=pt.getTimestamp();(e.isDashboardRoute()||e.isDashboardUri()&&!t)&&at(o._diContainer,o._curDashboard,!0)})).catch((function(n){o._handleError(n,"initializeDashboard")})).finally((function(){ai(u,"PortalLoad",o._curDashboard,o._startboard).then((function(){f.dashboardRevealed=pt.getTimestamp()}))})),h},n.prototype.addRepository=function(n){this._otherRepos.push(n)},n.prototype.readDashboardsForType=function(n,t){return t===void 0&&(t=[]),this._getRepositoryByType(n).readDashboards(t)},n.prototype.startNewDashboard=function(){var n=this;return this._privateRepo.canCreateNewDashboard().then((function(n){if(n)return Q();throw lt(6,null,{action:oi});})).then((function(){return ht(n,!0),n._addToRecent(n._curDashboard)})).then((function(){return n._privateRepo.createDefaultDashboard()})).then((function(t){return n._setCurDashboard(t,!0),at(n._diContainer,t),n._isStartboardChanging=!0,n._helper.clearStartboard(n._startboard),n._isStartboardChanging=!1,n._startboard.save(),n._saveDashboard(n._curDashboard)})).then((function(){n._helper.enterOrganizeMode(!0)})).catch((function(t){n._handleError(t,"startNewDashboard")})).finally((function(){ht(n,!1)}))},n.prototype.importDashboard=function(n){var t=this;return this._privateRepo.canCreateNewDashboard().then((function(n){if(!n)throw lt(6,null,{action:si});t._isStartboardChanging=!0;ht(t,!0)})).then((function(){return Q.all([t._addToRecent(t._curDashboard),t._privateRepo._getDashboards(),])})).then((function(r){var f=r[1],e=i.getUniqueId(),u=t._compressor.uncompress("private/"+e,n);return t._privateRepo.createDashboard({settings:u.settings,title:a.createDashboardTitle(f,u.title)})})).then((function(n){return at(t._diContainer,n),t._loadDashboard(n,!1,!0)})).catch((function(n){t._handleError(n,"importDashboard")})).finally((function(){t._isStartboardChanging=!1;ht(t,!1)}))},n.prototype.getArmDashboardJson=function(){var n=this;return this._collectDashboardSettings(!0,!0).then((function(t){var i=n._compressor.compress({id:"",title:t[wt].dashboardTitle,settings:t}),r={};return i.parts.forEach((function(n,t){r[t]=n})),{properties:{lenses:{"0":{order:0,parts:r}}},id:t[wt].dashboardId,name:"",type:"Microsoft.Portal/dashboards",location:"",tags:{"hidden-title":i.title},apiVersion:"2015-08-01-preview"}})).then((function(t){var r=o.getArmDashboardId(t.id),u=n._otherRepos[0];return u.readArmDashboards().then((function(n){return n.filter((function(n){return i.ViewModels.Services.ResourceTypes.compareResourceId(n.id,r)})).first()})).then((function(i){var r=n._isStartboardShared();return t.location=r&&i?i.location:"INSERT LOCATION",t.name=r&&i?i.name:t.tags["hidden-title"],t}))}))},n.prototype.saveCurrentDashboard=function(){var n=this;return this._saveDashboard(this._curDashboard).catch((function(t){n._handleError(t,"saveCurrentDashboard")}))},n.prototype.cloneCurrentDashboard=function(n){var t=this;return n===void 0&&(n=!0),this._privateRepo.canCreateNewDashboard().then((function(n){if(n)return Q();throw lt(6,null,{action:"import"});})).then((function(){return t._isStartboardChanging=!0,ht(t,!0),t._collectDashboardSettings(n,!0)})).then((function(n){return t._addToRecent(t._curDashboard).then((function(){return t._privateRepo.cloneDashboard(n,t._curDashboard.title)}))})).then((function(n){return at(t._diContainer,n),t._loadDashboard(n,!1,!0)})).then((function(){t._helper.enterOrganizeMode()})).catch((function(n){t._handleError(n,"cloneCurrentDashboard")})).finally((function(){t._isStartboardChanging=!1;ht(t,!1)}))},n.prototype.deleteCurrentDashboard=function(n){var t=this,i="deleteCurrentDashboard";return this._isStartboardChanging=!0,ht(this,!0),this._readNextDashboards(1).then((function(n){if(n.length<=0)throw lt(2);return n[0]})).then((function(r){return t._deleteDashboard(t._curDashboard,n).catch((function(n){return t._handleError(n,i)})).then((function(){return r}))})).then((function(n){return at(t._diContainer,n,!0),t._loadDashboard(n)})).catch((function(n){t._handleError(n,i)})).finally((function(){t._isStartboardChanging=!1;ht(t,!1)}))},n.prototype.restoreCurrentDashboard=function(){var n=this;return this._isStartboardChanging=!0,ht(this,!0),this._loadDashboard(this._curDashboard).catch((function(t){n._handleError(t,"restoreCurrentDashboard")})).finally((function(){n._isStartboardChanging=!1;ht(n,!1)}))},n.prototype.switchDashboard=function(n,t){var i=this,r=bt(this._curDashboard,n),u;return(at(this._diContainer,n,r),r)?Q():(u=ti("DashboardRevealed"),ht(this,!0),Q(this._switchDashboard(n,!1)).finally((function(){ht(i,!1);ai(u,t,i._curDashboard,i._startboard)})))},n.prototype.populateQuickDashboards=function(n){var t=this;return this._readNextDashboards(bi,(function(i){i=t._curDashboard.id?[t._curDashboard].concat(i):i;n(i)}))},n.prototype.shareCurrentDashboard=function(n,t,i){var r=this,u=this._curDashboard;return ht(this,!0),this.shareCurrentDashboardToArm(n,t,i).then((function(n){return at(r._diContainer,n,!0),r._switchDashboard(n,!0)})).then((function(){return r._deleteDashboard(u,2)})).finally((function(){ht(r,!1)}))},n.prototype.unshareCurrentDashboard=function(){var n=this,i="unshareCurrentDashboard",t=this._curDashboard;return this._privateRepo.canCreateNewDashboard().then((function(t){if(t)return Q();var r=lt(6,null,{action:hi});n._handleError(r,i);throw r;})).then((function(){return ht(n,!0),n._shareCurrentDashboard(h.PrivateDashboardRepository,t.title)})).then((function(t){return at(n._diContainer,t,!0),n._switchDashboard(t)})).then((function(){return n._deleteDashboard(t,3)})).finally((function(){ht(n,!1)}))},n.prototype.shareCurrentDashboardToArm=function(n,t,i){var r=this,u=ti(kt.DashboardPublishNew);return this._shareCurrentDashboard(h.ArmDashboardRepository,n,{subscriptionId:t,resourceGroupName:i}).then((function(n){return vt.completeTrace(u,{success:!0,dashboardId:n.id}),n})).catch((function(f){vt.completeTrace(u,{success:!1});var e=lt(7,f,{dashboardId:r._curDashboard.id,dashboardTitle:n,subscriptionId:t,resourceGroupName:i});r._handleError(e,"shareCurrentDashboardToArm");throw e;}))},n.prototype.shareCurrentDashboardToSession=function(n){var t=this;return this._shareCurrentDashboard(h.SessionDashboardRepository,n).catch((function(i){var r=lt(7,i,{dashboardId:t._curDashboard.id,dashboardTitle:n});t._handleError(r,"shareCurrentDashboardToSession");throw r;}))},n.prototype._registerEventHandlers=function(n){var t=this,f=this._startboard,h=this._topbarWidget.element,s=this._topbarWidget.options,e=f.widget,c=e.element;f.setGetDashboard((function(){return i.clone(t._curDashboard)}));u.reactor(n,(function(){var n,i,r;t.currentDashboardId();n=nr(t._curDashboard);i=gi(n&&n());i&&(r=yt.filterButtonTextFormat.format(i),e.options.filterButtonText(r))}));var l=function(n){n.stopPropagation();t._isMigrated&&t._helper.isStartboardReady()&&!t._isStartboardChanging&&t._notifyDashboardChanged()},a=function(n){n.stopPropagation();t._isMigrated&&t._helper.isStartboardReady()&&!t._isStartboardChanging&&t._notifyDashboardChanged()},o=function(n,i){var r,u,e;n.stopPropagation();r=i.part;r.getCompositionType()===b.CompositionType.StartboardPart&&(u=r.getViewModel(),u&&!u.container.operations.inProgress.peek()&&(e=t._privateRepo.identifyDashboard(t._curDashboard.id),e?t._notifyDashboardChanged():s.dashboardVisible()&&(i.isUserInteraction||f.services.desktop.mode()===1?t._notifyDashboardChanged():vt.trace({source:w.Source.StartBoardPart,action:kt.PartUpdated,name:r.locator.toFriendlyString(),data:{isPartLoading:r.awaitContentRevealed().isPending()}}))))},v=function(n){n.stopPropagation();var i=e.options;i.title().length===0&&(f.services.desktop.mode(1),i.title(yt.untitled));t._notifyDashboardChanged()},p=function(n,i){if(n.stopPropagation(),s.dashboardChanged(!1),!f.notFound())switch(i.action){case 1:t.saveCurrentDashboard();break;case 2:t.cloneCurrentDashboard(!1);break;case 3:t.restoreCurrentDashboard()}},k=function(n){n.stopPropagation();t._migrateStartboard()},r=e.options;r.refreshDashboardList=function(n){return t.populateQuickDashboards(n)};r.updateDashboardUri=at;r.switchDashboard=function(n){return t.switchDashboard(n,"RecentList")};r.title.subscribe(n,(function(n){t._curDashboard.title=n}));f.notFound.subscribe(n,(function(n){r.notFound(n)}));r.isShared(this.isCurrentDashboardShared());this._isStartboardShared.subscribe(n,r.isShared,(function(n){r.isShared(n)}));y.selectedSubsUpdateTriggered.subscribe(n,(function(){var n=i.Azure.getAllSubscriptions(),t=y.getSelectedSubscriptions();Q.all([n,t]).spread((function(n,t){var i=n.length,u=t.length;r.subscriptionsInfo(u>=i?yt.browseForAllSubs.format(i):yt.browseForSelectedSubs.format(u,i))}))})).callback(null);n.registerForDispose([function(){f.removeGetDashboard()},c.setEvents([tt.fxstartboardsettingchanged,l],[b.fxreplacedpartcomposing,a],[g.fxpartsettingchanged,o],[g.fxpartinputchanged,o],[it.fxpartfilterschanged,o],[et.fxstartboardtitlechanged,v],[et.fxmigratestartboard,k]),h.setEvents([ot.fxfinishdashboardedit,p])])},n.prototype._setCurDashboard=function(n,t,i){var r,u,f,e;i===void 0&&(i=!1);n=n||{id:"",title:l.NavBar.home};n&&(u=n.settings,f=u&&u[wt],r=f&&f.dashboardModel);r=ci(r);e={model:ii(r.model),metadata:r.metadata};this._curDashboard={id:n.id,title:n.title,isWritable:t,model:e};this._startboard.widget.options.title(n.title);this._topbarWidget.options.dashboardWritable(t);this.currentDashboardId(n.id);this._startboard.notFound(i);this._isStartboardShared(this.isCurrentDashboardShared());this._startboard.dashboardFiltersManager&&this._startboard.dashboardFiltersManager.loadDashboard(r&&r.model)},n.prototype._switchDashboard=function(n,t){var i=this;return this._isStartboardChanging=!0,this._addToRecent(this._curDashboard).then((function(){return i._loadDashboard(n,!1,t)})).catch((function(n){i._handleError(n,"switchDashboard")})).finally((function(){i._isStartboardChanging=!1}))},n.prototype._findOwningRepo=function(n){var t=[this._privateRepo];return t.concat(this._otherRepos).first((function(t){return t.identifyDashboard(n)}))},n.prototype._getRepositoryByType=function(n){var t=[this._privateRepo];return t.concat(this._otherRepos).first((function(t){return t.getTypeName()===n}))},n.prototype._readDashboard=function(n){var i=this,t=n.id;return ri(this._findOwningRepo(t)).then((function(n){return n.readDashboard(t)})).then((function(n){if(!n)throw new Error("It succeeded in reading dashboard '"+t+"'. But the result is "+n+".");return n})).catch((function(r){throw lt(1,r,{dashboardId:t,dashboardTitle:n.title,initDashboardIdFromStore:i.initDashboardIdFromStore});}))},n.prototype._collectDashboardSettings=function(n,t){var r=this,u=n?this._readDashboard(this._curDashboard):Q(null);return Q(u).catch(i.noop).then((function(n){return n?n.settings:r._helper.collectDashboardSettings(r._startboard)})).then((function(n){return t?di(n):n}))},n.prototype._saveDashboard=function(n){var u=this,t=n.id,r=n.title,f=i.getCurrentCallStack(!0);return this._collectDashboardSettings().then((function(n){return ri(u._findOwningRepo(t)).then((function(i){var e=n&&n.Startboard,u=vi(e),o=u.positions&&u.positions.length;return o||ct.warning("Saving empty dashboard.",0,f),i.updateDashboard(t,{settings:n,title:r})}))})).catch((function(t){throw lt(5,t,{dashboardId:n.id,dashboardTitle:r});}))},n.prototype._deleteDashboard=function(n,t){var e=this,r=n.id,f,u;return i.remove(this._armDashboardCache,(function(n){return n.id.toLowerCase()===r.toLowerCase()})),f=ti(kt.DashboardDelete),u=!0,this._removeFromRecent(r).then((function(){var n=e._findOwningRepo(r);return n.deleteDashboard(r)})).catch((function(t){u=!1;throw lt(4,t,{dashboardId:r,dashboardTitle:n.title});})).finally((function(){vt.completeTrace(f,{success:u,dashboardId:r,reason:t})}))},n.prototype._readNextDashboards=function(n,t){var r=this;t||(t=i.noop);var u=function(t,i){return t=i?o.filterDashboards(t,i):t,t.filter((function(n){return!bt(n,r._curDashboard)})).slice(0,n)},f=y.getSelectedSubscriptions().catch((function(){return[]})),e=this._privateRepo.getRecentDashboards().catch((function(){return[]}));return Q.all([f,e]).spread((function(f,e){var o=f.map((function(n){return n.subscriptionId}));return(e=u(e,o),e.length>=n)?(t(e),Q(e)):r._privateRepo.readDashboards().catch((function(){return[]})).then((function(f){var s=i.union(e,f,bt);return(s=u(s),s.length>=n)?(t(s),s):(s=i.union(s,r._armDashboardCache,bt),s=u(s,o),t(s),s.length>=n)?s:r._helper.readDashboardsOfMaxCount(r._otherRepos,n-s.length,s,(function(n,f){f===h.ArmDashboardRepository&&(r._armDashboardCache=n);s=i.union(s,n,bt);s=u(s);t(s)})).then((function(){return s}))}))}))},n.prototype._isWritable=function(n){return ri(this._findOwningRepo(n)).then((function(t){return t.isDashboardWritable(n)})).catch((function(){return!0}))},n.prototype._addToRecent=function(n){return this._startboard.notFound()?Q():this._privateRepo.addToRecent(n).catch(f.noop)},n.prototype._removeFromRecent=function(n){return this._privateRepo.removeFromRecent(n).catch(f.noop)},n.prototype._loadDashboard=function(n,t,i,r,u){var f=this,e=n.id,s=i?Q(n):this._readDashboard(n),o=this._helper;return r=r||{},Q.all([this._removeFromRecent(e).then((function(){r.dashboardRemoveFromRecent=pt.getTimestamp()})),this._isWritable(e).then((function(n){return r.dashboardIsWritable=pt.getTimestamp(),n})),Q(s).then((function(n){return r.dashboardRead=pt.getTimestamp(),n})),]).spread((function(n,i,r){return f._setCurDashboard(r,i),o.clearStartboard(f._startboard),o.renderStartboard(f._startboard,r.settings,{delayRendering:t,isCurrentDashboardShared:f.isCurrentDashboardShared()},u)})).catch((function(t){f._setCurDashboard(n,!0,!0);f._startboard.notFound()||f._startboard.save();throw t;}))},n.prototype._migrateStartboard=function(){var n=this,t=this._startboard.widget.options,i=l.NavBar.home;return this._helper.getStartboardReadyPromise().then((function(){return n._privateRepo.createDefaultDashboard(i)})).then((function(t){return n._setCurDashboard(null,!0),n._startboard.save(),n._saveDashboard(t).then((function(){return t}))})).then((function(i){t.headerMode(1);n._setCurDashboard(i,!0);n._startboard.save();n._isMigrated=!0})).catch((function(n){throw lt(3,n);}))},n.prototype._initDashboard=function(n,t){var i=this,r=this._startboard.widget.options;return r.headerMode(1),this._loadDashboard(n,!0,!1,t,!0).then((function(){i._startboard.logChildren()}))},n.prototype._shareCurrentDashboard=function(n,t,i){var r=this._getRepositoryByType(n);return this._collectDashboardSettings(!0,!0).then((function(n){return r.createDashboard({title:t,settings:n,extras:i})}))},n.prototype._handleError=function(n,t){var o=this,e=this._startboard.widget.options,r=this._helper,u=yt.Notification.errorTitle,i=yt.Error,f=function(n,i){ct.error(n,n.code,t+": "+i)},s=function(n){var u=n.data,i=u.dashboardId,f=u.dashboardTitle;ct.warning(n,n.code,t+": Failed to find dashboard '"+i);var r=o._findOwningRepo(i),s={id:i,title:f},h=r&&r.getNotFoundMessage?r.getNotFoundMessage(s):yt.NotFound.defaultMessageFormat.format(f);e.notFoundMessage(h)},h=function(){r.popNotification(u,i.cannotDelete)},c=function(n){f(n,"Failed to migrate startboard.");e.headerMode(2)},l=function(n){var t=n.data;f(n,"Failed to delete dashboard '"+t.dashboardId+"'");r.popNotification(u,i.failToDeleteFormat.format(t.dashboardTitle,n.message))},a=function(n){var t=n.data;f(n,"Failed to save dashboard '"+t.dashboardId+"'.");r.popNotification(u,i.failToSaveFormat.format(t.dashboardTitle))},v=function(n){var f=n.data.action,t="";switch(f){case oi:t=i.cannotCreate;break;case si:t=i.cannotClone;break;case hi:t=i.cannotUnpublish}r.popNotification(u,t)},y=function(n){var t=n.data,e=t.dashboardId,o=t.dashboardTitle,s=t.resourceGroupName,h=t.subscriptionId;f(n,"Failed to publish dashboard '"+e+"'");r.popNotification(u,i.failToPublishFormat.format(o,s,h,n.message))},p=function(){ct.error(n,0,t);r.popNotification(u,i.unknown)};if(n instanceof gt)switch(n.code){case 1:s(n);break;case 2:h();break;case 3:c(n);break;case 4:l(n);break;case 5:a(n);break;case 6:v(n);break;case 7:y(n)}else p()},n})();t.DashboardManagerImpl=fi}));
define("MsPortalImpl/UI/UI.DesktopManagerView",["require","exports","f","i","o","ko","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/Base/Telemetry","MsPortalImpl/UI/UI.ContextPane","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";function v(n,t){h.isTraceEnabled&&p.verbose("[DesktopManager] {0}\n  {1}\n  Model: {2}.".format(n,t.toString(),f.toJSON(t.getInputsOnlyViewModel())))}function w(n,t){return new l(n,t.get(s.RightContextPane))}var l;u.defineProperty(t,"__esModule",{value:!0});var a=i.Base.Diagnostics,y=window,p=a.createLog(n);t.showConfirmDialog=function(n){return y.confirm(n)};l=(function(){function n(n,t){var i=this;this._portalWidget=n;this._panoramaWidget=n.getPanorama();this._contextPane=t;this._portalWidget.element.on(c.default.fxautosettings,(function(n,t){i._autoOpenedBy=t}))}return u.defineProperty(n.prototype,"portalWidget",{get:function(){return this._portalWidget},enumerable:!0,configurable:!0}),n.prototype.composeJourney=function(n){n&&n.compose(this._panoramaWidget)},n.prototype.composeStartBoard=function(n){n&&n.compose(this._panoramaWidget)},n.prototype.addPartToStartBoard=function(n){n.compose(this._panoramaWidget.getStartBoardWidget())},n.prototype.addBlade=function(n,t){var u,f,e;return(v("Adding blade to desktop.",n),u=n.parent.blades,f=n.services.desktop.getActiveJourney(),a.Telemetry.trace({action:"JourneyLength",source:o.Source.Desktop,data:{count:u.length,blades:u.map((function(n){var t=n.locator;return{bladeName:t.name,extension:r.Extension.getWindowId(t.getExtensionLocator())}}))},journeyId:f&&f.id}),n.flags&1)?this._contextPane.tryOpen(n).then(i.noop):(this._autoOpenedBy&&(e=n.masterContainer,e&&e.instanceId===this._autoOpenedBy.masterBladeId&&(t||(t={}),t.autoOpenedByBlade=this._autoOpenedBy.masterBladeId,t.autoOpenedByPart=this._autoOpenedBy.masterPartId),this._autoOpenedBy=null),n.compose(this._panoramaWidget.getJourneyWidget(),t),Q())},n.prototype.removeBlade=function(n){v("Removing blade from desktop.",n);var t=this._contextPane;t.hasContent(n)?t.close(!0):this._panoramaWidget.removeChild(n.id)},n.prototype.removeAllBlades=function(n){var t=this._panoramaWidget.getJourneyWidget();t&&t.removeChildren(n);var i=this._contextPane,r=i.getContent(),u=r&&r.locator;u&&u.type===e.LocatorType.Blade&&i.close(!0)},n.prototype.showConfirmDialog=function(n){return!!t.showConfirmDialog(n)},n})();t.DesktopManagerViewImpl=l;t.create=w}));
define("MsPortalImpl/UI/UI.DesktopManagerImpl",["require","exports","f","i","o","ko","$","MsPortalImpl/Base/Base.Events","MsPortalImpl/Base/Base.Router","MsPortalImpl/Extension/DefinitionPreprocessor","MsPortalImpl/Extension/Extension.Definition.Locator","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Services/Services.AssetManagement","MsPortalImpl/Services/Services.Settings.Schema","MsPortalImpl/Services/Services.EditScopeManagement","MsPortalImpl/Base/Telemetry","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Compositions/UI.Composition.Base","MsPortalImpl/UI/Compositions/UI.Composition.Part","MsPortalImpl/UI/Compositions/UI.Composition.StartBoard","MsPortalImpl/UI/Compositions/UI.Composition.StartboardPart","MsPortalImpl/UI/Dashboard/DashboardManager","MsPortalImpl/UI/UI.DesktopManager","MsPortalImpl/UI/UI.DesktopManagerView","MsPortalImpl/Extension/ViewModelManager","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut){"use strict";function ii(n,t,i,r,u){return ht.startTrace({source:n,action:t,name:i,assetType:r,journeyId:u})}function ri(){return at("MsPortalImpl/UI/UI.Desktop.Actions")}function gi(n,t){return new fi(it.create(n,t.diContainer),t)}function nr(n,t){var r={},u=hi[hi.StartboardPart],f=i.forEachKey(n,(function(n,t,i){var f=d.isStartboardPartKey(n),e=ti(n,u+"-"+bt)||ti(n,u+"-"+kt);!f||e?r[n]=t:i.push(n)}),[]);return f.length&&t.deleteSettings({store:ni,keys:f}),r}function tr(n){var t=n[v.startBoardSettingsKey]||{},i=t.dashboardId;return!i?null:{id:i,title:t.dashboardTitle||l.NavBar.home}}function wi(n,t){if(!t)return n;if(n){var i=t.toLowerCase(),r=(n.id||"").toLowerCase()===i;return r?n:{id:i,title:i}}return null}function ui(n,t,i){n.removeChild(t,!1,!i&&!t.dontSetupWidget)}function bi(n){return n&&n.locator&&n.locator.toFriendlyString()}function ir(t){var u=r.ViewModels.Part.composePartViewModel,f=rt.registerWithState,e=n.normalize("./UI.BladeLauncher"),i;f("Shell$BladeLauncherViewModel",e,(function(n,t){return u((function(i){return new n.BladeLauncher(i,t)}),{initialState:t,createSelectable:!0,logArea:e})}));i=n.normalize("./UI.AssetBladeLauncher");f("Shell$AssetBladeLauncherViewModel",i,(function(n,r){return u((function(i){return new n.AssetBladeLauncher(i,r,t)}),{initialState:r,createSelectable:!0,logArea:i})}))}function rr(n,t,i,r){var u,f="Unable to replace part '"+(n&&n.toString())+"', ";return n&&t?n.isDisposed()?u=f+"it has already been disposed.":n.getPartsContainer()?n.widget&&n.parent&&n.parent.widget||(u=f+"the part or its parent have not been composed."):u=f+"it is not a child of a PartsContainerComposition.":u="Replace part requires a part and a new locator.",u&&r&&r(u),!!u==!1}var fi;u.defineProperty(t,"__esModule",{value:!0});var ki=c.Locator,lt=c.LocatorType,ei=r.Extension,oi=i.Base,wt=oi.Constants.ExtensionNames.Hubs,si=oi.Diagnostics,ht=si.Telemetry,di=i.Parts,hi=w.CompositionType,ot=tt.DesktopManagerEvents,st=i.Helpers.Deferred,ci=i.deepEquals,li=i.getUniqueId,ct=i.tryImmediateResolve,bt="AssetBladeLauncher",kt="BladeLauncher",ai=window,at=i.require,ft=si.createLog(n),vt=p.Source.Desktop,yt=p.Action,pt=l.Desktop,et={noActiveJourney:"Desktop has no active journey.",noBladeInJourney:"Blade '{0}' does not exist in the current journey.",noTileInDesktop:"Tile with id '{0}' was not found on the desktop."},dt=v.desktopSettingsKey,gt=8,ni=4,ti=i.startsWith,vi=ki.forExtension,yi=ot.journeyCreated,pi="./Compositions/UI.Composition.Blade";t.organizeModeModules={dragDrop:"MsPortalImpl/UI/UI.DragDropCompositionManager"};t.createDesktopManager=gi;t.resolveInitialDashboard=wi;fi=(function(){function v(n,t){this._previousActiveJourney="";this._startboardPartsLoadedDeferred=Q.defer();this._loadedStartBoardPartIds={};this._mode=f.observable(0);this._lifetime=new r.TriggerableLifetimeManager;this._dashboardMgrDeferred=Q.defer();this.activeJourney=f.observable(null);this.commandsEnabled=f.observable(!0);this._loadingJourneyGuid=null;this._view=n;this._services=t;this._initDeferred=st();this._sharedSettings=t.settings;this._portalServices=t;ir(this._services.assetTypeService)}return v.prototype.startBoardPartsLoaded=function(){return Q.isFulfilled(this.getStartboardPartsLoadedPromise())},v.prototype.getStartboardPartsLoadedPromise=function(){return this._startboardPartsLoadedDeferred.promise},u.defineProperty(v.prototype,"mode",{get:function(){return this._mode},enumerable:!0,configurable:!0}),u.defineProperty(v.prototype,"isJourneyLoading",{get:function(){return this._loadingJourneyGuid!==null},enumerable:!0,configurable:!0}),v.prototype.initialize=function(n,r,u){var f=this;this._setupOrganizeModeComponents(t.organizeModeModules);this._extensionsMetadata=n;this._services.diContainer.get(a.AssetManager).onAssetDeleted((function(n,t,i,r){ri().then((function(u){return u.handleAssetDeleted(f,n,t,i,r)}))}));var h=nt.startTrace("DashboardRevealed"),o=s.getDashboardIdFromUri(),e=this._dashboardMgr=nt.create({services:this._services,lifetime:this._lifetime});return r.then((function(n){u.startboardSettingsLoaded=ai.fx.getTimestamp();var t,r=n&&n[ni]||{},s=tr(r);return(u.dayZero=!r[dt])?(f._startBoard=d.create(f._createCompositionServices()),f._view.composeStartBoard(f._startBoard),i.isFeatureEnabled("noday0parts")?f._startboardPartsLoadedDeferred.resolve():f._populateStartBoardFromManifests().then((function(){f._startboardPartsLoadedDeferred.resolve()})),f._initDeferred.resolve()):(t=wi(s,o),f.load(n&&n[gt]||{},r,t&&t.id)),e.initDashboardIdFromStore=s?s.id:"",e.initialize(f._startBoard,t,o,h,u).finally((function(){u.dashboardManagerInitialized=ai.fx.getTimestamp();f._dashboardMgrDeferred.resolve(e);f._initDeferred.resolve()}))})),Q(this._initDeferred.promise())},v.prototype.resetStartBoard=function(n){var t=this,i;return i=n?Q(6):this._services.getService("DialogManager").then((function(n){return n.showModalDialog({title:l.Startboard.resetConfirmationTitle,description:l.Startboard.resetConfirmationText,buttons:4})})),i.then((function(n){var r,i;if(n===6){for(r=t.startBoard.children,i=r.length-1;i>=0;i--)t.removeTile(r[i].id,{force:!0});return t._populateStartBoardFromManifests()}}))},v.prototype._populateStartBoardFromManifests=function(){var n=this;return this._dashboardMgr.resetLayout(this._startBoard).then((function(){n.save();var t=n._services.extensionManager.getExtensions().map((function(t){var r=n._extensionsMetadata.first((function(n){return ei.isEqualDescriptor(n,t)})),i=r.startBoardParts;if(r.isTestExtension||i&&i.length)return t.getManifestAsync().then((function(t){n._addStartBoardPartsFromManifest(t,i);n.save()}))})).filter((function(n){return!!n}));return Q.allSettled(t)}))},v.prototype._getExtensionEmailAddress=function(n){var t=this._extensionsMetadata.first((function(t){return t.name===n}));return t&&t.feedbackEmail},v.prototype.getCurrentBladeInfo=function(){var t=this._getBreadCrumb(),r=this._getExtensionEmailAddress(wt),n=t[t.length-1],i=n&&n.extensionName||"",u=i?this._getExtensionEmailAddress(i):r;return{extensionName:i,feedbackTo:u,feedbackCC:r,breadcrumb:t.map((function(n){return n.title})).join(" > "),bladeName:n&&n.name||""}},v.prototype._getBreadCrumb=function(){var t=this.getActiveJourney(),n;return t?(n=t.children,!n||!n.length)?[]:n.map((function(n){return{title:n.isDefaultTitle()?n.id:n.title(),extensionName:n.locator.getExtensionLocator().name,name:"Extension/"+n.locator.getExtensionLocator().name+"/Blade/"+n.locator.name}})):[]},v.prototype.createJourney=function(t,i,r){var u=this,s=this._startBoard.children.first((function(n){return n.id===t})),o;return s?(o=st(),r||(r=li(),this._loadingJourneyGuid=r,this._createNewJourneyPromise=o.promise()),o.promise().finally((function(){u._loadingJourneyGuid===r&&(u._loadingJourneyGuid=null,u._createNewJourneyPromise=null)})),ct(Q(s.awaitComposed()),(function(){if(u.tryDeactivateJourney(r)){e(u).trigger(ot.journeyCreating,i);var t=u._createCompositionServices();ct(at("./Compositions/UI.Composition.Journey",n),(function(r){var f=r.create(t,s),h=ii(vt,yt.JourneyOpened,bi(s),undefined,f.id);return u.setActiveJourney(f),ct(at(pi,n),(function(n){var r=n.create(t,i,u._startBoard),f=u._activeJourney;f.addChild(r);u._view.composeJourney(f);u._startBoard.detailContainers=[r];u._view.addBlade(r,{assetType:i.originAssetType,focus:!0}).catch((function(n){ft.error(n)}));u._triggerActiveJourneyChanged();u.save();o.resolve(f);e(u).trigger(yi);ht.completeTrace(h);Q.nextTick((function(){u.save()}))}))})).catch((function(n){o.reject(n)}))}else o.reject("tryDeactivateJourney returned false")})),o.promise()):(ft.error(et.noTileInDesktop.format(t)),ft.verbose(f.toJSON(this.getDiagnosticsData(),null,2)),st().reject())},v.prototype.createJourneyForBlade=function(n,t){return this._createJourneyWithHiddenPart(wt,kt,n,t,kt,n.defaultMenuItemId)},v.prototype.createJourneyForAsset=function(n,t,i){return this._createJourneyWithHiddenPart(wt,bt,{extensionName:n.extension,assetType:n.assetType,assetId:i},t,bt,n.defaultMenuItemId,n.assetType)},v.prototype._createJourneyWithHiddenPart=function(n,t,r,u,f,o,s){var h=this;if(this._loadingJourneyGuid!==u)return Q();var a=ii(vt,yt.JourneyOpened,f,s),v=vi(n).withPartType(t),c=this.addPartToStartBoard({originPartLocator:v,model:r,defaultMenuItemId:o,dontSetupWidget:!0}),l;return l=c.isComposed&&c.isSelected()&&this._activeJourney&&this._activeJourney.originTile===c?Q():c.selectOnReady((function(){return h._loadingJourneyGuid!==u?!1:!c.isSelected()&&h.tryDeactivateJourney(u)}),{timeoutInMilliseconds:9e4}).then((function(n){n&&(h.save(),e(h).trigger(yi),ht.completeTrace(a))})),i.tryImmediateFinally(l,(function(){h._loadingJourneyGuid===u&&(h._loadingJourneyGuid=null)}))},v.prototype.openSingleBlade=function(n,t){return this._openBlade(n,t,(function(n,i){return i===0&&n.locator.equals(t.locator)}))},v.prototype.openMultipleBlades=function(n,t){var u=this,i=st(),r;return t&&t.length!==0?(r=t.map((function(t){return u._openBlade(n,t,(function(n){return n.locator.equals(t.locator)&&t.model&&n.getViewModel()&&w.deepSubset(n.getViewModel(),t.model)}))})),e.when.apply(e,r).done((function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];i.resolve(t)})).fail((function(){i.reject()}))):i.resolve([]),i.promise()},v.prototype.confirmBladesCanClose=function(n){var t=this,f=(n||[]).first((function(n){return!t.canCloseBlade(n)})),r,u;return f?(r=[],n.forEach((function(n){r.push(t._findFirstItem(t.activeJourney().children,n,et.noBladeInJourney.format(n)))})),u=[],i.pushUnique(u,i.mapMany(r,(function(n){return t._getAlertMessageRecursive(n)}))),this._view.showConfirmDialog(u.join("\n")||pt.confirmEditScopeDiscard)):!0},v.prototype.forceCloseBlade=function(n,t,i){var u,r,f,e;if(!this._activeJourney)throw new Error(et.noActiveJourney);u=this._findFirstItemIndex(this._activeJourney.children,n,et.noBladeInJourney.format(n));r=this._activeJourney.children[u];this._startBoard.detailContainers.length===1&&this._startBoard.detailContainers[0].id===r.id?this.forceDiscardJourney(this._activeJourney.id,t):(r.masterContainer&&(f=r.masterContainer.detailContainers,e=f.indexOf(r),e>=0&&(f.splice(e,1),i&&i.openBlade||r.masterContainer.onDetailContainersChanged())),this._closeBladeRecursive(r,u,t));this._triggerActiveJourneyChanged();this.save()},v.prototype.tryCloseBlade=function(n,t){if(this._activeJourney&&i.findIndex(this._activeJourney.children,(function(t){return t.id===n}))>=0){var r=this.confirmBladesCanClose([n]);return r&&this.forceCloseBlade(n,t),r}return!0},v.prototype.closeChildBlades=function(n){var i=this.discardEditsOfBlade(n,{includeSelf:!1,includeDescendants:!0}),t;if(i.successful)for(t=n.detailContainers.length-1;t>=0;t--)this.forceCloseBlade(n.detailContainers[t].id,1);return i},v.prototype.discardEditsOfPart=function(n,t){var r=n.getPartsContainer();return this._discardEditsOfContainer(r,t.force,(function(u){var s=u.path,e=r.journeyPath,h=ci(s,n.journeyPath),c=!1,f,o;if(!h&&s.length>e.length){f=void 0;try{f=i.parseSortedString(u.path[e.length])}catch(l){ft.error("Failed to parse journey path segment for blade '{0)'. Path: '{1}'. Error: '{2}'.".format(r.toString(),JSON.stringify(e),l.message))}c=f&&f.master&&f.master.part===n.id}return o=u.value,o&&o.editScope&&(t.includeSelf&&h||t.includeDescendants&&c)}))},v.prototype.discardEditsOfBlade=function(n,t){return this._discardEditsOfContainer(n,t.force,(function(i){var r=i.value,u=i.path,f=n.journeyPath,e=ci(u,f),o=!e&&(r.type===lt.Blade||u.length>=f.length+2);return r&&r.editScope&&(t.includeSelf&&e||t.includeDescendants&&o)}))},v.prototype._discardEditsOfContainer=function(n,t,i){var o=this,u=[],r={confirmationRequired:!1,successful:!1},e=this._activeJourney,f;if(!e)throw new Error(et.noActiveJourney);return f=e.ambientSettings,(n instanceof d.Instance||n.isInitialized)&&(u=f.getItemsInPath(n.journeyPath).filter(i)),r.confirmationRequired=!t&&u.filter((function(n){var t=n.value.editScope;return t.dirty&&!t.saving})).length>0,(!r.confirmationRequired||this._view.showConfirmDialog(pt.confirmEditScopeDiscard))&&(r.successful=!0,u.forEach((function(n){f.removeItem(n.path);o._services.diContainer.get(y.EditScopeManager).onEditScopeDisposed(n.value.editScope.editScopeId)}))),r},v.prototype.canCloseBlade=function(n){var t=this._activeJourney,r,i;return t?(r=this._findFirstItem(t.children,n,et.noBladeInJourney.format(n)),i=function(n){if(!f.unwrap(n.editScopeId)&&n.shouldAlertOnClose()||n.isInitialized&&!n.children.some((function(n){return n.children.some((function(n){return n.suppressAlert()}))}))&&t.ambientSettings.getItemsInPath(n.journeyPath).some((function(n){var i=n.value,t=i&&i.editScope;return t&&t.dirty&&!t.saving})))return!0;var r=n.detailContainers;return!r||r.length===0?!1:(r||[]).some((function(n){return i(n)}))},!i(r)):!0},v.prototype.addPartToStartBoard=function(n){var i,r;if(!n){ft.error("options should be specified for adding a part to the startboard.");return}if(!n.originPartLocator){ft.error("options.originPartLocator should be specified for adding a part to the startboard.");return}var u=this._createCompositionServices(),f=n.model,t=g.create(u,n.originPartLocator,f,{modelContainsSensitiveData:n.modelContainsSensitiveData,filters:n.filters});return t.dontSetupWidget=!!n.dontSetupWidget,i=n.defaultMenuItemId,i&&(t.defaultMenuItemId=i),di.InternalPartSize[n.initialSize]&&(t.initialSize=n.initialSize,n.initialSize===99&&(t.initialHeight=n.initialHeight,t.initialWidth=n.initialWidth)),r=t.id,this._isStartBoardPartLoaded(r)||(this._isStartBoardPartLoaded(r,!0),this._startBoard.addChild(t,undefined,!t.dontSetupWidget),this._view.addPartToStartBoard(t),t.save(),this.save()),t},v.prototype.pinMultipleParts=function(n,t,i){var r=this,u=this._createCompositionServices();return ri().then((function(f){return f.pinMultipleParts(r,u.finder,n,t,i)}))},v.prototype.removeTile=function(n,t){var e=this._startBoard,i=e.children.first((function(t){return t.id===n})),r,u;if(i){r=void 0;u=this._activeJourney;u&&u.originTile===i&&(r=u.id);var f=i.editScopeId()&&this._services.diContainer.get(y.EditScopeManager).getStateObservable(i.editScopeId()),s=!f||f()===0||f()===2,h=!r||this._canDiscardJourney(r),o=t&&t.force||s&&h;(o||this._view.showConfirmDialog(pt.confirmEditScopeDiscard))&&(r&&this.forceDiscardJourney(r),i.clearIdentitySettings(),ui(e,i,t&&t.skipSave),o||i.dontSetupWidget||ft.warning("Part '{0}' is removed from the start board.".format(i)),this.save())}},v.prototype.replacePart=function(n,t,i){var o=this,f=n&&n.id,r,s=this._createCompositionServices(),u=st(),h=!0,c,l,e;return i=i||{},rr(n,t,i.newPartContainerModel,(function(n){l=n}))?(n instanceof g.Instance?(r=g.create(s,t,i.newPartContainerModel,{id:f,doNotSaveSettings:i.doNotSaveSettings,overridesModel:i.newPartOverridesModel,filters:n.filters}),e=n,r.dontSetupWidget=e.dontSetupWidget,h=!e.dontSetupWidget):r=k.create(s,t,f,i.newPartContainerModel,i.newPartOverridesModel),r.previousLocator=n.previousLocator||n.locator,r.flags|=4,c=n.getPartsContainer(),n.dispose(!0),n.parent.replaceChild(n,r),r instanceof g.Instance&&this._activeJourney&&this._activeJourney.originTile===n?this.tryDiscardJourney(this._activeJourney.id):c.getPartsContainer().detailContainers.slice(0).reverse().forEach((function(n){n.masterPartId===f&&o.tryCloseBlade(n.id,1)})),r.widgetState(n.widgetState()),r.save(),h?(r.widget=n.widget,r.recompose(n.parent.widget)):r.compose(n.parent.widget),r.widget.element.trigger(w.fxreplacedpartcomposing,{part:r}),r.awaitComposed().then((function(){!i.preventNewPartActivation&&r.partDefinition.details&&r.partDefinition.details.length>0?r.selectOnReady((function(){return!o._activeJourney}),{timeoutInMilliseconds:15e3}).then((function(){u.resolve(r)})).catch((function(n){u.reject(n&&n.message||"part.selectOnReady failed")})):u.resolve(r)}),(function(){return u.reject("Unable to compose the mutated part.")}))):u.reject(l),u.promise()},u.defineProperty(v.prototype,"portalWidget",{get:function(){return this._view.portalWidget},enumerable:!0,configurable:!0}),v.prototype.getDashboardManager=function(){return this._dashboardMgrDeferred.promise},v.prototype.getSettingCollections=function(){var i={},r={},n=this._activeJourney,t=[];return i[dt]=JSON.parse(JSON.stringify(this)),t.push({store:ni,settings:i}),n&&n.children&&(r[n.id]=JSON.parse(JSON.stringify(n)),t.push({store:gt,settings:r})),t},v.prototype.dispose=function(){this._lifetime&&(this._lifetime.dispose(),this._lifetime=null)},v.prototype.save=function(){var n=this;this._initDeferred.promise().finally((function(){n.getSettingCollections().forEach((function(t){n._services.settings.setSettings(t)}))}))},v.prototype.load=function(n,t,i){var r=this,o=this._createCompositionServices(),u=t[dt],f=!1,s,h;u&&u.startBoardId&&t[u.startBoardId]?(s=t[u.startBoardId],f=!!i,f&&(t=nr(t,this._sharedSettings)),this._startBoard=d.Instance.fromJSON(o,t,s)):(ft.error("Unable to load StartBoard state from user settings, setting does not exist. Creating a default StartBoard."),this._startBoard=d.create(o));this._removeOrphanedStartboardParts();this._view.composeStartBoard(this._startBoard);f||this._initDeferred.resolve();h=this._view.portalWidget.element;h.one(ut.default.fxshowstartboard,(function(){var n=r._startBoard.children.slice();n.forEach((function(n){r._displayPartOnStartBoardIfAvailable(n)}));r._startBoard.discardWidgetStateOfUnusedChildren();r._startboardPartsLoadedDeferred.resolve()}));e(this).trigger(ot.settingsLoaded)},v.prototype._removeOrphanedStartboardParts=function(){var n=this.startBoard;n.children.slice(0).forEach((function(t){t.dontSetupWidget&&ui(n,t)}))},u.defineProperty(v.prototype,"startBoard",{get:function(){return this._startBoard},enumerable:!0,configurable:!0}),v.prototype.getActiveJourney=function(){return this._activeJourney},v.prototype.setActiveJourney=function(n){this.activeJourney(n);this._activeJourney=n;this.portalWidget.hasActiveJourney=!!n;n&&o.isFullscreen()&&o.exitFullscreen()},v.prototype.generateLoadingJourneyGuid=function(){return this._loadingJourneyGuid=li(),this._loadingJourneyGuid},v.prototype.tryDeactivateJourney=function(n){var t=this._activeJourney,r,i,u;if(t){if(!this.confirmBladesCanClose(t.children.map((function(n){return n.id}))))return!1;for(r=t.children.filter((function(n){return!n.isRestorable()})),i=r.length-1;i>=0;i--)this.forceCloseBlade(r[i].id);u=ii(vt,yt.JourneyDeactivated,bi(t.originTile),undefined,t.id);t.save();this._closeActiveJourney(!0);this.save();e(this).trigger(ot.journeyDeactivated);ht.completeTrace(u)}else this._startBoard&&(this._startBoard.detailContainers=[]);return this._loadingJourneyGuid=n||null,!0},v.prototype.tryDiscardJourney=function(n){var t=!1;return(this._canDiscardJourney(n)||this._view.showConfirmDialog(pt.confirmEditScopeDiscard))&&(this.forceDiscardJourney(n),t=!0),t},v.prototype._triggerActiveJourneyChanged=function(){var n=this._activeJourney,t=n?JSON.stringify(n):"";this._previousActiveJourney!==t&&(e(this).trigger(ot.activeJourneyChanged),this._previousActiveJourney=t)},v.prototype._canDiscardJourney=function(n){var t=this._activeJourney&&this._activeJourney.id===n&&this._activeJourney,i=t&&t.ambientSettings.getObservable().peek().some((function(n){var i=n.value,t=i&&i.editScope;return t&&t.dirty&&!t.saving&&t.disposeOnJourneyDiscard}));return!t||!i},v.prototype.forceDiscardJourney=function(n,t){var i=!1;this._deleteJourneySettings(n);this._activeJourney&&this._activeJourney.id===n&&(this._closeActiveJourney(!1,t),i=!0);i&&(this._triggerActiveJourneyChanged(),this.save(),e(this).trigger(ot.journeyDiscarded))},v.prototype._deleteJourneySettings=function(n){this._sharedSettings.deleteSettings({store:gt,keys:[n]})},v.prototype.toJSON=function(){return{startBoardId:this._startBoard?this._startBoard.id:null}},v.prototype._addStartBoardPartsFromManifest=function(n,t){var r=this,i=n.startBoardParts;t||(t=i.map((function(n){return n.name})));i&&i.length&&t.forEach((function(t){var u=i.first((function(n){return n.name===t})),f;u&&(f=vi(n.name).withStartboardPartInstance(u.name),r.addPartToStartBoard({originPartLocator:f,initialSize:u.initialSize}))}))},v.prototype._createCompositionServices=function(n){return n?i.extend2(this._services,{finder:n,desktop:this,sharedSettings:this._sharedSettings}):this._thisCompositionServices||(this._thisCompositionServices=i.extend2(this._services,{finder:new c.DefinitionFinderImpl(this._services.extensionManager),desktop:this,sharedSettings:this._sharedSettings}))},v.prototype._findPartContainer=function(n){var t,i=this._startBoard;if(i&&i.id===n)t=i;else if(this._activeJourney)t=this._findFirstItem(this._activeJourney.children,n,et.noBladeInJourney.format(n));else throw new Error(et.noActiveJourney);return t},v.prototype._openBlade=function(t,i,r){var s=this,o=this._findPartContainer(t),v=o instanceof d.Instance,h=st(),u,c,y=this._createCompositionServices(),l,a;return o?((o.detailContainers||[]).forEach((function(n,t){n.locator.equals(i.locator)&&n.masterPartId===i.masterPartId&&n.masterInvocationProperty===i.masterInvocationProperty&&r(n,t)&&(u=n,h.resolve(u))})),u?(a=u.containerWidget,a&&a.setFocus(),tt.isTraceEnabled&&ft.verbose("[DesktopManager] Found a previously opened detail blade."+"\n  Existing blade: {0}. Model: {1}.".format(u.toString(),f.toJSON(u.getInputsOnlyViewModel()))+"\n  Requested Descriptor: {0}.".format(f.toJSON(i)))):(e(this).trigger(ot.bladeOpening,{masterContainerId:t,bladeDescriptor:i}),l=function(){v&&o.detailContainers.length===0?s.createJourney(i.masterPartId,i).finally((function(n){n&&n.children&&n.children.length>0?h.resolve(n.children[0]):h.reject()})):ct(at(pi,n),(function(n){return ct(Q(),(function(){u=n.create(y,i,o);o.detailContainers.unshift(u);o.onDetailContainersChanged();c=v?0:1+s._findFirstItemIndex(s._activeJourney.children,o.id,et.noBladeInJourney.format(o.id));s._activeJourney.addChild(u,c);s._view.addBlade(u,{assetType:i.originAssetType,index:c,focus:!0}).catch((function(n){ft.error(n)}));s._triggerActiveJourneyChanged();s.save();h.resolve(u)}))})).catch((function(n){h.reject(n)}))},this._createNewJourneyPromise?this._createNewJourneyPromise.always((function(){l()})):l())):h.reject(),h.promise()},v.prototype._closeBladeRecursive=function(n,t,i,r){this._removeBladesFromUIRecursive(n);this._disposeBladesRecursive(n,t,r);r||(n.parent.save(),e(this).trigger(ot.bladeClosed,{id:n.id,reason:i,masterPartId:n.masterPartId}))},v.prototype._getAlertMessageRecursive=function(n){var t=function(n){var t=n.detailContainers,r;return t&&t.length!==0?(r=i.mapMany(t,(function(n){return n.getAlertOnCloseMessages()})),i.union(n.getAlertOnCloseMessages(),r)):n.getAlertOnCloseMessages()};return t(n)},v.prototype._removeBladesFromUIRecursive=function(n){for(var i=n.detailContainers,t=i.length-1;t>=0;t--)this._removeBladesFromUIRecursive(i[t]);this._view.removeBlade(n)},v.prototype._disposeBladesRecursive=function(n,t,i){var u=this,r=n.parent.children.indexOf(n,t);i?n.dispose(!0):n.parent.removeChildAt(r,undefined);n.detailContainers.forEach((function(n){u._disposeBladesRecursive(n,r,i)}))},v.prototype._closeActiveJourney=function(n,t){var u=this,i=this._activeJourney,r;this.setActiveJourney(null);this._startBoard.detailContainers=[];i&&(i.children.slice(0).forEach((function(i){i.isDisposed()||u._closeBladeRecursive(i,0,t,n)})),r=i.originTile,r&&r.dontSetupWidget&&!n&&this.removeTile(r.id),i.dispose(n));this._view.removeAllBlades((function(n){ft.error("DesktopManager: Found un-tracked blade '{0}' in view after closing active journey. It will be forcefully removed.".format(n))}))},v.prototype._findFirstItem=function(n,t,i){var r=this._findFirstItemIndex(n,t,i);return n[r]},v.prototype._findFirstItemIndex=function(n,t,i){var r=n.firstIndex((function(n){return n.id===t}));if(r===-1){ft.verbose(f.toJSON(this.getDiagnosticsData(),null,2));throw new Error(i);}return r},v.prototype.pinPartComposition=function(n){this._startBoard.addChild(n);this._view.addPartToStartBoard(n);ht.trace({source:vt,action:yt.DashboardPinPart,name:n.locator.toFriendlyString(),data:n.id});n.save();this.save()},v.prototype._isStartBoardPartLoaded=function(n,t){return typeof t=="boolean"?this._loadedStartBoardPartIds[n]=t:!!this._loadedStartBoardPartIds[n]},v.prototype._displayPartOnStartBoardIfAvailable=function(n){var i=this;if(!this._isStartBoardPartLoaded(n.id)){this._isStartBoardPartLoaded(n.id,!0);var t=n.locator,r=t.getExtensionLocator(),u=function(t,r){if(ft.warning(t.format(n)),r){var u=i._startBoard;ui(u,n);u.removeChildWidget(n.id)}},f=function(t,r){var f=!1;return t===0?(r||i._view.addPartToStartBoard(n),f=!0):t===1&&(u("[Definition Change] Part '{0}' is not working because it no longer exists in pre-loaded extension definition"),f=!0),f},e=function(r,f){(r.startBoardParts||[]).some((function(n){return n.name===t.name}))?f||i._view.addPartToStartBoard(n):u("[Definition Change] Part '{0}' is not working because it no longer exists in force-loaded extension definition.")};this._extensionsMetadata.some((function(n){return ei.isEqualDescriptor(n,r)}))?f(n.definitionExists(),n.isComposed||n.dontSetupWidget)||(this._view.addPartToStartBoard(n),t.type===lt.StartboardPartInstance?this._services.extensionManager.getManifestByName(r.name).then((function(n){e(n,!0)})):this._services.extensionManager.getExtensionByName(r.name).then((function(n){var r=h.PinPrefix,u=t.name,f,i;if(ti(u,r))return f=u.substr(r.length),n.getBladeDefinition(f);for(i=t;i;i=i.parent)if(i.type===lt.Blade)return n.getBladeDefinition(i.name);if(t.type===lt.PartType)return n.getPartDefinition(t.name)})).then((function(){f(n.definitionExists(!0),!0)}))):u("[Definition Change] Part '{0}' will be removed because the extension it belongs to is no longer known by the portal.",!0)}},v.prototype.getDiagnosticsData=function(){var n=this._startBoard,t=this._activeJourney;return{startboard:n&&n.getDiagnosticsData(),activeJourney:t&&t.getDiagnosticsData()}},v.prototype.getAssetDiagnosticsData=function(){var n=this._activeJourney;return n?ri().then((function(t){return t.dumpCompositionAssets(n)})):Q.resolve("No journey")},v.prototype._setupOrganizeModeComponents=function(n){var t=this,r=this._lifetime,u=r.createChildLifetime();this.mode.subscribe(u,(function(f){f===1&&i.require(n.dragDrop).then((function(n){n.create(r,t,t.portalWidget.element);u.dispose()}))}))},v})();t.DesktopManagerImpl=fi}));
define("MsPortalImpl/Interactions/Interactions.FlowLayoutDragDrop",["require","exports","f","o","MsPortalImpl/Base/Base.Events","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.FlowLayout","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u,f,e,o,s){"use strict";function at(n){var i=n.target,t=$(i);if(!h||h.htmlTarget===i){if(h={htmlTarget:i,elementObject:t,width:t.outerWidth(!1),height:t.outerHeight(!1)},k.top=-n.offsetY,k.left=-n.offsetX,c=ut(t.closest(a),o.Widget),!c){n.preventDefault();rt(n);return}t.css("opacity",.75);g=l=it({left:n.pageX,top:n.pageY});f.register(ot,!0)}}function nt(n){if(h){y.off(a);var t=h.elementObject,i=t.attr("dragdrop.revert")==="true",r={left:n.pageX,top:n.pageY};f.unregister(ot);i&&t.attr("dragdrop.revert","false");tt();i&&yt();t.css("opacity",1);l=i?g:it(r);c.moveChild(h.elementObject,Math.max(l.col,0),Math.max(l.row,0),!0);ht()}}function st(){h.elementObject.attr("dragdrop.revert","true").trigger(s.default.mouseup)}function vt(n,t){if(c){var i=it(t);i.col===l.col&&i.row===l.row||(l=i)}tt();p=v.setTimeout((function(){p=null;c&&c.moveChild(h.elementObject,Math.max(l.col,0),Math.max(l.row,0),!1)}),50)}function tt(){p&&(v.clearTimeout(p),p=null)}function yt(){c&&(tt(),c.refreshLayout())}function it(n){var t=c.element,i=t.offset(),r={left:n.left+k.left,top:n.top+k.top},u=r.left-i.left+t.scrollLeft(),f=r.top-i.top+t.scrollTop(),e=Math.floor((u+.33*w.GridSpacingWidth)/w.GridSpacingWidth),o=Math.floor((f+.33*w.GridSpacingHeight)/w.GridSpacingHeight);return{col:e,row:o}}function ht(){c=null;g=null;l=null;h=null}function ct(){var t=$(a),n=[];return t.each((function(t,i){var r=ut($(i),o.Widget),u=r.options;u.allowReorder&&!u.locked()&&n.push(r.element.findByClassName("fxs-flowlayout-childcontainer"))})),n}function rt(n){st();nt(n)}var lt;r.defineProperty(t,"__esModule",{value:!0});var w=i.Widgets.AzureGrid,v=window,y=$(v.document.body),ut=e.Widget.getWidget,ft="ui-draggable",b="draggable",et=ft+" fxs-drag-disableTouchAction",d=".fxs-tile:not(.fxs-tilesize-herowidefitheight):not(.fxs-tilesize-fullwidthfitheight):not(.fxs-tilesize-fittocontainer)",a=".fxs-flowlayout",ot={dismissFn:st,logName:"flowlayoutdragdrop"},h,c,g,l,p,k={left:0,top:0};lt=(function(){function n(){if(n._singleton)throw new Error("FlowLayoutDragDrop operates as a singleton.");n._singleton=this}return n.prototype.dispose=function(){this.disableDragDropTargets();ht();n._singleton=null},r.defineProperty(n,"Instance",{get:function(){return n._singleton||(n._singleton=new n),n._singleton},enumerable:!0,configurable:!0}),n.prototype.enableDragDropOnSingleTarget=function(n){if(n.attr(b)!=="true"){n.attr(b,"true");var t=n.filter(d).addClass(et);t.on(s.default.dragstart,(function(n){var t,i;if(h&&rt(n),u.isFullscreen()||n.target!==n.currentTarget){n.preventDefault();return}t={left:n.pageX,top:n.pageY};y.on(s.default.dragover+a,(function(n){n.preventDefault();var i={left:n.pageX,top:n.pageY};(i.left!==t.left||i.top!==t.top)&&vt(n,t=i)}));y.on(s.default.drop+a,(function(n){n.preventDefault();nt(n)}));y.on(s.default.dragend+a,(function(n){nt(n)}));y.on(s.default.dragleave+a,(function(n){0<n.clientX&&n.clientX<v.innerWidth&&0<n.clientY&&n.clientY<v.innerHeight||rt(n)}));i=n.originalEvent.dataTransfer;i.setData("text","fxs-draganddrop");i.effectAllowed="move";at(n)}))}},n.prototype.enableDragDropTargets=function(){var n=this;ct().forEach((function(t){t.on(s.default.mouseenter,d,(function(t){var i=$(t.currentTarget);i.attr(b)!=="true"&&n.enableDragDropOnSingleTarget(i)}))}))},n.prototype.disableDragDropTargets=function(){ct().forEach((function(n){return n.off(s.default.mouseenter,d)}));$("."+ft).removeClass(et).off(s.default.dragstart).removeAttr(b)},n})();t.FlowLayoutDragDrop=lt}));
define("_generated/Less/MsPortalImpl/Widgets/OrganizeMode.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".fxs-desktop-organize .fxs-blade-content-container .fxs-bladestyle-context .fxs-tile div.fxs-tile-overlay,.fxs-desktop-organize .fxs-blade-content-container .fxs-bladestyle-contextaction .fxs-tile div.fxs-tile-overlay,.fxs-desktop-organize .fxs-blade-content-container .fxs-bladestyle-help .fxs-tile div.fxs-tile-overlay,.fxs-desktop-organize .fxs-tile:hover .fxs-tile-overlay{background-color:transparent}.fxs-desktop-organize .fxs-tile .fxs-tile-content{z-index:0}.fxs-desktop-organize .fxs-tile .fxs-tile-overlay{display:block;-ms-touch-action:none;touch-action:none}.fxs-desktop-normal .fxs-hide-in-normal,.fxs-desktop-normal .fxs-portal-contextpane-left,.fxs-desktop-organize .fxs-contextpane .fxs-tile .fxs-tile-overlay,.fxs-desktop-organize .fxs-sidebar,.fxs-desktop-organize .fxs-startboard-header .fxs-startboard-actions,.fxs-desktop-organize .fxs-startboard-header .fxs-startboard-dropdown,.fxs-desktop-organize .fxs-startboard-header .fxs-startboard-migration{display:none}.fxs-desktop-organize .fxs-tile.fxs-tilesize-custom .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-hero .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-herotall .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-herowide .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-large .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-mini .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-normal .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-small .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-tall .fxs-tile-overlay,.fxs-desktop-organize .fxs-tile.fxs-tilesize-wide .fxs-tile-overlay{cursor:move}.fxs-desktop-organize .fxs-hide-in-customize{visibility:hidden}.fxs-desktop-organize .fxs-startboard-layout>.fxs-flowlayout-childcontainer{min-height:2155px;min-width:3865px}.fxs-desktop-organize .fxc-hotspot-customclick{z-index:1}")}));
define("MsPortalImpl/UI/UI.DesktopModeManager",["require","exports","f","o","$","MsPortalImpl/Base/Base.Events","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Interactions/Interactions.FlowLayoutDragDrop","MsPortalImpl/UI/UI.ContextPane","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.Tile","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Resources/Resources.Images","_generated/Less/MsPortalImpl/Widgets/OrganizeMode.css"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a){"use strict";function rt(n,t,r){var o=n.desktop,e=new y(o,t,n,r),a=function(n){var t=u(n.target).closest(k);return h.Widget.getWidget(t,c.Widget)},v=t.element,s=t.getPanorama().getStartBoardArea();v.on(l.default.fxexitorganizemode,(function(){o.mode(0);var n=o.startBoard.widget.element.findByClassName("fxs-startboard-button-edit");n.length&&n.focus()}));s.on(l.default.fxenterorganizemode,(function(n,t){n.stopPropagation();var r=a(n);t=u.extend({},t);i.isNullOrUndefined(t.trigger)&&(t.trigger=r?0:1);e.startPartManagment(t);r&&(r.options.selected(!0),e.updateTileSelection(r),r.showTileManagementContextMenu())}));s.on(l.default.click,b,(function(n){var i=a(n),t=i&&i.options;t&&!t.locked()&&(t.selected(!t.selected()),e.updateTileSelection(i))}));s.on(l.default.click,d,(function(n){if(o.mode()===1){var i=a(n),t=i&&i.options;!t||t.locked()||t.selected()||(t.selected(!0),e.updateTileSelection(i))}}));s.on(l.default.dragstart,nt,(function(n){if(f.isFullscreen()){n.preventDefault();return}o.mode()!==1&&o.mode(1);var t=a(n),i=t&&t.options;i&&!i.selected()&&(i.selected(!0),e.updateTileSelection(t))}));s.on(l.default.fxpartcreated,(function(n,t){n.stopPropagation();var i=t.widget;i.options.selected(!0);e.updateTileSelection(i)}));return e}var y;r.defineProperty(t,"__esModule",{value:!0});var p=h.Widget.widgetRemoveEvent,b="."+c.overlayClassName,k="."+c.widgetClassName,d="."+c.actionBarContainerClassName,w="fxs-desktop-normal",g="fxs-partgallery-container",nt=".ui-draggable",v=i.isFeatureEnabled("newtilegallery"),tt=v?"MsPortalImpl/UI/UI.PartGalleryManager2":"MsPortalImpl/UI/UI.PartGalleryManager",it=v?"MsPortalImpl/Widgets/Widgets.PartGallery2":"MsPortalImpl/Widgets/Widgets.PartGallery";(function(){var t=a.getFlowLayout().gridShadow,i=".fxs-desktop-organize .fxs-flowlayout-childcontainer {"+("background: url("+t+");")+"}",n=document.createElement("style");n.setAttribute("type","text/css");n.appendChild(document.createTextNode(i));document.head.appendChild(n)})();t.organizeModeClassName="fxs-desktop-organize";t.createDesktopModeManager=rt;y=(function(){function n(n,t,i,r){var u=this;this._wasContextPaneCollapsed=!1;this._dismissHandle={dismissFn:function(){u._desktop.mode(0)},logName:"desktopmodemanager"};this._desktop=n;this._portalWidget=t;this._services=i;this._lifetime=r;this._userSettingsManager=i.settings;this._contextPane=i.diContainer.get(s.LeftContextPane);this._partMgmtStarted=!1;this._selectedTile=null;this._handleModeChange(n,r)}return r.defineProperty(n.prototype,"selectedTile",{get:function(){return this._selectedTile},enumerable:!0,configurable:!0}),n.prototype.updateTileSelection=function(n){var t=this;if(this._deselectCurrentTile(),n.options.selected()&&(this._selectedTile=n),this._selectedTile)this._selectedTile.element.on(p,this._tileRemoveHandler=function(n){n.target===t._selectedTile.element[0]&&t._deselectCurrentTile()})},n.prototype.startPartManagment=function(n){var t=this,r;return this._partMgmtStarted?Q():(this._partMgmtStarted=!0,this._desktop.mode(1),r=this._contextPane,r.tryOpen(this).then((function(){return Q.spread([t._partGalleryWidget,i.require(tt)],(function(i,u){t._partGalleryManager||(t._partGalleryManager=u.create(t._lifetime.createChildLifetime(),t._services.diContainer,i),v||t._partGalleryManager.load(5,n));i.setFocus();n.expandTileGallery&&r.collapsed(!1)}))})))},n.prototype.onAddingContent=function(n){var t=this;return i.require(it).then((function(i){t._partGalleryWidget||(t._partGalleryWidget=i.create(u("<div class='"+g+"'><\/div>"),new i.ViewModel(t._lifetime)),n.addChild(t._partGalleryWidget.element))}))},n.prototype.onRemovingContent=function(){this._partMgmtStarted=!1},n.prototype._enterOrganizeMode=function(){var i=this._portalWidget,r=i.element,n;return(r.addClass(t.organizeModeClassName),r.removeClass(w),n=i.getTopBarWidget(),n&&n.options.isInOrganizeMode(!0),e.register(this._dismissHandle),o.FlowLayoutDragDrop.Instance.enableDragDropTargets(),this._wasContextPaneCollapsed=this._contextPane.collapsed(),!this._partMgmtStarted)?this.startPartManagment({}):Q()},n.prototype._exitOrganizeMode=function(){var r=this._portalWidget,u=r.element,n,i;o.FlowLayoutDragDrop.Instance.disableDragDropTargets();u.removeClass(t.organizeModeClassName);u.addClass(w);n=r.getTopBarWidget();n&&n.options.isInOrganizeMode(!1);i=this._contextPane;i.close(!0);i.collapsed(this._wasContextPaneCollapsed);this._deselectCurrentTile();this._userSettingsManager.flushSettings();e.unregister(this._dismissHandle)},n.prototype._handleModeChange=function(n,t){var i=this;n.mode.subscribe(t,(function(n){switch(n){case 1:i._services.getService("DialogManager").then((function(n){n.dismissOpenDialog()}));i._enterOrganizeMode();f.isFullscreen()&&f.exitFullscreen();break;case 0:default:i._exitOrganizeMode()}}))},n.prototype._deselectCurrentTile=function(){this._selectedTile&&(this._selectedTile.element.off(p,this._tileRemoveHandler),this._tileRemoveHandler=null,this._selectedTile.options.selected(!1),this._selectedTile=null)},n})();t.DesktopModeManagerImpl=y}));
define("MsPortalImpl/UI/Compositions/UI.Composition.Services",["require","exports","f","i","MsPortalImpl/Base/Base.Router","MsPortalImpl/Services/Services.AssetTypes","MsPortalImpl/Base/Themes","MsPortalImpl/UI/Commands/UI.CommandManager","MsPortalImpl/UI/UI.ContextPane","MsPortalImpl/UI/UI.DesktopManagerImpl","MsPortalImpl/UI/UI.DesktopModeManager","MsPortalImpl/UI/Hubs/UI.NotificationManager","MsPortalImpl/Widgets/Widgets.WidgetBase","FxHubs/RpcEndPoints"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){"use strict";var y;return (function(t){function b(t,b,k,d,g){var tt=r.Rpc.client,ft=b.extensionManager,et=b.diContainer.get(f.AssetTypeService);i.isFeatureEnabled("whatsnew")&&k.whatsNewEnabledKey()&&v.WhatsNew.showWhatsNewModal.register(tt,[y],(function(n){i.require("MsPortalImpl/Widgets/Widgets.WhatsNew").then((function(t){var i=n.items.map((function(n){var t=!n.published?"":new Date(n.published).toLocaleString();return n.description+="\r\n"+t,n}));new t.Widget($("<div />"),new a.ViewModel,i,d.element)}))}));v.UpdateContact.showUpdateContactModal.register(tt,[y],(function(n){i.require("MsPortalImpl/Widgets/Widgets.UpdateContact").then((function(t){new t.Widget($("<div />"),new t.ViewModel,n.profile,n.irisNotificationDetails,d.element)}))}));var it=e.createManager(t,w,k["fxs-theme"],k.highContrastKey),ot=d.getToastVM(),nt={diContainer:b.diContainer,rpcClient:tt,storageService:b.storageService,themeManager:it,settings:b.settings,extensionManager:ft,assetTypeService:et,desktop:null,modeManager:null,getService:null,router:null,notificationManager:null},rt=nt.desktop=h.createDesktopManager(d,nt),ut=o.createCommandManager(nt.desktop).startListeningForEvents(),st=nt.getService=i.memoizeQ((function(t){switch(t){case"DialogManager":return g();case"FeedbackPane":return p("../../Widgets/Widgets.FeedbackPane",n).then((function(n){return{amdModule:n,widget:new n.FeedbackPane(b.diContainer.get(s.RightContextPane),ot,function(){return rt.getCurrentBladeInfo()})}}));case"ThemeManager":return Q(it);case"PortalFormTarget":return ut.getFormTarget()}throw new Error("Invalid service type '{0}' specified.".format(t));}));return nt.notificationManager=l.createNotificationManager(nt),nt.router=u.createRouter(nt),nt.modeManager=c.createDesktopModeManager(nt,d,t),t.registerForDispose([rt,ut,nt.router,st,]),nt}var y=r.Extension.getHubsWindowId(),p=i.require,w=$("body,head");t.initialize=b})(y||(y={})),y}));
define("MsPortalImpl/UI/Hubs/UI.HubsRpcCallbacks",["require","exports","f","i","o","FxHubs/HubsSettingsSchema","FxHubs/RpcEndPoints","Fx/Composition/DashboardFilters","MsPortalImpl/UI/UI.DashboardFiltersManager"],(function(n,t,i,r,u,f,e,o,s){"use strict";function c(n,t,r){var u={store:i.isNullOrUndefined(r)?6:r,keys:t};return n.querySettings(u).then((function(n){return i.convertArrayToMap(t,i.identity,(function(t){return n[t]}))}))}function l(n,t,i){var r={store:6,settings:t};n.setSettings(r,i)}function a(n){var v=n.settings,t=n.rpcClient,a=[r.Extension.getHubsWindowId()];f.readHubsUserSettings.register(t,a,(function(n){return c(v,n.settingsKeys,n.settingStore)}));f.writeHubsUserSettings.register(t,a,(function(n){return l(v,n.settings,n.priority),undefined}));e.BrowserStorageSettings.readBrowserStorageSettingsEndpoint.register(t,a,(function(n){if(n.storageType!==0)return Q.reject("Access outside of local storage is denied.");var t={},i=!1;return n.storageKeys.forEach((function(n){h[n]||(i=!0);t[n]=MsPortalImpl.localStorage.getItem(h[n])})),i?Q.reject("Certain keys in the list are not allowed to be accessed."):Q(t)}));e.BrowserStorageSettings.writeBrowserStorageSettingsEndpoint.register(t,a,(function(n){if(n.storageType!==0)return Q.reject("Access outside of local storage is denied.");var t=!1;return(i.forEachKey(n.storageSettings,(function(n){h[n]||(t=!0)})),t)?Q.reject("Certain keys in the list are not allowed to be accessed."):(i.forEachKey(n.storageSettings,(function(n,t){i.getTypeOf(t)==="string"&&MsPortalImpl.localStorage.setItem(h[n],t)})),Q(null))}));e.PartFilterEndpoints.getFilters.register(t,a,(function(t){var r=n.desktop.startBoard,f=r.dashboardFiltersManager,e=r.getFilterIdsForPart(t).then((function(n){var i=[];return n.forEach((function(n){i.push(r.dashboardFiltersManager.getFilterIdText(t,n).then((function(t){return{id:n,displayString:t}})))})),Q.all(i)})),h=r.getDashboardFiltersForPart(t,!0);return Q.all([e,h]).then((function(n){var l={},h=n[1],c=[],e;return u.keys(h).forEach((function(r){var u=f.normalizeFilterModel(s.getFilterKindFromId(r),h[r]),e;r!==o.TimeRangeFilter.filterId&&(e=f.getFilterValueDisplayText(r,h[r],t).then((function(n){return{displayString:n,value:u.values}})),c.push(e.then((function(t){var f=i.find(n[0],(function(n){return n.id===r})).displayString;l[r]={filterIdDisplayText:f,operator:u.operator,valueString:t.displayString,values:t.value}}))))})),e=i.clone(r.getPartInstance(t).filters,!0)||{},u.keys(e).forEach((function(n){var r=f.getFilterValueDisplayText(n,e[n],t).then((function(t){e[n]=i.extend(f.normalizeFilterModel(s.getFilterKindFromId(n),e[n]),{valueString:t})}));c.push(r)})),Q.all(c).then((function(){return{dashboardFilterDisplays:l,dashboardTimeRangeFilter:h[o.TimeRangeFilter.filterId],partFilters:e||{},allPossibleFilters:n[0]}}))}))}));e.PartFilterEndpoints.getFilterValues.register(t,a,(function(t){return n.desktop.startBoard.dashboardFiltersManager.getFilterValues(t.filterId,t.filterText,t.partId)}));e.PartFilterEndpoints.getFilterValueDisplayText.register(t,a,(function(t){var i=n.desktop.startBoard.dashboardFiltersManager.denormalizeFilterModel(s.getFilterKindFromId(t.filterId),t);return n.desktop.startBoard.dashboardFiltersManager.getFilterValueDisplayText(t.filterId,i,t.partId)}));e.PartFilterEndpoints.getFilterWarning.register(t,a,(function(t){return n.desktop.startBoard.dashboardFiltersManager.getFilterWarning(t.filterId,t.filterModel)}))}u.defineProperty(t,"__esModule",{value:!0});var h=[];h[1]="hideBrowseInfo";t.registerRpcCallbacks=a}));
define("MsPortalImpl/UI/Hubs/UI.NotificationsPane",["require","exports","f","ko","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Widgets/Widgets.WidgetBase"],(function(n,t,i,r,u,f){"use strict";var e;return (function(n){var t=i.Hubs.Notifications.NotificationStatus,e=u.NotificationMenu,o=[t.Information,t.Warning,t.Error,t.Success],s=[t.Information],h=(function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t.hasNotifications=r.pureComputed((function(){return t.notifications&&(t.notifications()||[]).length})),t.lastPaneOpenedTime=r.observable(Date.now()),t.isPaneOpen=r.observable(!1),t.dismissOptions=[{name:e.informational,dismissableStates:s,isEnabled:r.pureComputed((function(){return t._checkNotificationsState(s)}))},{name:e.completed,dismissableStates:o,isEnabled:r.pureComputed((function(){return t._checkNotificationsState(o)}))},{name:e.all,dismissableStates:null,isEnabled:t.hasNotifications},],t}return __extends(t,n),t.prototype._checkNotificationsState=function(n){return this.hasNotifications()&&this.notifications().some((function(t){return n.indexOf(t.status)>-1}))},t})(f.ViewModel);n.ViewModel=h})(e||(e={})),e}));
define("MsPortalImpl/UI/Hubs/ViewModels/UI.Browse.ViewModelRegistration",["require","exports","f","i","o","MsPortalImpl/Extension/ExtensionManager","MsPortalImpl/Extension/ViewModelManager","MsPortalImpl/Services/Services.AssetTypes","MsPortalImpl/UI/Hubs/UI.BrowseManager"],(function(n,t,i,r,u,f,e,o,s){"use strict";function l(n){var t={diContainer:n,browseManager:n.get(s.BrowseManager),assetTypeService:n.get(o.AssetTypeService),extensionManager:n.get(f.ExtensionManager)},a=h+"All.Part",u,l;e.registerWithState("Browse$BrowseAllBlade$ServicesListPartViewModel",a,(function(n,i){return c.composePartViewModel((function(r){return new n.ServicesListPartViewModel(r,i,t)}),{initialState:i,logArea:a})}));e.registerWithState("Browse$BrowseServiceBladeViewModel",h+"Service.Blade",(function(n,u){var f=new i.ViewModels.Internal.ContainerViewModel;return new r.ViewModels.CompositionViewModel(f,new n.BrowseServiceBladeViewModel(f,u,t),u)}));u=h+"Service.Part";e.registerWithState("Browse$BrowseServiceBlade$ServiceItemsListPartViewModel",u,(function(n,i){return c.composePartViewModel((function(r){return new n.ServiceItemsListPartViewModel(r,i,t)}),{logArea:u})}));l=h+"Service.PinnedPart";e.registerWithState("Browse$BrowseServiceTileViewModel",l,(function(n,i){return c.composePartViewModel((function(r){return new n.BrowseServiceTileViewModel(r,i,t)}),{logArea:l})}))}u.defineProperty(t,"__esModule",{value:!0});var c=r.ViewModels.Part,h="./MsPortalImpl/UI/Hubs/ViewModels/UI.Browse";t.registerViewModels=l}));
define("MsPortalImpl/UI/Hubs/ViewModels/UI.Gallery.ViewModelRegistration",["require","exports","MsPortalImpl/Extension/ViewModelManager"],(function(n,t,i){"use strict";var r;return (function(n){function t(){i.register("Gallery$CsmCommand","./MsPortalImpl/UI/Hubs/ViewModels/UI.Gallery.CsmCommand",(function(n){return new n.CsmCommand}))}n.registerViewModels=t})(r||(r={})),r}));
define("MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.ViewModelRegistration",["require","exports","f","i","o","MsPortalImpl/Extension/ViewModelManager"],(function(n,t,i,r,u,f){"use strict";function w(n){var t=f.registerWithState,r,i,u,l;t(v+"ViewModel",e+(o+"Blade"),(function(n,t){var i=new c,r=new n.SettingsBladeViewModel(i,t);return new h(i,r,t)}));r=e+(o+"SettingsPart");t(v+"$SettingsPartViewModel",r,(function(t,i){return s((function(r){return new t.SettingsPartViewModel(r,i,n)}),{logArea:r})}));t(y+"ViewModel",e+(o+"LanguageSelectionBlade"),(function(n,t){var i=new c;return new h(i,new n.LanguageSelectionBladeViewModel(i,t),t)}));i=e+(o+"LanguageGrid");t(y+"$LanguageGridViewModel",i,(function(n,t){return s((function(i){return new n.LanguageGridViewModel(i,t)}),{logArea:i})}));t(p+"ViewModel",e+(o+"LocaleSelectionBlade"),(function(n,t){var i=new c;return new h(i,new n.LocaleSelectionBladeViewModel(i,t),t)}));u=e+(o+"LocaleGrid");t(p+"$LocaleGridViewModel",u,(function(n,t){return s((function(i){return new n.LocaleGridViewModel(i,t)}),{logArea:i})}));l=e+(o+"DiagnosticsPart");t("Help$HelpAndSupportBlade$DiagnosticsPartViewModel",l,(function(t,r){return s((function(i){return new t.DiagnosticsPartViewModel(i,r,n)}),{logArea:i})}))}u.defineProperty(t,"__esModule",{value:!0});var a=r.ViewModels,h=a.CompositionViewModel,s=a.Part.composePartViewModel,c=i.ViewModels.Internal.ContainerViewModel,e="./MsPortalImpl/UI/Hubs/ViewModels/",l="Settings$",v=l+"SettingsBlade",y=l+"LanguageSelectionBlade",p=l+"LocaleSelectionBlade",o="UI.Settings.";t.registerViewModels=w}));
define("MsPortalImpl/UI/UI.NpsHelper",["require","exports","f","MsPortalImpl/Base/Telemetry"],(function(n,t,i,r){"use strict";var u;return (function(n){function u(u,s,h,c,l,a){return t||!o&&e&&!n.npsShownInSession?i.require("MsPortalImpl/Widgets/Widgets.Nps").then((function(t){f.Diagnostics.Telemetry.trace({source:r.Source.ToastTray,action:r.Action.NPSShown,data:i.extend({productId:c},l)});t.showSurvey(u,s,h,c,a);n.npsShownInSession=!0})):Q(null)}function c(n,i,r){var f=r(),e=Date.now()-h,o=f<e&&Math.random()<s;return t||o?u(n,i,null,null,{surveyLastCompleted:f},(function(){r(Date.now())})):Q(null)}var f=i.Base,t=i.isFeatureEnabled("testnps"),e=i.isFeatureEnabled("nps"),o=i.isFeatureEnabled("ci"),s=(parseFloat(i.getFeatureValue("npspercent"))||1)/100,h=(parseInt(i.getFeatureValue("npsintervaldays"))||90)*864e5;n.npsShownInSession=!1;n.showNps=u;n.showPortalNps=c})(u||(u={})),u}));
define("MsPortalImpl/UI/UI.SessionHandler",["require","exports","f","o","ko"],(function(n,t,i,r,u){"use strict";function l(n,t,r){return t.addCallbacks({onIdle:function(t,i){var f=u.unwrap(n);f&&t.getTime()-i.getTime()>=f*6e4&&(o.warning("Signing out at {0} after idle timeout of {1} minutes".format(t,f)),r())},onBusy:i.noop})}function p(n,t,r,u,o,s,a){if(c?l(c,u,o):r.subscribeAndRun(n,(function(n){n&&!f?f=l(r,u,o):!n&&f&&u.removeCallbacks(f)})),i.isFeatureEnabled("sessionvalidity")){var p=function(){return Q.delay(v).then((function(){e().then((function(n){n&&i.require("MsPortalImpl/UI/UI.SessionHandlerDeferred",null,!0).then((function(n){n.validateSessionLifetime(t.bootstrapState,s,a,"SessionValidityPoll").then((function(n){n?(h(),p()):y()}))}))}))}))};p()}h()}r.defineProperty(t,"__esModule",{value:!0});var a=window,o=i.Base.Diagnostics.createLog(n),v=parseInt(i.getFeatureValue("sessionpollinterval"))||36e5,s="LastValidSessionTs",h=function(){MsPortalImpl.localStorage.setItem(s,Date.now().toString())},y=function(){MsPortalImpl.localStorage.removeItem(s)},c=parseInt(i.getFeatureValue("idletimeoutmins")),f,e=i.memoizeQ((function(){var n=a.fx.environment.links.graphPoliciesEndpoint;return n?Q(i.Base.Net2.ajax({uri:n,setAuthorizationHeader:{resourceName:"graph"}})).then((function(n){return(n.value||[]).some((function(n){return(n.type||"").toLowerCase()==="tokenlifetimepolicy"&&(n.definition||[]).some((function(n){return(n||"").toLowerCase().includes("maxagesession")}))}))})).catch((function(n){var t=(n.jqXHR||{}).status;return t===401||t===403?!0:t===0?(e.clear(),!1):(e.clear(),o.error("Error calling graph for policy details",n),!0)})):Q(!0)}));t.initialize=p}));
define("MsPortalImpl/UI/UI.ViewTimeTelemetry",["require","exports","f","i","o","MsPortalImpl/Base/Base.Events","MsPortalImpl/Base/Telemetry","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u,f,e,o){"use strict";function ft(n,t){l=n.desktop;k=t&&t.increment||w;d=t&&t.tooSmall||b;s&&s.dispose();s=new r.TriggerableLifetimeManager;rt=l.activeJourney.subscribe(s,(function(n){n?v():a(y)}));l.getDashboardManager().then((function(n){ut=n.currentDashboardId.subscribe(s,(function(n){v();p=n;a(y)}));p=n.currentDashboardId()}));var i,u,f;h.addEventListener(o.default.blur,u=function(){v()});h.addEventListener(o.default.focus,f=function(){a(y)});h.addEventListener(o.default.mousemove,i=function(){h.removeEventListener(o.default.mousemove,i);a()});s.registerForDispose((function(){h.removeEventListener(o.default.blur,u);h.removeEventListener(o.default.focus,f);h.removeEventListener(o.default.mousemove,i)}))}function et(){s&&(s.dispose(),s=null);v()}function a(n){c||l.activeJourney()||(n&&(nt=0,++g),tt=Date.now(),c=setTimeout((function(){it();c=null;a()}),k))}function v(){c!==null&&(clearTimeout(c),it());c=null}function it(){var n=Date.now()-tt;n>=d&&i.Base.Diagnostics.Telemetry.trace({source:e.Source.Shell,action:e.Action.DashboardViewTime,data:{target:"Dashboard",trackId:p,timespan:n,sequenceId:g,sequence:++nt,tileCount:l.startBoard.children.filter((function(n){return!n.dontSetupWidget})).length,fullscreen:!!f.isFullscreen()}})}u.defineProperty(t,"__esModule",{value:!0});var h=window,y=!0,w=3e5,b=1e4,l,p="",rt,ut,k=w,d=b,g=0,nt=0,c=null,tt,s;t.start=ft;t.stop=et}));
define("MsPortalImpl/UI/UI.Initialize",["require","exports","f","i","o","a","ko","$","MsPortalImpl/AsyncLoader","MsPortalImpl/Base/Base.KnockoutExtensions.FxParameterCollector","MsPortalImpl/Base/Base.BrowserDetection","MsPortalImpl/Base/Base.ImplUtils","MsPortalImpl/Base/ClaimsIdentity","MsPortalImpl/CodeComponentSideLoad/CodeComponentSideLoadModels","MsPortalImpl/Controls/ControlBindings.Async","MsPortalImpl/UI/UI.DialogManager","MsPortalImpl/Extension/DefinitionPreprocessor","MsPortalImpl/Extension/ExtensionMetadataSource","Fx/Feedback","MsPortalImpl/GalleryPackage/GalleryPackageLoader","MsPortalImpl/Resources/ImplScriptResources","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Interactions/Interactions.KeyboardShortcutHandler","MsPortalImpl/Interactions/Interactions.PortalReader","MsPortalImpl/Base/Languages","MsPortalImpl.Controls/Controls/ResourceFilterHelper","MsPortalImpl/Services/Services.AssetManagement","MsPortalImpl/Services/Services.AssetTypes","MsPortalImpl/Services/Services.AzureStorage","MsPortalImpl/Services/Services.BrowseCuration","MsPortalImpl/Services/Services.FileUploadEndpointRegistration","MsPortalImpl/Services/Services.FileUploadInitialization","MsPortalImpl/Services/Services.GeneralSettings","MsPortalImpl/Services/Services.FavoritesSettings","MsPortalImpl/Services/Services.PortalIdentity","MsPortalImpl/Services/Services.SharedSettings","MsPortalImpl/Services/Services.Storage","MsPortalImpl/Services/Services.PortalIdleState","MsPortalImpl/Services/Services.SecurityTokens","MsPortalImpl/Services/Services.SelectedSubscriptions","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Services/Services.ShellProvisioner","MsPortalImpl/Services/Services.TelemetrySharing","MsPortalImpl/Services/Services.Util","MsPortalImpl/Base/Telemetry","MsPortalImpl/UI/Hubs/ViewModels/UI.Browse.ViewModelRegistration","MsPortalImpl/UI/Compositions/UI.Composition","MsPortalImpl/UI/Compositions/UI.Composition.Services","MsPortalImpl/UI/Hubs/UI.BrowseManager","MsPortalImpl/UI/Hubs/UI.FavoritesManager","MsPortalImpl/UI/Hubs/ViewModels/UI.Gallery.ViewModelRegistration","MsPortalImpl/UI/Hubs/UI.HubsRpcCallbacks","MsPortalImpl/UI/Hubs/UI.NotificationsPane","MsPortalImpl/UI/UI.NpsHelper","MsPortalImpl/UI/UI.NavigationManager","MsPortalImpl/UI/Hubs/ViewModels/UI.Settings.ViewModelRegistration","MsPortalImpl/UI/UI.SessionHandler","MsPortalImpl/UI/UI.StatusHandler","MsPortalImpl/UI/UI.ViewTimeTelemetry","MsPortalImpl/Extension/ViewModelManager","MsPortalImpl/Widgets/Widgets.Portal","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Base/Base.EventTypes","MsPortalImpl/Base/Base.KnockoutExtensions","MsPortalImpl/Base/Base.KnockoutExtensions.Image","MsPortalImpl/Controls/ControlBindings","MsPortalImpl/Base/Base.KnockoutExtensions.Copy","MsPortalImpl/Base/Base.KnockoutExtensions.HtmlTemplateBinding","MsPortalImpl/Base/Base.KnockoutExtensions.OverrideComputed","MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedAttrBinding","MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedCssBinding","MsPortalImpl/Base/Base.KnockoutExtensions.SanitizedHtmlBinding","MsPortalImpl/Base/JQueryExtensions","MsPortalImpl/Parts/Parts.Intrinsics","MsPortalImpl/Parts/Parts.ButtonPart","MsPortalImpl/Parts/Parts.Collection","MsPortalImpl/UI/Compositions/UI.Composition.DynamicPartBinder","MsPortalImpl/UI/Compositions/UI.Composition.SelectableRegistration"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,wt,bt,kt,dt,gt,ni,ti,ii,ri,ui,fi,ei,oi,si,hi,ci,li,ai,vi,yi,pi,wi,bi,ki,di,gi){"use strict";function fu(n,t){t&&t.startsWith("#")&&n.route(t)}function ir(n,t,i){wr({source:n,action:t,data:i})}function yu(n,t){return Q().then(t).catch((function(n){kr.error(n)})).then((function(){return n.getCodeComponentsMetadata()}))}function pf(n){var f,e;if(n&&yr&&yr.getEntriesByType&&yr.timing){var u=ur(),i=function(n,t,i){pu(n,{duration:t,endTime:Math.round(i+yr.timing.navigationStart)})},o=yr.getEntriesByType("resource").filter((function(n){var t=n.initiatorType;return t==="link"||t==="script"})),r=o.reduce((function(n,t){return Math.min(t.startTime,n)}),Infinity),t=o.reduce((function(n,t){return Math.max(t.responseEnd,n)}),0),s=t-r,h=t;return r=Math.max(r,n),t=Math.min(t,u),f=t-r,e=u-f-n,i("TotalTimeToSplashScreen",n,n),i("TotalStartupResourceDownload",s,h),i("StartupResourceDownload",f,t),i("StartupScriptExecution",e,u),e}}function pu(n,t){t=t||{};var r=t.duration||ur(),i=t.data||{};return i.cdn="CdnIndex"+dr.index,i.bundling="Bundling"+dr.bundling,wr({timestamp:t.endTime,source:or,action:n,actionModifier:lr.ActionModifier.Complete,duration:r,data:i}),r}function wf(n,t){var i=n.getValue(lu,cu,au);return t!==i&&n.setValue(lu,cu,t,au),i}function bf(){bi.registerPrefix(w.PinVMPrefix,"./MsPortalImpl/Extension/PinBladeInferred",(function(n,t,i,r){return n.createViewModel(t,i,r)}))}function kf(n,t,r,u,f){var e=new ci.ViewModel,c=i.memoizeQ((function(){return nr("MsPortalImpl/Widgets/Widgets.NotificationsPane").then((function(n){return new n.Widget(o("<div/>"),e,t)}))})),s=i.memoizeQ((function(){return nr("MsPortalImpl/UI/Hubs/UI.NotificationHelper")})),h;t.notificationManager.notifications.subscribeArrayChanges(f,(function(n){s().then((function(t){return t.showToastAndUpdateCount(n,e,r)}))}),(function(n){s().then((function(t){return t.removeToastAndUpdateCount(n,e,r)}))}));f.registerForDispose(n.options.topBarViewModel.notificationButtonClick=function(){c().then((function(n){n.toggleNotificationsContextPane().then((function(){r.removeAllToasts();s().then((function(n){return n.updateUnreadCountOnButton(0)}))}))}))});h={events:gi.default.fxtoastclick,handler:function(n,t){u.handleNotificationClick(t,!0)}};r.eventHandlers.push(h)}function df(n,t,r,u,f){var e=i.memoizeQ((function(){return nr("MsPortalImpl/Widgets/Widgets.SettingsPane").then((function(n){return new n.Widget(o("<div/>"),new n.ViewModel,t,r,f)}))}));u.registerForDispose(e);n.element.on(gi.default.fxsettingsbuttonclick,(function(){e().then((function(n){ir(ar.TopBar,rr.SettingsPaneOpen);n.toggleSettingsContextPane()}))}))}function gf(n,t){n.feedbackButtonClick=function(){t.getService("FeedbackPane").then((function(n){var t=n.widget;ir(pr,rr.FeedbackSmileyClicked,{isPaneOpen:t.isVisible()});t.toggle()}))}}function ne(n,t,r,u,f,e){var s=i.memoizeQ((function(){return nr("MsPortalImpl/Widgets/Widgets.DirectoryPane").then((function(n){return new n.Widget(o("<div><\/div>"),new n.ViewModel,{portalServices:t,userInfoPromise:r,tenantsPromise:u,redirectWithCdn:e})}))}));f.registerForDispose(n.options.topBarViewModel.directoryButtonClick=function(){s().then((function(n){n.toggleDirectoryContextPane()}))})}function te(n,t,i,r){var u=function(n){return nr("MsPortalImpl/Widgets/Widgets.SharedOptionsInit").then((function(t){n(t)}))};n.initOptions((function(){return u((function(t){t.initSearchWidgetOptions(r,n,i)}))}));t.initOptions((function(){return u((function(n){n.initSideBarWidgetOptions(r,t,i)}))}))}function ie(n,t,i,r,u,f,e,o,s){var l=n.getToastVM(),c=n.getTopBarWidget(),a=n.getSearchWidget(),v=n.getSideBarWidget(),y=c.options,h;df(c,t,i,f,s);gf(y,t);te(a,v,t,f);kf(n,t,l,e,f);fr("directorypane")&&(h=t.diContainer.get(vt.SignedInUser),ne(n,t,h.getUserInfo(),h.getTenants(),f,o))}function re(){return i.convertArrayToMap(["EntryPoint","SignInIndex"],(function(n){return"PageTelemetry_"+n}),(function(n,t,i){var r=MsPortalImpl.sessionStorage.getItem(i);if(r)return MsPortalImpl.sessionStorage.removeItem(i),JSON.parse(r)}))}var wu;u.defineProperty(t,"__esModule",{value:!0});var hr=r,bu=hr.Data,ku=hr.Extension,du=hr.TriggerableLifetimeManager,cr=i.Base,gu=cr.Constants,nf=gu.Shell,gr=cr.Diagnostics,lr=gr.Telemetry,tf=r.NetDiagnostics,rf=cr.Resources,eu=r.Rpc,uf=i.Hubs.Notifications,ff=uf.NotificationStatus,ef=hr.Hubs.Notifications,of=i.Services,ou=cr.Net2,rr=ii.Action,ar=ii.Source,er=MsPortalImpl.Performance,su=cr.UriBuilder,vr=window,yr=vr.performance,nu=vr.fx,ur=nu.getTimestamp,wr=lr.trace,sf=eu.client,or=ar.Shell,tr=nu.environment,hf=tr.chrome,tu=tr.links,pr=ar.TopBar,nr=i.require,cf=i.ensureSuffix,br=cf(rf.getAppRelativeUri("/"),"/"),lf=vr.console,sr=vr.location,kr=gr.createLog(n),hu=br+"SignOut",af=br+"signin/index",vf=r.ensureAbsoluteUri(nu.internalEnv.errorPageUri),yf=i.isDevelopmentMode,cu="loadedPageVersion",lu=pt.ComponentName.Telemetry,au=0,dr=tr.cdn,fr=i.isFeatureEnabled,iu=fr("ci"),ru,uu,vu=function(){kr.warning.apply(kr,arguments)};ou.setAjaxLogFunc(vu);t.routeIfHash=fu;wu=(function(){function t(n){this._lifetime=new du;this._disposed=!1;this._dependencies=n}return t.prototype.initialize=function(){var t=this,f=this._lifetime,u=this._dependencies,ci=u.diContainer.get(ai.RootElements),cr=i.memoizeQ((function(){return Q(t._dependencies.diContainer.get(p.DialogManager))})),w=u.settings,pt=u.extensionManager,ii=u.storageService,bi=new su(sr.href);return u.diContainer.getAsync(pi.AuthStateManager).then((function(p){var lu=p.bootstrapState,au=function(n,r,u){var f=new su(n+sr.search+(u||"")),e=dr.forceIndex,o=f.query;p.clear(!0);e&&o.setParameter(dr.indexParameter,e);i.forEachKey(r,(function(n,t){return o.setParameter(n,t)}));t._redirect({uri:f.toString()})},wu,nu,te;if(!lu){au(br,null,sr.hash);return}tr.enableAnimations||o.enableAnimations(!1);nu=u.diContainer.get(wt.PortalIdleStateService);lr.initialize(or);lt.init(w);at.initFavoritesSettings(w);kt.init(w);var ue=dt.queryStores(w,[8,4]),cf=tr.pageVersion,kf=wf(ii,cf),yr={defaultRoute:!1,splashScreen:er.splashScreenLoadTime,initializeStart:ur(),cdnFailedIndex:u.cdnFailedIndex,loadedSameVersion:cf===kf,previousVersion:kf||"",performanceTelemetry:r.NetDiagnostics.getPerformanceTelemetry()};it.shutdown();it.initialize(ci.portal);var fe=it.read(g.Shell.Reader.portalLoading,1,"portal"),du=u.diContainer.get(pi.StatusHandler),ai,df=!1,gu=u.diContainer.getAsync(b.ExtensionMetadataSource).then((function(n){return n.getCodeComponentsMetadata()}));v.canModifyExtensions&&(gu=gu.then((function(n){return s.patchMetadataSource(u.diContainer).then((function(n){return yu(n,(function(){return n.registerTestPatchesFromUri(sr.href).then((function(){return n.listTestPatches().then((function(n){n=n||[];(t=MsPortalEarly.ExtensionLoader.patchUris).push.apply(t,n.map((function(n){return n.uri})));df=!!n.length;var t}))}))}))})).then((function(){return n}))})));var cu=u.diContainer.get(bt.SecurityTokensManager),gf=lt.processor.initialized.then((function(e){function ee(n){b.avatarImage(a.getAvatarImage(yi.avatarUri,yi.defaultAvatarUri,ii,n))}var he=bi.query.getParameter("l")!==undefined,ni,lr,ht,lt,pi,of,dr,it,pf,su,dt,kt,te,ae,vu,bu,b,fe,nf,wt,tf,oe,se;rt.initialize(f,ii,e.rawLocale,tr.localeFromQuery,he)&&t._redirect({uri:null,skipFlushBuffers:!0});Q.fcall((function(){i.isObject(tr)&&lf.log("Version: "+tr.version+"\nSession: "+i.sessionId)}));yr.initializeGeneralSettings=ur();ni=rt.currentLocaleContext;lr=ni.selectedDisplayLanguage;ir(or,rr.PortalInitializeLanguage,{language:lr,formatCulture:ni.selectedFormatCulture||lr});t._user=vt.SignedInUser.register(u.diContainer,lu.user);var yi=t._user.value,bt=yi.tenantId,ce=t._user.getTenants();nt.initialize();f.registerForDispose((function(){nt.dispose()}));ht=u.diContainer.get(ki.Widget);ai=fi.initialize(f,u,e,ht,cr);y.initialize(ai);lt=ai.desktop;ut.initialize(ai.assetTypeService,f);pi=Q(vt.getSubscriptions());of=pi.then((function(n){rf(n);u.diContainer.get(ei.RdfeAccessObservable).value((n&&n.subscriptions||[]).some((function(n){return n.requireRdfe})))}));t._notificationManager=ai.notificationManager;ku.extensionStatusEndPoint.register(sf,null,(function(n,t){n&&ne(n,t.srcWindowId)}));dr=ht.options;it=dr.topBarViewModel;fr("azureconsole")&&(it.getConsoleViewModel=function(){return nr("MsPortalImpl/Widgets/Widgets.Console").then((function(n){return new n.ViewModel({src:tr.consoleUri,getAuthToken:wu})}))});it.exitDevMode=function(){ci.showSplash(!0);MsPortalImpl.Extension.unregisterAll().then((function(){t._redirect({uri:br})}))};var wi=function(){nr("../Base/Base.ClientRawFileDownload",n).then((function(n){n.downloadFile({provideText:function(){return wf().then((function(n){return JSON.stringify(n,null,2)}))}},"PortalDiagnostics.json","charset=utf-8;application/json")}))},hr=i.memoizeQ((function(){return nr("../Base/Base.DebugInfo",n).then((function(n){return n.initialize(f,ai)}))})),le=hf.hideShortcuts?null:tt.setup(ht,ai,wi,(function(){hr().then((function(n){return n.toggleStickys(ru)}))})),cf=ht.element,ou=function(){return nr("MsPortalImpl/Widgets/Widgets.WelcomeSequence").then((function(n){return new n.Widget(o("<div />"),new di.ViewModel,cf,w)}))};f.registerForDispose(ou);pf=i.memoizeQ((function(){return nr("MsPortalImpl/Widgets/Widgets.HelpPane").then((function(n){return new n.Widget(o("<div/>"),new n.ViewModel,ai,wi,le,w,ou)}))}));f.registerForDispose(it.helpButtonClick=function(){pf().then((function(n){return n.toggle(ar.TopBar)}))});var wf=function(){return Q.all([nr("MsPortalImpl/Base/Base.DiagnosticsPopup"),of,fe]).spread((function(n){return n.getDiagnosticsData(ai,rf,uf,cu)}))},kf=bt==="72f988bf-86f1-41af-91ab-2d7cd011db47",gf=i.getFeatureValue("showbugreportlink");it.canReportBug(gf==="force"||gf==="true"&&kf&&!iu);it.reportBug=function(){nr("./UI.Portal.Actions",n).then((function(n){n.reportBug(ai,wf,bi)}))};su=ai.diContainer.get(oi.FavoritesManager);dt=dr.sideBarViewModel;dt.attachFavoritesManager(su);kt=ai.router;dt.onDashboardFavoriteClick=function(n){kt.navigateToDashboard(n)};te=i.getIdGenerator("SideBarOpeningBlade");dt.launchBlade=function(n){var u=kt.route(n),r=ht.getPanorama(),t=r&&r.getJourneyWidget(),i;t&&(i=te(),t.loadingHint(i,!0),u.finally((function(){t.loadingHint(i,!1);t.trigger(gi.default.fxbladerepos,null,{noScroll:!0,noExitPeekMode:!0})})))};yr.preGetExtensionMetadata=ur();vu=gu.then((function(n){yr.getExtensionMetadata=ur();ae=at.sidebarFavoritesProcessor.initialized.then((function(t){yr.favoritesManagerInitialized=ur();var i=t.favorites(),r=i&&JSON.parse(i);return ir(ar.SideBar,"SideBarSettings",{collapsed:e.sideBarCollapsedKey(),favorites:r,favoritesCount:r.length}),su.initializeFavorites(t,n)}));pt.initialize({extensions:n,useCachedManifests:!0});cu.registerGetAuthorizationTokenEndpoint(n);vt.initializeRpc(t._user,n);yt.initializeRpc();st.initializeRpc();ot.registerSasEndPoint();ti.registerEndpoints(eu.client,ai.desktop);var i=function(t){var i=n.some((function(n){return n.isTestExtension||n.isTestStamp}));return it.inDevMode(i||t||df),lt.initialize(n,ue,yr)};return v.canAddGalleryPackages?s.galleryPackageMetadataSource(u.diContainer).then((function(n){return yu(n,(function(){return n.registerTestGalleryPackagesFromUri(sr.href)}))})).then((function(n){var t=d.initialize(pt);return t.loadGalleryPackages(n),n&&n.length>0})).then((function(n){return yr.galleryPackagesSideload=ur(),i(n)})):i(!1)})).then((function(){yr.desktopAndExtensionManagerInitialize=ur();var n=fr("nodirectory"),t=function(){return ai.router.goToDashboardOnInit("UiInitialize",n)};return kt.initialRoute((function(){return yr.defaultRoute=!0,t()}),{skipFocus:n})})).then((function(){yr.setupInitialRoute=ur();ci.showSplash(!1);er.pageLoaded();yr.locationHash=bi.fragment.split("?")[0];yr.hiddenTime=er.getHiddenTime();var n={data:o.extend(yr,re())};pt.getHubsExtension().then((function(){ru=pu("TotalTimeToPortalReady",n)}));t._idleHandle=nu.addCallbacks({onIdle:function(){var n=vr.navigator;n&&n.onLine!==!1&&(ee(!0),i.getFeatureValue("prefetch")!=="false"&&nr("MsPortalImpl/Services/Services.PortalPrefetch",null,!0).then((function(n){n.start(f,nu,ii,ru)})),tr.useCachedManifests&&pt.refreshManifests().catch((function(){})),nr("MsPortalImpl/Services/Services.BrowserTelemetry",null,!0));nu.removeCallbacks(t._idleHandle)},onBusy:i.noop})})).catch((function(n){uu=uu||"/LoadFailed?stack="+encodeURIComponent(n&&n.stack).substr(0,1e3);t._redirect({uri:vf+uu})}));at.userDirectorySettingsProcessor.initialized.then((function(n){var t=i.isFeatureEnabled("tokenfetch");(!fr("directorypane")||n.signInToLastVisitedDirectory())&&n.userDefaultDirectory()!==bt?(n.userDefaultDirectory(bt),t&&p.persistentRefreshToken(bt)):t&&n.userDefaultDirectory()===bt&&p.persistentRefreshToken(bt)}));vu.then((function(){var n,i,u,f;w.querySetting(14,"FirstVisitedTimestamp").then((function(n){n||(n=Date.now(),w.setSetting(14,"FirstVisitedTimestamp",n));ir(or,rr.FirstVisited,{FirstVisitedTimestamp:n})}));!iu&&fr("guidedtour")?w.querySetting(7,"WelcomeSequence").then((function(n){n||ou().then((function(){ir(or,rr.PortalInitializeWelcome)}))})):fr("nodirectory")&&b.dropMenu.isMenuOpen(!0);t._notificationManager.listenForClientNotifications();ct.init(w);!fr("internalonly")||v.canModifyExtensions||kf||(n=r.trustedParentOrigin,i=n.replace(/^([^\/]+\/\/).+\.([^\.]+\.[^\.]+\.[^\.]+)$/,"$1$2"),n!==i&&(u=g.Portal,t._notificationManager.addClientNotification({status:ff.Information,title:u.preview,description:u.unsupportedEnvironment.format(n),uri:i,timestamp:new Date,uriAction:ef.ClientNotificationUriAction.OpenInCurrentTab})));c.isSafari&&c.webKitVersion<602&&(f=g.Portal,cr().then((function(n){return n.showModalDialog({title:f.unsupportedBrowser,description:f.unsupportedBrowserDesc.format(tu.unsupportedBrowser),buttons:1,showErrorIcon:!0})})))}));et.setupAssetTypeServiceRpc(ai);ai.diContainer.get(ft.AssetManager).onAssetDeleted((function(n,t,i){s.resourceMapManager(ai.diContainer).then((function(r){r.processAssetDeletion(n,t,i)}))}));return s.registerRpc(ai.diContainer),gt.create(ai),gr.ErrorReporter.initialize((function(){kr.debug(lt.getDiagnosticsData())})),h.initialize(lt,ai),bu=ht.getToastVM(),ie(ht,ai,pi,wi,hr,f,t._notificationManager,au,wu),k.Internal.showNpsEndpoint.register(ai.rpcClient,null,(function(n,t){li.showNps(w,bu,n.productDisplayName,(t.srcWindowId||"")+"_"+n.productId)})),k.Internal.canShowNpsEndpoint.register(ai.rpcClient,null,(function(){return!li.npsShownInSession})),li.showPortalNps(w,bu,e.npsTimeMs),b=it.avatarMenu,b.userIdentity(yi),b.hideTenant(fr("hideavatartenant")),t._user.getUserInfo().then((function(n){b.userInfo(n)})),fe=ce.then((function(n){var t=n.tenants;uf(t);b.listOfTenants(t)})),b.showDiagnostics=wi,b.signedOut=function(){p.clear();t._redirect({uri:hu})},b.openAccountPortal=function(){var n=tu.accountPortal;ir(pr,rr.AvatarMenuOpenBilling);fu(kt,n.startsWith("#")?n:n+"subscriptions")},i.isFeatureEnabled("directorypane")&&(b.switchDirectory=function(){return it.directoryButtonClick()}),ee(),dt.saveCollapseState=function(n){e.sideBarCollapsedKey(n)},b.giveFeedback=function(){ir(pr,rr.AvatarMenuOpenFeedback);fu(kt,tu.giveFeedback)},b.showMyAccessBlade=function(){ir(pr,rr.AvatarMenuOpenAccessDetails);lt.createJourneyForBlade({extension:"HubsExtension",detailBlade:"MyAccessBlade",detailBladeInputs:{resourceId:""},openInContextPane:!0,defaultMenuItemId:undefined},lt.generateLoadingJourneyGuid())},pi.then((function(n){var t=(ni.selectedFormatCulture||"").toLowerCase().split("-").slice(-1)[0];b.contactInfoEnabled(n.subscriptions.length&&i.isFeatureEnabled("contactinfo")&&!["at","ru","de","gr"].includes(t))})),b.showContactInfoBlade=function(){ir(pr,rr.AvatarMenuOpenContactInfo);lt.createJourneyForBlade({extension:"HubsExtension",detailBlade:"ContactInfoBlade",detailBladeInputs:{resourceId:""},openInContextPane:!0,defaultMenuItemId:undefined},lt.generateLoadingJourneyGuid())},b.switchedTenant=function(n,t){var i=l.getHashQueryStringSegment(sr.href);MsPortalImpl.localStorage.removeItem("LastValidSessionTs");au(af+"/@"+t.tenant.domainName,null,"#"+i)},!iu&&(yf||tr.clientOptimizations&&tr.clientOptimizations!=="true"||v.canModifyExtensions)&&hr().then((function(n){return n.startErrorDetection(f)})),f.registerForDispose(hr),nf="data-click-telemetry",wt=cf[0],wt.addEventListener(gi.default.mousedown,se=function(n){tf=n.target},!0),wt.addEventListener(gi.default.mouseup,oe=function(n){var i=tf,r,t;if(tf=null,n.target===i&&(r=o(i),t=r.closest("["+nf+"]",wt),t.length)){var e=t.attr(nf)+"",u=t.closest(".fxs-tile",wt).data(ui.CompositionInstanceDataName),f=u&&u.locator,s=f&&f.toFriendlyString()||or;wr({source:s,action:rr.CustomClick,name:e})}},!0),f.registerForDispose((function(){wt.removeEventListener(gi.default.mousedown,se,!0);wt.removeEventListener(gi.default.mouseup,oe,!0)})),ai.diContainer.get(ei.BrowseManager).initialize(),ri.registerViewModels(ai.diContainer),si.registerViewModels(),vi.registerViewModels({portalServices:ai,securityTokensManager:cu,subscriptions:rf,tenants:uf}),hi.registerRpcCallbacks(ai),bf(),du.isShellInitialized.resolve(),vu})),ne=function(n,t){du.onStatus(n,t)},rf=e.observable(),uf=e.observableArray();return bu.registerTelemetrySubmissionHandler(),tf.registerTelemetrySubmissionHandler(),hr.ProvisioningTelemetry.registerTelemetrySubmissionHandler(),ou.status.subscribe(f,(function(n){ne(n,nf)})),lr.addProcessor(ni.getProcessor(pt)),fr("consoletelemetry")&&(te=of.getConsoleTelemetryEventProcessor(),lr.addProcessor(te)),MsPortalEarly.initializedTelemetry(wr),pf(er.splashScreenLoadTime),gf.then((function(){wi.start(ai)})).then((function(){function r(n){vu("Injecting {0}blockable untrusted content : {1} from {2}".format(n.blockable?"":"un",n.tag,n.src));ir(or,"UntrustedSource",n)}function i(t){var i=t.src,s=t.tag,u=i!=="document.write",f,e,o;return u&&s==="SCRIPT"&&(f=document.createElement("a"),f.href=i,i=f.href,e=/(.*?)[#\?]|$/.exec(i)[1]||i,o=!!n.filter((function(n){return!!~e.indexOf(n||null)})).length,u=!i||o||!!r(t)&&!1),u}var n=er.allowList=er.allowList.concat(tr.cdnPrefixes);n.push(sr.host);n.push("about:blank");er.sourceLogger=i;er.sourceBacklog.forEach(i);fe();it.read(g.Shell.Reader.portalReady,1,"portal");yi.initialize(t._lifetime,p,lt.settings.idleTimeoutMins,nu,(function(){return t._redirect({uri:hu})}),t._user.value.tenantDomain,du)})),f.registerForDispose(wi.stop),wu=cu.initializeSecurityForShell(lu),ht.registerFileUploadEndpoints(),ct.uploadSettingsManager=w,gf}))},t.prototype.dispose=function(){this._disposed=!0;hr.resetGlobalState();var n=this._lifetime;n&&(n.dispose(),this._lifetime=null)},t.prototype._redirect=function(n){this._dependencies.diContainer.get(ai.WindowManager).redirect(n)},t})();t.Portal=wu}));
define("_generated/Less/MsPortalImpl/Base/Base.Images.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,".msportalfx-svg-c01{fill:#fff}.msportalfx-svg-c02{fill:#e5e5e5}.msportalfx-svg-c03{fill:#a0a1a2}.msportalfx-svg-c04{fill:#7a7a7a}.msportalfx-svg-c05{fill:#3e3e3e}.msportalfx-svg-c06{fill:#1e1e1e}.msportalfx-svg-c07{fill:#0f0f0f}.msportalfx-svg-c08{fill:#ba141a}.msportalfx-svg-c09{fill:#dd5900}.msportalfx-svg-c10{fill:#ff8c00}.msportalfx-svg-c11{fill:#fcd116}.msportalfx-svg-c12{fill:#fee087}.msportalfx-svg-c13{fill:#b8d432}.msportalfx-svg-c14{fill:#7fba00}.msportalfx-svg-c15{fill:#59b4d9}.msportalfx-svg-c16{fill:#3999c6}.msportalfx-svg-c17{fill:#804998}.msportalfx-svg-c18{fill:#ec008c}.msportalfx-svg-c19{fill:#0072c6}.msportalfx-svg-c20{fill:#68217a}.msportalfx-svg-c21{fill:#00188f}.msportalfx-svg-c22{fill:#e81123}.msportalfx-svg-c97{fill:#ffb900}.msportalfx-svg-c98{fill:#00a4ef}.msportalfx-svg-c99{fill:#f25022}.fxs-blade-header-icon .msportalfx-svg-c05,.fxs-sidebar-middle .msportalfx-svg-c05,.fxs-theme-dark .msportalfx-svg-c05,.msportalfx-inverted-theme .msportalfx-svg-c05{fill:#777}.fxs-blade-header-icon .msportalfx-svg-c07,.fxs-sidebar-middle .msportalfx-svg-c07,.fxs-theme-dark .msportalfx-svg-c07,.msportalfx-inverted-theme .msportalfx-svg-c07{fill:#f2f2f2}.msportalfx-svg-palette-white>*,.msportalfx-svg-palette-white>g>*{fill:#fff}.msportalfx-svg-palette-blue>*,.msportalfx-svg-palette-blue>g>*{fill:#3999c6}.msportalfx-svg-palette-black>*,.msportalfx-svg-palette-black>g>*{fill:#1e1e1e}.msportalfx-svg-palette-green>*,.msportalfx-svg-palette-green>g>*{fill:#7fba00}.msportalfx-svg-palette-gray>*,.msportalfx-svg-palette-gray>g>*{fill:#a0a1a2}.msportalfx-svg-palette-inherit>*,.msportalfx-svg-palette-inherit>g *{fill:inherit!important}.msportalfx-svg-badge{position:absolute;left:0;bottom:0;min-height:12px;min-width:12px}.ext-fxc-menu-icon>.msportalfx-svg-badge{left:8px;bottom:7px;min-height:8px;min-width:8px}.msportalfx-svg-disabled{filter:grayscale(100%)}@-moz-document url-prefix(){.msportalfx-svg-disabled{filter:none}}.msportalfx-svg-disabled .msportalfx-svg-c01{fill:#fff}.msportalfx-svg-disabled .msportalfx-svg-c02{fill:#e5e5e5}.msportalfx-svg-disabled .msportalfx-svg-c03{fill:#a1a1a1}.msportalfx-svg-disabled .msportalfx-svg-c04{fill:#7a7a7a}.msportalfx-svg-disabled .msportalfx-svg-c05{fill:#3e3e3e}.msportalfx-svg-disabled .msportalfx-svg-c06{fill:#1e1e1e}.msportalfx-svg-disabled .msportalfx-svg-c07{fill:#0f0f0f}.msportalfx-svg-disabled .msportalfx-svg-c08{fill:#676767}.msportalfx-svg-disabled .msportalfx-svg-c09{fill:#6f6f6f}.msportalfx-svg-disabled .msportalfx-svg-c10{fill:grey}.msportalfx-svg-disabled .msportalfx-svg-c11{fill:#898989}.msportalfx-svg-disabled .msportalfx-svg-c12{fill:#c3c3c3}.msportalfx-svg-disabled .msportalfx-svg-c13{fill:#838383}.msportalfx-svg-disabled .msportalfx-svg-c14{fill:#5d5d5d}.msportalfx-svg-disabled .msportalfx-svg-c15{fill:#999}.msportalfx-svg-disabled .msportalfx-svg-c16{fill:grey}.msportalfx-svg-disabled .msportalfx-svg-c17{fill:#717171}.msportalfx-svg-disabled .msportalfx-svg-c18{fill:#767676}.msportalfx-svg-disabled .msportalfx-svg-c19{fill:#636363}.msportalfx-svg-disabled .msportalfx-svg-c20{fill:#4e4e4e}.msportalfx-svg-disabled .msportalfx-svg-c21{fill:#484848}.msportalfx-svg-disabled .msportalfx-svg-c22{fill:#7d7d7d}.msportalfx-svg-disabled .msportalfx-svg-c97{fill:grey}.msportalfx-svg-disabled .msportalfx-svg-c98{fill:#787878}.msportalfx-svg-disabled .msportalfx-svg-c99{fill:#8a8a8a}.msportalfx-svg-loading-square{-webkit-animation:ProgressFlagAnimation 1.45s infinite ease-in-out;animation:ProgressFlagAnimation 1.45s infinite ease-in-out}.msportalfx-svg-loading-square:nth-child(1){-webkit-animation-delay:0s;animation-delay:0s}.msportalfx-svg-loading-square:nth-child(2){-webkit-animation-delay:.2s;animation-delay:.2s}.msportalfx-svg-loading-square:nth-child(3){-webkit-animation-delay:.4s;animation-delay:.4s}@-webkit-keyframes ProgressFlagAnimation{0%{opacity:1}30%{opacity:.6}60%{opacity:.3}}@keyframes ProgressFlagAnimation{0%{opacity:1}30%{opacity:.6}60%{opacity:.3}}.msportalfx-svg-flip-horizontal>svg,svg.msportalfx-svg-flip-horizontal{transform:scalex(-1)}.msportalfx-svg-flip-vertical>svg,svg.msportalfx-svg-flip-vertical{transform:scaley(-1)}.msportalfx-svg-rotate360{-webkit-animation:ImageRotation 1.45s infinite linear;animation:ImageRotation 1.45s infinite linear}@-webkit-keyframes ImageRotation{100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes ImageRotation{100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}")}));
define("_generated/Less/MsPortalImpl/Themes/Themes.Universal.css",["require","exports","o","module"],(function(n,t,i,r){"use strict";i.defineProperty(t,"__esModule",{value:!0});window.fx.injectCss(r,"a{color:#015cda}.fxs-topbar{background-color:#1c1c1c;color:#fff}.fxs-topbar .fxs-bg-warning,.fxs-topbar.fxs-bg-warning{color:#000}.fxs-topbar .fxs-bg-warning svg,.fxs-topbar.fxs-bg-warning svg{fill:#000}.fxs-topbar-search .fxs-searchbox input{background-color:#444;color:#fff}.fxs-topbar-search .fxs-searchbox input::-webkit-input-placeholder{color:#bbb}.fxs-topbar-search .fxs-searchbox input:-ms-input-placeholder{color:#bbb}.fxs-topbar-search .fxs-searchbox input::-moz-placeholder{color:#bbb}.fxs-trim,.fxs-trim-text,.fxs-trim-text a,a.fxs-trim-text{color:#fff}.fxs-topbar-dashboard,.fxs-topbar-exit-customize{background-color:#8a2da5}.fxs-trim{background-color:#252525}.fxs-trim-btn{color:#fff;border-color:#fff}.fxs-trim-title{color:#bbb}.fxs-trim-selected{background-color:#444}.fxs-trim-hover:hover{background-color:#3d3d3d}.fxs-trim-border{border-color:#444}.fxs-trim-svg{fill:#fff}.fxs-trim-svg .fxs-portal-svg{fill:#fff!important}.fxs-trim-svg-secondary{fill:#bbb}a.fxs-trim-text-primary{color:#55b3ff}.fxs-sidebar-star.fxs-is-favorite svg{fill:#ffb900;stroke:#000;stroke-width:1px}.fxs-sidebar .azc-form-labelcontainer{color:#fff}.fxs-bg-white{background-color:#fff}.fxs-overlay{background:rgba(0,0,0,.7)}.fxs-highlight{color:#000;background-color:#fff100}.fxs-tile-actionbar-action.fxs-tile-actionbar-action-pressed,.fxs-tile-actionbar-action:hover{background:rgba(125,125,125,.2)}.fxs-tile-actionbar-action.fxs-tile-actionbar-command-unpinfromstartboard:hover{background:#ba141a;fill:#fff}.fxs-portal .fxs-accent,.fxs-portal .fxs-popup{box-shadow:0 5px 15px 2px rgba(0,0,0,.3)}.fxs-portal .fxs-portal-main .azc-is-edited .azc-dockedballoon-validation.azc-control.azc-dockedballoon{border-color:#8a2da5}.fxs-blade-status-container,.fxs-blade-title-description{color:#000}.fxs-text-white{color:#fff}.fxs-fill-white{fill:#fff}.fxs-br-primary{border-color:#00bcf2}.fxs-tile-selected .fxs-tile-overlay{background-color:transparent}.fxs-bg-overlay-dark{background:rgba(0,0,0,.7)}.fxs-bg-primary-10{background-color:rgba(0,188,242,.1)}.azc-is-edited.azc-has-focus{border-color:#7fba00!important}.azc-is-edited.azc-has-focus .azc-dockedballoon-validation{border-color:#00bcf2}.azc-is-edited .azc-dockedballoon-validation{border-color:#8a2da5}.azc-disabled:hover,.azc-row-disabled:hover{background-color:inherit}.azc-disabled,.azc-disabled:focus,.azc-disabled:hover,input.azc-disabled{cursor:default;outline:0}.fxs-portal .fxs-text-info,.fxs-portal .msportalfx-text-info{color:#0058ad}.fxs-portal .fxs-text-success,.fxs-portal .msportalfx-text-success{color:#7fba00}.fxs-portal .fxs-text-dirty,.fxs-portal .msportalfx-text-dirty{color:#8a2da5}.fxs-portal .fxs-text-warning,.fxs-portal .msportalfx-text-warning{color:#ff8c00}.fxs-fill-info,.msportalfx-fill-info{fill:#0058ad!important}.fxs-fill-complete,.fxs-fill-success,.msportalfx-fill-success{fill:#7fba00!important}.fxs-fill-dirty,.fxs-fill-upsell,.msportalfx-fill-dirty{fill:#8a2da5!important}.fxs-fill-warning,.msportalfx-fill-warning{fill:#ff8c00!important}.fxs-fill-error,.msportalfx-fill-error{fill:#e81123!important}.fxs-br-info,.msportalfx-br-info{border-color:#00bcf2!important}.fxs-br-success,.msportalfx-br-success{border-color:#7fba00!important}.fxs-br-dirty,.msportalfx-br-dirty{border-color:#8a2da5!important}.fxs-br-warning,.msportalfx-br-warning{border-color:#ff8c00!important}.fxs-br-error,.msportalfx-br-error{border-color:#e81123!important}.fxs-bg-info,.msportalfx-bg-info{background-color:#0058ad!important}.fxs-bg-success,.msportalfx-bg-success{background-color:#7fba00!important}.fxs-bg-dirty,.fxs-bg-upsell,.msportalfx-bg-dirty{background-color:#8a2da5!important}.fxs-bg-warning,.msportalfx-bg-warning{background-color:#ff8c00!important}.fxs-bg-error,.msportalfx-bg-error{background-color:#e81123!important}.fxs-blade-statusbg.fxs-bg-info{background-color:#d1e7f8!important}.fxs-blade-statusbg.fxs-bg-complete,.fxs-blade-statusbg.fxs-bg-success{background-color:#d1ebd1!important}.fxs-blade-statusbg.fxs-bg-dirty,.fxs-blade-statusbg.fxs-bg-upsell{background-color:#e4d5f0!important}.fxs-blade-statusbg.fxs-bg-warning{background-color:#fff0d1!important}.fxs-blade-statusbg.fxs-bg-error{background-color:#f9b1b7!important}")}));
define("MsPortalImpl/Init",["require","exports","f","o","MsPortalImpl/Base/Base.Router","FxInternal/Di","MsPortalImpl/Extension/ExtensionManager","MsPortalImpl/Services/Services.Settings","MsPortalImpl/Base/Telemetry","MsPortalImpl/UI/UI.Initialize","MsPortalImpl/Services/Services.Storage","_generated/Less/MsPortalImpl/Base/Base.Images.css","_generated/Less/MsPortalImpl/Themes/Themes.Universal.css"],(function(n,t,i,r,u,f,e,o,s,h,c){"use strict";function k(n){var t={fx:p.version};n||d.initializedExtensions.forEach((function(n){t[n.name]=n.extension.getVersion()}));tt.custom("Session",rt,ut++,ft,t)}var b;r.defineProperty(t,"__esModule",{value:!0});var y=i.Base,g=y.Diagnostics,nt=y.UriBuilder,v=c.ComponentName,l=window,p=l.fx.environment,tt=g.createLog(n),it=p.cdn,a=f.container.get(c.StorageService),w=new nt(l.location.href);a.clearValue(v.Redirect,"ReloadCount",1);w.query=new y.QueryStringBuilder(l.fx.bootParameters.userQuery);u.history_replaceState(null,l.document.title,w.toString());it.enabled||(b=a.clearValue(v.Cdn,"FailedIndex",1));a.clearValue(v.Redirect,"IdpRedirectCount",1);var rt=1,ut=0,ft=a.clearValue(v.Redirect,"Referrers",1)||"";k(!0);l.setInterval(k,36e5);var d=f.container.get(e.ExtensionManager),et=f.container.get(o.SettingsManager),ot=new h.Portal({diContainer:f.container,storageService:a,settings:et,extensionManager:d,cdnFailedIndex:b});ot.initialize()}))