define("AdminUnit/AdminUnitUserService",["require","exports","o","Users/UsersResources","Shared/Notification"],(function(n,t,i,r,u){"use strict";i.defineProperty(t,"__esModule",{value:!0});var f=(function(){function n(n){this._dataContext=n}return n.prototype.assignUsersToAdminUnit=function(n,t){var i=new u.Notification;return i.PublishInProgress(r.addMemberToAdminUnitTitle,r.addMemberToAdminUnitInProgressMessage),this._dataContext.assignUsersToAdminUnit(n,t).then((function(){i.PublishOnSuccess(r.addMemberToAdminUnitTitle,r.addMemberToAdminUnitSuccessMessage)})).catch((function(){i.PublishOnError(r.addMemberToAdminUnitTitle,r.addMemberToAdminUnitFailMessage)}))},n.prototype.removeUsersFromAdminUnit=function(n,t){var i=new u.Notification;return i.PublishInProgress(r.removeMemberFromAdminUnitTitle,r.removeMemberFromAdminUnitInProgressMessage),this._dataContext.removeUsersFromAdminUnit(n,t).then((function(){i.PublishOnSuccess(r.removeMemberFromAdminUnitTitle,r.removeMemberFromAdminUnitSuccessMessage)})).catch((function(){i.PublishOnError(r.removeMemberFromAdminUnitTitle,r.removeMemberFromAdminUnitFailMessage)}))},n})();t.AdminUnitUserService=f}));
define("_generated/Microsoft_Azure_Policy/BladeReferences",["require","exports","Fx/Composition/Selectable"],(function(n,t,i){"use strict";var r;return (function(n){function r(n,t,i){return{onClosed:n,parameters:t,callbacks:i}}var t="Microsoft_Azure_Policy",h=(function(n){function i(i,u){return n.call(this,"ArmPolicyBlade",t,r(u,i),{})||this}return __extends(i,n),i})(i.PdlBladeReference),u,f,e,o,s;n.ArmPolicyBladeReference=h;u=(function(n){function i(i,u){return n.call(this,"AssignmentBlade",t,r(u,i),{})||this}return __extends(i,n),i})(i.PdlBladeReference);n.AssignmentBladeReference=u;f=(function(n){function i(i,u){return n.call(this,"EditAssignmentBlade",t,r(u,i),{})||this}return __extends(i,n),i})(i.PdlBladeReference);n.EditAssignmentBladeReference=f;e=(function(n){function i(i,u){return n.call(this,"EditPolicySetDefinitionBlade",t,r(u,i),{})||this}return __extends(i,n),i})(i.PdlBladeReference);n.EditPolicySetDefinitionBladeReference=e;o=(function(n){function i(i,u){return n.call(this,"PolicyMenuBlade",t,r(u,i),{})||this}return __extends(i,n),i})(i.PdlBladeReference);n.PolicyMenuBladeReference=o;s=(function(n){function i(i){return n.call(this,"UserPrivacyListBlade",t,r(i,undefined),{})||this}return __extends(i,n),i})(i.PdlBladeReference);n.UserPrivacyListBladeReference=s})(r||(r={})),r}));
define("Users/ViewModels/UsersList/UsersListBladeViewModelV2",["require","exports","f","i","o","ko","Shared/FilterableColumns/FilterableColumnCreator","Shared/FilterableColumns/ColumnsAndFilters","Fx/Controls/DropDown","_generated/ExtensionDefinition","Fx/Composition/TemplateBlade","Fx/Controls/TextBox","_generated/BladeReferences","Fx/Controls/Section","Shared/Utilities","Shared/DirectoryCache","Permissions/Permission","Shared/AdminUnit","AdminUnit/AdminUnitUserService","_generated/Microsoft_Azure_Policy/BladeReferences","DocumentProcessorTasks/Constants","Users/UsersResources","CommonResources","Users/Constants","MsPortalFx/Globalization","Users/ViewModels/UserAddNew/UserCreationService","Users/Utilities/UsersUtils"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft){"use strict";function vt(n){return n&&n.isB2BContext?n.isB2BContext.valueOf():!1}function pt(n,t){gt()||n.openBlade(new a.UserDetailsMenuBladeReference({userId:t}))}function ni(n){var r=it.usersListGridItemKeys.name,t=nt.usersListPartColumnUser,u={id:r,itemKey:r,name:f.observable(t),width:f.observable("25%"),format:st.Format.HtmlBindings,formatOptions:{htmlBindingsTemplate:"<div>\n    <img data-bind='attr: {src: settings.item.imageUrl}' class='ext-userslist-image ext-thumbnailborder-user' />\n    <a href=\"#\" class='msportalfx-text-ellipsis ext-userlist-row-align' data-bind='click: settings.item.openUserDetailsBlade, text: value'><\/a>\n<\/div>"},activatable:f.observable(!0),enableEllipse:f.observable(!0)},o=nt.userPropertyMaxLengthExceeded.format(it.validationsMaxLengthFormElements.userDisplayName);return e.availableColumnInfo(u,!0,!1,e.wrapTextBox(l.create(n,{label:t,ariaLabel:t,valueUpdateTrigger:4,placeHolderText:nt.usersListNameFilterPlaceholderText,suppressDirtyBehavior:!0,validations:f.observableArray([new i.ViewModels.MaxLengthValidation(it.validationsMaxLengthFormElements.userDisplayName,o)])}),(function(n,t){n.searchText=t})))}function ti(){var n=it.usersListGridItemKeys.userName,t={id:n,itemKey:n,name:f.observable(nt.usersListPartColumnUserName),width:f.observable("25%"),activatable:f.observable(!0),enableEllipse:f.observable(!0)};return e.availableColumnInfo(t,!0,!1)}function ii(n,t){var o=it.usersListGridItemKeys.userType,h={id:o,itemKey:o,name:f.observable(nt.usersListPartColumnUserType),activatable:f.observable(!0),width:f.observable("25%")},c=[{text:f.observable(nt.usersListBladeUserTypeFilterAllUsersText),value:it.userTypes.all},{text:f.observable(nt.userTypeFilterGuestUsersText),value:it.userTypes.guest}],i,r,u,l;return i=it.userTypes.all,vt(t)&&(c=[{text:f.observable(nt.userTypeFilterExternalUsersText),value:it.userTypes.external}],i=it.userTypes.external),r=nt.usersListBladeUserTypeFilterLabel,u=e.wrapDropDown(s.create(n,{value:i,label:r,ariaLabel:r,items:c,disabled:vt(t),visible:!vt(t),suppressDirtyBehavior:!0}),(function(n,t){n.filterValue=t})),u.alwaysVisible=!0,l=t&&t.adminUnitObjectId,l?e.availableColumnInfo(h,!0,!0):e.availableColumnInfo(h,!0,!0,u)}function ri(){var n=it.usersListGridItemKeys.source,t={id:n,itemKey:n,name:f.observable(nt.usersListPartColumnSourceOfAuthority),width:f.observable("25%"),activatable:f.observable(!0),enableEllipse:f.observable(!0)};return e.availableColumnInfo(t,!0)}function ui(n,t){return[ni(n),ti(n),ii(n,t),ri(n)]}function fi(n){return{objectId:n.objectId,displayName:n.displayName,userPrincipalName:n.userPrincipalName,source:n.source,dirSyncEnabled:n.dirSyncEnabled}}var ct,wt;u.defineProperty(t,"__esModule",{value:!0});var kt=i.Hubs.Notifications.ClientNotification,lt=i.Hubs.Notifications.NotificationStatus,et=i.Base,yt=i.ViewModels,dt=yt.Controls,st=dt.Lists.Grid,bt=yt.Dialogs,ot=yt.Toolbars,ht=et.Diagnostics.createLog(n),at=f.observable(null),gt=f.observable(!1);ct=wt=(function(){function n(){var n=this;this.grid=f.observable(null);this._isCreateUserDisabled=f.observable(!1);this._isReadUserDisabled=f.observable(!1);this._isDeleteUserDisabled=f.observable(!1);this._isInviteUserDisabled=f.observable(!1);this._isMFADisabled=f.observable(!1);this._isMFAVisible=f.observable(!1);this._currentUserId=f.observable("");this._autoGeneratePasswordForUser=f.observable(!0);this._MFANavigationUrl=f.observable("");this._addNotifySubscribers=function(t){n._dataContext.userAddNotifier.notifySubscribers({objectId:f.observable(t.objectId),displayName:f.observable(t.displayName),userPrincipalName:f.observable(t.userPrincipalName),displayUserPrincipalName:f.observable(t.displayUserPrincipalName),thumbnailMediaContentType:f.observable(t.thumbnailMediaContentType),hasThumbnail:f.observable(t.hasThumbnail),imageUrl:f.observable(t.imageUrl),givenName:f.observable(t.givenName),surname:f.observable(t.surname),mail:f.observable(t.mail),source:f.observable(t.source),userType:f.observable(t.userType),dirSyncEnabled:f.observable(t.dirSyncEnabled)});n._dataContext.crossAreaNotifiers.userAddNotifier.notifySubscribers(t.objectId)}}return n.prototype.onInitialize=function(){var n=this,u=this.context,t=u.container,s=u.model,c=u.parameters,e,h;this._dataContext=s;this._container=t;this._adminUnitUserService=new k.AdminUnitUserService(this._dataContext);this.title=nt.usersListBladeTitle;this.sectionHeaders=v.create(t,{children:[]});this._commandBar=new ot.Toolbar(t);e=ui(t,c);h=f.observableArray(e.map((function(n){return n.column.id})));this._InitializePermissionPromise();var l=this._dataContext.sharedDataContext.getCurrentContext.fetch({},this._container),a=i.Base.Security.getUserInfo(),w=p.DirectoryCache.getCachedDirectoryName(),r=o.setupColumnsAndFilters(t,h,e);return this.filterList=r.filterList,this._subscribeFilters(),y.isAdminUnitEnabled()&&this._setupAdminUnitFilter(),this._setupGrid(t,s,r.selectedColumns,r.expressFilterState),this._initializeNotifiers(),this._resetGrid(),Q.all([l,this._permissionPromise,a,w]).then((function(u){var o,h=u[0],c=h.data(),f,e,s;n._currentUserId(c.userId());u!==null&&u.length===4&&(o=u[1],n._ApplyUserRolePermissions(o),f=u[2],e=u[3],f!==null&&e&&(s=f.directoryId,n.subtitle=n._dataContext.getCommonSubtitle(e),n._MFANavigationUrl(wt.MFAUrl.format(i.getEnvironmentValue("iamuxBaseUri"),s,rt.formatCulture))));n._isReadUserDisabled()&&t.unauthorized();n._commandBarItems=n._populateCommandBar(r);n._adminUnitUsersCommandBarItems=n._populateCommandBarForAdminUnit(r);n._reloadCommandBar("");t.commandBar=n._commandBar})).catch((function(){n._container.noDataMessage(tt.retry)}))},n.prototype._populateCommandBarForAdminUnit=function(){var n=this,i=this._getAdminUnitObjectId(),e=function(t,r){if(t===2&&r&&r.selectedMembers.length>0){var u=r.selectedMembers.map((function(n){return n.objectId}));n._adminUnitUserService.assignUsersToAdminUnit(i,u).then((function(){n._dataContext.getUsersFromObjectIdsQuery.fetch(u,n._container).then((function(t){var i=t.data();n._dataContext.userAssignToAdminUnitNotifier.notifySubscribers(i)}))}))}},o=new ot.CommandButton({label:nt.addMemberToAdminUnit,icon:et.Images.Add(),command:{canExecute:f.observable(!0),execute:function(){var t={isSingleSelect:!1,isInviteEnabled:!1,searchCriteria:1,disabledObjectIds:n.grid().items().map((function(n){return n.objectId()}))};return n._container.openContextPane(new a.DirectoryObjectPickerBladeReference(t,e)),Q()}}}),s=new ot.CommandButton({label:nt.bulkAddMemberToAdminUnit,icon:et.Images.Add(),command:{canExecute:f.observable(!0),execute:function(){return n._container.openBlade(new a.TasksListBladeReference({asyncTaskType:g.tasksTypeDropdownItem.adminUnitAssign})),Q()}}}),t=new ot.DialogButton({label:nt.removeMemberFromAdminUnit,icon:et.Images.Delete(),disabled:f.observable(!0)}),r,u;return t.dialogOptions=new bt.MessageBox(nt.removeMemberFromAdminUnit,nt.removeMemberFromAdminUnitConfirmationMessage,4),t.command={canExecute:f.observable(!0),execute:function(t){if(t===6){var u=n.grid().selectableData.selectedItems(),r=u.map((function(n){return n.objectId()}));return n._adminUnitUserService.removeUsersFromAdminUnit(i,r).then((function(){n._dataContext.userRemoveFromAdminUnitNotifier.notifySubscribers(r)}))}return Q()}},r=new ot.CommandButton({label:nt.bulkRemoveMemberFromAdminUnit,icon:et.Images.Delete(),command:{canExecute:f.observable(!0),execute:function(){return n._container.openBlade(new a.TasksListBladeReference({asyncTaskType:g.tasksTypeDropdownItem.adminUnitRemoveMember})),Q()}}}),u=new ot.CommandButton({label:tt.refresh,icon:et.Images.Refresh(),command:{canExecute:f.observable(!0),execute:function(){return ht.verbose("Refresh command clicked on UsersListV2 blade."),n._resetGrid()}}}),f.reactor(this._container,(function(){var i=n.grid(),r;i&&(r=i.selectableData.selectedItems(),r.length===0?t.disabled(!0):t.disabled(!1))})),[o,s,t,r,u]},n.prototype._populateCommandBar=function(n){var t=this,v=new ut.UserCreationService(this._container,this._dataContext),p=this.context.parameters,s=new ot.OpenBladeButton2,u,e,i,o,c,h,l;return s.label(nt.addUserCommandLabel),s.icon(et.Images.Add()),s.id="Add",s.disabled(this._isCreateUserDisabled()),s.selectable=new r.Composition.Selectable.Selectable2({supplyBladeReference:function(){return new a.UserAddNewBladeReference({supplyInitialData:function(){return v.SupplyInitialData()},receiveResult:function(n){return v.ReceiveResult(n,t._addNotifySubscribers)},supplyProviderConfig:function(){return{}}})}}),u=new ot.OpenBladeButton2,u.label(nt.inviteUserCommandLabel),u.icon(et.Images.Add()),u.id="Invite",u.disabled(!y.isB2BUserInviteEnabled()||this._isInviteUserDisabled()),u.selectable=new r.Composition.Selectable.Selectable2({supplyBladeReference:function(){return new a.UserAddNewBladeV2Reference({initialMode:it.bladeMode.invite,lock:!0})}}),e=new ot.OpenBladeButton2,e.label(nt.userDetailsResetPasswordCommandTitle),e.icon(et.Images.Key()),e.disabled(!0),e.id="Reset",e.selectable=new r.Composition.Selectable.Selectable2({supplyBladeReference:function(){var n=t.grid().selectableData.selectedItems().first().objectId();return new a.UserDetailsResetPasswordBladeReference({autoGeneratePasswordForUser:t._autoGeneratePasswordForUser(),userId:n})}}),i=new ot.DialogButton,i.label(tt.deleteUser),i.icon(et.Images.Delete()),i.disabled(!0),i.dialogOptions=new bt.MessageBox(null,nt.userDeleteConfirmationMessage,4),i.command={canExecute:f.observable(!0),execute:function(n){var r,i,u;return(ht.verbose("Delete command clicked on UsersListv2 blade."),n===6)?(ht.verbose("Remove command confirmation accepted on UsersListV2 blade."),r=t.grid().selectableData.selectedItems(),i=[],r.forEach((function(n){var r=t.grid().items().first((function(t){return t.objectId===n.objectId}));i.push(r)})),u=t._deleteUserCore(i),Q(u)):(ht.verbose("Delete command confirmation rejected on UsersListV2 blade."),Q())}},o=new ot.OpenBladeButton2,o.label(nt.exportUserDataCommand),o.icon(et.Images.Download()),o.disabled(!1),o.id="Export",o.selectable=new r.Composition.Selectable.Selectable2({supplyBladeReference:function(){return new d.UserPrivacyListBladeReference}}),c=new ot.OpenLinkButton(this._MFANavigationUrl()),c.label(tt.multiFactorAuth),c.icon(et.Images.Hyperlink()),c.disabled(this._isMFADisabled()),h=new ot.CommandButton,h.label(tt.refresh),h.icon(et.Images.Refresh()),h.command={canExecute:f.observable(!0),execute:function(){return ht.verbose("Refresh command clicked on UsersListV2 blade."),t._resetGrid()}},l=[s,u,e,i,h,n.columnsCommand],this._isMFAVisible()&&l.splice(4,0,c),vt(p)&&(u.label(nt.inviteUserCommandLabel),l=[u,i,h,n.columnsCommand]),f.reactor(this._container,(function(){var r=t.grid(),n;r&&(n=r.selectableData.selectedItems(),n.length!==1?e.disabled(!0):(t._autoGeneratePasswordForUser(!0),e.disabled(!1)),n.length===0||n.length>it.usersMaxLimits.usersPerPageInUsersList||t._isDeleteUserDisabled()?i.disabled(!0):i.disabled(t._enableDisableDeleteUserCommandButton(n)),n.length>it.usersMaxLimits.usersPerPageInUsersList?t.context.container.statusBar({text:nt.multiUserDeleteInfoBox,state:5}):t.context.container.statusBar({text:"",state:0}),t._isDeleteUserDisabled()&&o.disabled(!0))})),l},n.prototype._deleteUserCore=function(n){var r=this,i=n.length,t,u=n.first().displayName(),f=n.first().userPrincipalName();t=kt.publish({title:i===1?nt.deleteUserNotificationProgressLabel:nt.deleteMulipleUserNotificationProgressLabel,description:i===1?nt.deleteSingleUserNotificationProgressDescription.format(u,f):nt.deleteMultipleUsersNotificationProgressDescription.format(i),status:lt.InProgress});var e=function(){n.forEach((function(n){var t=n.objectId();r._dataContext.userDeletedNotifier.notifySubscribers(t);r._dataContext.crossAreaNotifiers.userDeletedNotifier.notifySubscribers(t)}));t.title=i===1?nt.deleteUserNotificationSuccessLabel:nt.deleteMultipleUserNotificationSuccessLabel;t.description=i===1?nt.deleteSingleUserNotificationSuccessDescription.format(u,f):nt.deleteMultipleUserNotificationSuccessDescription.format(i);t.status=lt.Success;t.publish()},o=function(e){var o=e.responseJSON,s=!o?i:o.length,h;n.forEach((function(n){if(!!o&&o.indexOf(n.objectId())===-1){var t=n.objectId();r._dataContext.userDeletedNotifier.notifySubscribers(t);r._dataContext.crossAreaNotifiers.userDeletedNotifier.notifySubscribers(t)}}));s===i?(t.title=i===1?nt.deleteUserNotificationErrorLabel:nt.deleteMultipleUserNotificationErrorLabel,t.description=i===1?nt.deleteSingleUserNotificationErrorDescription.format(u,f):nt.deleteMultipleUserNotificationErrorDescription.format(i),t.status=lt.Error,t.publish()):(h=i-s,t.title=nt.deleteMultipleUserNotificationPartialSucessLabel,t.description=nt.deleteMultipleUserNotificationPartialSucessLabel.format(h,s),t.status=lt.Warning,t.publish())},s=n.map((function(n){return n.objectId}));return this._dataContext.DeleteUsers(s).then(e,o)},n.prototype._setupGrid=function(n,t,i,r){var u=this;this._eventNavigator=t.usersListQuery.createNavigator(n);var o=st.Extensions.SelectableRow|st.Extensions.Pageable|st.Extensions.RightClickableRow,s={pageable:{type:st.PageableType.Sequential,dataNavigator:this._eventNavigator},selectableRow:{selectionMode:2,itemMatchesSelection:function(n,t){return n.objectId()===t.objectId()},activateOnSelected:f.observable(!0),createSelection:fi}},e=new st.ViewModel(n,null,o,s);e.columns=i;e.showHeader=!0;this.grid(e);this._eventNavigator.items.subscribe(n,(function(){var i=u._eventNavigator.items(),t;i.forEach((function(i){i.commandGroup=f.observable(h.CommandGroupNames.userDeleteCommandGroup);i.sourceOfAuthority=f.observable(ft.getUserSourceOfAuthorityText(i.source()));i.displayedUserType=f.observable(ft.getDisplayUserTypeFromUserType(i));i.openUserDetailsBlade=function(){return pt(n,i.objectId())};t=i.objectId();e.items.remove((function(n){return n.objectId()===t}))}))}));this._resetGrid=function(){var n={searchText:"",top:it.usersMaxLimits.usersPerPageInUsersList,filterValue:"",adminUnit:u._getAdminUnitObjectId(),nextLink:null},t,i;return at(""),r(n),t=n.filterValue,y.isAdminUnitEnabled()&&u._adminUnitFilter&&u._adminUnitFilter.value&&(t===it.userState.all||t===""?(i=u._adminUnitFilter.value(),n.adminUnit=i,b.AdminUnit.setCurrentAdminUnit(i),u._adminUnitFilter.disabled(!1)):(u._adminUnitFilter.value(b.AdminUnit.AdminUnitsAllUsersDefaultValue),u._adminUnitFilter.disabled(!0))),u._eventNavigator.setQuery(n).finally((function(){var n=null;n=at()===it.userTypes.guest?nt.userListNoGuestUsersFound:at()===it.userState.deleted?nt.userListNoRecentlyDeletedUsersFound:nt.userListNoUsersFound;u.grid().noRowsMessage(n)}))}},n.prototype._reloadCommandBar=function(){this._isAdminUnitUsersList()?this._commandBar.setItems(this._adminUnitUsersCommandBarItems):this._commandBar.setItems(this._commandBarItems)},n.prototype._subscribeFilters=function(){var n=this,t=this.context.container;o.debounceFilterList(t,this.filterList,(function(){n._resetGrid()}))},n.prototype._setupAdminUnitFilter=function(){var n=this,t;this._isAdminUnitUsersList()||(t=b.AdminUnit.getAllAdminUnitsForCurrentTenant(this._container),t.then((function(t){var i=t.data();n._adminUnitFilter=n._createAdminUnitFilter(i);n.filterList.push(n._adminUnitFilter);n._subscribeExtraFilters()})))},n.prototype._subscribeExtraFilters=function(){var n=this;this.filterList.subscribe(this._container,(function(){n.filterList.indexOf(n._adminUnitFilter)===-1&&n.filterList.push(n._adminUnitFilter)}));o.debounceFilterList(this._container,f.observableArray([this._adminUnitFilter]),(function(){n._resetGrid()}))},n.prototype._initializeNotifiers=function(){var n=this;this._dataContext.userAddNotifier.subscribe(this._container,(function(t){var i=ft.cloneObject(t);i.sourceOfAuthority=f.observable(ft.getUserSourceOfAuthorityText(i.source()));i.displayedUserType=f.observable(ft.getDisplayUserTypeFromUserType(i));i.commandGroup=f.observable(h.CommandGroupNames.userDeleteCommandGroup);i.openUserDetailsBlade=function(){return pt(n._container,i.objectId())};n.grid().items.push(i)}));this._dataContext.userEditedNotifier.subscribe(this._container,(function(t){var i=n.grid().items(),r=t.objectId();i.every((function(n){return r===n.objectId()?(n.displayName(t.displayName()),n.userPrincipalName(t.userPrincipalName()),n.displayUserPrincipalName(t.displayUserPrincipalName()),n.imageUrl(t.imageUrl()),!1):!0}))}));this._dataContext.userDeletedNotifier.subscribe(this._container,(function(t){n.grid().items.remove((function(n){return n.objectId()===t}))}));this._dataContext.userAssignToAdminUnitNotifier.subscribe(this._container,(function(t){t.forEach((function(t){var i=ft.cloneObject(t);i.sourceOfAuthority=f.observable(ft.getUserSourceOfAuthorityText(i.source()));i.displayedUserType=f.observable(ft.getDisplayUserTypeFromUserType(i));i.commandGroup=f.observable(h.CommandGroupNames.userDeleteCommandGroup);i.openUserDetailsBlade=function(){return pt(n._container,i.objectId())};at()!==it.userState.deleted&&n.grid().items.push(i)}))}));this._dataContext.userRemoveFromAdminUnitNotifier.subscribe(this._container,(function(t){t.forEach((function(t){n.grid().items.remove((function(n){return n.objectId()===t}))}))}))},n.prototype._InitializePermissionPromise=function(){var n=[],t=y.isForceRefreshPermissions();n.push({objectType:w.TargetObjectType.User,actionType:w.ActionType.Read});n.push({objectType:w.TargetObjectType.User,actionType:w.ActionType.Create});n.push({objectType:w.TargetObjectType.User,actionType:w.ActionType.Delete});n.push({objectType:w.TargetObjectType.User,actionType:w.ActionType.InviteGuest});n.push({objectType:w.TargetObjectType.MultiFactorAuthentication,actionType:w.ActionType.Read});this._permissionPromise=w.Permission.CheckMultiplePermissions(n,this._container,t)},n.prototype._ApplyUserRolePermissions=function(n){var r,u,t;if(!i.isNullOrUndefined(n))for(r=0,u=n;r<u.length;r++)t=u[r],t.objectType===w.TargetObjectType.User&&t.actionType===w.ActionType.Read?this._isReadUserDisabled(!t.hasAccess):t.objectType===w.TargetObjectType.User&&t.actionType===w.ActionType.Create?this._isCreateUserDisabled(!t.hasAccess):t.objectType===w.TargetObjectType.User&&t.actionType===w.ActionType.Delete?this._isDeleteUserDisabled(!t.hasAccess):t.objectType===w.TargetObjectType.User&&t.actionType===w.ActionType.InviteGuest?this._isInviteUserDisabled(!t.hasAccess):t.objectType===w.TargetObjectType.MultiFactorAuthentication&&t.actionType===w.ActionType.Read&&(this._isMFADisabled(!t.hasAccess),this._isMFAVisible(t.isApplicable))},n.prototype._enableDisableDeleteUserCommandButton=function(n){var r=this,t=!1,i=0;return n.forEach((function(n){t=r._currentUserId()===n.objectId();(t||n.dirSyncEnabled()&&n.source()!==it.userSourceTypes.liveId&&n.source()!==it.userSourceTypes.externalOrgId)&&(i+=1)})),i===0?!1:!0},n.prototype._createAdminUnitFilter=function(n){var t=n.map((function(n){return{text:n.displayName(),value:n.objectId()}}));return t.splice(0,0,{text:nt.adminUnitsAllUsers,value:b.AdminUnit.AdminUnitsAllUsersDefaultValue}),s.create(this._container,{label:f.observable(nt.adminUnitsAdminUnitLabel),items:t,value:b.AdminUnit.getCurrentAdminUnit()||b.AdminUnit.AdminUnitsAllUsersDefaultValue,suppressDirtyBehavior:!0})},n.prototype._getAdminUnitObjectId=function(){return this.context.parameters&&this.context.parameters.adminUnitObjectId?this.context.parameters.adminUnitObjectId:""},n.prototype._isAdminUnitUsersList=function(){return!!this._getAdminUnitObjectId()},n})();ct.MFAUrl="{0}/usermanagement/multifactorverification.aspx?tenantId={1}&culture={2}&requestInitiatedContext=users";ct=wt=__decorate([c.Decorator({htmlTemplate:"./../../../Shared/Templates/AadGridPartContent.html",isPinnable:!1})],ct);t.UsersListBladeV2=ct}));
define("_generated/adapters/blade/UsersListBladeV2Adapter",["require","exports","o","Fx/Composition/ViewModelAdapters","Users/ViewModels/UsersList/UsersListBladeViewModelV2"],(function(n,t,i,r,u){"use strict";i.defineProperty(t,"__esModule",{value:!0});var f=(function(n){function t(t,i,r){return n.call(this,t,i,r,u.UsersListBladeV2)||this}return __extends(t,n),t})(r.ViewModelAdapter);t.UsersListBladeV2Adapter=f}));
define("_generated/Blades/UsersListBladeV2",["require","exports","_generated/Blades/UsersAreaStyles.css","_generated/Blades/UserProvisioning.css","_generated/Blades/Upsell.css","_generated/Blades/SupportRequestProblemDetailsAreaStyles.css","_generated/Blades/SpotlightStyles.css","_generated/Blades/SingleSignOn.css","_generated/Blades/SharedAreaStyles.css","_generated/Blades/Settings.css","_generated/Blades/SelectorAndGridStyles.css","_generated/Blades/PoliciesAreaStyles.css","_generated/Blades/PasswordResetAreaStyles.css","_generated/Blades/NotificationsAreaStyles.css","_generated/Blades/MultifactorAuthentication.css","_generated/Blades/MdmApps.css","_generated/Blades/ManagedApps.css","_generated/Blades/LoginTenantBranding.css","_generated/Blades/Licenses.css","_generated/Blades/GroupsAreaStyles.css","_generated/Blades/EnterpriseApps.css","_generated/Blades/Domains.css","_generated/Blades/DirectoriesAreaStyles.css","_generated/Blades/DevicesAreaStyles.css","_generated/Blades/CustomAppAddButtonParts.css","_generated/Blades/ClassicPolicies.css","_generated/Blades/AppList.css","_generated/Blades/ApplicationsStyles.css","_generated/Blades/ApplicationProxy.css","_generated/adapters/blade/UsersListBladeV2Adapter"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot){"use strict";var st;return (function(n){n.blade={name:"UsersListBladeV2",optionalInputs:["isB2BContext","adminUnitObjectId"],viewModelName:"Users$UsersListBladeV2Adapter",lenses:[],pinnable:!1,initialDisplayState:2,style:8,toolbar:{source:{valuesFrom:[{referenceType:0,property:"content.commandBar"}]}},templateBlade:{htmlTemplate:null,partSize:9,htmlTemplateInline:{file:"AadGridPartContent.html",content:'<div class="msportalfx-padding"> <div data-bind="pcControl: sectionHeaders"><\/div> <div data-bind="visible: filterList().length > 0"> <div class="ext-aad-grid-header"> <div class="ext-aad-grid-filtergroup"> <div data-bind="foreach: filterList"> <div data-bind="formElement: $data" class="ext-aad-grid-filter"><\/div> <\/div> <\/div> <\/div> <\/div> <div class="ext-aad-grid-body"> <div data-bind=\'pcControl: grid\'><\/div> <\/div> <\/div>'},styleSheets:[{file:"Blades/ApplicationProxy.css",content:ot},{file:"Blades/EnterpriseApps.css",content:g},{file:"Blades/EnterpriseApps.css",content:g},{file:"Blades/AppList.css",content:ft},{file:"Blades/CustomAppAddButtonParts.css",content:rt},{file:"Blades/ManagedApps.css",content:w},{file:"Blades/MdmApps.css",content:p},{file:"Blades/Settings.css",content:h},{file:"Blades/SingleSignOn.css",content:o},{file:"Blades/SharedAreaStyles.css",content:s},{file:"Blades/DevicesAreaStyles.css",content:it},{file:"Blades/DirectoriesAreaStyles.css",content:tt},{file:"Blades/Domains.css",content:nt},{file:"Blades/SharedAreaStyles.css",content:s},{file:"Blades/GroupsAreaStyles.css",content:d},{file:"Blades/Licenses.css",content:k},{file:"Blades/LoginTenantBranding.css",content:b},{file:"Blades/MultifactorAuthentication.css",content:y},{file:"Blades/NotificationsAreaStyles.css",content:v},{file:"Blades/PasswordResetAreaStyles.css",content:a},{file:"Blades/SelectorAndGridStyles.css",content:c},{file:"Blades/SelectorAndGridStyles.css",content:c},{file:"Blades/ClassicPolicies.css",content:ut},{file:"Blades/PoliciesAreaStyles.css",content:l},{file:"Blades/Upsell.css",content:u},{file:"Blades/ApplicationsStyles.css",content:et},{file:"Blades/SharedAreaStyles.css",content:s},{file:"Blades/SpotlightStyles.css",content:e},{file:"Blades/SupportRequestProblemDetailsAreaStyles.css",content:f},{file:"Blades/SharedAreaStyles.css",content:s},{file:"Blades/UserProvisioning.css",content:r},{file:"Blades/SharedAreaStyles.css",content:s},{file:"Blades/UsersAreaStyles.css",content:i}],isV2:!0},attributes:1}})(st||(st={})),st}))