define("MsPortalImpl/Interactions/Interactions.FlowLayoutUserResize",["require","exports","f","ko","MsPortalImpl/Interactions/Interactions.DismissHandler","MsPortalImpl/Widgets/Widgets.WidgetBase","MsPortalImpl/Widgets/Widgets.FlowLayout","MsPortalImpl/Base/Base.EventTypes"],(function(n,t,i,r,u,f,e,o){"use strict";var s;return (function(n){function tt(n){var t=n.closest(d);return k(t,e.Widget)}function w(n){var i=t.initialWidth+(n.pageX-t.startX),r=t.initialHeight+(n.pageY-t.startY);return i=Math.max(i,85),r=Math.max(r,85),{width:i,height:r}}function rt(){t.targetGrid.refreshLayout();b()}function b(){var n,i;$(document).off(o.default.mousemove,a).off(o.default.mouseup,v);c.clearTimeout(h);u.unregister(p);s.detach().empty();n=t.target;n&&n.css({display:""});i=t.targetGrid;i&&i.disposeDropPlaceholder();t=null}function ut(n){var t=n.element,i=n.options,u=n.ltm;r.computed(u,(function(){i.userResizable()?t.append(nt):t.findByClassName(l).remove()}));u.registerForDispose([t.setEvents([o.default.mousedown,"."+l,function(n){it(n,{element:t,id:i.id})}]),function(){$(document).off(o.default.mousemove,a).off(o.default.mouseup,v)}])}var y=i.Widgets.AzureGrid,c=window,k=f.Widget.getWidget,d=".fxs-flowlayout",g=".fxs-flowlayout-childcontainer",l="fxs-flowlayout-resizehandle",nt='<div class="'+l+'"><div><\/div><\/div>',s=$('<div class="fxs-flowlayout-livepreview"><\/div>'),p={dismissFn:rt,logName:"flowlayoutuserresize"},h,t,a=function(n){n.preventDefault();n.stopPropagation();var i=w(n);s.css(i);t.targetGrid.resizeDropPlaceholder(i.width,i.height);c.clearTimeout(h);h=c.setTimeout((function(){t.target.trigger(o.default.fxsizechange,[t.targetId,i.width,i.height,!1]);h=null}),250)},v=function(n){n.preventDefault();n.stopPropagation();t.target.find("iframe").css({pointerEvents:""});var i=w(n);t.target.trigger(o.default.fxsizechange,[t.targetId,i.width,i.height]);t.targetGrid.trigger(o.default.fxenterorganizemode);b()},it=function(n,i){var r,f,e;if((n.preventDefault(),n.stopPropagation(),r=i.element,r.find("iframe").css({pointerEvents:"none"}),!t||t.target===r)&&(f=parseInt(r.css("width"))||r.outerWidth(),e=parseInt(r.css("height"))||r.outerHeight(),t={target:r,targetId:i.id,targetGrid:tt(r),startX:n.pageX,startY:n.pageY,initialWidth:f,initialHeight:e},!t||t.target===r)){var c=r.css("left"),l=r.css("top"),h=t.targetGrid;h.createDropPlaceholder(f,e);h.moveDropPlaceholder({col:Math.floor(parseInt(c)/y.GridSpacingWidth),row:Math.floor(parseInt(l)/y.GridSpacingHeight)});h.element.find(g).prepend(s);s.css({width:f,height:e,top:l,left:c});s.empty().append(r.clone().css({top:0,left:0,width:"100%",height:"100%"}));r.css({display:"none"});$(document).on(o.default.mousemove,a).one(o.default.mouseup,v);u.register(p,!0)}};n.addUserResizeBehavior=ut})(s||(s={})),s}))