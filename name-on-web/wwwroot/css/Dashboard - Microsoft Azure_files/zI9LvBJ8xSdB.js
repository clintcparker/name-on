var __extends=this&&this.__extends||(function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}})();define("WebsitesExtension/TypeScript/ViewModels/Parts/SingleWebsitePart",["require","exports","f","o","ko","Websites/ClientResources/GeneralResources","WebsitesExtension/TypeScript/ExtensionAssets/Constants","WebsitesExtension/TypeScript/Models/WebsiteResourceId","WebsitesExtension/TypeScript/Data/Data.Websites","WebsitesExtension/TypeScript/_generated/Svg","WebsitesExtension/TypeScript/_generated/ExtensionDefinition","WebsitesExtension/TypeScript/Utility/Utility.Website","WebsitesExtension/TypeScript/Environment/Environment.Switcher"],(function(n,t,i,r,u,f,e,o,s,h,c,l,a){"use strict";var v;return (function(n){var t=(function(n){function t(t,r,f){var e=n.call(
this)||this;return e.WebsiteId=u.observable(),e.resourceUri=u.observable(""),e.container=t,e.icon(i.Base.Images.ImageUri(i.Base.Resources.getContentUri("Content/Images/Azure-Website-50x50.png"))),e._websiteView=f.websitesData.websiteCache.createView(t),e}return __extends(t,n),t.prototype.onInputsSet=function(n){var t=this,r,u;return n.id?(typeof n.id=="string"?(r=o.WebsiteResourceId.fromCsmResourceId(n.id),this.WebsiteId(r),this.resourceUri(n.id)):(this.WebsiteId(n.id),this.resourceUri(o.WebsiteResourceId.toCsmResourceId(n.id))),this.assetId(this.resourceUri()),u=a.isFeatureSet(e.EnvPartNames.AnyPart,e.EnvFeature.UseOldWebsiteBlade,this.WebsiteId().SubscriptionId),Q.all([u,this._checkReadPermission()]).then((function(n){var r=n[0];if(t.container.selectable.selectedValue({detailBlade:r?c.BladeNames.websiteBlade:c.BladeNames.appsOverviewBlade,detailBladeInputs:{id:t.resourceUri()}}),n[1])return t._websiteView.fetch(t.WebsiteId()).then((function(){var u=t._websiteView.item();t._website=u;var
o=f.website,n=i.Base.Images.Polychromatic.Website(),r=!u.Kind()?"":u.Kind().toLowerCase();o=l.getDisplayTypeForSite(u);r.indexOf(e.KindsAvailable.ApiApp)>-1?n=h.Content.Images.apiApp:r.indexOf(e.KindsAvailable.Mobileappcode)>-1?n=i.Base.Images.Polychromatic.Mobile():r.indexOf(e.KindsAvailable.MobileApp)>-1?n=i.Base.Images.Polychromatic.Mobile():r.indexOf(e.KindsAvailable.ApiAppV2)>-1?n=h.Content.Images.apiApp:r.indexOf(e.KindsAvailable.Webjob)>-1?n=i.Base.Images.Polychromatic.WebJobs():r.indexOf(e.KindsAvailable.Bots)>-1?(n=h.Content.Images.azurebotservicesblue,t.container.selectable.selectedValue({detailBlade:c.BladeNames.botsIFrameBlade,detailBladeInputs:{id:t.resourceUri()}})):r.indexOf(e.KindsAvailable.Botsv2)>-1?(n=h.Content.Images.azurebotservicesblue,t.container.selectable.selectedValue({detailBlade:c.BladeNames.botsV2IFrameBlade,detailBladeInputs:{id:t.resourceUri()}})):r.indexOf(e.KindsAvailable.Functions)>-1&&(n=h.Content.Images.functions,t.container.selectable.selectedValue(
{detailBlade:c.BladeNames.functionsIFrameBladeFromNonBrowse,detailBladeInputs:{id:t.resourceUri()}}));t.assetType(o);t.icon(n);t.assetName(u.DisplayName());t._website.Status.subscribe(t.container,(function(){t._setSiteState()}));t._setSiteState()}),(function(){i.UI.AssetManager.notifyAssetDeleted(c.AssetTypes.Website.name,t.resourceUri())}));t.container.noDataMessage(f.noAccessText)}))):Q.reject()},t.prototype._setSiteState=function(){this.status(s.getWebsiteStatus(this._website));switch(this.status()){case e.WebsiteStatus.Running:this.state(1);break;case e.WebsiteStatus.Configuring:case e.WebsiteStatus.Deleting:case e.WebsiteStatus.Restarting:case e.WebsiteStatus.Starting:case e.WebsiteStatus.Stopping:this.state(0);break;case e.WebsiteStatus.Stopped:this.state(3);break;default:this.state(2)}},t.prototype._checkReadPermission=function(){return i.Base.Security.hasPermission(this.resourceUri(),[c.AssetTypes.Website.Permissions.read])},t})(i.ViewModels.AssetPart);n.SingleWebsitePart=t})(v||(v={})
),v}))